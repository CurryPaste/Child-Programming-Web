(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-469ec564","chunk-2d0db847","chunk-2d0c8988"],{"00d8":function(t,e){(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,r=0;i<t.length;i++,r+=8)e[r>>>5]|=t[i]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(t){for(var i=[],r=0;r<t.length;r+=3)for(var n=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?i.push(e.charAt(n>>>6*(3-o)&63)):i.push("=");return i.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],r=0,n=0;r<t.length;n=++r%4)0!=n&&i.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|e.indexOf(t.charAt(r))>>>6-2*n);return i}};t.exports=i})()},"044b":function(t,e){function i(t){return!!t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function r(t){return"function"===typeof t.readFloatLE&&"function"===typeof t.slice&&i(t.slice(0,0))}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(i(t)||r(t)||!!t._isBuffer)}},"0789":function(t,e,i){"use strict";i.d(e,"c",(function(){return h})),i.d(e,"d",(function(){return c})),i.d(e,"a",(function(){return u})),i.d(e,"b",(function(){return d}));var r=i("d9f7");function n(t=[],...e){return Array().concat(t,...e)}function o(t,e="top center 0",i){return{name:t,functional:!0,props:{group:{type:Boolean,default:!1},hideOnLeave:{type:Boolean,default:!1},leaveAbsolute:{type:Boolean,default:!1},mode:{type:String,default:i},origin:{type:String,default:e}},render(e,i){const o="transition"+(i.props.group?"-group":""),s={props:{name:t,mode:i.props.mode},on:{beforeEnter(t){t.style.transformOrigin=i.props.origin,t.style.webkitTransformOrigin=i.props.origin}}};return i.props.leaveAbsolute&&(s.on.leave=n(s.on.leave,t=>{const{offsetTop:e,offsetLeft:i,offsetWidth:r,offsetHeight:n}=t;t._transitionInitialStyles={position:t.style.position,top:t.style.top,left:t.style.left,width:t.style.width,height:t.style.height},t.style.position="absolute",t.style.top=e+"px",t.style.left=i+"px",t.style.width=r+"px",t.style.height=n+"px"}),s.on.afterLeave=n(s.on.afterLeave,t=>{if(t&&t._transitionInitialStyles){const{position:e,top:i,left:r,width:n,height:o}=t._transitionInitialStyles;delete t._transitionInitialStyles,t.style.position=e||"",t.style.top=i||"",t.style.left=r||"",t.style.width=n||"",t.style.height=o||""}})),i.props.hideOnLeave&&(s.on.leave=n(s.on.leave,t=>{t.style.setProperty("display","none","important")})),e(o,Object(r["a"])(i.data,s),i.children)}}}function s(t,e,i="in-out"){return{name:t,functional:!0,props:{mode:{type:String,default:i}},render(i,n){return i("transition",Object(r["a"])(n.data,{props:{name:t},on:e}),n.children)}}}var a=i("80d2"),l=function(t="",e=!1){const i=e?"width":"height",r="offset"+Object(a["D"])(i);return{beforeEnter(t){t._parent=t.parentNode,t._initialStyle={transition:t.style.transition,overflow:t.style.overflow,[i]:t.style[i]}},enter(e){const n=e._initialStyle;e.style.setProperty("transition","none","important"),e.style.overflow="hidden";const o=e[r]+"px";e.style[i]="0",e.offsetHeight,e.style.transition=n.transition,t&&e._parent&&e._parent.classList.add(t),requestAnimationFrame(()=>{e.style[i]=o})},afterEnter:o,enterCancelled:o,leave(t){t._initialStyle={transition:"",overflow:t.style.overflow,[i]:t.style[i]},t.style.overflow="hidden",t.style[i]=t[r]+"px",t.offsetHeight,requestAnimationFrame(()=>t.style[i]="0")},afterLeave:n,leaveCancelled:n};function n(e){t&&e._parent&&e._parent.classList.remove(t),o(e)}function o(t){const e=t._initialStyle[i];t.style.overflow=t._initialStyle.overflow,null!=e&&(t.style[i]=e),delete t._initialStyle}};o("carousel-transition"),o("carousel-reverse-transition"),o("tab-transition"),o("tab-reverse-transition"),o("menu-transition"),o("fab-transition","center center","out-in"),o("dialog-transition"),o("dialog-bottom-transition"),o("dialog-top-transition");const h=o("fade-transition"),c=(o("scale-transition"),o("scroll-x-transition"),o("scroll-x-reverse-transition"),o("scroll-y-transition"),o("scroll-y-reverse-transition"),o("slide-x-transition")),u=(o("slide-x-reverse-transition"),o("slide-y-transition"),o("slide-y-reverse-transition"),s("expand-transition",l())),d=s("expand-x-transition",l("",!0))},"0bc6":function(t,e,i){},"166a":function(t,e,i){},"169a":function(t,e,i){"use strict";i("368e");var r=i("480e"),n=i("4ad4"),o=i("b848"),s=i("75eb"),a=i("e707"),l=i("e4d3"),h=i("21be"),c=i("a293"),u=i("58df"),d=i("d9bd"),p=i("80d2");const f=Object(u["a"])(o["a"],s["a"],a["a"],l["a"],h["a"],n["a"]);e["a"]=f.extend({name:"v-dialog",directives:{ClickOutside:c["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:[String,Number],noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:[String,Number]},data(){return{activatedBy:null,animate:!1,animateTimeout:-1,stackMinZIndex:200,previousActiveElement:null}},computed:{classes(){return{[("v-dialog "+this.contentClass).trim()]:!0,"v-dialog--active":this.isActive,"v-dialog--persistent":this.persistent,"v-dialog--fullscreen":this.fullscreen,"v-dialog--scrollable":this.scrollable,"v-dialog--animated":this.animate}},contentClasses(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive(t){var e;t?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null===(e=this.previousActiveElement)||void 0===e||e.focus())},fullscreen(t){this.isActive&&(t?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created(){this.$attrs.hasOwnProperty("full-width")&&Object(d["e"])("full-width",this)},beforeMount(){this.$nextTick(()=>{this.isBooted=this.isActive,this.isActive&&this.show()})},beforeDestroy(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick(){this.animate=!1,this.$nextTick(()=>{this.animate=!0,window.clearTimeout(this.animateTimeout),this.animateTimeout=window.setTimeout(()=>this.animate=!1,150)})},closeConditional(t){const e=t.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(e)||this.overlay&&e&&!this.overlay.$el.contains(e))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):a["a"].options.methods.hideScroll.call(this)},show(){!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick(()=>{this.$nextTick(()=>{var t,e;(null===(t=this.$refs.dialog)||void 0===t?void 0:t.contains(document.activeElement))||(this.previousActiveElement=document.activeElement,null===(e=this.$refs.dialog)||void 0===e||e.focus()),this.bind()})})},bind(){window.addEventListener("focusin",this.onFocusin)},unbind(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside(t){this.$emit("click:outside",t),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown(t){if(t.keyCode===p["w"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;const t=this.getActivator();this.$nextTick(()=>t&&t.focus())}this.$emit("keydown",t)},onFocusin(t){if(!t||!this.retainFocus)return;const e=t.target;if(e&&this.$refs.dialog&&![document,this.$refs.dialog].includes(e)&&!this.$refs.dialog.contains(e)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some(t=>t.contains(e))){const t=this.$refs.dialog.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])'),e=[...t].find(t=>!t.hasAttribute("disabled")&&!t.matches('[tabindex="-1"]'));e&&e.focus()}},genContent(){return this.showLazyContent(()=>[this.$createElement(r["a"],{props:{root:!0,light:this.light,dark:this.dark}},[this.$createElement("div",{class:this.contentClasses,attrs:{role:"dialog","aria-modal":this.hideOverlay?void 0:"true",...this.getScopeIdAttrs()},on:{keydown:this.onKeydown},style:{zIndex:this.activeZIndex},ref:"content"},[this.genTransition()])])])},genTransition(){const t=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[t]):t},genInnerContent(){const t={class:this.classes,attrs:{tabindex:this.isActive?0:void 0},ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(t.style={...t.style,maxWidth:Object(p["h"])(this.maxWidth),width:Object(p["h"])(this.width)}),this.$createElement("div",t,this.getContentSlot())}},render(t){return t("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},[this.genActivator(),this.genContent()])}})},"16b7":function(t,e,i){"use strict";var r=i("2b0e");e["a"]=r["a"].extend().extend({name:"delayable",props:{openDelay:{type:[Number,String],default:0},closeDelay:{type:[Number,String],default:0}},data:()=>({openTimeout:void 0,closeTimeout:void 0}),methods:{clearDelay(){clearTimeout(this.openTimeout),clearTimeout(this.closeTimeout)},runDelay(t,e){this.clearDelay();const i=parseInt(this[t+"Delay"],10);this[t+"Timeout"]=setTimeout(e||(()=>{this.isActive={open:!0,close:!1}[t]}),i)}}})},1800:function(t,e,i){"use strict";var r=i("2b0e");e["a"]=r["a"].extend({name:"v-list-item-action",functional:!0,render(t,{data:e,children:i=[]}){e.staticClass=e.staticClass?"v-list-item__action "+e.staticClass:"v-list-item__action";const r=i.filter(t=>!1===t.isComment&&" "!==t.text);return r.length>1&&(e.staticClass+=" v-list-item__action--stack"),t("div",e,i)}})},"1b2c":function(t,e,i){},"1baa":function(t,e,i){"use strict";i("899c");var r=i("604c"),n=i("a9ad"),o=i("58df");e["a"]=Object(o["a"])(r["a"],n["a"]).extend({name:"v-list-item-group",provide(){return{isInGroup:!0,listItemGroup:this}},computed:{classes(){return{...r["a"].options.computed.classes.call(this),"v-list-item-group":!0}}},methods:{genData(){return this.setTextColor(this.color,{...r["a"].options.methods.genData.call(this),attrs:{role:"listbox"}})}}})},"20f6":function(t,e,i){},"21be":function(t,e,i){"use strict";var r=i("2b0e"),n=i("80d2");e["a"]=r["a"].extend().extend({name:"stackable",data(){return{stackElement:null,stackExclude:null,stackMinZIndex:0,isActive:!1}},computed:{activeZIndex(){if("undefined"===typeof window)return 0;const t=this.stackElement||this.$refs.content,e=this.isActive?this.getMaxZIndex(this.stackExclude||[t])+2:Object(n["t"])(t);return null==e?e:parseInt(e)}},methods:{getMaxZIndex(t=[]){const e=this.$el,i=[this.stackMinZIndex,Object(n["t"])(e)],r=[...document.getElementsByClassName("v-menu__content--active"),...document.getElementsByClassName("v-dialog__content--active")];for(let o=0;o<r.length;o++)t.includes(r[o])||i.push(Object(n["t"])(r[o]));return Math.max(...i)}}})},2794:function(t,e,i){"use strict";i.r(e);var r=i("7496"),n=i("8336"),o=i("b0af"),s=i("99d9"),a=i("169a"),l=i("132d"),h=i("8860"),c=i("56b0"),u=i("da13"),d=i("5d23"),p=i("34c3"),f=i("e449"),_=i("f774"),g=i("b974"),m=i("2fa4"),b=i("8654"),v=function(){var t=this,e=t._self._c;return e(r["a"],[e(_["a"],{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticStyle:{"z-index":"10009"},attrs:{absolute:"",temporary:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[e(h["a"],{attrs:{nav:"",dense:""}},[e(u["a"],{attrs:{link:""},on:{click:t.jumpTypeEdit}},[e(p["a"],[e(l["a"],{domProps:{textContent:t._s("mdi-playlist-edit")}})],1),e(d["a"],[e(d["b"],{domProps:{textContent:t._s("编辑板块")}})],1)],1),t._l(t.studyProjects,(function(i){return e(c["a"],{key:i.type_name,attrs:{"prepend-icon":"mdi-school",color:"#64A70A","no-action":""},scopedSlots:t._u([{key:"activator",fn:function(){return[e(d["a"],[e(d["b"],{domProps:{textContent:t._s(i.type_name)}})],1)]},proxy:!0}],null,!0),model:{value:i.active,callback:function(e){t.$set(i,"active",e)},expression:"item.active"}},t._l(i.children,(function(i){return e(u["a"],{key:i.id,attrs:{link:"",to:i.href,"active-class":i.href===t.$route.fullPath?"active":"unactive"}},[e(d["a"],[e(d["b"],{domProps:{textContent:t._s(i.name)}})],1)],1)})),1)}))],2)],1),e("div",{staticStyle:{height:"100%",width:"100%"}},[e("div",{staticClass:"navgationbar",on:{click:t.saveProject}},[e("div",{staticClass:"title"},[t._v(" "+t._s(t.projectId?t.projectTitle:"新项目"))]),e(n["a"],{directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],class:t.prepareTitle?"listbtn":"nonelistbtn",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"white"},on:{click:function(e){e.stopPropagation(),t.drawer=!0}}},[e(l["a"],[t._v("mdi-menu")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.prepareTitle,expression:"!prepareTitle"}]},[t._v("选择旧项目")])],1),e(f["a"],{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:r}){return[e(n["a"],t._g(t._b({directives:[{name:"show",rawName:"v-show",value:t.edit,expression:"edit"}],staticClass:"addbtn",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"white"}},"v-btn",r,!1),i),[e(l["a"],[t._v("mdi-dots-vertical")])],1)]}}])},[e(h["a"],{attrs:{nav:"",dense:""}},t._l(t.moreActionMenus,(function(i){return e(u["a"],{key:i.title,on:{click:function(e){return t.dropMenuAction(i.title)}}},[e(p["a"],[e(l["a"],[t._v(t._s(i.icon))])],1),e(d["b"],{staticClass:"text-caption font-weight-medium"},[t._v(" "+t._s(i.title)+" ")])],1)})),1)],1),t._e()],1),e(n["a"],{staticClass:"btnplay",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#4E737B"},on:{click:t.playAction}},[e(l["a"],[t._v("mdi-play")])],1),e(n["a"],{staticClass:"btnstop",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#4E737B"},on:{click:t.stopAction}},[e(l["a"],[t._v("mdi-stop")])],1),e(n["a"],{directives:[{name:"show",rawName:"v-show",value:!t.show3D,expression:"!show3D"}],staticClass:"btn3d",attrs:{elevation:"2",fab:"",icon:""},on:{click:t.show3DAction}},[e(l["a"],[t._v("mdi-menu-open")])],1),e("blocklycomponent",{ref:"blockRef",attrs:{id:"blockly",robotController:t.robotController,projectId:t.projectId}}),e("div",{directives:[{name:"window",rawName:"v-window",value:t.windowParams,expression:"windowParams"},{name:"show",rawName:"v-show",value:t.show3D,expression:"show3D"}],staticClass:"window1"},[e("div",{staticClass:"window__header"},[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",{staticStyle:{padding:"10px 20px 5px 20px",color:"white",display:"flex"}},[t._v("仿真 "),e("div",{attrs:{id:"fps"}})]),e(n["a"],{staticStyle:{padding:"10px 20px 5px 20px"},attrs:{icon:"",color:"white"},on:{click:t.close3dAction}},[e(l["a"],[t._v("mdi-close")])],1)],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show3D,expression:"show3D"}],staticStyle:{"z-index":"10001","padding-left":"10px"}},[e("canvas",{attrs:{id:"renderCanvas"}})])]),e("div",{directives:[{name:"window",rawName:"v-window",value:t.windowParams,expression:"windowParams"},{name:"show",rawName:"v-show",value:!t.show3D,expression:"!show3D"}],staticClass:"window1"},[e("div",{staticClass:"window__header"},[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",[t._v("生成代码")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.show3D,expression:"!show3D"}],staticStyle:{"z-index":"10001"}},[e("button",{on:{click:function(e){return t.showCode()}}},[t._v("Show JavaScript")]),e("pre",{domProps:{innerHTML:t._s(t.code)}})])]),e(a["a"],{staticStyle:{"z-index":"10009"},attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:r}){return[e(n["a"],t._g(t._b({staticClass:"backbtn",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#80441E"}},"v-btn",r,!1),i),[e(l["a"],[t._v("mdi-reply")])],1)]}}]),model:{value:t.showDeleteDialog,callback:function(e){t.showDeleteDialog=e},expression:"showDeleteDialog"}},[e(o["a"],[e(s["c"],{staticClass:"text-h5"},[t._v(" 确定退出吗？ ")]),e(s["b"],[t._v("退出之前保存项目，可以在下次进入后继续编辑")]),e(s["a"],[e(m["a"]),e(n["a"],{attrs:{color:"grey",text:""},on:{click:t.backAction}},[t._v(" 继续退出 ")]),e(n["a"],{attrs:{color:"green darken-1",text:""},on:{click:t.saveProject}},[t._v(" 保存 ")])],1)],1)],1),e("Modal",{attrs:{show:t.showSaveProjectModal,title:"保存项目"},on:{hideModal:t.hideSaveProjectModal,submit:t.saveProjectSubmit}},[e(b["a"],{staticClass:"centered-input text--darken-3 mt-3",attrs:{placeholder:"输入项目名称","solo-inverted":"",flat:""},model:{value:t.prepareTitle,callback:function(e){t.prepareTitle=e},expression:"prepareTitle"}})],1),e("Modal",{attrs:{show:t.newBlockShow,title:"新增项目配置"},on:{hideModal:t.hideNewBlockModal,submit:t.submitNewBlockModal}},[e(b["a"],{staticClass:"centered-input text--darken-3 mt-3",attrs:{placeholder:"输入项目名称","solo-inverted":"",flat:""},model:{value:t.newBlockName,callback:function(e){t.newBlockName=e},expression:"newBlockName"}}),e(g["a"],{attrs:{items:t.studyProjects,"item-text":"type_name","item-value":"id",label:"请选择板块",dense:"",solo:"",flat:""},on:{change:t.typeSelectAction}})],1)],1)],1)},y=[],T=i("f32a"),O=i("5b28"),E=i("f289"),A=(i("8464"),i("fc06")),C=i.n(A),x=i("714b"),w=i("54ca"),M=i.n(w),S=i("e07a");window.robot=O["a"];var I=null;async function P(){var t=async function(){var t=document.getElementById("renderCanvas"),e=document.getElementById("fps");return T["a"].cleanDrawLines(),I=await T["a"].init(t,e),O["a"].initScene(I,T["a"].getRobot(),T["a"].getStartPoint()),O["a"].initRobotPenclDynamicTexture(T["a"].getRobotPenclDynamicTexture()),T["a"].bindRobotController(O["a"].getRobotInstance()),O["a"].getRobotInstance()},e=await t();return e}var R={name:"caseEdit",components:{blocklycomponent:E["a"],Modal:x["a"]},data(){return{edit:0,typeSelect:-1,projectId:null,showDeleteDialog:!1,show3D:!0,projectTitle:"",prepareTitle:"",newBlockShow:!1,newBlockName:"",drawer:!1,currentSelectProject:null,studyProjects:[],moreActionMenus:[{title:"新增案例",route:"",icon:"mdi-shape-square-plus"},{title:"删除案例",route:"",icon:"mdi-trash-can-outline"}],typeNames:[{id:1,type_name:"学习案例"}],showSaveProjectModal:!1,windowParams:{movable:!0,resizable:!1},code:"",robotController:null}},methods:{show3DAction(){console.log("show3DAction"),this.show3D=!this.show3D,0==this.show3D&&this.showCode()},close3dAction(){this.show3D=!1},saveProject(){this.showDeleteDialog=!1,null==this.projectId?this.newBlockShow=!0:this.showSaveProjectModal=!0},backAction(){this.showDeleteDialog=!1,this.$router.replace("/")},playAction(){this.$refs["blockRef"].runCodeClick()},stopAction(){this.$refs["blockRef"].stopCodeClick()},showCode(){this.code=C.a.workspaceToCode(this.$refs["blockRef"].workspace)},hideSaveProjectModal(){this.showSaveProjectModal=!1},saveProjectSubmit(){this.projectTitle=this.prepareTitle,!this.edit&&this.prepareTitle?this.saveProjectToLocal():this.saveCaseToServer(),this.showSaveProjectModal=!1},typeSelectAction(t){this.typeSelect=t},saveProjectToLocal(){this.showSaveProjectModal=!1;const t=M.a.Xml.workspaceToDom(this.$refs["blockRef"].workspace),e=M.a.Xml.domToText(t);var i=S["a"].createProjectId();window.localStorage.setItem(i,e);var r=S["a"].getLocalProjects();const n=(new Date).Format("yyyy-MM-dd HH:mm:ss");var o={id:i,name:this.projectTitle,time:n,update_time:n,img:"art.jpg"};r.push(o),window.localStorage.setItem("MyProjects",JSON.stringify(r)),alert("保存成功")},async saveCaseToServer(){if(null==this.projectId){console.log("新增案例"),this.currentSelectProject.id=S["a"].createProjectId(),this.currentSelectProject.name=this.projectTitle;const t=M.a.Xml.workspaceToDom(this.$refs["blockRef"].workspace),e=M.a.Xml.domToText(t);this.currentSelectProject.blocks=e,console.log(this.currentSelectProject)}else{console.log("编辑案例"),this.currentSelectProject.name=this.projectTitle;const e=M.a.Xml.workspaceToDom(this.$refs["blockRef"].workspace),i=M.a.Xml.domToText(e);this.currentSelectProject.blocks=i,console.log(this.currentSelectProject);var t=await this.$request.callApi("POST",this.$robotApi.saveBlock,this.currentSelectProject);t.errno,alert(t.data)}},getProject(){if(this.projectId=this.$route.query.project_id,this.projectId){var t=null;for(const e in this.studyProjects)for(const i of this.studyProjects[e].children)console.log("block",i),i.id==this.projectId&&(this.studyProjects[e].active=!0,this.prepareTitle=i.name,this.projectTitle=i.name,t=i);if(t){this.currentSelectProject=t;var e=t.blocks;if(console.log("xml_text",e),e){this.$refs["blockRef"].workspace.clear();const t=M.a.Xml.textToDom(e);M.a.Xml.domToWorkspace(t,this.$refs["blockRef"].workspace)}}}},dropMenuAction(t){console.log(t),"新增案例"==t?(this.newEmptyProject(),this.initProjects()):"删除案例"==t&&this.deleteBlock()},hideNewBlockModal(){this.newBlockShow=!1},async submitNewBlockModal(){if(console.log("add",this.typeSelect),-1==this.typeSelect)return void alert("请选择板块");const t=M.a.Xml.workspaceToDom(this.$refs["blockRef"].workspace),e=M.a.Xml.domToText(t);var i=await this.$request.callApi("POST",this.$robotApi.addBlock,{type:this.typeSelect,name:this.newBlockName,blocks:e});i?(this.newBlockShow=!1,this.$router.push({path:this.$route.path+"?edit=1&project_id="+i.data.id}),this.projectTitle=this.newBlockName,this.prepareTitle=this.newBlockName,this.initProjects(),alert("新增成功")):(this.newBlockShow=!1,alert("新增失败"))},async deleteBlock(){if(this.projectId){console.log("delete",this.projectId);var t=await this.$request.callApi("POST",this.$robotApi.deleteBlock,{id:this.projectId});t?(this.newEmptyProject(),alert("删除成功")):alert("删除失败")}else alert("案例不存在")},newEmptyProject(){this.projectId?(this.$refs["blockRef"].workspace.clear(),this.prepareTitle="",this.projectTitle="",this.projectId=null,this.$router.push({path:this.$route.path+"?edit=1"}),this.initProjects()):alert("已在新增页面")},async initProjects(){var t=await this.$request.callApi("GET",this.$robotApi.getAllBlocks);t=t.data,this.studyProjects=t,this.getProject()},jumpTypeEdit(){this.$router.push({path:"/Game/typeEdit"})}},beforeDestroy(){var t=document.getElementById("customLoadingScreenDiv");t&&(t.outerHTML="")},async mounted(){this.edit=this.$route.query.edit,await this.initProjects();var t=await P();this.robotController=t},watch:{"$route.query"(){console.log("change $route.query.project_id",this.$route.query.project_id),this.getProject()}}},L=R,N=(i("e28d"),i("2877")),k=Object(N["a"])(L,v,y,!1,null,"eaad2f0a",null);e["default"]=k.exports},"297c":function(t,e,i){"use strict";var r=i("2b0e"),n=i("37c6");e["a"]=r["a"].extend().extend({name:"loadable",props:{loading:{type:[Boolean,String],default:!1},loaderHeight:{type:[Number,String],default:2}},methods:{genProgress(){return!1===this.loading?null:this.$slots.progress||this.$createElement(n["a"],{props:{absolute:!0,color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,height:this.loaderHeight,indeterminate:!0}})}}})},"2bf3":function(t,e,i){},"2fa4":function(t,e,i){"use strict";i("20f6");var r=i("80d2");e["a"]=Object(r["i"])("spacer","div","v-spacer")},"326d":function(t,e,i){"use strict";var r=i("e449");e["a"]=r["a"]},3408:function(t,e,i){},"34c3":function(t,e,i){"use strict";var r=i("2b0e");e["a"]=r["a"].extend({name:"v-list-item-icon",functional:!0,render(t,{data:e,children:i}){return e.staticClass=("v-list-item__icon "+(e.staticClass||"")).trim(),t("div",e,i)}})},"34ef":function(t,e,i){"use strict";i("8adc");var r=i("58df"),n=i("0789"),o=i("9d26"),s=i("a9ad"),a=i("4e82"),l=i("7560"),h=i("f2e7"),c=i("1c87"),u=i("af2b"),d=i("d9bd"),p=Object(r["a"])(s["a"],u["a"],c["a"],l["a"],Object(a["a"])("chipGroup"),Object(h["b"])("inputValue")).extend({name:"v-chip",props:{active:{type:Boolean,default:!0},activeClass:{type:String,default(){return this.chipGroup?this.chipGroup.activeClass:""}},close:Boolean,closeIcon:{type:String,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},disabled:Boolean,draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:Boolean,outlined:Boolean,pill:Boolean,tag:{type:String,default:"span"},textColor:String,value:null},data:()=>({proxyClass:"v-chip--active"}),computed:{classes(){return{"v-chip":!0,...c["a"].options.computed.classes.call(this),"v-chip--clickable":this.isClickable,"v-chip--disabled":this.disabled,"v-chip--draggable":this.draggable,"v-chip--label":this.label,"v-chip--link":this.isLink,"v-chip--no-color":!this.color,"v-chip--outlined":this.outlined,"v-chip--pill":this.pill,"v-chip--removable":this.hasClose,...this.themeClasses,...this.sizeableClasses,...this.groupClasses}},hasClose(){return Boolean(this.close)},isClickable(){return Boolean(c["a"].options.computed.isClickable.call(this)||this.chipGroup)}},created(){const t=[["outline","outlined"],["selected","input-value"],["value","active"],["@input","@active.sync"]];t.forEach(([t,e])=>{this.$attrs.hasOwnProperty(t)&&Object(d["a"])(t,e,this)})},methods:{click(t){this.$emit("click",t),this.chipGroup&&this.toggle()},genFilter(){const t=[];return this.isActive&&t.push(this.$createElement(o["a"],{staticClass:"v-chip__filter",props:{left:!0}},this.filterIcon)),this.$createElement(n["b"],t)},genClose(){return this.$createElement(o["a"],{staticClass:"v-chip__close",props:{right:!0,size:18},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:t=>{t.stopPropagation(),t.preventDefault(),this.$emit("click:close"),this.$emit("update:active",!1)}}},this.closeIcon)},genContent(){return this.$createElement("span",{staticClass:"v-chip__content"},[this.filter&&this.genFilter(),this.$slots.default,this.hasClose&&this.genClose()])}},render(t){const e=[this.genContent()];let{tag:i,data:r}=this.generateRouteLink();r.attrs={...r.attrs,draggable:this.draggable?"true":void 0,tabindex:this.chipGroup&&!this.disabled?0:r.attrs.tabindex},r.directives.push({name:"show",value:this.active}),r=this.setBackgroundColor(this.color,r);const n=this.textColor||this.outlined&&this.color;return t(i,this.setTextColor(n,r),e)}});e["a"]=p},"368e":function(t,e,i){},"36a7":function(t,e,i){},"37c6":function(t,e,i){"use strict";i("6ece");var r=i("0789"),n=i("90a2"),o=i("a9ad"),s=i("fe6c"),a=i("a452"),l=i("7560"),h=i("80d2"),c=i("58df");const u=Object(c["a"])(o["a"],Object(s["b"])(["absolute","fixed","top","bottom"]),a["a"],l["a"]);var d=u.extend({name:"v-progress-linear",directives:{intersect:n["a"]},props:{active:{type:Boolean,default:!0},backgroundColor:{type:String,default:null},backgroundOpacity:{type:[Number,String],default:null},bufferValue:{type:[Number,String],default:100},color:{type:String,default:"primary"},height:{type:[Number,String],default:4},indeterminate:Boolean,query:Boolean,reverse:Boolean,rounded:Boolean,stream:Boolean,striped:Boolean,value:{type:[Number,String],default:0}},data(){return{internalLazyValue:this.value||0,isVisible:!0}},computed:{__cachedBackground(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor||this.color,{staticClass:"v-progress-linear__background",style:this.backgroundStyle}))},__cachedBar(){return this.$createElement(this.computedTransition,[this.__cachedBarType])},__cachedBarType(){return this.indeterminate?this.__cachedIndeterminate:this.__cachedDeterminate},__cachedBuffer(){return this.$createElement("div",{staticClass:"v-progress-linear__buffer",style:this.styles})},__cachedDeterminate(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__determinate",style:{width:Object(h["h"])(this.normalizedValue,"%")}}))},__cachedIndeterminate(){return this.$createElement("div",{staticClass:"v-progress-linear__indeterminate",class:{"v-progress-linear__indeterminate--active":this.active}},[this.genProgressBar("long"),this.genProgressBar("short")])},__cachedStream(){return this.stream?this.$createElement("div",this.setTextColor(this.color,{staticClass:"v-progress-linear__stream",style:{width:Object(h["h"])(100-this.normalizedBuffer,"%")}})):null},backgroundStyle(){const t=null==this.backgroundOpacity?this.backgroundColor?1:.3:parseFloat(this.backgroundOpacity);return{opacity:t,[this.isReversed?"right":"left"]:Object(h["h"])(this.normalizedValue,"%"),width:Object(h["h"])(Math.max(0,this.normalizedBuffer-this.normalizedValue),"%")}},classes(){return{"v-progress-linear--absolute":this.absolute,"v-progress-linear--fixed":this.fixed,"v-progress-linear--query":this.query,"v-progress-linear--reactive":this.reactive,"v-progress-linear--reverse":this.isReversed,"v-progress-linear--rounded":this.rounded,"v-progress-linear--striped":this.striped,"v-progress-linear--visible":this.isVisible,...this.themeClasses}},computedTransition(){return this.indeterminate?r["c"]:r["d"]},isReversed(){return this.$vuetify.rtl!==this.reverse},normalizedBuffer(){return this.normalize(this.bufferValue)},normalizedValue(){return this.normalize(this.internalLazyValue)},reactive(){return Boolean(this.$listeners.change)},styles(){const t={};return this.active||(t.height=0),this.indeterminate||100===parseFloat(this.normalizedBuffer)||(t.width=Object(h["h"])(this.normalizedBuffer,"%")),t}},methods:{genContent(){const t=Object(h["r"])(this,"default",{value:this.internalLazyValue});return t?this.$createElement("div",{staticClass:"v-progress-linear__content"},t):null},genListeners(){const t=this.$listeners;return this.reactive&&(t.click=this.onClick),t},genProgressBar(t){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__indeterminate",class:{[t]:!0}}))},onClick(t){if(!this.reactive)return;const{width:e}=this.$el.getBoundingClientRect();this.internalValue=t.offsetX/e*100},onObserve(t,e,i){this.isVisible=i},normalize(t){return t<0?0:t>100?100:parseFloat(t)}},render(t){const e={staticClass:"v-progress-linear",attrs:{role:"progressbar","aria-valuemin":0,"aria-valuemax":this.normalizedBuffer,"aria-valuenow":this.indeterminate?void 0:this.normalizedValue},class:this.classes,directives:[{name:"intersect",value:this.onObserve}],style:{bottom:this.bottom?0:void 0,height:this.active?Object(h["h"])(this.height):0,top:this.top?0:void 0},on:this.genListeners()};return t("div",e,[this.__cachedStream,this.__cachedBackground,this.__cachedBuffer,this.__cachedBar,this.genContent()])}});e["a"]=d},"38cb":function(t,e,i){"use strict";var r=i("a9ad"),n=i("7560"),o=i("3206"),s=i("80d2"),a=i("d9bd"),l=i("58df");const h=Object(l["a"])(r["a"],Object(o["a"])("form"),n["a"]);e["a"]=h.extend({name:"validatable",props:{disabled:Boolean,error:Boolean,errorCount:{type:[Number,String],default:1},errorMessages:{type:[String,Array],default:()=>[]},messages:{type:[String,Array],default:()=>[]},readonly:Boolean,rules:{type:Array,default:()=>[]},success:Boolean,successMessages:{type:[String,Array],default:()=>[]},validateOnBlur:Boolean,value:{required:!1}},data(){return{errorBucket:[],hasColor:!1,hasFocused:!1,hasInput:!1,isFocused:!1,isResetting:!1,lazyValue:this.value,valid:!1}},computed:{computedColor(){if(!this.isDisabled)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},hasError(){return this.internalErrorMessages.length>0||this.errorBucket.length>0||this.error},hasSuccess(){return this.internalSuccessMessages.length>0||this.success},externalError(){return this.internalErrorMessages.length>0||this.error},hasMessages(){return this.validationTarget.length>0},hasState(){return!this.isDisabled&&(this.hasSuccess||this.shouldValidate&&this.hasError)},internalErrorMessages(){return this.genInternalMessages(this.errorMessages)},internalMessages(){return this.genInternalMessages(this.messages)},internalSuccessMessages(){return this.genInternalMessages(this.successMessages)},internalValue:{get(){return this.lazyValue},set(t){this.lazyValue=t,this.$emit("input",t)}},isDisabled(){return this.disabled||!!this.form&&this.form.disabled},isInteractive(){return!this.isDisabled&&!this.isReadonly},isReadonly(){return this.readonly||!!this.form&&this.form.readonly},shouldValidate(){return!!this.externalError||!this.isResetting&&(this.validateOnBlur?this.hasFocused&&!this.isFocused:this.hasInput||this.hasFocused)},validations(){return this.validationTarget.slice(0,Number(this.errorCount))},validationState(){if(!this.isDisabled)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":this.hasColor?this.computedColor:void 0},validationTarget(){return this.internalErrorMessages.length>0?this.internalErrorMessages:this.successMessages&&this.successMessages.length>0?this.internalSuccessMessages:this.messages&&this.messages.length>0?this.internalMessages:this.shouldValidate?this.errorBucket:[]}},watch:{rules:{handler(t,e){Object(s["j"])(t,e)||this.validate()},deep:!0},internalValue(){this.hasInput=!0,this.validateOnBlur||this.$nextTick(this.validate)},isFocused(t){t||this.isDisabled||(this.hasFocused=!0,this.validateOnBlur&&this.$nextTick(this.validate))},isResetting(){setTimeout(()=>{this.hasInput=!1,this.hasFocused=!1,this.isResetting=!1,this.validate()},0)},hasError(t){this.shouldValidate&&this.$emit("update:error",t)},value(t){this.lazyValue=t}},beforeMount(){this.validate()},created(){this.form&&this.form.register(this)},beforeDestroy(){this.form&&this.form.unregister(this)},methods:{genInternalMessages(t){return t?Array.isArray(t)?t:[t]:[]},reset(){this.isResetting=!0,this.internalValue=Array.isArray(this.internalValue)?[]:null},resetValidation(){this.isResetting=!0},validate(t=!1,e){const i=[];e=e||this.internalValue,t&&(this.hasInput=this.hasFocused=!0);for(let r=0;r<this.rules.length;r++){const t=this.rules[r],n="function"===typeof t?t(e):t;!1===n||"string"===typeof n?i.push(n||""):"boolean"!==typeof n&&Object(a["b"])(`Rules should return a string or boolean, received '${typeof n}' instead`,this)}return this.errorBucket=i,this.valid=0===i.length,this.valid}}})},"3a66":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("fe6c"),n=i("58df");function o(t,e=[]){return Object(n["a"])(Object(r["b"])(["absolute","fixed"])).extend({name:"applicationable",props:{app:Boolean},computed:{applicationProperty(){return t}},watch:{app(t,e){e?this.removeApplication(!0):this.callUpdate()},applicationProperty(t,e){this.$vuetify.application.unregister(this._uid,e)}},activated(){this.callUpdate()},created(){for(let t=0,i=e.length;t<i;t++)this.$watch(e[t],this.callUpdate);this.callUpdate()},mounted(){this.callUpdate()},deactivated(){this.removeApplication()},destroyed(){this.removeApplication()},methods:{callUpdate(){this.app&&this.$vuetify.application.register(this._uid,this.applicationProperty,this.updateApplication())},removeApplication(t=!1){(t||this.app)&&this.$vuetify.application.unregister(this._uid,this.applicationProperty)},updateApplication:()=>0}})}},"3ad0":function(t,e,i){},"3c93":function(t,e,i){},"480e":function(t,e,i){"use strict";var r=i("7560");e["a"]=r["a"].extend({name:"v-theme-provider",props:{root:Boolean},computed:{isDark(){return this.root?this.rootIsDark:r["a"].options.computed.isDark.call(this)}},render(){return this.$slots.default&&this.$slots.default.find(t=>!t.isComment&&" "!==t.text)}})},"4ad4":function(t,e,i){"use strict";var r=i("16b7"),n=i("f2e7"),o=i("58df"),s=i("80d2"),a=i("d9bd");const l=Object(o["a"])(r["a"],n["a"]);e["a"]=l.extend({name:"activatable",props:{activator:{default:null,validator:t=>["string","object"].includes(typeof t)},disabled:Boolean,internalActivator:Boolean,openOnClick:{type:Boolean,default:!0},openOnHover:Boolean,openOnFocus:Boolean},data:()=>({activatorElement:null,activatorNode:[],events:["click","mouseenter","mouseleave","focus"],listeners:{}}),watch:{activator:"resetActivator",openOnFocus:"resetActivator",openOnHover:"resetActivator"},mounted(){const t=Object(s["s"])(this,"activator",!0);t&&["v-slot","normal"].includes(t)&&Object(a["b"])('The activator slot must be bound, try \'<template v-slot:activator="{ on }"><v-btn v-on="on">\'',this),this.addActivatorEvents()},beforeDestroy(){this.removeActivatorEvents()},methods:{addActivatorEvents(){if(!this.activator||this.disabled||!this.getActivator())return;this.listeners=this.genActivatorListeners();const t=Object.keys(this.listeners);for(const e of t)this.getActivator().addEventListener(e,this.listeners[e])},genActivator(){const t=Object(s["r"])(this,"activator",Object.assign(this.getValueProxy(),{on:this.genActivatorListeners(),attrs:this.genActivatorAttributes()}))||[];return this.activatorNode=t,t},genActivatorAttributes(){return{role:this.openOnClick&&!this.openOnHover?"button":void 0,"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genActivatorListeners(){if(this.disabled)return{};const t={};return this.openOnHover?(t.mouseenter=t=>{this.getActivator(t),this.runDelay("open")},t.mouseleave=t=>{this.getActivator(t),this.runDelay("close")}):this.openOnClick&&(t.click=t=>{const e=this.getActivator(t);e&&e.focus(),t.stopPropagation(),this.isActive=!this.isActive}),this.openOnFocus&&(t.focus=t=>{this.getActivator(t),t.stopPropagation(),this.isActive=!this.isActive}),t},getActivator(t){if(this.activatorElement)return this.activatorElement;let e=null;if(this.activator){const t=this.internalActivator?this.$el:document;e="string"===typeof this.activator?t.querySelector(this.activator):this.activator.$el?this.activator.$el:this.activator}else if(1===this.activatorNode.length||this.activatorNode.length&&!t){const t=this.activatorNode[0].componentInstance;e=t&&t.$options.mixins&&t.$options.mixins.some(t=>t.options&&["activatable","menuable"].includes(t.options.name))?t.getActivator():this.activatorNode[0].elm}else t&&(e=t.currentTarget||t.target);return this.activatorElement=(null===e||void 0===e?void 0:e.nodeType)===Node.ELEMENT_NODE?e:null,this.activatorElement},getContentSlot(){return Object(s["r"])(this,"default",this.getValueProxy(),!0)},getValueProxy(){const t=this;return{get value(){return t.isActive},set value(e){t.isActive=e}}},removeActivatorEvents(){if(!this.activator||!this.activatorElement)return;const t=Object.keys(this.listeners);for(const e of t)this.activatorElement.removeEventListener(e,this.listeners[e]);this.listeners={}},resetActivator(){this.removeActivatorEvents(),this.activatorElement=null,this.getActivator(),this.addActivatorEvents()}}})},"4edb":function(t,e,i){},"4ff9":function(t,e,i){},"560a":function(t,e,i){var r,n,o;(function(s,a){n=[i("b7fd")],r=a,o="function"===typeof r?r.apply(e,n):r,void 0===o||(t.exports=o)})(0,(function(t){t={Msg:{}};return t.Msg["ADD_COMMENT"]="添加注释",t.Msg["CANNOT_DELETE_VARIABLE_PROCEDURE"]="不能删除变量“%1”，因为它是函数“%2”定义的一部分",t.Msg["CHANGE_VALUE_TITLE"]="更改值：",t.Msg["CLEAN_UP"]="整理块",t.Msg["COLLAPSED_WARNINGS_WARNING"]="已收起的信息块内包含警告。",t.Msg["COLLAPSE_ALL"]="折叠块",t.Msg["COLLAPSE_BLOCK"]="折叠块",t.Msg["COLOUR_BLEND_COLOUR1"]="颜色1",t.Msg["COLOUR_BLEND_COLOUR2"]="颜色2",t.Msg["COLOUR_BLEND_HELPURL"]="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",t.Msg["COLOUR_BLEND_RATIO"]="比例",t.Msg["COLOUR_BLEND_TITLE"]="混合",t.Msg["COLOUR_BLEND_TOOLTIP"]="把两种颜色以一个给定的比例(0.0-1.0)进行混合。",t.Msg["COLOUR_PICKER_HELPURL"]="https://zh.wikipedia.org/wiki/颜色",t.Msg["COLOUR_PICKER_TOOLTIP"]="从调色板中选择一种颜色。",t.Msg["COLOUR_RANDOM_HELPURL"]="http://randomcolour.com",t.Msg["COLOUR_RANDOM_TITLE"]="随机颜色",t.Msg["COLOUR_RANDOM_TOOLTIP"]="随机选择一种颜色。",t.Msg["COLOUR_RGB_BLUE"]="蓝色",t.Msg["COLOUR_RGB_GREEN"]="绿色",t.Msg["COLOUR_RGB_HELPURL"]="https://www.december.com/html/spec/colorpercompact.html",t.Msg["COLOUR_RGB_RED"]="红色",t.Msg["COLOUR_RGB_TITLE"]="颜色",t.Msg["COLOUR_RGB_TOOLTIP"]="通过指定红色、绿色和蓝色的量创建一种颜色。所有的值必须在0和100之间。",t.Msg["CONTROLS_FLOW_STATEMENTS_HELPURL"]="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",t.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK"]="跳出循环",t.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE"]="继续下一轮循环",t.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK"]="跳出包含它的循环。",t.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE"]="跳过本轮循环的剩余部分，并继进行续下一轮循环。",t.Msg["CONTROLS_FLOW_STATEMENTS_WARNING"]="警告：这个块只能在循环内使用。",t.Msg["CONTROLS_FOREACH_HELPURL"]="https://github.com/google/blockly/wiki/Loops#for-each",t.Msg["CONTROLS_FOREACH_TITLE"]="遍历列表 %2 里的每一项 %1",t.Msg["CONTROLS_FOREACH_TOOLTIP"]="遍历列表中的每一项，将变量“%1”设为所选项，并执行一些语句。",t.Msg["CONTROLS_FOR_HELPURL"]="https://github.com/google/blockly/wiki/Loops#count-with",t.Msg["CONTROLS_FOR_TITLE"]="变量 %1 从 %2 数到 %3 每次增加 %4",t.Msg["CONTROLS_FOR_TOOLTIP"]="用变量%1记录从开始数值到终止数值之间的数值，数值按指定间隔增加，并执行指定的块。",t.Msg["CONTROLS_IF_ELSEIF_TOOLTIP"]="在这个if语句块中增加一个条件。",t.Msg["CONTROLS_IF_ELSE_TOOLTIP"]="在这个if语句块中添加一个最终的，包括所有其余情况的条件。",t.Msg["CONTROLS_IF_HELPURL"]="https://github.com/google/blockly/wiki/IfElse",t.Msg["CONTROLS_IF_IF_TOOLTIP"]="增加、删除或重新排列各节来重新配置这个if语句块。",t.Msg["CONTROLS_IF_MSG_ELSE"]="否则",t.Msg["CONTROLS_IF_MSG_ELSEIF"]="否则如果",t.Msg["CONTROLS_IF_MSG_IF"]="如果",t.Msg["CONTROLS_IF_TOOLTIP_1"]="如果值为真，执行一些语句。",t.Msg["CONTROLS_IF_TOOLTIP_2"]="如果值为真，则执行第一块语句。否则，则执行第二块语句。",t.Msg["CONTROLS_IF_TOOLTIP_3"]="如果第一个值为真，则执行第一块的语句。否则，如果第二个值为真，则执行第二块的语句。",t.Msg["CONTROLS_IF_TOOLTIP_4"]="如果第一个值为真，则执行第一块对语句。否则，如果第二个值为真，则执行语句的第二块。如果没有值为真，则执行最后一块的语句。",t.Msg["CONTROLS_REPEAT_HELPURL"]="https://zh.wikipedia.org/wiki/For循环",t.Msg["CONTROLS_REPEAT_INPUT_DO"]="执行",t.Msg["CONTROLS_REPEAT_TITLE"]="重复 %1 次",t.Msg["CONTROLS_REPEAT_TOOLTIP"]="多次执行一些语句。",t.Msg["CONTROLS_WHILEUNTIL_HELPURL"]="https://github.com/google/blockly/wiki/Loops#repeat",t.Msg["CONTROLS_WHILEUNTIL_OPERATOR_UNTIL"]="重复直到条件满足",t.Msg["CONTROLS_WHILEUNTIL_OPERATOR_WHILE"]="当条件满足时重复",t.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL"]="只要值为假，就一直循环执行一些语句。",t.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_WHILE"]="只要值为真，就一直循环执行一些语句。",t.Msg["DELETE_ALL_BLOCKS"]="删除所有 %1 个块吗？",t.Msg["DELETE_BLOCK"]="删除块",t.Msg["DELETE_VARIABLE"]="删除变量“%1”",t.Msg["DELETE_VARIABLE_CONFIRMATION"]="要删除对变量“%2”的%1个引用吗？",t.Msg["DELETE_X_BLOCKS"]="删除 %1 个块",t.Msg["DISABLE_BLOCK"]="禁用块",t.Msg["DUPLICATE_BLOCK"]="复制",t.Msg["DUPLICATE_COMMENT"]="复制注释",t.Msg["ENABLE_BLOCK"]="启用块",t.Msg["EXPAND_ALL"]="展开块",t.Msg["EXPAND_BLOCK"]="展开块",t.Msg["EXTERNAL_INPUTS"]="外部输入",t.Msg["HELP"]="帮助",t.Msg["INLINE_INPUTS"]="单行输入",t.Msg["IOS_CANCEL"]="取消",t.Msg["IOS_ERROR"]="错误",t.Msg["IOS_OK"]="确定",t.Msg["IOS_PROCEDURES_ADD_INPUT"]="+ 添加输入",t.Msg["IOS_PROCEDURES_ALLOW_STATEMENTS"]="允许的语句",t.Msg["IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR"]="这个函数有多个输入。",t.Msg["IOS_PROCEDURES_INPUTS"]="输入",t.Msg["IOS_VARIABLES_ADD_BUTTON"]="添加",t.Msg["IOS_VARIABLES_ADD_VARIABLE"]="+ 添加变量",t.Msg["IOS_VARIABLES_DELETE_BUTTON"]="删除",t.Msg["IOS_VARIABLES_EMPTY_NAME_ERROR"]="你不能使用空白的变量名。",t.Msg["IOS_VARIABLES_RENAME_BUTTON"]="重命名",t.Msg["IOS_VARIABLES_VARIABLE_NAME"]="变量名",t.Msg["LISTS_CREATE_EMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-empty-list",t.Msg["LISTS_CREATE_EMPTY_TITLE"]="创建空列表",t.Msg["LISTS_CREATE_EMPTY_TOOLTIP"]="返回一个列表，长度为 0，不包含任何数据记录",t.Msg["LISTS_CREATE_WITH_CONTAINER_TITLE_ADD"]="列表",t.Msg["LISTS_CREATE_WITH_CONTAINER_TOOLTIP"]="增加、删除或重新排列各部分以此重新配置这个列表块。",t.Msg["LISTS_CREATE_WITH_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg["LISTS_CREATE_WITH_INPUT_WITH"]="创建列表，内容：",t.Msg["LISTS_CREATE_WITH_ITEM_TOOLTIP"]="将一个项添加到列表中。",t.Msg["LISTS_CREATE_WITH_TOOLTIP"]="建立一个具有任意数量项目的列表。",t.Msg["LISTS_GET_INDEX_FIRST"]="第一项",t.Msg["LISTS_GET_INDEX_FROM_END"]="倒数第#项",t.Msg["LISTS_GET_INDEX_FROM_START"]="#",t.Msg["LISTS_GET_INDEX_GET"]="取得",t.Msg["LISTS_GET_INDEX_GET_REMOVE"]="取得并移除",t.Msg["LISTS_GET_INDEX_LAST"]="最后一项",t.Msg["LISTS_GET_INDEX_RANDOM"]="随机的一项",t.Msg["LISTS_GET_INDEX_REMOVE"]="移除",t.Msg["LISTS_GET_INDEX_TAIL"]="-",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FIRST"]="返回列表中的第一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FROM"]="返回在列表中的指定位置的项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_LAST"]="返回列表中的最后一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_RANDOM"]="返回列表中的随机一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST"]="移除并返回列表中的第一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM"]="移除并返回列表中的指定位置的项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST"]="移除并返回列表中的最后一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM"]="移除并返回列表中的随机一项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST"]="移除列表中的第一项",t.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM"]="移除在列表中的指定位置的项。",t.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST"]="移除列表中的最后一项",t.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM"]="删除列表中的随机一项。",t.Msg["LISTS_GET_SUBLIST_END_FROM_END"]="到倒数第#项",t.Msg["LISTS_GET_SUBLIST_END_FROM_START"]="到第#项",t.Msg["LISTS_GET_SUBLIST_END_LAST"]="到最后一项",t.Msg["LISTS_GET_SUBLIST_HELPURL"]="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",t.Msg["LISTS_GET_SUBLIST_START_FIRST"]="获取子列表，从第一项",t.Msg["LISTS_GET_SUBLIST_START_FROM_END"]="获取子列表，从倒数第#项",t.Msg["LISTS_GET_SUBLIST_START_FROM_START"]="获取子列表，从第#项",t.Msg["LISTS_GET_SUBLIST_TAIL"]="-",t.Msg["LISTS_GET_SUBLIST_TOOLTIP"]="复制列表中指定的部分。",t.Msg["LISTS_INDEX_FROM_END_TOOLTIP"]="%1是最后一项。",t.Msg["LISTS_INDEX_FROM_START_TOOLTIP"]="%1是第一项。",t.Msg["LISTS_INDEX_OF_FIRST"]="寻找第一次出现的项",t.Msg["LISTS_INDEX_OF_HELPURL"]="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",t.Msg["LISTS_INDEX_OF_LAST"]="寻找最后一次出现的项",t.Msg["LISTS_INDEX_OF_TOOLTIP"]="返回在列表中的第一/最后一个匹配项的索引值。如果找不到项目则返回%1。",t.Msg["LISTS_INLIST"]="在列表中",t.Msg["LISTS_ISEMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Lists#is-empty",t.Msg["LISTS_ISEMPTY_TITLE"]="%1是空的",t.Msg["LISTS_ISEMPTY_TOOLTIP"]="如果改列表为空，则返回真。",t.Msg["LISTS_LENGTH_HELPURL"]="https://github.com/google/blockly/wiki/Lists#length-of",t.Msg["LISTS_LENGTH_TITLE"]="%1的长度",t.Msg["LISTS_LENGTH_TOOLTIP"]="返回列表的长度。",t.Msg["LISTS_REPEAT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-list-with",t.Msg["LISTS_REPEAT_TITLE"]="建立列表使用项 %1 重复 %2 次",t.Msg["LISTS_REPEAT_TOOLTIP"]="建立包含指定重复次数的值的列表。",t.Msg["LISTS_REVERSE_HELPURL"]="https://github.com/google/blockly/wiki/Lists#reversing-a-list",t.Msg["LISTS_REVERSE_MESSAGE0"]="倒转%1",t.Msg["LISTS_REVERSE_TOOLTIP"]="倒转一个列表，返回副本。",t.Msg["LISTS_SET_INDEX_HELPURL"]="https://github.com/google/blockly/wiki/Lists#in-list--set",t.Msg["LISTS_SET_INDEX_INPUT_TO"]="值为",t.Msg["LISTS_SET_INDEX_INSERT"]="插入在",t.Msg["LISTS_SET_INDEX_SET"]="设置",t.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST"]="在列表的起始处添加该项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FROM"]="在列表中指定位置插入项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_LAST"]="在列表的末尾处添加该项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM"]="在列表的随机位置插入该项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FIRST"]="设置列表中的第一项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FROM"]="设置在列表中指定位置的项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_SET_LAST"]="设置列表中的最后一项。",t.Msg["LISTS_SET_INDEX_TOOLTIP_SET_RANDOM"]="设置列表中的随机一项。",t.Msg["LISTS_SORT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#sorting-a-list",t.Msg["LISTS_SORT_ORDER_ASCENDING"]="升序",t.Msg["LISTS_SORT_ORDER_DESCENDING"]="降序",t.Msg["LISTS_SORT_TITLE"]="排序%1 %2 %3",t.Msg["LISTS_SORT_TOOLTIP"]="排序一个列表，返回副本。",t.Msg["LISTS_SORT_TYPE_IGNORECASE"]="按字母（忽略大小写）",t.Msg["LISTS_SORT_TYPE_NUMERIC"]="按数字",t.Msg["LISTS_SORT_TYPE_TEXT"]="按字母",t.Msg["LISTS_SPLIT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",t.Msg["LISTS_SPLIT_LIST_FROM_TEXT"]="从文本制作列表",t.Msg["LISTS_SPLIT_TEXT_FROM_LIST"]="将列表合并为文本",t.Msg["LISTS_SPLIT_TOOLTIP_JOIN"]="加入文本列表至一个文本，由分隔符分隔。",t.Msg["LISTS_SPLIT_TOOLTIP_SPLIT"]="将文本按指定的分隔符拆分为文本组成的列表。",t.Msg["LISTS_SPLIT_WITH_DELIMITER"]="分隔符：",t.Msg["LOGIC_BOOLEAN_FALSE"]="假",t.Msg["LOGIC_BOOLEAN_HELPURL"]="https://github.com/google/blockly/wiki/Logic#values",t.Msg["LOGIC_BOOLEAN_TOOLTIP"]="返回真或假。",t.Msg["LOGIC_BOOLEAN_TRUE"]="真",t.Msg["LOGIC_COMPARE_HELPURL"]="https://zh.wikipedia.org/wiki/不等",t.Msg["LOGIC_COMPARE_TOOLTIP_EQ"]="如果两个输入结果相等，则返回真。",t.Msg["LOGIC_COMPARE_TOOLTIP_GT"]="如果第一个输入结果比第二个大，则返回真。",t.Msg["LOGIC_COMPARE_TOOLTIP_GTE"]="如果第一个输入结果大于或等于第二个输入结果，则返回真。",t.Msg["LOGIC_COMPARE_TOOLTIP_LT"]="如果第一个输入结果比第二个小，则返回真。",t.Msg["LOGIC_COMPARE_TOOLTIP_LTE"]="如果第一个输入结果小于或等于第二个输入结果，则返回真。",t.Msg["LOGIC_COMPARE_TOOLTIP_NEQ"]="如果两个输入结果不相等，则返回真。",t.Msg["LOGIC_NEGATE_HELPURL"]="https://github.com/google/blockly/wiki/Logic#not",t.Msg["LOGIC_NEGATE_TITLE"]="%1不成立",t.Msg["LOGIC_NEGATE_TOOLTIP"]="如果输入结果为假，则返回真；如果输入结果为真，则返回假。",t.Msg["LOGIC_NULL"]="空",t.Msg["LOGIC_NULL_HELPURL"]="https://en.wikipedia.org/wiki/Nullable_type",t.Msg["LOGIC_NULL_TOOLTIP"]="返回空值。",t.Msg["LOGIC_OPERATION_AND"]="并且",t.Msg["LOGIC_OPERATION_HELPURL"]="https://github.com/google/blockly/wiki/Logic#logical-operations",t.Msg["LOGIC_OPERATION_OR"]="或",t.Msg["LOGIC_OPERATION_TOOLTIP_AND"]="如果两个输入结果都为真，则返回真。",t.Msg["LOGIC_OPERATION_TOOLTIP_OR"]="如果至少有一个输入结果为真，则返回真。",t.Msg["LOGIC_TERNARY_CONDITION"]="断言",t.Msg["LOGIC_TERNARY_HELPURL"]="https://zh.wikipedia.org/wiki/条件运算符",t.Msg["LOGIC_TERNARY_IF_FALSE"]="如果为假",t.Msg["LOGIC_TERNARY_IF_TRUE"]="如果为真",t.Msg["LOGIC_TERNARY_TOOLTIP"]="检查“断言”里的条件语句。如果条件为真，则返回“如果为真”的值，否则，则返回“如果为假”的值。",t.Msg["MATH_ADDITION_SYMBOL"]="+",t.Msg["MATH_ARITHMETIC_HELPURL"]="https://zh.wikipedia.org/wiki/算术",t.Msg["MATH_ARITHMETIC_TOOLTIP_ADD"]="返回两个数值的和。",t.Msg["MATH_ARITHMETIC_TOOLTIP_DIVIDE"]="返回两个数值的商。",t.Msg["MATH_ARITHMETIC_TOOLTIP_MINUS"]="返回两个数值的差。",t.Msg["MATH_ARITHMETIC_TOOLTIP_MULTIPLY"]="返回两个数值的乘积。",t.Msg["MATH_ARITHMETIC_TOOLTIP_POWER"]="返回以第一个数值为底数，以第二个数值为幂的结果。",t.Msg["MATH_ATAN2_HELPURL"]="https://zh.wikipedia.org/wiki/反正切2",t.Msg["MATH_ATAN2_TITLE"]="点(x:%1,y:%2)的方位角",t.Msg["MATH_ATAN2_TOOLTIP"]="返回点（X，Y）的反正切值，范围为-180到180度。",t.Msg["MATH_CHANGE_HELPURL"]="https://zh.wikipedia.org/wiki/加法",t.Msg["MATH_CHANGE_TITLE"]="将 %1 增加 %2",t.Msg["MATH_CHANGE_TOOLTIP"]="为变量“%1”增加一个数值。",t.Msg["MATH_CONSTANT_HELPURL"]="https://zh.wikipedia.org/wiki/数学常数",t.Msg["MATH_CONSTANT_TOOLTIP"]="返回一个常见常量：π (3.141…)、e (2.718…)、φ (1.618…)、根号2 (1.414…)、根号二分之一 (0.707…)或∞ (无穷大)。",t.Msg["MATH_CONSTRAIN_HELPURL"]="https://en.wikipedia.org/wiki/Clamping_(graphics)",t.Msg["MATH_CONSTRAIN_TITLE"]="将 %1 限制在 最低 %2 到最高 %3 之间",t.Msg["MATH_CONSTRAIN_TOOLTIP"]="将一个数值限制在两个指定的数值范围（含边界）之间。",t.Msg["MATH_DIVISION_SYMBOL"]="÷",t.Msg["MATH_IS_DIVISIBLE_BY"]="可被整除",t.Msg["MATH_IS_EVEN"]="是偶数",t.Msg["MATH_IS_NEGATIVE"]="是负数",t.Msg["MATH_IS_ODD"]="是奇数",t.Msg["MATH_IS_POSITIVE"]="是正数",t.Msg["MATH_IS_PRIME"]="是质数",t.Msg["MATH_IS_TOOLTIP"]="检查一个数值是否是偶数、奇数、质数、自然数、正数、负数或者是否能被某数整除。返回真或假。",t.Msg["MATH_IS_WHOLE"]="是整数",t.Msg["MATH_MODULO_HELPURL"]="https://zh.wikipedia.org/wiki/模除",t.Msg["MATH_MODULO_TITLE"]="取 %1 ÷ %2 的余数",t.Msg["MATH_MODULO_TOOLTIP"]="返回这两个数字相除后的余数。",t.Msg["MATH_MULTIPLICATION_SYMBOL"]="×",t.Msg["MATH_NUMBER_HELPURL"]="https://zh.wikipedia.org/wiki/数",t.Msg["MATH_NUMBER_TOOLTIP"]="一个数值。",t.Msg["MATH_ONLIST_HELPURL"]="",t.Msg["MATH_ONLIST_OPERATOR_AVERAGE"]="列表平均值",t.Msg["MATH_ONLIST_OPERATOR_MAX"]="列表最大值",t.Msg["MATH_ONLIST_OPERATOR_MEDIAN"]="列表中位数",t.Msg["MATH_ONLIST_OPERATOR_MIN"]="列表最小值",t.Msg["MATH_ONLIST_OPERATOR_MODE"]="列表中的众数",t.Msg["MATH_ONLIST_OPERATOR_RANDOM"]="列表中的随机一项",t.Msg["MATH_ONLIST_OPERATOR_STD_DEV"]="列表的标准差",t.Msg["MATH_ONLIST_OPERATOR_SUM"]="列表中数值的和",t.Msg["MATH_ONLIST_TOOLTIP_AVERAGE"]="返回列表中的数值的平均值。",t.Msg["MATH_ONLIST_TOOLTIP_MAX"]="返回列表中最大值。",t.Msg["MATH_ONLIST_TOOLTIP_MEDIAN"]="返回列表中数值的中位数。",t.Msg["MATH_ONLIST_TOOLTIP_MIN"]="返回列表中最小值。",t.Msg["MATH_ONLIST_TOOLTIP_MODE"]="返回列表中的出现次数最多的项的列表。",t.Msg["MATH_ONLIST_TOOLTIP_RANDOM"]="从列表中返回一个随机的元素。",t.Msg["MATH_ONLIST_TOOLTIP_STD_DEV"]="返回列表的标准差。",t.Msg["MATH_ONLIST_TOOLTIP_SUM"]="返回列表中的所有数值的和。",t.Msg["MATH_POWER_SYMBOL"]="^",t.Msg["MATH_RANDOM_FLOAT_HELPURL"]="https://zh.wikipedia.org/wiki/随机数生成器",t.Msg["MATH_RANDOM_FLOAT_TITLE_RANDOM"]="随机小数",t.Msg["MATH_RANDOM_FLOAT_TOOLTIP"]="返回一个从0.0（含）到1.0（不含）之间的随机数。",t.Msg["MATH_RANDOM_INT_HELPURL"]="https://zh.wikipedia.org/wiki/随机数生成器",t.Msg["MATH_RANDOM_INT_TITLE"]="从 %1 到 %2 范围内的随机整数",t.Msg["MATH_RANDOM_INT_TOOLTIP"]="返回一个限制在两个指定数值的范围（含边界）之间的随机整数。",t.Msg["MATH_ROUND_HELPURL"]="https://zh.wikipedia.org/wiki/数值修约",t.Msg["MATH_ROUND_OPERATOR_ROUND"]="四舍五入",t.Msg["MATH_ROUND_OPERATOR_ROUNDDOWN"]="向下舍入",t.Msg["MATH_ROUND_OPERATOR_ROUNDUP"]="向上舍入",t.Msg["MATH_ROUND_TOOLTIP"]="数字向上或向下舍入。",t.Msg["MATH_SINGLE_HELPURL"]="https://zh.wikipedia.org/wiki/平方根",t.Msg["MATH_SINGLE_OP_ABSOLUTE"]="绝对值",t.Msg["MATH_SINGLE_OP_ROOT"]="平方根",t.Msg["MATH_SINGLE_TOOLTIP_ABS"]="返回一个数值的绝对值。",t.Msg["MATH_SINGLE_TOOLTIP_EXP"]="返回一个数值的e次幂。",t.Msg["MATH_SINGLE_TOOLTIP_LN"]="返回一个数值的自然对数。",t.Msg["MATH_SINGLE_TOOLTIP_LOG10"]="返回一个数值的以10为底的对数。",t.Msg["MATH_SINGLE_TOOLTIP_NEG"]="返回一个数值的相反数。",t.Msg["MATH_SINGLE_TOOLTIP_POW10"]="返回一个数值的10次幂。",t.Msg["MATH_SINGLE_TOOLTIP_ROOT"]="返回一个数的平方根。",t.Msg["MATH_SUBTRACTION_SYMBOL"]="-",t.Msg["MATH_TRIG_ACOS"]="acos",t.Msg["MATH_TRIG_ASIN"]="asin",t.Msg["MATH_TRIG_ATAN"]="atan",t.Msg["MATH_TRIG_COS"]="cos",t.Msg["MATH_TRIG_HELPURL"]="https://zh.wikipedia.org/wiki/三角函数",t.Msg["MATH_TRIG_SIN"]="sin",t.Msg["MATH_TRIG_TAN"]="tan",t.Msg["MATH_TRIG_TOOLTIP_ACOS"]="返回一个数值的反余弦值。",t.Msg["MATH_TRIG_TOOLTIP_ASIN"]="返回一个数值的反正弦值。",t.Msg["MATH_TRIG_TOOLTIP_ATAN"]="返回一个数值的反正切值。",t.Msg["MATH_TRIG_TOOLTIP_COS"]="返回指定角度的余弦值（非弧度）。",t.Msg["MATH_TRIG_TOOLTIP_SIN"]="返回指定角度的正弦值（非弧度）。",t.Msg["MATH_TRIG_TOOLTIP_TAN"]="返回指定角度的正切值（非弧度）。",t.Msg["NEW_COLOUR_VARIABLE"]="创建颜色变量...",t.Msg["NEW_NUMBER_VARIABLE"]="创建数字变量...",t.Msg["NEW_STRING_VARIABLE"]="创建字符串变量...",t.Msg["NEW_VARIABLE"]="创建变量...",t.Msg["NEW_VARIABLE_TITLE"]="新变量的名称：",t.Msg["NEW_VARIABLE_TYPE_TITLE"]="新变量的类型：",t.Msg["ORDINAL_NUMBER_SUFFIX"]="-",t.Msg["PROCEDURES_ALLOW_STATEMENTS"]="允许声明",t.Msg["PROCEDURES_BEFORE_PARAMS"]="与：",t.Msg["PROCEDURES_CALLNORETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",t.Msg["PROCEDURES_CALLNORETURN_TOOLTIP"]="运行用户定义的函数“%1”。",t.Msg["PROCEDURES_CALLRETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",t.Msg["PROCEDURES_CALLRETURN_TOOLTIP"]="运行用户定义的函数“%1”，并使用它的输出值。",t.Msg["PROCEDURES_CALL_BEFORE_PARAMS"]="与：",t.Msg["PROCEDURES_CREATE_DO"]="创建“%1”",t.Msg["PROCEDURES_DEFNORETURN_COMMENT"]="描述该功能...",t.Msg["PROCEDURES_DEFNORETURN_DO"]="-",t.Msg["PROCEDURES_DEFNORETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",t.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"]="做点什么",t.Msg["PROCEDURES_DEFNORETURN_TITLE"]="至",t.Msg["PROCEDURES_DEFNORETURN_TOOLTIP"]="创建一个不带输出值的函数。",t.Msg["PROCEDURES_DEFRETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",t.Msg["PROCEDURES_DEFRETURN_RETURN"]="返回",t.Msg["PROCEDURES_DEFRETURN_TOOLTIP"]="创建一个有输出值的函数。",t.Msg["PROCEDURES_DEF_DUPLICATE_WARNING"]="警告：此函数具有重复参数。",t.Msg["PROCEDURES_HIGHLIGHT_DEF"]="突出显示函数定义",t.Msg["PROCEDURES_IFRETURN_HELPURL"]="http://c2.com/cgi/wiki?GuardClause",t.Msg["PROCEDURES_IFRETURN_TOOLTIP"]="如果值为真，则返回第二个值。",t.Msg["PROCEDURES_IFRETURN_WARNING"]="警告：这个块只能在函数内部使用。",t.Msg["PROCEDURES_MUTATORARG_TITLE"]="输入名称：",t.Msg["PROCEDURES_MUTATORARG_TOOLTIP"]="添加函数输入。",t.Msg["PROCEDURES_MUTATORCONTAINER_TITLE"]="输入",t.Msg["PROCEDURES_MUTATORCONTAINER_TOOLTIP"]="添加、移除或重新排此函数的输入。",t.Msg["REDO"]="重做",t.Msg["REMOVE_COMMENT"]="删除注释",t.Msg["RENAME_VARIABLE"]="重命名变量...",t.Msg["RENAME_VARIABLE_TITLE"]="将所有“%1”变量重命名为:",t.Msg["TEXT_APPEND_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg["TEXT_APPEND_TITLE"]="在%1之后加上文本%2",t.Msg["TEXT_APPEND_TOOLTIP"]="将一些文本追加到变量“%1”里。",t.Msg["TEXT_CHANGECASE_HELPURL"]="https://github.com/google/blockly/wiki/Text#adjusting-text-case",t.Msg["TEXT_CHANGECASE_OPERATOR_LOWERCASE"]="转为小写",t.Msg["TEXT_CHANGECASE_OPERATOR_TITLECASE"]="转为首字母大写",t.Msg["TEXT_CHANGECASE_OPERATOR_UPPERCASE"]="转为大写",t.Msg["TEXT_CHANGECASE_TOOLTIP"]="用不同的大小写模式复制并返回这段文字。",t.Msg["TEXT_CHARAT_FIRST"]="获取第一个字符",t.Msg["TEXT_CHARAT_FROM_END"]="获取倒数第#个字符",t.Msg["TEXT_CHARAT_FROM_START"]="获取第#个字符",t.Msg["TEXT_CHARAT_HELPURL"]="https://github.com/google/blockly/wiki/Text#extracting-text",t.Msg["TEXT_CHARAT_LAST"]="获取最后一个字符",t.Msg["TEXT_CHARAT_RANDOM"]="获取随机一个字符",t.Msg["TEXT_CHARAT_TAIL"]="-",t.Msg["TEXT_CHARAT_TITLE"]="在文本%1 里 %2",t.Msg["TEXT_CHARAT_TOOLTIP"]="返回位于指定位置的字符。",t.Msg["TEXT_COUNT_HELPURL"]="https://github.com/google/blockly/wiki/Text#counting-substrings",t.Msg["TEXT_COUNT_MESSAGE0"]="计算%1在%2里出现的次数",t.Msg["TEXT_COUNT_TOOLTIP"]="计算在一段文本中，某个部分文本重复出现了多少次。",t.Msg["TEXT_CREATE_JOIN_ITEM_TOOLTIP"]="将一个项添加到文本中。",t.Msg["TEXT_CREATE_JOIN_TITLE_JOIN"]="拼接",t.Msg["TEXT_CREATE_JOIN_TOOLTIP"]="添加、移除或重新排列各节来重新配置这个文本块。",t.Msg["TEXT_GET_SUBSTRING_END_FROM_END"]="到倒数第#个字符",t.Msg["TEXT_GET_SUBSTRING_END_FROM_START"]="到第#个字符",t.Msg["TEXT_GET_SUBSTRING_END_LAST"]="到最后一个字符",t.Msg["TEXT_GET_SUBSTRING_HELPURL"]="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",t.Msg["TEXT_GET_SUBSTRING_INPUT_IN_TEXT"]="从文本",t.Msg["TEXT_GET_SUBSTRING_START_FIRST"]="获取子串，从第一个字符",t.Msg["TEXT_GET_SUBSTRING_START_FROM_END"]="获取子串，从倒数第#个字符",t.Msg["TEXT_GET_SUBSTRING_START_FROM_START"]="获取子串，从第#个字符",t.Msg["TEXT_GET_SUBSTRING_TAIL"]="-",t.Msg["TEXT_GET_SUBSTRING_TOOLTIP"]="返回文本中指定的一部分。",t.Msg["TEXT_INDEXOF_HELPURL"]="https://github.com/google/blockly/wiki/Text#finding-text",t.Msg["TEXT_INDEXOF_OPERATOR_FIRST"]="寻找第一次出现的文本",t.Msg["TEXT_INDEXOF_OPERATOR_LAST"]="寻找最后一次出现的文本",t.Msg["TEXT_INDEXOF_TITLE"]="在文本 %1 里 %2  %3",t.Msg["TEXT_INDEXOF_TOOLTIP"]="返回第一个文本段在第二个文本段中的第一/最后一个匹配项的起始位置。如果未找到，则返回%1。",t.Msg["TEXT_ISEMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",t.Msg["TEXT_ISEMPTY_TITLE"]="%1是空的",t.Msg["TEXT_ISEMPTY_TOOLTIP"]="如果给定的文本为空，则返回真。",t.Msg["TEXT_JOIN_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-creation",t.Msg["TEXT_JOIN_TITLE_CREATEWITH"]="创建文本，内容：",t.Msg["TEXT_JOIN_TOOLTIP"]="通过串起任意数量的项以建立一段文本。",t.Msg["TEXT_LENGTH_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-modification",t.Msg["TEXT_LENGTH_TITLE"]="%1的长度",t.Msg["TEXT_LENGTH_TOOLTIP"]="返回给定文本的字母数（包括空格）。",t.Msg["TEXT_PRINT_HELPURL"]="https://github.com/google/blockly/wiki/Text#printing-text",t.Msg["TEXT_PRINT_TITLE"]="输出%1",t.Msg["TEXT_PRINT_TOOLTIP"]="输出指定的文字、数字或其他值。",t.Msg["TEXT_PROMPT_HELPURL"]="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",t.Msg["TEXT_PROMPT_TOOLTIP_NUMBER"]="要求用户输入数字。",t.Msg["TEXT_PROMPT_TOOLTIP_TEXT"]="要求用户输入一些文本。",t.Msg["TEXT_PROMPT_TYPE_NUMBER"]="要求输入数字，并显示提示消息",t.Msg["TEXT_PROMPT_TYPE_TEXT"]="要求输入文本，并显示提示消息",t.Msg["TEXT_REPLACE_HELPURL"]="https://github.com/google/blockly/wiki/Text#replacing-substrings",t.Msg["TEXT_REPLACE_MESSAGE0"]="把%3中的%1替换为%2",t.Msg["TEXT_REPLACE_TOOLTIP"]="在一段文本中，将出现过的某部分文本都替换掉。",t.Msg["TEXT_REVERSE_HELPURL"]="https://github.com/google/blockly/wiki/Text#reversing-text",t.Msg["TEXT_REVERSE_MESSAGE0"]="倒转文本%1",t.Msg["TEXT_REVERSE_TOOLTIP"]="将文本中各个字符的顺序倒转。",t.Msg["TEXT_TEXT_HELPURL"]="https://zh.wikipedia.org/wiki/字符串",t.Msg["TEXT_TEXT_TOOLTIP"]="一个字、词语或一行文本。",t.Msg["TEXT_TRIM_HELPURL"]="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",t.Msg["TEXT_TRIM_OPERATOR_BOTH"]="消除其两侧的空白",t.Msg["TEXT_TRIM_OPERATOR_LEFT"]="消除其左侧的空白",t.Msg["TEXT_TRIM_OPERATOR_RIGHT"]="消除其右侧的空白",t.Msg["TEXT_TRIM_TOOLTIP"]="从某一端或同时从两端删除多余的空白，并返回这段文字的一个副本。",t.Msg["TODAY"]="今天",t.Msg["UNDO"]="撤销",t.Msg["UNNAMED_KEY"]="匿名",t.Msg["VARIABLES_DEFAULT_NAME"]="项目",t.Msg["VARIABLES_GET_CREATE_SET"]="创建“设定%1”",t.Msg["VARIABLES_GET_HELPURL"]="https://github.com/google/blockly/wiki/Variables#get",t.Msg["VARIABLES_GET_TOOLTIP"]="返回此变量的值。",t.Msg["VARIABLES_SET"]="赋值 %1 为 %2",t.Msg["VARIABLES_SET_CREATE_GET"]="创建“获得%1”",t.Msg["VARIABLES_SET_HELPURL"]="https://github.com/google/blockly/wiki/Variables#set",t.Msg["VARIABLES_SET_TOOLTIP"]="设置此变量，以使它和输入值相等。",t.Msg["VARIABLE_ALREADY_EXISTS"]="名字叫“%1”的变量已经存在了。",t.Msg["VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE"]="名字叫“%1”的变量已经有了另一个类型：“%2”。",t.Msg["WORKSPACE_ARIA_LABEL"]="Blockly工作区",t.Msg["WORKSPACE_COMMENT_DEFAULT_TEXT"]="说点什么...",t.Msg["CONTROLS_FOREACH_INPUT_DO"]=t.Msg["CONTROLS_REPEAT_INPUT_DO"],t.Msg["CONTROLS_FOR_INPUT_DO"]=t.Msg["CONTROLS_REPEAT_INPUT_DO"],t.Msg["CONTROLS_IF_ELSEIF_TITLE_ELSEIF"]=t.Msg["CONTROLS_IF_MSG_ELSEIF"],t.Msg["CONTROLS_IF_ELSE_TITLE_ELSE"]=t.Msg["CONTROLS_IF_MSG_ELSE"],t.Msg["CONTROLS_IF_IF_TITLE_IF"]=t.Msg["CONTROLS_IF_MSG_IF"],t.Msg["CONTROLS_IF_MSG_THEN"]=t.Msg["CONTROLS_REPEAT_INPUT_DO"],t.Msg["CONTROLS_WHILEUNTIL_INPUT_DO"]=t.Msg["CONTROLS_REPEAT_INPUT_DO"],t.Msg["LISTS_CREATE_WITH_ITEM_TITLE"]=t.Msg["VARIABLES_DEFAULT_NAME"],t.Msg["LISTS_GET_INDEX_HELPURL"]=t.Msg["LISTS_INDEX_OF_HELPURL"],t.Msg["LISTS_GET_INDEX_INPUT_IN_LIST"]=t.Msg["LISTS_INLIST"],t.Msg["LISTS_GET_SUBLIST_INPUT_IN_LIST"]=t.Msg["LISTS_INLIST"],t.Msg["LISTS_INDEX_OF_INPUT_IN_LIST"]=t.Msg["LISTS_INLIST"],t.Msg["LISTS_SET_INDEX_INPUT_IN_LIST"]=t.Msg["LISTS_INLIST"],t.Msg["MATH_CHANGE_TITLE_ITEM"]=t.Msg["VARIABLES_DEFAULT_NAME"],t.Msg["PROCEDURES_DEFRETURN_COMMENT"]=t.Msg["PROCEDURES_DEFNORETURN_COMMENT"],t.Msg["PROCEDURES_DEFRETURN_DO"]=t.Msg["PROCEDURES_DEFNORETURN_DO"],t.Msg["PROCEDURES_DEFRETURN_PROCEDURE"]=t.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"],t.Msg["PROCEDURES_DEFRETURN_TITLE"]=t.Msg["PROCEDURES_DEFNORETURN_TITLE"],t.Msg["TEXT_APPEND_VARIABLE"]=t.Msg["VARIABLES_DEFAULT_NAME"],t.Msg["TEXT_CREATE_JOIN_ITEM_TITLE_ITEM"]=t.Msg["VARIABLES_DEFAULT_NAME"],t.Msg["MATH_HUE"]="230",t.Msg["LOOPS_HUE"]="120",t.Msg["LISTS_HUE"]="260",t.Msg["LOGIC_HUE"]="210",t.Msg["VARIABLES_HUE"]="330",t.Msg["TEXTS_HUE"]="160",t.Msg["PROCEDURES_HUE"]="290",t.Msg["COLOUR_HUE"]="20",t.Msg["VARIABLES_DYNAMIC_HUE"]="310",t.Msg}))},"56b0":function(t,e,i){"use strict";i("db42");var r=i("9d26"),n=i("da13"),o=i("34c3"),s=i("7e2b"),a=i("9d65"),l=i("a9ad"),h=i("f2e7"),c=i("3206"),u=i("5607"),d=i("0789"),p=i("58df"),f=i("80d2");const _=Object(p["a"])(s["a"],a["a"],l["a"],Object(c["a"])("list"),h["a"]);e["a"]=_.extend().extend({name:"v-list-group",directives:{ripple:u["a"]},props:{activeClass:{type:String,default:""},appendIcon:{type:String,default:"$expand"},color:{type:String,default:"primary"},disabled:Boolean,group:[String,RegExp],noAction:Boolean,prependIcon:String,ripple:{type:[Boolean,Object],default:!0},subGroup:Boolean},computed:{classes(){return{"v-list-group--active":this.isActive,"v-list-group--disabled":this.disabled,"v-list-group--no-action":this.noAction,"v-list-group--sub-group":this.subGroup}}},watch:{isActive(t){!this.subGroup&&t&&this.list&&this.list.listClick(this._uid)},$route:"onRouteChange"},created(){this.list&&this.list.register(this),this.group&&this.$route&&null==this.value&&(this.isActive=this.matchRoute(this.$route.path))},beforeDestroy(){this.list&&this.list.unregister(this)},methods:{click(t){this.disabled||(this.isBooted=!0,this.$emit("click",t),this.$nextTick(()=>this.isActive=!this.isActive))},genIcon(t){return this.$createElement(r["a"],t)},genAppendIcon(){const t=!this.subGroup&&this.appendIcon;return t||this.$slots.appendIcon?this.$createElement(o["a"],{staticClass:"v-list-group__header__append-icon"},[this.$slots.appendIcon||this.genIcon(t)]):null},genHeader(){return this.$createElement(n["a"],{staticClass:"v-list-group__header",attrs:{"aria-expanded":String(this.isActive),role:"button"},class:{[this.activeClass]:this.isActive},props:{inputValue:this.isActive},directives:[{name:"ripple",value:this.ripple}],on:{...this.listeners$,click:this.click}},[this.genPrependIcon(),this.$slots.activator,this.genAppendIcon()])},genItems(){return this.showLazyContent(()=>[this.$createElement("div",{staticClass:"v-list-group__items",directives:[{name:"show",value:this.isActive}]},Object(f["r"])(this))])},genPrependIcon(){const t=this.subGroup&&null==this.prependIcon?"$subgroup":this.prependIcon;return t||this.$slots.prependIcon?this.$createElement(o["a"],{staticClass:"v-list-group__header__prepend-icon"},[this.$slots.prependIcon||this.genIcon(t)]):null},onRouteChange(t){if(!this.group)return;const e=this.matchRoute(t.path);e&&this.isActive!==e&&this.list&&this.list.listClick(this._uid),this.isActive=e},toggle(t){const e=this._uid===t;e&&(this.isBooted=!0),this.$nextTick(()=>this.isActive=e)},matchRoute(t){return null!==t.match(this.group)}},render(t){return t("div",this.setTextColor(this.isActive&&this.color,{staticClass:"v-list-group",class:this.classes}),[this.genHeader(),t(d["a"],this.genItems())])}})},"5b28":function(t,e,i){"use strict";var r=i("633b"),n=i("e07a");if("undefined"==typeof o)var o={Left:0,Right:1,Forward:2,Back:3};if("undefined"==typeof s)var s={UP:0,DOWN:1};var a=!1,l=null,h=null,c=null,u=null,d=!0,p={turn:!0,move:!0,arc:!0},f=null,_=null,g=0,m=0,b=null,v=null,y=[],T=[],O=20,E=1,A=0,C=new r["Color4"](0,1,0,1),x=null,w=null,M=null,S=null,I=512;const P=9,R=.16,L=P*R;var N={getRobotInstance(){return this},initScene:function(t,e,i){l=t,h=e,c=n["a"].getMeshSize(h),this.resetBodyPose(),this.setSpeed(1),u=i,a=!1,f=null,b=null,v=null,y=[],T=[]},initRobotPenclDynamicTexture(t){_=t},resetScene:function(t,e,i){l=t,h=e,c=n["a"].getMeshSize(h),this.resetBodyPose(),this.setSpeed(1),u=i,g=0,m=0,a=!1,f=null,b=null,v=null,y=[],T=[]},init:function(){console.log("robot模块化程序初始化"),a=!0},upadteCurrentPosition(t,e){g=t,m=e},setSpeed:function(t){console.log("setSpeed"),E=t},checkStatus:function(){if(!a&&!d)throw"程序需要初始化模块"},stop:function(){console.log("robot模块运行结束"),this.resetPencil(),a=!1},pencilTo(t,e){if(!b)return g=t,void(m=e);var i=_.getContext();i.beginPath(),i.lineWidth=2,i.fillStyle="green",i.strokeStyle="green";var r=this.sceneToPadX(g),n=this.sceneToPadY(m),o=this.sceneToPadX(t),s=this.sceneToPadY(e);i.moveTo(r,n),i.lineTo(o,s),i.quadraticCurveTo(r,n,o,s),i.stroke(),_.update(),g=t,m=e},sceneToPadX(t){var e=100*L,i=I/e;return-t*i+I/2},sceneToPadY(t){var e=100*L,i=I/e;return t*i+I/2},robotPosition(){return{z:Math.round(h.position.z,2),x:Math.round(h.position.x,2)}},drawable:async function(t){var e=b,i=s.DOWN==t;e==s.DOWN&&0==i&&(A+=1,console.log("drawable.line_grounp",A),y=[],T=[]),b=i;for(let n=0;n<h._children.length;n++){var r=h._children[n];if("pencil"==r.id){await this.pencilDown(t,r);break}}},resetPencil(){if(b)for(let e=0;e<h._children.length;e++){var t=h._children[e];if("pencil"==t.id){t.position.y+=c.y/1e3,b=!1;break}}},drawableBlockly(t,e){var i=b,r=s.DOWN==t;i==s.DOWN&&0==r&&(A+=1,y=[],T=[]),b=r;for(let o=0;o<h._children.length;o++){var n=h._children[o];if("pencil"==n.id){this.pencilDown(t,n).then(t=>{e(t)});break}}},pencilDown:async function(t,e){var i=new r["Vector3"](e.position._x,e.position._y,e.position._z),n=c.y/1e3;if(i.y==-n&&t==s.DOWN)return console.log("[pencil already down]"),"pencil already down";if(0==i.y&&t==s.UP)return console.log("[pencil already up]"),"pencil already up";var o=0,a=25e-5*E;return console.log("pencilDownOffset,pencilSpeed",n,a),await new Promise(r=>{var l=setInterval((function(){var h=!1;n-o<a?setTimeout((function(){e.position.y=i.y-n*(t==s.DOWN?1:-1),console.log(t==s.DOWN?"[pencil down done]":"[pencil up done]",e.position.y),r("pencil down/up done"),clearInterval(l)})):h=!0,h&&(e.position.y-=a*(t==s.DOWN?1:-1),o+=a)}),O)})},pencilcolor:async function(t,e,i){return A+=1,console.log("pencilcolor.line_grounp",A),y=[],T=[],C.r=t,C.g=e,C.b=i,new Promise(t=>{setTimeout((function(){console.log("[pencil color set]"),t("[pencil color set]")}),1e3/O)})},draw:function(t){b&&(t.y=.01,y.push(t),T.push(new r["Vector3"](0,1,0)),null==f?(console.log("new line"),f=r["MeshBuilder"].CreateLines("line",{points:y,colors:T,updatable:!0,useVertexAlpha:!0},l)):(null!=f&&f.dispose(),f=r["MeshBuilder"].CreateLines("line",{points:y,colors:T,updatable:!0,useVertexAlpha:!0},l)),f.material.freeze(),f.freezeWorldMatrix(),f.enableEdgesRendering(),f.edgesWidth=50,f.edgesColor=new r["Color4"](C.r,C.g,C.b,C.a))},move:async function(t){this.checkStatus(),await this.slowRunMoveTask(t)},moveBlockly:function(t,e){this.checkStatus(),this.slowRunMoveTask(t).then(t=>{e(t)})},slowRunMoveTask:async function(t){var e=h.getAbsolutePosition(),i=Math.round(S,0),o=-Math.round(Math.cos(n["a"].degToRad(i))*t,2),s=-Math.round(Math.sin(n["a"].degToRad(i))*t,2),l=new r["Vector3"](e._x,e._y,e._z);v=e,g=v._x,m=v._z,this.pencilTo(v._x,v._z);var c=0,u=0,d=this,f=E/4;return await new Promise(e=>{var i=setInterval((function(){a||setTimeout((function(){clearInterval(i),e("move force stop")}));var r=Math.sqrt(Math.pow(c,2)+Math.pow(u,2)),n=!1;if(t-r<=f?setTimeout((function(){v._x=l._x+o,v._z=l._z+s,h.position=v,d.pencilTo(v._x,v._z),p.move&&console.log("[move done]z,x",d.robotPosition().z,d.robotPosition().x),e("move done"),clearInterval(i)})):n=!0,n){var _=o/t*f,g=s/t*f;c+=_,u+=g,v._x+=_,v._z+=g,d.pencilTo(v._x,v._z),h.position=v}}),O)})},turn:async function(t,e){await this.turnTask(t,e)},turnBlockly:function(t,e,i){this.turnTask(t,e).then(t=>{i(t)})},async turnTask(t,e){x=t==o.Left?1:-1,w=S,M=this.getBodyHeading();var i=this,r=0;return await new Promise(t=>{var n=setInterval((function(){a||setTimeout((function(){S=w+x*(r-E),S>360?S-=360:S<-360&&(S+=360),clearInterval(n),t("turn force stop")}));var o=!1;e-r<=E?setTimeout((function(){i.setBodyHeading(M+x*e),S=w+x*e,S>360?S-=360:S<-360&&(S+=360),p.turn&&console.log("[turn done]rotation.y",S),t("turn done"),clearInterval(n)})):o=!0,o&&(i.setBodyHeading(M+x*r),r+=E)}),O)})},turnTaskSync(t,e){x=t==o.Left?1:-1,w=S,M=this.getBodyHeading(),this.setBodyHeading(M+x*e),S=w+x*e,S>360?S-=360:S<-360&&(S+=360)},arc:async function(t,e,i){this.checkStatus();var s=h.getAbsolutePosition();g=s._x,m=s._z;var a=Math.round(S,0),l=Math.round(Math.sin(n["a"].degToRad(a))*i,2),c=Math.round(Math.cos(n["a"].degToRad(a))*i,2);t==o.Left?c=-c:l=-l;var d=new r["Vector3"](s._x+l,s._y,s._z+c);return u=new r["Vector3"](s._x,s._y,s._z),t==o.Right?await this.arc_right(e,i,s,d):t==o.Left?await this.arc_left(e,i,s,d):void 0},arcBlockly:function(t,e,i,s){this.checkStatus();var a=h.getAbsolutePosition(),l=Math.round(S,0),c=Math.round(Math.sin(n["a"].degToRad(l))*i,2),d=Math.round(Math.cos(n["a"].degToRad(l))*i,2);t==o.Left?d=-d:c=-c;var p=new r["Vector3"](a._x+c,a._y,a._z+d);u=new r["Vector3"](a._x,a._y,a._z),g=a._x,m=a._z,this.pencilTo(u._x,u._z),t==o.Right?this.arc_right(e,i,a,p).then(t=>{s(t)}):t==o.Left&&this.arc_left(e,i,a,p).then(t=>{s(t)})},arc_left:async function(t,e,i,r){var s=this.get_angle(u._z,u._x,r._z,r._x)+270;s=180-s,s=s<0?s+360:s,s=s>=360?s-360:s,v=i;var l=0,c=this;return await new Promise(i=>{var u=setInterval((function(){a||setTimeout((function(){clearInterval(u),i("arc left force stop")}));var d=!1;if(t-l<=E?setTimeout((function(){clearInterval(u);var a=t-l;s+=a;var d=r._z+e*Math.cos(n["a"].degToRad(s)),f=r._x-e*Math.sin(n["a"].degToRad(s));v._x=f,v._z=d,h.position=v,c.turnTaskSync(o.Left,a),c.pencilTo(v._x,v._z),p.arc&&console.log("[arc left done]z,x,roation.y",c.robotPosition().z,c.robotPosition().x,S),i("arc done")})):d=!0,d){var f=r._z+e*Math.cos(n["a"].degToRad(s)),_=r._x-e*Math.sin(n["a"].degToRad(s));v._x=_,v._z=f,h.position=v;var g=E;c.turnTaskSync(o.Left,g),c.pencilTo(v._x,v._z),s+=E,l+=E}}),O)})},arc_right:async function(t,e,i,r){var s=this.get_angle(u._z,u._x,r._z,r._x)+270;s=s>=360?s-360:s,v=i;var l=0,c=this;return await new Promise(i=>{var u=setInterval((function(){a||setTimeout((function(){clearInterval(u),i("arc right force stop")}));var d=!1;if(t-l<=E?setTimeout((function(){clearInterval(u);var a=t-l;s+=a;var d=r._z-e*Math.cos(n["a"].degToRad(s)),f=r._x-e*Math.sin(n["a"].degToRad(s));v._x=f,v._z=d,h.position=v,c.turnTaskSync(o.Right,a),c.pencilTo(v._x,v._z),p.arc&&console.log("[arc right done]z,x,roation.y",c.robotPosition().z,c.robotPosition().x,S),i("arc done")})):d=!0,d){var f=r._z-e*Math.cos(n["a"].degToRad(s)),_=r._x-e*Math.sin(n["a"].degToRad(s));v._x=_,v._z=f,h.position=v;var g=E;c.turnTaskSync(o.Right,g),c.pencilTo(v._x,v._z),s+=E,l+=E}}),O)})},get_angle:function(t,e,i,r){var n=Math.abs(t-i),o=Math.abs(e-r),s=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),a=o/s,l=Math.acos(a),h=Math.floor(180/(Math.PI/l));return i>t&&r>e&&(h=180-h),i==t&&r>e&&(h=180),i>t&&r==e&&(h=90),i<t&&r>e&&(h=180+h),i<t&&r==e&&(h=270),i<t&&r<e&&(h=360-h),h},resetBodyPose(t=0,e=0){S=0,this.setBodyHeading(this.initialHeading()),this.setBodyPosition(t,e)},setBodyPosition(t,e){h.position.x=t,h.position.z=e},initialHeading(){return 90},getBodyHeading(){return-n["a"].radToDeg(h.rotationQuaternion.toEulerAngles().y)},setBodyHeading(t){const e=h.rotationQuaternion.toEulerAngles();h.rotationQuaternion=r["Quaternion"].RotationYawPitchRoll(n["a"].degToRad(-t),e.x,e.z)}};e["a"]=N},"5d23":function(t,e,i){"use strict";i.d(e,"a",(function(){return b})),i.d(e,"b",(function(){return v}));var r=i("80d2"),n=i("8860"),o=i("56b0"),s=i("da13"),a=i("1baa"),l=i("1800"),h=(i("3408"),i("a9ad")),c=i("24b2"),u=i("a236"),d=i("58df"),p=Object(d["a"])(h["a"],c["a"],u["a"]).extend({name:"v-avatar",props:{left:Boolean,right:Boolean,size:{type:[Number,String],default:48}},computed:{classes(){return{"v-avatar--left":this.left,"v-avatar--right":this.right,...this.roundedClasses}},styles(){return{height:Object(r["h"])(this.size),minWidth:Object(r["h"])(this.size),width:Object(r["h"])(this.size),...this.measurableStyles}}},render(t){const e={staticClass:"v-avatar",class:this.classes,style:this.styles,on:this.$listeners};return t("div",this.setBackgroundColor(this.color,e),this.$slots.default)}}),f=p,_=f.extend({name:"v-list-item-avatar",props:{horizontal:Boolean,size:{type:[Number,String],default:40}},computed:{classes(){return{"v-list-item__avatar--horizontal":this.horizontal,...f.options.computed.classes.call(this),"v-avatar--tile":this.tile||this.horizontal}}},render(t){const e=f.options.render.call(this,t);return e.data=e.data||{},e.data.staticClass+=" v-list-item__avatar",e}}),g=i("34c3");const m=Object(r["i"])("v-list-item__action-text","span"),b=Object(r["i"])("v-list-item__content","div"),v=Object(r["i"])("v-list-item__title","div"),y=Object(r["i"])("v-list-item__subtitle","div");n["a"],o["a"],s["a"],l["a"],a["a"],g["a"]},"604c":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));i("166a");var r=i("8547"),n=i("a452"),o=i("7560"),s=i("58df"),a=i("d9bd");const l=Object(s["a"])(r["a"],n["a"],o["a"]).extend({name:"base-item-group",props:{activeClass:{type:String,default:"v-item--active"},mandatory:Boolean,max:{type:[Number,String],default:null},multiple:Boolean,tag:{type:String,default:"div"}},data(){return{internalLazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,items:[]}},computed:{classes(){return{"v-item-group":!0,...this.themeClasses}},selectedIndex(){return this.selectedItem&&this.items.indexOf(this.selectedItem)||-1},selectedItem(){if(!this.multiple)return this.selectedItems[0]},selectedItems(){return this.items.filter((t,e)=>this.toggleMethod(this.getValue(t,e)))},selectedValues(){return null==this.internalValue?[]:Array.isArray(this.internalValue)?this.internalValue:[this.internalValue]},toggleMethod(){if(!this.multiple)return t=>this.valueComparator(this.internalValue,t);const t=this.internalValue;return Array.isArray(t)?e=>t.some(t=>this.valueComparator(t,e)):()=>!1}},watch:{internalValue:"updateItemsState",items:"updateItemsState"},created(){this.multiple&&!Array.isArray(this.internalValue)&&Object(a["c"])("Model must be bound to an array if the multiple property is true.",this)},methods:{genData(){return{class:this.classes}},getValue(t,e){return void 0===t.value?e:t.value},onClick(t){this.updateInternalValue(this.getValue(t,this.items.indexOf(t)))},register(t){const e=this.items.push(t)-1;t.$on("change",()=>this.onClick(t)),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(t,e)},unregister(t){if(this._isDestroyed)return;const e=this.items.indexOf(t),i=this.getValue(t,e);this.items.splice(e,1);const r=this.selectedValues.indexOf(i);if(!(r<0)){if(!this.mandatory)return this.updateInternalValue(i);this.multiple&&Array.isArray(this.internalValue)?this.internalValue=this.internalValue.filter(t=>t!==i):this.internalValue=void 0,this.selectedItems.length||this.updateMandatory(!0)}},updateItem(t,e){const i=this.getValue(t,e);t.isActive=this.toggleMethod(i)},updateItemsState(){this.$nextTick(()=>{if(this.mandatory&&!this.selectedItems.length)return this.updateMandatory();this.items.forEach(this.updateItem)})},updateInternalValue(t){this.multiple?this.updateMultiple(t):this.updateSingle(t)},updateMandatory(t){if(!this.items.length)return;const e=this.items.slice();t&&e.reverse();const i=e.find(t=>!t.disabled);if(!i)return;const r=this.items.indexOf(i);this.updateInternalValue(this.getValue(i,r))},updateMultiple(t){const e=Array.isArray(this.internalValue)?this.internalValue:[],i=e.slice(),r=i.findIndex(e=>this.valueComparator(e,t));this.mandatory&&r>-1&&i.length-1<1||null!=this.max&&r<0&&i.length+1>this.max||(r>-1?i.splice(r,1):i.push(t),this.internalValue=i)},updateSingle(t){const e=this.valueComparator(this.internalValue,t);this.mandatory&&e||(this.internalValue=e?void 0:t)}},render(t){return t(this.tag,this.genData(),this.$slots.default)}});l.extend({name:"v-item-group",provide(){return{itemGroup:this}}})},"615b":function(t,e,i){},"61d2":function(t,e,i){},6821:function(t,e,i){(function(){var e=i("00d8"),r=i("9a63").utf8,n=i("044b"),o=i("9a63").bin,s=function(t,i){t.constructor==String?t=i&&"binary"===i.encoding?o.stringToBytes(t):r.stringToBytes(t):n(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var a=e.bytesToWords(t),l=8*t.length,h=1732584193,c=-271733879,u=-1732584194,d=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[14+(l+64>>>9<<4)]=l;var f=s._ff,_=s._gg,g=s._hh,m=s._ii;for(p=0;p<a.length;p+=16){var b=h,v=c,y=u,T=d;h=f(h,c,u,d,a[p+0],7,-680876936),d=f(d,h,c,u,a[p+1],12,-389564586),u=f(u,d,h,c,a[p+2],17,606105819),c=f(c,u,d,h,a[p+3],22,-1044525330),h=f(h,c,u,d,a[p+4],7,-176418897),d=f(d,h,c,u,a[p+5],12,1200080426),u=f(u,d,h,c,a[p+6],17,-1473231341),c=f(c,u,d,h,a[p+7],22,-45705983),h=f(h,c,u,d,a[p+8],7,1770035416),d=f(d,h,c,u,a[p+9],12,-1958414417),u=f(u,d,h,c,a[p+10],17,-42063),c=f(c,u,d,h,a[p+11],22,-1990404162),h=f(h,c,u,d,a[p+12],7,1804603682),d=f(d,h,c,u,a[p+13],12,-40341101),u=f(u,d,h,c,a[p+14],17,-1502002290),c=f(c,u,d,h,a[p+15],22,1236535329),h=_(h,c,u,d,a[p+1],5,-165796510),d=_(d,h,c,u,a[p+6],9,-1069501632),u=_(u,d,h,c,a[p+11],14,643717713),c=_(c,u,d,h,a[p+0],20,-373897302),h=_(h,c,u,d,a[p+5],5,-701558691),d=_(d,h,c,u,a[p+10],9,38016083),u=_(u,d,h,c,a[p+15],14,-660478335),c=_(c,u,d,h,a[p+4],20,-405537848),h=_(h,c,u,d,a[p+9],5,568446438),d=_(d,h,c,u,a[p+14],9,-1019803690),u=_(u,d,h,c,a[p+3],14,-187363961),c=_(c,u,d,h,a[p+8],20,1163531501),h=_(h,c,u,d,a[p+13],5,-1444681467),d=_(d,h,c,u,a[p+2],9,-51403784),u=_(u,d,h,c,a[p+7],14,1735328473),c=_(c,u,d,h,a[p+12],20,-1926607734),h=g(h,c,u,d,a[p+5],4,-378558),d=g(d,h,c,u,a[p+8],11,-2022574463),u=g(u,d,h,c,a[p+11],16,1839030562),c=g(c,u,d,h,a[p+14],23,-35309556),h=g(h,c,u,d,a[p+1],4,-1530992060),d=g(d,h,c,u,a[p+4],11,1272893353),u=g(u,d,h,c,a[p+7],16,-155497632),c=g(c,u,d,h,a[p+10],23,-1094730640),h=g(h,c,u,d,a[p+13],4,681279174),d=g(d,h,c,u,a[p+0],11,-358537222),u=g(u,d,h,c,a[p+3],16,-722521979),c=g(c,u,d,h,a[p+6],23,76029189),h=g(h,c,u,d,a[p+9],4,-640364487),d=g(d,h,c,u,a[p+12],11,-421815835),u=g(u,d,h,c,a[p+15],16,530742520),c=g(c,u,d,h,a[p+2],23,-995338651),h=m(h,c,u,d,a[p+0],6,-198630844),d=m(d,h,c,u,a[p+7],10,1126891415),u=m(u,d,h,c,a[p+14],15,-1416354905),c=m(c,u,d,h,a[p+5],21,-57434055),h=m(h,c,u,d,a[p+12],6,1700485571),d=m(d,h,c,u,a[p+3],10,-1894986606),u=m(u,d,h,c,a[p+10],15,-1051523),c=m(c,u,d,h,a[p+1],21,-2054922799),h=m(h,c,u,d,a[p+8],6,1873313359),d=m(d,h,c,u,a[p+15],10,-30611744),u=m(u,d,h,c,a[p+6],15,-1560198380),c=m(c,u,d,h,a[p+13],21,1309151649),h=m(h,c,u,d,a[p+4],6,-145523070),d=m(d,h,c,u,a[p+11],10,-1120210379),u=m(u,d,h,c,a[p+2],15,718787259),c=m(c,u,d,h,a[p+9],21,-343485551),h=h+b>>>0,c=c+v>>>0,u=u+y>>>0,d=d+T>>>0}return e.endian([h,c,u,d])};s._ff=function(t,e,i,r,n,o,s){var a=t+(e&i|~e&r)+(n>>>0)+s;return(a<<o|a>>>32-o)+e},s._gg=function(t,e,i,r,n,o,s){var a=t+(e&r|i&~r)+(n>>>0)+s;return(a<<o|a>>>32-o)+e},s._hh=function(t,e,i,r,n,o,s){var a=t+(e^i^r)+(n>>>0)+s;return(a<<o|a>>>32-o)+e},s._ii=function(t,e,i,r,n,o,s){var a=t+(i^(e|~r))+(n>>>0)+s;return(a<<o|a>>>32-o)+e},s._blocksize=16,s._digestsize=16,t.exports=function(t,i){if(void 0===t||null===t)throw new Error("Illegal argument "+t);var r=e.wordsToBytes(s(t,i));return i&&i.asBytes?r:i&&i.asString?o.bytesToString(r):e.bytesToHex(r)}})()},"68dd":function(t,e,i){},"6cd8":function(t,e,i){"use strict";i("2bf3")},"6ece":function(t,e,i){},"6fcd":function(t,e,i){(function(e){!function(e,r){t.exports=r(i("633b"))}("undefined"!=typeof self&&self,(function(t){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(e,i){e.exports=t},function(t,e,i){"use strict";i.r(e),i.d(e,"Button",(function(){return T})),i.d(e,"Checkbox",(function(){return E})),i.d(e,"ColorPicker",(function(){return w})),i.d(e,"Container",(function(){return g})),i.d(e,"Control",(function(){return _})),i.d(e,"Ellipse",(function(){return M})),i.d(e,"Grid",(function(){return x})),i.d(e,"Image",(function(){return y})),i.d(e,"InputText",(function(){return C})),i.d(e,"InputPassword",(function(){return S})),i.d(e,"Line",(function(){return I})),i.d(e,"MultiLine",(function(){return R})),i.d(e,"RadioButton",(function(){return L})),i.d(e,"StackPanel",(function(){return O})),i.d(e,"SelectorGroup",(function(){return D})),i.d(e,"CheckboxGroup",(function(){return B})),i.d(e,"RadioGroup",(function(){return F})),i.d(e,"SliderGroup",(function(){return V})),i.d(e,"SelectionPanel",(function(){return j})),i.d(e,"ScrollViewer",(function(){return W})),i.d(e,"TextWrapping",(function(){return m})),i.d(e,"TextBlock",(function(){return v})),i.d(e,"TextWrapper",(function(){return A})),i.d(e,"KeyPropertySet",(function(){return z})),i.d(e,"VirtualKeyboard",(function(){return X})),i.d(e,"Rectangle",(function(){return b})),i.d(e,"DisplayGrid",(function(){return $})),i.d(e,"BaseSlider",(function(){return N})),i.d(e,"Slider",(function(){return k})),i.d(e,"ImageBasedSlider",(function(){return Y})),i.d(e,"ScrollBar",(function(){return U})),i.d(e,"ImageScrollBar",(function(){return G})),i.d(e,"name",(function(){return K})),i.d(e,"AdvancedDynamicTexture",(function(){return Z})),i.d(e,"AdvancedDynamicTextureInstrumentation",(function(){return J})),i.d(e,"Vector2WithInfo",(function(){return p})),i.d(e,"Matrix2D",(function(){return f})),i.d(e,"Measure",(function(){return d})),i.d(e,"MultiLinePoint",(function(){return P})),i.d(e,"Style",(function(){return q})),i.d(e,"ValueAndUnit",(function(){return a})),i.d(e,"XmlLoader",(function(){return Q})),i.d(e,"AbstractButton3D",(function(){return it})),i.d(e,"Button3D",(function(){return rt})),i.d(e,"Container3D",(function(){return nt})),i.d(e,"Control3D",(function(){return et})),i.d(e,"CylinderPanel",(function(){return st})),i.d(e,"HolographicButton",(function(){return ut})),i.d(e,"MeshButton3D",(function(){return dt})),i.d(e,"PlanePanel",(function(){return pt})),i.d(e,"ScatterPanel",(function(){return ft})),i.d(e,"SpherePanel",(function(){return _t})),i.d(e,"StackPanel3D",(function(){return gt})),i.d(e,"VolumeBasedPanel",(function(){return ot})),i.d(e,"FluentMaterialDefines",(function(){return ht})),i.d(e,"FluentMaterial",(function(){return ct})),i.d(e,"GUI3DManager",(function(){return mt})),i.d(e,"Vector3WithInfo",(function(){return tt}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function o(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}Object.create,Object.create;var s=i(0),a=function(){function t(e,i,r){void 0===i&&(i=t.UNITMODE_PIXEL),void 0===r&&(r=!0),this.unit=i,this.negativeValueAllowed=r,this._value=1,this.ignoreAdaptiveScaling=!1,this._value=e,this._originalUnit=i}return Object.defineProperty(t.prototype,"isPercentage",{get:function(){return this.unit===t.UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPixel",{get:function(){return this.unit===t.UNITMODE_PIXEL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"internalValue",{get:function(){return this._value},enumerable:!1,configurable:!0}),t.prototype.getValueInPixel=function(t,e){return this.isPixel?this.getValue(t):this.getValue(t)*e},t.prototype.updateInPlace=function(e,i){return void 0===i&&(i=t.UNITMODE_PIXEL),this._value=e,this.unit=i,this},t.prototype.getValue=function(e){if(e&&!this.ignoreAdaptiveScaling&&this.unit!==t.UNITMODE_PERCENTAGE){var i=0,r=0;if(e.idealWidth&&(i=this._value*e.getSize().width/e.idealWidth),e.idealHeight&&(r=this._value*e.getSize().height/e.idealHeight),e.useSmallestIdeal&&e.idealWidth&&e.idealHeight)return window.innerWidth<window.innerHeight?i:r;if(e.idealWidth)return i;if(e.idealHeight)return r}return this._value},t.prototype.toString=function(e,i){switch(this.unit){case t.UNITMODE_PERCENTAGE:var r=100*this.getValue(e);return(i?r.toFixed(i):r)+"%";case t.UNITMODE_PIXEL:var n=this.getValue(e);return(i?n.toFixed(i):n)+"px"}return this.unit.toString()},t.prototype.fromString=function(e){var i=t._Regex.exec(e.toString());if(!i||0===i.length)return!1;var r=parseFloat(i[1]),n=this._originalUnit;if(this.negativeValueAllowed||r<0&&(r=0),4===i.length)switch(i[3]){case"px":n=t.UNITMODE_PIXEL;break;case"%":n=t.UNITMODE_PERCENTAGE,r/=100}return(r!==this._value||n!==this.unit)&&(this._value=r,this.unit=n,!0)},Object.defineProperty(t,"UNITMODE_PERCENTAGE",{get:function(){return t._UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNITMODE_PIXEL",{get:function(){return t._UNITMODE_PIXEL},enumerable:!1,configurable:!0}),t._Regex=/(^-?\d*(\.\d+)?)(%|px)?/,t._UNITMODE_PERCENTAGE=0,t._UNITMODE_PIXEL=1,t}(),l=[new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0)],h=[new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0)],c=new s.Vector2(0,0),u=new s.Vector2(0,0),d=function(){function t(t,e,i,r){this.left=t,this.top=e,this.width=i,this.height=r}return t.prototype.copyFrom=function(t){this.left=t.left,this.top=t.top,this.width=t.width,this.height=t.height},t.prototype.copyFromFloats=function(t,e,i,r){this.left=t,this.top=e,this.width=i,this.height=r},t.CombineToRef=function(t,e,i){var r=Math.min(t.left,e.left),n=Math.min(t.top,e.top),o=Math.max(t.left+t.width,e.left+e.width),s=Math.max(t.top+t.height,e.top+e.height);i.left=r,i.top=n,i.width=o-r,i.height=s-n},t.prototype.addAndTransformToRef=function(t,e,i,r,n,o){var s=this.left+e,a=this.top+i,d=this.width+r,p=this.height+n;l[0].copyFromFloats(s,a),l[1].copyFromFloats(s+d,a),l[2].copyFromFloats(s+d,a+p),l[3].copyFromFloats(s,a+p),c.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE),u.copyFromFloats(0,0);for(var f=0;f<4;f++)t.transformCoordinates(l[f].x,l[f].y,h[f]),c.x=Math.floor(Math.min(c.x,h[f].x)),c.y=Math.floor(Math.min(c.y,h[f].y)),u.x=Math.ceil(Math.max(u.x,h[f].x)),u.y=Math.ceil(Math.max(u.y,h[f].y));o.left=c.x,o.top=c.y,o.width=u.x-c.x,o.height=u.y-c.y},t.prototype.transformToRef=function(t,e){this.addAndTransformToRef(t,0,0,0,0,e)},t.prototype.isEqualsTo=function(t){return this.left===t.left&&this.top===t.top&&this.width===t.width&&this.height===t.height},t.Empty=function(){return new t(0,0,0,0)},t}(),p=function(t){function e(e,i){void 0===i&&(i=0);var r=t.call(this,e.x,e.y)||this;return r.buttonIndex=i,r}return n(e,t),e}(s.Vector2),f=function(){function t(t,e,i,r,n,o){this.m=new Float32Array(6),this.fromValues(t,e,i,r,n,o)}return t.prototype.fromValues=function(t,e,i,r,n,o){return this.m[0]=t,this.m[1]=e,this.m[2]=i,this.m[3]=r,this.m[4]=n,this.m[5]=o,this},t.prototype.determinant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]},t.prototype.invertToRef=function(t){var e=this.m[0],i=this.m[1],r=this.m[2],n=this.m[3],o=this.m[4],a=this.m[5],l=this.determinant();if(l<s.Epsilon*s.Epsilon)return t.m[0]=0,t.m[1]=0,t.m[2]=0,t.m[3]=0,t.m[4]=0,t.m[5]=0,this;var h=1/l,c=r*a-n*o,u=i*o-e*a;return t.m[0]=n*h,t.m[1]=-i*h,t.m[2]=-r*h,t.m[3]=e*h,t.m[4]=c*h,t.m[5]=u*h,this},t.prototype.multiplyToRef=function(t,e){var i=this.m[0],r=this.m[1],n=this.m[2],o=this.m[3],s=this.m[4],a=this.m[5],l=t.m[0],h=t.m[1],c=t.m[2],u=t.m[3],d=t.m[4],p=t.m[5];return e.m[0]=i*l+r*c,e.m[1]=i*h+r*u,e.m[2]=n*l+o*c,e.m[3]=n*h+o*u,e.m[4]=s*l+a*c+d,e.m[5]=s*h+a*u+p,this},t.prototype.transformCoordinates=function(t,e,i){return i.x=t*this.m[0]+e*this.m[2]+this.m[4],i.y=t*this.m[1]+e*this.m[3]+this.m[5],this},t.Identity=function(){return new t(1,0,0,1,0,0)},t.TranslationToRef=function(t,e,i){i.fromValues(1,0,0,1,t,e)},t.ScalingToRef=function(t,e,i){i.fromValues(t,0,0,e,0,0)},t.RotationToRef=function(t,e){var i=Math.sin(t),r=Math.cos(t);e.fromValues(r,i,-i,r,0,0)},t.ComposeToRef=function(e,i,r,n,o,s,a){t.TranslationToRef(e,i,t._TempPreTranslationMatrix),t.ScalingToRef(n,o,t._TempScalingMatrix),t.RotationToRef(r,t._TempRotationMatrix),t.TranslationToRef(-e,-i,t._TempPostTranslationMatrix),t._TempPreTranslationMatrix.multiplyToRef(t._TempScalingMatrix,t._TempCompose0),t._TempCompose0.multiplyToRef(t._TempRotationMatrix,t._TempCompose1),s?(t._TempCompose1.multiplyToRef(t._TempPostTranslationMatrix,t._TempCompose2),t._TempCompose2.multiplyToRef(s,a)):t._TempCompose1.multiplyToRef(t._TempPostTranslationMatrix,a)},t._TempPreTranslationMatrix=t.Identity(),t._TempPostTranslationMatrix=t.Identity(),t._TempRotationMatrix=t.Identity(),t._TempScalingMatrix=t.Identity(),t._TempCompose0=t.Identity(),t._TempCompose1=t.Identity(),t._TempCompose2=t.Identity(),t}(),_=function(){function t(e){this.name=e,this._alpha=1,this._alphaSet=!1,this._zIndex=0,this._currentMeasure=d.Empty(),this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new a(18,a.UNITMODE_PIXEL,!1),this._width=new a(1,a.UNITMODE_PERCENTAGE,!1),this._height=new a(1,a.UNITMODE_PERCENTAGE,!1),this._color="",this._style=null,this._horizontalAlignment=t.HORIZONTAL_ALIGNMENT_CENTER,this._verticalAlignment=t.VERTICAL_ALIGNMENT_CENTER,this._isDirty=!0,this._wasDirty=!1,this._tempParentMeasure=d.Empty(),this._prevCurrentMeasureTransformedIntoGlobalSpace=d.Empty(),this._cachedParentMeasure=d.Empty(),this._paddingLeft=new a(0),this._paddingRight=new a(0),this._paddingTop=new a(0),this._paddingBottom=new a(0),this._left=new a(0),this._top=new a(0),this._scaleX=1,this._scaleY=1,this._rotation=0,this._transformCenterX=.5,this._transformCenterY=.5,this._transformMatrix=f.Identity(),this._invertTransformMatrix=f.Identity(),this._transformedPosition=s.Vector2.Zero(),this._isMatrixDirty=!0,this._isVisible=!0,this._isHighlighted=!1,this._fontSet=!1,this._dummyVector2=s.Vector2.Zero(),this._downCount=0,this._enterCount=-1,this._doNotRender=!1,this._downPointerIds={},this._isEnabled=!0,this._disabledColor="#9a9a9a",this._disabledColorItem="#6a6a6a",this._rebuildLayout=!1,this._customData={},this._isClipped=!1,this._automaticSize=!1,this.metadata=null,this.isHitTestVisible=!0,this.isPointerBlocker=!1,this.isFocusInvisible=!1,this.clipChildren=!0,this.clipContent=!0,this.useBitmapCache=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowBlur=0,this._shadowColor="black",this.hoverCursor="",this._linkOffsetX=new a(0),this._linkOffsetY=new a(0),this.onWheelObservable=new s.Observable,this.onPointerMoveObservable=new s.Observable,this.onPointerOutObservable=new s.Observable,this.onPointerDownObservable=new s.Observable,this.onPointerUpObservable=new s.Observable,this.onPointerClickObservable=new s.Observable,this.onPointerEnterObservable=new s.Observable,this.onDirtyObservable=new s.Observable,this.onBeforeDrawObservable=new s.Observable,this.onAfterDrawObservable=new s.Observable,this.onDisposeObservable=new s.Observable,this.fixedRatio=0,this._fixedRatioMasterIsWidth=!0,this._tmpMeasureA=new d(0,0,0,0)}return Object.defineProperty(t.prototype,"shadowOffsetX",{get:function(){return this._shadowOffsetX},set:function(t){this._shadowOffsetX!==t&&(this._shadowOffsetX=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetY",{get:function(){return this._shadowOffsetY},set:function(t){this._shadowOffsetY!==t&&(this._shadowOffsetY=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowBlur",{get:function(){return this._shadowBlur},set:function(t){this._shadowBlur!==t&&(this._shadowBlur=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(t){this._shadowColor!==t&&(this._shadowColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return this._getTypeName()},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontOffset",{get:function(){return this._fontOffset},set:function(t){this._fontOffset=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alphaSet=!0,this._alpha=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(t){this._isHighlighted!==t&&(this._isHighlighted=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX!==t&&(this._scaleX=t,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY!==t&&(this._scaleY=t,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformCenterY",{get:function(){return this._transformCenterY},set:function(t){this._transformCenterY!==t&&(this._transformCenterY=t,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformCenterX",{get:function(){return this._transformCenterX},set:function(t){this._transformCenterX!==t&&(this._transformCenterX=t,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this._horizontalAlignment},set:function(t){this._horizontalAlignment!==t&&(this._horizontalAlignment=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{get:function(){return this._verticalAlignment},set:function(t){this._verticalAlignment!==t&&(this._verticalAlignment=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(t){this._fixedRatioMasterIsWidth=!0,this._width.toString(this._host)!==t&&this._width.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"widthInPixels",{get:function(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(t){isNaN(t)||(this._fixedRatioMasterIsWidth=!0,this.width=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(t){this._fixedRatioMasterIsWidth=!1,this._height.toString(this._host)!==t&&this._height.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"heightInPixels",{get:function(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this._fixedRatioMasterIsWidth=!1,this.height=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontSet?this._fontFamily:""},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){var e=this;this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this._style=t,this._style&&(this._styleObserver=this._style.onChangedObservable.add((function(){e._markAsDirty(),e._resetFontCache()}))),this._markAsDirty(),this._resetFontCache()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFontSizeInPercentage",{get:function(){return this._fontSize.isPercentage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSizeInPixels",{get:function(){var t=this._style?this._style._fontSize:this._fontSize;return t.isPixel?t.getValue(this._host):t.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this.fontSize=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(t){this._fontSize.toString(this._host)!==t&&this._fontSize.fromString(t)&&(this._markAsDirty(),this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this.zIndex!==t&&(this._zIndex=t,this.parent&&this.parent._reOrderControl(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notRenderable",{get:function(){return this._doNotRender},set:function(t){this._doNotRender!==t&&(this._doNotRender=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){this._isVisible!==t&&(this._isVisible=t,this._markAsDirty(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkedMesh",{get:function(){return this._linkedMesh},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingLeft",{get:function(){return this._paddingLeft.toString(this._host)},set:function(t){this._paddingLeft.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingLeftInPixels",{get:function(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(t){isNaN(t)||(this.paddingLeft=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingRight",{get:function(){return this._paddingRight.toString(this._host)},set:function(t){this._paddingRight.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingRightInPixels",{get:function(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(t){isNaN(t)||(this.paddingRight=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingTop",{get:function(){return this._paddingTop.toString(this._host)},set:function(t){this._paddingTop.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingTopInPixels",{get:function(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this.paddingTop=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingBottom",{get:function(){return this._paddingBottom.toString(this._host)},set:function(t){this._paddingBottom.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paddingBottomInPixels",{get:function(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this.paddingBottom=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._left.toString(this._host)},set:function(t){this._left.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftInPixels",{get:function(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(t){isNaN(t)||(this.left=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this._top.toString(this._host)},set:function(t){this._top.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topInPixels",{get:function(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this.top=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkOffsetX",{get:function(){return this._linkOffsetX.toString(this._host)},set:function(t){this._linkOffsetX.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkOffsetXInPixels",{get:function(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(t){isNaN(t)||(this.linkOffsetX=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkOffsetY",{get:function(){return this._linkOffsetY.toString(this._host)},set:function(t){this._linkOffsetY.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkOffsetYInPixels",{get:function(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(t){isNaN(t)||(this.linkOffsetY=t+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerX",{get:function(){return this._currentMeasure.left+this._currentMeasure.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return this._currentMeasure.top+this._currentMeasure.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(t){this._isEnabled!==t&&(this._isEnabled=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disabledColor",{get:function(){return this._disabledColor},set:function(t){this._disabledColor!==t&&(this._disabledColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disabledColorItem",{get:function(){return this._disabledColorItem},set:function(t){this._disabledColorItem!==t&&(this._disabledColorItem=t,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Control"},t.prototype.getAscendantOfClass=function(t){return this.parent?this.parent.getClassName()===t?this.parent:this.parent.getAscendantOfClass(t):null},t.prototype._resetFontCache=function(){this._fontSet=!0,this._markAsDirty()},t.prototype.isAscendant=function(t){return!!this.parent&&(this.parent===t||this.parent.isAscendant(t))},t.prototype.getLocalCoordinates=function(t){var e=s.Vector2.Zero();return this.getLocalCoordinatesToRef(t,e),e},t.prototype.getLocalCoordinatesToRef=function(t,e){return e.x=t.x-this._currentMeasure.left,e.y=t.y-this._currentMeasure.top,this},t.prototype.getParentLocalCoordinates=function(t){var e=s.Vector2.Zero();return e.x=t.x-this._cachedParentMeasure.left,e.y=t.y-this._cachedParentMeasure.top,e},t.prototype.moveToVector3=function(e,i){if(this._host&&this.parent===this._host._rootContainer){this.horizontalAlignment=t.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=t.VERTICAL_ALIGNMENT_TOP;var r=this._host._getGlobalViewport(i),n=s.Vector3.Project(e,s.Matrix.Identity(),i.getTransformMatrix(),r);this._moveToProjectedPosition(n),n.z<0||n.z>1?this.notRenderable=!0:this.notRenderable=!1}else s.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},t.prototype.getDescendantsToRef=function(t,e,i){void 0===e&&(e=!1)},t.prototype.getDescendants=function(t,e){var i=new Array;return this.getDescendantsToRef(i,t,e),i},t.prototype.linkWithMesh=function(e){if(!this._host||this.parent&&this.parent!==this._host._rootContainer)e&&s.Tools.Error("Cannot link a control to a mesh if the control is not at root level");else{var i=this._host._linkedControls.indexOf(this);if(-1!==i)return this._linkedMesh=e,void(e||this._host._linkedControls.splice(i,1));e&&(this.horizontalAlignment=t.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=t.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=e,this._host._linkedControls.push(this))}},t.prototype._moveToProjectedPosition=function(t){var e=this._left.getValue(this._host),i=this._top.getValue(this._host),r=t.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,n=t.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling&&(Math.abs(r-e)<.5&&(r=e),Math.abs(n-i)<.5&&(n=i)),this.left=r+"px",this.top=n+"px",this._left.ignoreAdaptiveScaling=!0,this._top.ignoreAdaptiveScaling=!0,this._markAsDirty()},t.prototype._offsetLeft=function(t){this._isDirty=!0,this._currentMeasure.left+=t},t.prototype._offsetTop=function(t){this._isDirty=!0,this._currentMeasure.top+=t},t.prototype._markMatrixAsDirty=function(){this._isMatrixDirty=!0,this._flagDescendantsAsMatrixDirty()},t.prototype._flagDescendantsAsMatrixDirty=function(){},t.prototype._intersectsRect=function(t){return this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),!(this._tmpMeasureA.left>=t.left+t.width)&&!(this._tmpMeasureA.top>=t.top+t.height)&&!(this._tmpMeasureA.left+this._tmpMeasureA.width<=t.left)&&!(this._tmpMeasureA.top+this._tmpMeasureA.height<=t.top)},t.prototype.invalidateRect=function(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization)if(this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),d.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA),this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var t=this.shadowOffsetX,e=this.shadowOffsetY,i=this.shadowBlur,r=Math.min(Math.min(t,0)-2*i,0),n=Math.max(Math.max(t,0)+2*i,0),o=Math.min(Math.min(e,0)-2*i,0),s=Math.max(Math.max(e,0)+2*i,0);this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+r),Math.floor(this._tmpMeasureA.top+o),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+n),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+s))}else this.host.invalidateRect(Math.floor(this._tmpMeasureA.left),Math.floor(this._tmpMeasureA.top),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height))},t.prototype._markAsDirty=function(t){void 0===t&&(t=!1),(this._isVisible||t)&&(this._isDirty=!0,this._host&&this._host.markAsDirty())},t.prototype._markAllAsDirty=function(){this._markAsDirty(),this._font&&this._prepareFont()},t.prototype._link=function(t){this._host=t,this._host&&(this.uniqueId=this._host.getScene().getUniqueId())},t.prototype._transform=function(t){if(this._isMatrixDirty||1!==this._scaleX||1!==this._scaleY||0!==this._rotation){var e=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,i=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;t&&(t.translate(e,i),t.rotate(this._rotation),t.scale(this._scaleX,this._scaleY),t.translate(-e,-i)),(this._isMatrixDirty||this._cachedOffsetX!==e||this._cachedOffsetY!==i)&&(this._cachedOffsetX=e,this._cachedOffsetY=i,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),f.ComposeToRef(-e,-i,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix))}},t.prototype._renderHighlight=function(t){this.isHighlighted&&(t.save(),t.strokeStyle="#4affff",t.lineWidth=2,this._renderHighlightSpecific(t),t.restore())},t.prototype._renderHighlightSpecific=function(t){t.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)},t.prototype._applyStates=function(e){this._isFontSizeInPercentage&&(this._fontSet=!0),this._fontSet&&(this._prepareFont(),this._fontSet=!1),this._font&&(e.font=this._font),this._color&&(e.fillStyle=this._color),t.AllowAlphaInheritance?e.globalAlpha*=this._alpha:this._alphaSet&&(e.globalAlpha=this.parent?this.parent.alpha*this._alpha:this._alpha)},t.prototype._layout=function(t,e){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(t)){this.host._numLayoutCalls++,this._currentMeasure.addAndTransformToRef(this._transformMatrix,0|-this.paddingLeftInPixels,0|-this.paddingTopInPixels,0|this.paddingRightInPixels,0|this.paddingBottomInPixels,this._prevCurrentMeasureTransformedIntoGlobalSpace),e.save(),this._applyStates(e);var i=0;do{this._rebuildLayout=!1,this._processMeasures(t,e),i++}while(this._rebuildLayout&&i<3);i>=3&&s.Logger.Error("Layout cycle detected in GUI (Control name="+this.name+", uniqueId="+this.uniqueId+")"),e.restore(),this.invalidateRect(),this._evaluateClippingState(t)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0},t.prototype._processMeasures=function(t,e){this._currentMeasure.copyFrom(t),this._preMeasure(t,e),this._measure(),this._computeAlignment(t,e),this._currentMeasure.left=0|this._currentMeasure.left,this._currentMeasure.top=0|this._currentMeasure.top,this._currentMeasure.width=0|this._currentMeasure.width,this._currentMeasure.height=0|this._currentMeasure.height,this._additionalProcessing(t,e),this._cachedParentMeasure.copyFrom(t),this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)},t.prototype._evaluateClippingState=function(t){if(this.parent&&this.parent.clipChildren){if(this._currentMeasure.left>t.left+t.width)return void(this._isClipped=!0);if(this._currentMeasure.left+this._currentMeasure.width<t.left)return void(this._isClipped=!0);if(this._currentMeasure.top>t.top+t.height)return void(this._isClipped=!0);if(this._currentMeasure.top+this._currentMeasure.height<t.top)return void(this._isClipped=!0)}this._isClipped=!1},t.prototype._measure=function(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host),this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host),0!==this.fixedRatio&&(this._fixedRatioMasterIsWidth?this._currentMeasure.height=this._currentMeasure.width*this.fixedRatio:this._currentMeasure.width=this._currentMeasure.height*this.fixedRatio)},t.prototype._computeAlignment=function(e,i){var r=this._currentMeasure.width,n=this._currentMeasure.height,o=e.width,s=e.height,a=0,l=0;switch(this.horizontalAlignment){case t.HORIZONTAL_ALIGNMENT_LEFT:a=0;break;case t.HORIZONTAL_ALIGNMENT_RIGHT:a=o-r;break;case t.HORIZONTAL_ALIGNMENT_CENTER:a=(o-r)/2}switch(this.verticalAlignment){case t.VERTICAL_ALIGNMENT_TOP:l=0;break;case t.VERTICAL_ALIGNMENT_BOTTOM:l=s-n;break;case t.VERTICAL_ALIGNMENT_CENTER:l=(s-n)/2}this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=o*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=o*this._paddingLeft.getValue(this._host)),this._paddingRight.isPixel?this._currentMeasure.width-=this._paddingRight.getValue(this._host):this._currentMeasure.width-=o*this._paddingRight.getValue(this._host),this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=s*this._paddingTop.getValue(this._host),this._currentMeasure.height-=s*this._paddingTop.getValue(this._host)),this._paddingBottom.isPixel?this._currentMeasure.height-=this._paddingBottom.getValue(this._host):this._currentMeasure.height-=s*this._paddingBottom.getValue(this._host),this._left.isPixel?this._currentMeasure.left+=this._left.getValue(this._host):this._currentMeasure.left+=o*this._left.getValue(this._host),this._top.isPixel?this._currentMeasure.top+=this._top.getValue(this._host):this._currentMeasure.top+=s*this._top.getValue(this._host),this._currentMeasure.left+=a,this._currentMeasure.top+=l},t.prototype._preMeasure=function(t,e){},t.prototype._additionalProcessing=function(t,e){},t.prototype._clipForChildren=function(t){},t.prototype._clip=function(e,i){if(e.beginPath(),t._ClipMeasure.copyFrom(this._currentMeasure),i){i.transformToRef(this._invertTransformMatrix,this._tmpMeasureA);var r=new d(0,0,0,0);r.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),r.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),r.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-r.left,r.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-r.top,t._ClipMeasure.copyFrom(r)}if(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var n=this.shadowOffsetX,o=this.shadowOffsetY,s=this.shadowBlur,a=Math.min(Math.min(n,0)-2*s,0),l=Math.max(Math.max(n,0)+2*s,0),h=Math.min(Math.min(o,0)-2*s,0),c=Math.max(Math.max(o,0)+2*s,0);e.rect(t._ClipMeasure.left+a,t._ClipMeasure.top+h,t._ClipMeasure.width+l-a,t._ClipMeasure.height+c-h)}else e.rect(t._ClipMeasure.left,t._ClipMeasure.top,t._ClipMeasure.width,t._ClipMeasure.height);e.clip()},t.prototype._render=function(t,e){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(this.host._numRenderCalls++,t.save(),this._applyStates(t),this._transform(t),this.clipContent&&this._clip(t,e),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?t.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(t,e),this.useBitmapCache&&this._wasDirty&&(this._cacheData=t.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(t),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),t.restore(),!0)},t.prototype._draw=function(t,e){},t.prototype.contains=function(t,e){return this._invertTransformMatrix.transformCoordinates(t,e,this._transformedPosition),t=this._transformedPosition.x,e=this._transformedPosition.y,!(t<this._currentMeasure.left)&&!(t>this._currentMeasure.left+this._currentMeasure.width)&&!(e<this._currentMeasure.top)&&!(e>this._currentMeasure.top+this._currentMeasure.height)&&(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),!0)},t.prototype._processPicking=function(t,e,i,r,n,o,s,a){return!!this._isEnabled&&!(!this.isHitTestVisible||!this.isVisible||this._doNotRender)&&!!this.contains(t,e)&&(this._processObservables(r,t,e,i,n,o,s,a),!0)},t.prototype._onPointerMove=function(t,e,i,r){this.onPointerMoveObservable.notifyObservers(e,-1,t,this,r)&&null!=this.parent&&this.parent._onPointerMove(t,e,i,r)},t.prototype._onPointerEnter=function(t,e){return!!this._isEnabled&&!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,t,this,e)&&null!=this.parent&&this.parent._onPointerEnter(t,e),!0)},t.prototype._onPointerOut=function(t,e,i){if(void 0===i&&(i=!1),i||this._isEnabled&&t!==this){this._enterCount=0;var r=!0;t.isAscendant(this)||(r=this.onPointerOutObservable.notifyObservers(this,-1,t,this,e)),r&&null!=this.parent&&this.parent._onPointerOut(t,e,i)}},t.prototype._onPointerDown=function(t,e,i,r,n){return this._onPointerEnter(this,n),0===this._downCount&&(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new p(e,r),-1,t,this,n)&&null!=this.parent&&this.parent._onPointerDown(t,e,i,r,n),!0)},t.prototype._onPointerUp=function(t,e,i,r,n,o){if(this._isEnabled){this._downCount=0,delete this._downPointerIds[i];var s=n;n&&(this._enterCount>0||-1===this._enterCount)&&(s=this.onPointerClickObservable.notifyObservers(new p(e,r),-1,t,this,o)),this.onPointerUpObservable.notifyObservers(new p(e,r),-1,t,this,o)&&null!=this.parent&&this.parent._onPointerUp(t,e,i,r,s,o)}},t.prototype._forcePointerUp=function(t){if(void 0===t&&(t=null),null!==t)this._onPointerUp(this,s.Vector2.Zero(),t,0,!0);else for(var e in this._downPointerIds)this._onPointerUp(this,s.Vector2.Zero(),+e,0,!0)},t.prototype._onWheelScroll=function(t,e){this._isEnabled&&this.onWheelObservable.notifyObservers(new s.Vector2(t,e))&&null!=this.parent&&this.parent._onWheelScroll(t,e)},t.prototype._onCanvasBlur=function(){},t.prototype._processObservables=function(t,e,i,r,n,o,a,l){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(e,i),t===s.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,n,r);var h=this._host._lastControlOver[n];return h&&h!==this&&h._onPointerOut(this,r),h!==this&&this._onPointerEnter(this,r),this._host._lastControlOver[n]=this,!0}return t===s.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,n,o,r),this._host._registerLastControlDown(this,n),this._host._lastPickedControl=this,!0):t===s.PointerEventTypes.POINTERUP?(this._host._lastControlDown[n]&&this._host._lastControlDown[n]._onPointerUp(this,this._dummyVector2,n,o,!0,r),delete this._host._lastControlDown[n],!0):!(t!==s.PointerEventTypes.POINTERWHEEL||!this._host._lastControlOver[n])&&(this._host._lastControlOver[n]._onWheelScroll(a,l),!0)},t.prototype._prepareFont=function(){(this._font||this._fontSet)&&(this._style?this._font=this._style.fontStyle+" "+this._style.fontWeight+" "+this.fontSizeInPixels+"px "+this._style.fontFamily:this._font=this._fontStyle+" "+this._fontWeight+" "+this.fontSizeInPixels+"px "+this._fontFamily,this._fontOffset=t._GetFontOffset(this._font))},t.prototype.dispose=function(){this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this.onWheelObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host&&this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},Object.defineProperty(t,"HORIZONTAL_ALIGNMENT_LEFT",{get:function(){return t._HORIZONTAL_ALIGNMENT_LEFT},enumerable:!1,configurable:!0}),Object.defineProperty(t,"HORIZONTAL_ALIGNMENT_RIGHT",{get:function(){return t._HORIZONTAL_ALIGNMENT_RIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(t,"HORIZONTAL_ALIGNMENT_CENTER",{get:function(){return t._HORIZONTAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),Object.defineProperty(t,"VERTICAL_ALIGNMENT_TOP",{get:function(){return t._VERTICAL_ALIGNMENT_TOP},enumerable:!1,configurable:!0}),Object.defineProperty(t,"VERTICAL_ALIGNMENT_BOTTOM",{get:function(){return t._VERTICAL_ALIGNMENT_BOTTOM},enumerable:!1,configurable:!0}),Object.defineProperty(t,"VERTICAL_ALIGNMENT_CENTER",{get:function(){return t._VERTICAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),t._GetFontOffset=function(e){if(t._FontHeightSizes[e])return t._FontHeightSizes[e];var i=document.createElement("span");i.innerHTML="Hg",i.style.font=e;var r=document.createElement("div");r.style.display="inline-block",r.style.width="1px",r.style.height="0px",r.style.verticalAlign="bottom";var n=document.createElement("div");n.style.whiteSpace="nowrap",n.appendChild(i),n.appendChild(r),document.body.appendChild(n);var o=0,s=0;try{s=r.getBoundingClientRect().top-i.getBoundingClientRect().top,r.style.verticalAlign="baseline",o=r.getBoundingClientRect().top-i.getBoundingClientRect().top}finally{document.body.removeChild(n)}var a={ascent:o,height:s,descent:s-o};return t._FontHeightSizes[e]=a,a},t.drawEllipse=function(t,e,i,r,n){n.translate(t,e),n.scale(i,r),n.beginPath(),n.arc(0,0,1,0,2*Math.PI),n.closePath(),n.scale(1/i,1/r),n.translate(-t,-e)},t.AllowAlphaInheritance=!1,t._ClipMeasure=new d(0,0,0,0),t._HORIZONTAL_ALIGNMENT_LEFT=0,t._HORIZONTAL_ALIGNMENT_RIGHT=1,t._HORIZONTAL_ALIGNMENT_CENTER=2,t._VERTICAL_ALIGNMENT_TOP=0,t._VERTICAL_ALIGNMENT_BOTTOM=1,t._VERTICAL_ALIGNMENT_CENTER=2,t._FontHeightSizes={},t.AddHeader=function(){},t}();s._TypeStore.RegisteredTypes["BABYLON.GUI.Control"]=_;var g=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._children=new Array,i._measureForChildren=d.Empty(),i._background="",i._adaptWidthToChildren=!1,i._adaptHeightToChildren=!1,i.logLayoutCycleErrors=!1,i.maxLayoutCycle=3,i}return n(e,t),Object.defineProperty(e.prototype,"adaptHeightToChildren",{get:function(){return this._adaptHeightToChildren},set:function(t){this._adaptHeightToChildren!==t&&(this._adaptHeightToChildren=t,t&&(this.height="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"adaptWidthToChildren",{get:function(){return this._adaptWidthToChildren},set:function(t){this._adaptWidthToChildren!==t&&(this._adaptWidthToChildren=t,t&&(this.width="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Container"},e.prototype._flagDescendantsAsMatrixDirty=function(){for(var t=0,e=this.children;t<e.length;t++)e[t]._markMatrixAsDirty()},e.prototype.getChildByName=function(t){for(var e=0,i=this.children;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},e.prototype.getChildByType=function(t,e){for(var i=0,r=this.children;i<r.length;i++){var n=r[i];if(n.typeName===e)return n}return null},e.prototype.containsControl=function(t){return-1!==this.children.indexOf(t)},e.prototype.addControl=function(t){return t?(-1!==this._children.indexOf(t)||(t._link(this._host),t._markAllAsDirty(),this._reOrderControl(t),this._markAsDirty()),this):this},e.prototype.clearControls=function(){for(var t=0,e=this.children.slice();t<e.length;t++){var i=e[t];this.removeControl(i)}return this},e.prototype.removeControl=function(t){var e=this._children.indexOf(t);return-1!==e&&(this._children.splice(e,1),t.parent=null),t.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(t),this._markAsDirty(),this},e.prototype._reOrderControl=function(t){this.removeControl(t);for(var e=!1,i=0;i<this._children.length;i++)if(this._children[i].zIndex>t.zIndex){this._children.splice(i,0,t),e=!0;break}e||this._children.push(t),t.parent=this,this._markAsDirty()},e.prototype._offsetLeft=function(e){t.prototype._offsetLeft.call(this,e);for(var i=0,r=this._children;i<r.length;i++)r[i]._offsetLeft(e)},e.prototype._offsetTop=function(e){t.prototype._offsetTop.call(this,e);for(var i=0,r=this._children;i<r.length;i++)r[i]._offsetTop(e)},e.prototype._markAllAsDirty=function(){t.prototype._markAllAsDirty.call(this);for(var e=0;e<this._children.length;e++)this._children[e]._markAllAsDirty()},e.prototype._localDraw=function(t){this._background&&(t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fillStyle=this._background,t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),t.restore())},e.prototype._link=function(e){t.prototype._link.call(this,e);for(var i=0,r=this._children;i<r.length;i++)r[i]._link(e)},e.prototype._beforeLayout=function(){},e.prototype._processMeasures=function(e,i){!this._isDirty&&this._cachedParentMeasure.isEqualsTo(e)||(t.prototype._processMeasures.call(this,e,i),this._evaluateClippingState(e))},e.prototype._layout=function(t,e){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this.host._numLayoutCalls++,this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);var i=0;e.save(),this._applyStates(e),this._beforeLayout();do{var r=-1,n=-1;if(this._rebuildLayout=!1,this._processMeasures(t,e),!this._isClipped){for(var o=0,a=this._children;o<a.length;o++){var l=a[o];l._tempParentMeasure.copyFrom(this._measureForChildren),l._layout(this._measureForChildren,e)&&(this.adaptWidthToChildren&&l._width.isPixel&&(r=Math.max(r,l._currentMeasure.width+l.paddingLeftInPixels+l.paddingRightInPixels)),this.adaptHeightToChildren&&l._height.isPixel&&(n=Math.max(n,l._currentMeasure.height+l.paddingTopInPixels+l.paddingBottomInPixels)))}this.adaptWidthToChildren&&r>=0&&(r+=this.paddingLeftInPixels+this.paddingRightInPixels,this.width!==r+"px"&&(this.width=r+"px",this._rebuildLayout=!0)),this.adaptHeightToChildren&&n>=0&&(n+=this.paddingTopInPixels+this.paddingBottomInPixels,this.height!==n+"px"&&(this.height=n+"px",this._rebuildLayout=!0)),this._postMeasure()}i++}while(this._rebuildLayout&&i<this.maxLayoutCycle);return i>=3&&this.logLayoutCycleErrors&&s.Logger.Error("Layout cycle detected in GUI (Container name="+this.name+", uniqueId="+this.uniqueId+")"),e.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0},e.prototype._postMeasure=function(){},e.prototype._draw=function(t,e){this._localDraw(t),this.clipChildren&&this._clipForChildren(t);for(var i=0,r=this._children;i<r.length;i++){var n=r[i];e&&!n._intersectsRect(e)||n._render(t,e)}},e.prototype.getDescendantsToRef=function(t,e,i){if(void 0===e&&(e=!1),this.children)for(var r=0;r<this.children.length;r++){var n=this.children[r];i&&!i(n)||t.push(n),e||n.getDescendantsToRef(t,!1,i)}},e.prototype._processPicking=function(e,i,r,n,o,s,a,l){if(!this._isEnabled||!this.isVisible||this.notRenderable)return!1;if(!t.prototype.contains.call(this,e,i))return!1;for(var h=this._children.length-1;h>=0;h--){var c=this._children[h];if(c._processPicking(e,i,r,n,o,s,a,l))return c.hoverCursor&&this._host._changeCursor(c.hoverCursor),!0}return!!this.isHitTestVisible&&this._processObservables(n,e,i,r,o,s,a,l)},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._measureForChildren.copyFrom(this._currentMeasure)},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=this.children.length-1;e>=0;e--)this.children[e].dispose()},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Container"]=g;var m,b=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._thickness=1,i._cornerRadius=0,i}return n(e,t),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness!==t&&(this._thickness=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(t){t<0&&(t=0),this._cornerRadius!==t&&(this._cornerRadius=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Rectangle"},e.prototype._localDraw=function(t){t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),this._background&&(t.fillStyle=this._background,this._cornerRadius?(this._drawRoundedRect(t,this._thickness/2),t.fill()):t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._thickness&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),this.color&&(t.strokeStyle=this.color),t.lineWidth=this._thickness,this._cornerRadius?(this._drawRoundedRect(t,this._thickness/2),t.stroke()):t.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),t.restore()},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},e.prototype._drawRoundedRect=function(t,e){void 0===e&&(e=0);var i=this._currentMeasure.left+e,r=this._currentMeasure.top+e,n=this._currentMeasure.width-2*e,o=this._currentMeasure.height-2*e,s=Math.min(o/2-2,Math.min(n/2-2,this._cornerRadius));t.beginPath(),t.moveTo(i+s,r),t.lineTo(i+n-s,r),t.quadraticCurveTo(i+n,r,i+n,r+s),t.lineTo(i+n,r+o-s),t.quadraticCurveTo(i+n,r+o,i+n-s,r+o),t.lineTo(i+s,r+o),t.quadraticCurveTo(i,r+o,i,r+o-s),t.lineTo(i,r+s),t.quadraticCurveTo(i,r,i+s,r),t.closePath()},e.prototype._clipForChildren=function(t){this._cornerRadius&&(this._drawRoundedRect(t,this._thickness),t.clip())},e}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Rectangle"]=b,function(t){t[t.Clip=0]="Clip",t[t.WordWrap=1]="WordWrap",t[t.Ellipsis=2]="Ellipsis"}(m||(m={}));var v=function(t){function e(e,i){void 0===i&&(i="");var r=t.call(this,e)||this;return r.name=e,r._text="",r._textWrapping=m.Clip,r._textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,r._textVerticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,r._resizeToFit=!1,r._lineSpacing=new a(0),r._outlineWidth=0,r._outlineColor="white",r._underline=!1,r._lineThrough=!1,r.onTextChangedObservable=new s.Observable,r.onLinesReadyObservable=new s.Observable,r.text=i,r}return n(e,t),Object.defineProperty(e.prototype,"lines",{get:function(){return this._lines},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resizeToFit",{get:function(){return this._resizeToFit},set:function(t){this._resizeToFit!==t&&(this._resizeToFit=t,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWrapping",{get:function(){return this._textWrapping},set:function(t){this._textWrapping!==t&&(this._textWrapping=+t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHorizontalAlignment",{get:function(){return this._textHorizontalAlignment},set:function(t){this._textHorizontalAlignment!==t&&(this._textHorizontalAlignment=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textVerticalAlignment",{get:function(){return this._textVerticalAlignment},set:function(t){this._textVerticalAlignment!==t&&(this._textVerticalAlignment=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this._lineSpacing.toString(this._host)},set:function(t){this._lineSpacing.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this._underline},set:function(t){this._underline!==t&&(this._underline=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineThrough",{get:function(){return this._lineThrough},set:function(t){this._lineThrough!==t&&(this._lineThrough=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(t){this._outlineColor!==t&&(this._outlineColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"TextBlock"},e.prototype._processMeasures=function(e,i){this._fontOffset||(this._fontOffset=_._GetFontOffset(i.font)),t.prototype._processMeasures.call(this,e,i),this._lines=this._breakLines(this._currentMeasure.width,i),this.onLinesReadyObservable.notifyObservers(this);for(var r=0,n=0;n<this._lines.length;n++){var o=this._lines[n];o.width>r&&(r=o.width)}if(this._resizeToFit){if(this._textWrapping===m.Clip){var s=this.paddingLeftInPixels+this.paddingRightInPixels+r|0;s!==this._width.internalValue&&(this._width.updateInPlace(s,a.UNITMODE_PIXEL),this._rebuildLayout=!0)}var l=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){var h=0;h=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),l+=(this._lines.length-1)*h}l!==this._height.internalValue&&(this._height.updateInPlace(l,a.UNITMODE_PIXEL),this._rebuildLayout=!0)}},e.prototype._drawText=function(t,e,i,r){var n=this._currentMeasure.width,o=0;switch(this._textHorizontalAlignment){case _.HORIZONTAL_ALIGNMENT_LEFT:o=0;break;case _.HORIZONTAL_ALIGNMENT_RIGHT:o=n-e;break;case _.HORIZONTAL_ALIGNMENT_CENTER:o=(n-e)/2}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY),this.outlineWidth&&r.strokeText(t,this._currentMeasure.left+o,i),r.fillText(t,this._currentMeasure.left+o,i),this._underline&&(r.beginPath(),r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.moveTo(this._currentMeasure.left+o,i+3),r.lineTo(this._currentMeasure.left+o+e,i+3),r.stroke(),r.closePath()),this._lineThrough&&(r.beginPath(),r.lineWidth=Math.round(.05*this.fontSizeInPixels),r.moveTo(this._currentMeasure.left+o,i-this.fontSizeInPixels/3),r.lineTo(this._currentMeasure.left+o+e,i-this.fontSizeInPixels/3),r.stroke(),r.closePath())},e.prototype._draw=function(t,e){t.save(),this._applyStates(t),this._renderLines(t),t.restore()},e.prototype._applyStates=function(e){t.prototype._applyStates.call(this,e),this.outlineWidth&&(e.lineWidth=this.outlineWidth,e.strokeStyle=this.outlineColor,e.lineJoin="miter",e.miterLimit=2)},e.prototype._breakLines=function(t,e){var i=[],r=this.text.split("\n");if(this._textWrapping===m.Ellipsis)for(var n=0,o=r;n<o.length;n++){var s=o[n];i.push(this._parseLineEllipsis(s,t,e))}else if(this._textWrapping===m.WordWrap)for(var a=0,l=r;a<l.length;a++)s=l[a],i.push.apply(i,this._parseLineWordWrap(s,t,e));else for(var h=0,c=r;h<c.length;h++)s=c[h],i.push(this._parseLine(s,e));return i},e.prototype._parseLine=function(t,e){return void 0===t&&(t=""),{text:t,width:e.measureText(t).width}},e.prototype._parseLineEllipsis=function(t,e,i){void 0===t&&(t="");var r=i.measureText(t).width;r>e&&(t+="…");var n=Array.from&&Array.from(t);if(n)for(;n.length&&r>e;)n.pop(),t=n.join("")+"...",r=i.measureText(t).width;else for(;t.length>2&&r>e;)t=t.slice(0,-2)+"…",r=i.measureText(t).width;return{text:t,width:r}},e.prototype._parseLineWordWrap=function(t,e,i){void 0===t&&(t="");for(var r=[],n=this.wordSplittingFunction?this.wordSplittingFunction(t):t.split(" "),o=0,s=0;s<n.length;s++){var a=s>0?t+" "+n[s]:n[0],l=i.measureText(a).width;l>e&&s>0?(r.push({text:t,width:o}),t=n[s],o=i.measureText(t).width):(o=l,t=a)}return r.push({text:t,width:o}),r},e.prototype._renderLines=function(t){var e=this._currentMeasure.height,i=0;switch(this._textVerticalAlignment){case _.VERTICAL_ALIGNMENT_TOP:i=this._fontOffset.ascent;break;case _.VERTICAL_ALIGNMENT_BOTTOM:i=e-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case _.VERTICAL_ALIGNMENT_CENTER:i=this._fontOffset.ascent+(e-this._fontOffset.height*this._lines.length)/2}i+=this._currentMeasure.top;for(var r=0;r<this._lines.length;r++){var n=this._lines[r];0!==r&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?i+=this._lineSpacing.getValue(this._host):i+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(n.text,n.width,i,t),i+=this._fontOffset.height}},e.prototype.computeExpectedHeight=function(){if(this.text&&this.widthInPixels){var t=document.createElement("canvas").getContext("2d");if(t){this._applyStates(t),this._fontOffset||(this._fontOffset=_._GetFontOffset(t.font));var e=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,t),i=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*e.length;if(e.length>0&&0!==this._lineSpacing.internalValue){var r=0;r=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),i+=(e.length-1)*r}return i}}return 0},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.onTextChangedObservable.clear()},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.TextBlock"]=v;var y=function(t){function e(i,r){void 0===r&&(r=null);var n=t.call(this,i)||this;return n.name=i,n._workingCanvas=null,n._loaded=!1,n._stretch=e.STRETCH_FILL,n._autoScale=!1,n._sourceLeft=0,n._sourceTop=0,n._sourceWidth=0,n._sourceHeight=0,n._svgAttributesComputationCompleted=!1,n._isSVG=!1,n._cellWidth=0,n._cellHeight=0,n._cellId=-1,n._populateNinePatchSlicesFromImage=!1,n._imageDataCache={data:null,key:""},n.onImageLoadedObservable=new s.Observable,n.onSVGAttributesComputedObservable=new s.Observable,n.source=r,n}return n(e,t),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"populateNinePatchSlicesFromImage",{get:function(){return this._populateNinePatchSlicesFromImage},set:function(t){this._populateNinePatchSlicesFromImage!==t&&(this._populateNinePatchSlicesFromImage=t,this._populateNinePatchSlicesFromImage&&this._loaded&&this._extractNinePatchSliceDataFromImage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detectPointerOnOpaqueOnly",{get:function(){return this._detectPointerOnOpaqueOnly},set:function(t){this._detectPointerOnOpaqueOnly!==t&&(this._detectPointerOnOpaqueOnly=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sliceLeft",{get:function(){return this._sliceLeft},set:function(t){this._sliceLeft!==t&&(this._sliceLeft=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sliceRight",{get:function(){return this._sliceRight},set:function(t){this._sliceRight!==t&&(this._sliceRight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sliceTop",{get:function(){return this._sliceTop},set:function(t){this._sliceTop!==t&&(this._sliceTop=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sliceBottom",{get:function(){return this._sliceBottom},set:function(t){this._sliceBottom!==t&&(this._sliceBottom=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceLeft",{get:function(){return this._sourceLeft},set:function(t){this._sourceLeft!==t&&(this._sourceLeft=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceTop",{get:function(){return this._sourceTop},set:function(t){this._sourceTop!==t&&(this._sourceTop=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceWidth",{get:function(){return this._sourceWidth},set:function(t){this._sourceWidth!==t&&(this._sourceWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceHeight",{get:function(){return this._sourceHeight},set:function(t){this._sourceHeight!==t&&(this._sourceHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSVG",{get:function(){return this._isSVG},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"svgAttributesComputationCompleted",{get:function(){return this._svgAttributesComputationCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoScale",{get:function(){return this._autoScale},set:function(t){this._autoScale!==t&&(this._autoScale=t,t&&this._loaded&&this.synchronizeSizeWithContent())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stretch",{get:function(){return this._stretch},set:function(t){this._stretch!==t&&(this._stretch=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._rotate90=function(t,i){void 0===i&&(i=!1);var r=document.createElement("canvas"),n=r.getContext("2d"),o=this._domImage.width,s=this._domImage.height;r.width=s,r.height=o,n.translate(r.width/2,r.height/2),n.rotate(t*Math.PI/2),n.drawImage(this._domImage,0,0,o,s,-o/2,-s/2,o,s);var a=r.toDataURL("image/jpg"),l=new e(this.name+"rotated",a);return i&&(l._stretch=this._stretch,l._autoScale=this._autoScale,l._cellId=this._cellId,l._cellWidth=t%1?this._cellHeight:this._cellWidth,l._cellHeight=t%1?this._cellWidth:this._cellHeight),this._handleRotationForSVGImage(this,l,t),this._imageDataCache.data=null,l},e.prototype._handleRotationForSVGImage=function(t,e,i){var r=this;t._isSVG&&(t._svgAttributesComputationCompleted?(this._rotate90SourceProperties(t,e,i),this._markAsDirty()):t.onSVGAttributesComputedObservable.addOnce((function(){r._rotate90SourceProperties(t,e,i),r._markAsDirty()})))},e.prototype._rotate90SourceProperties=function(t,e,i){var r,n,o=t.sourceLeft,s=t.sourceTop,a=t.domImage.width,l=t.domImage.height,h=o,c=s,u=t.sourceWidth,d=t.sourceHeight;if(0!=i){var p=i<0?-1:1;i%=4;for(var f=0;f<Math.abs(i);++f)h=-(s-l/2)*p+l/2,c=(o-a/2)*p+a/2,u=(r=[d,u])[0],d=r[1],i<0?c-=d:h-=u,o=h,s=c,a=(n=[l,a])[0],l=n[1]}e.sourceLeft=h,e.sourceTop=c,e.sourceWidth=u,e.sourceHeight=d},Object.defineProperty(e.prototype,"domImage",{get:function(){return this._domImage},set:function(t){var e=this;this._domImage=t,this._loaded=!1,this._imageDataCache.data=null,this._domImage.width?this._onImageLoaded():this._domImage.onload=function(){e._onImageLoaded()}},enumerable:!1,configurable:!0}),e.prototype._onImageLoaded=function(){this._imageDataCache.data=null,this._imageWidth=this._domImage.width,this._imageHeight=this._domImage.height,this._loaded=!0,this._populateNinePatchSlicesFromImage&&this._extractNinePatchSliceDataFromImage(),this._autoScale&&this.synchronizeSizeWithContent(),this.onImageLoadedObservable.notifyObservers(this),this._markAsDirty()},e.prototype._extractNinePatchSliceDataFromImage=function(){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"));var t=this._workingCanvas,e=t.getContext("2d"),i=this._domImage.width,r=this._domImage.height;t.width=i,t.height=r,e.drawImage(this._domImage,0,0,i,r);var n=e.getImageData(0,0,i,r);this._sliceLeft=-1,this._sliceRight=-1;for(var o=0;o<i;o++)if((a=n.data[4*o+3])>127&&-1===this._sliceLeft)this._sliceLeft=o;else if(a<127&&this._sliceLeft>-1){this._sliceRight=o;break}this._sliceTop=-1,this._sliceBottom=-1;for(var s=0;s<r;s++){var a;if((a=n.data[s*i*4+3])>127&&-1===this._sliceTop)this._sliceTop=s;else if(a<127&&this._sliceTop>-1){this._sliceBottom=s;break}}},Object.defineProperty(e.prototype,"source",{set:function(t){var e=this;this._source!==t&&(this._loaded=!1,this._source=t,this._imageDataCache.data=null,t&&(t=this._svgCheck(t)),this._domImage=document.createElement("img"),this._domImage.onload=function(){e._onImageLoaded()},t&&(s.Tools.SetCorsBehavior(t,this._domImage),this._domImage.src=t))},enumerable:!1,configurable:!0}),e.prototype._svgCheck=function(t){var e=this;if(window.SVGSVGElement&&-1!==t.search(/.svg#/gi)&&t.indexOf("#")===t.lastIndexOf("#")){this._isSVG=!0;var i=t.split("#")[0],r=t.split("#")[1],n=document.body.querySelector('object[data="'+i+'"]');if(n){var o=n.contentDocument;if(o&&o.documentElement){var s=o.documentElement.getAttribute("viewBox"),a=Number(o.documentElement.getAttribute("width")),l=Number(o.documentElement.getAttribute("height"));if(o.getElementById(r)&&s&&a&&l)return this._getSVGAttribs(n,r),t}n.addEventListener("load",(function(){e._getSVGAttribs(n,r)}))}else{var h=document.createElement("object");h.data=i,h.type="image/svg+xml",h.width="0%",h.height="0%",document.body.appendChild(h),h.onload=function(){var t=document.body.querySelector('object[data="'+i+'"]');t&&e._getSVGAttribs(t,r)}}return i}return t},e.prototype._getSVGAttribs=function(t,e){var i=t.contentDocument;if(i&&i.documentElement){var r=i.documentElement.getAttribute("viewBox"),n=Number(i.documentElement.getAttribute("width")),o=Number(i.documentElement.getAttribute("height")),s=i.getElementById(e);if(r&&n&&o&&s){var a=Number(r.split(" ")[2]),l=Number(r.split(" ")[3]),h=s.getBBox(),c=1,u=1,d=0,p=0;s.transform&&s.transform.baseVal.consolidate()&&(c=s.transform.baseVal.consolidate().matrix.a,u=s.transform.baseVal.consolidate().matrix.d,d=s.transform.baseVal.consolidate().matrix.e,p=s.transform.baseVal.consolidate().matrix.f),this.sourceLeft=(c*h.x+d)*n/a,this.sourceTop=(u*h.y+p)*o/l,this.sourceWidth=h.width*c*(n/a),this.sourceHeight=h.height*u*(o/l),this._svgAttributesComputationCompleted=!0,this.onSVGAttributesComputedObservable.notifyObservers(this)}}},Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(t){this._cellWidth!==t&&(this._cellWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(t){this._cellHeight!==t&&(this._cellHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellId",{get:function(){return this._cellId},set:function(t){this._cellId!==t&&(this._cellId=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype.contains=function(e,i){if(!t.prototype.contains.call(this,e,i))return!1;if(!this._detectPointerOnOpaqueOnly||!this._workingCanvas)return!0;var r=0|this._currentMeasure.width,n=0|this._currentMeasure.height,o=r+"_"+n,s=this._imageDataCache.data;if(!s||this._imageDataCache.key!==o){var a=this._workingCanvas.getContext("2d");this._imageDataCache.data=s=a.getImageData(0,0,r,n).data,this._imageDataCache.key=o}return s[4*((e=e-this._currentMeasure.left|0)+(i=i-this._currentMeasure.top|0)*r)+3]>0},e.prototype._getTypeName=function(){return"Image"},e.prototype.synchronizeSizeWithContent=function(){this._loaded&&(this.width=this._domImage.width+"px",this.height=this._domImage.height+"px")},e.prototype._processMeasures=function(i,r){if(this._loaded)switch(this._stretch){case e.STRETCH_NONE:case e.STRETCH_FILL:case e.STRETCH_UNIFORM:case e.STRETCH_NINE_PATCH:break;case e.STRETCH_EXTEND:this._autoScale&&this.synchronizeSizeWithContent(),this.parent&&this.parent.parent&&(this.parent.adaptWidthToChildren=!0,this.parent.adaptHeightToChildren=!0)}t.prototype._processMeasures.call(this,i,r)},e.prototype._prepareWorkingCanvasForOpaqueDetection=function(){if(this._detectPointerOnOpaqueOnly){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"));var t=this._workingCanvas,e=this._currentMeasure.width,i=this._currentMeasure.height,r=t.getContext("2d");t.width=e,t.height=i,r.clearRect(0,0,e,i)}},e.prototype._drawImage=function(t,e,i,r,n,o,s,a,l){t.drawImage(this._domImage,e,i,r,n,o,s,a,l),this._detectPointerOnOpaqueOnly&&(t=this._workingCanvas.getContext("2d")).drawImage(this._domImage,e,i,r,n,o-this._currentMeasure.left,s-this._currentMeasure.top,a,l)},e.prototype._draw=function(t){var i,r,n,o;if(t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),-1==this.cellId)i=this._sourceLeft,r=this._sourceTop,n=this._sourceWidth?this._sourceWidth:this._imageWidth,o=this._sourceHeight?this._sourceHeight:this._imageHeight;else{var s=this._domImage.naturalWidth/this.cellWidth,a=this.cellId/s>>0,l=this.cellId%s;i=this.cellWidth*l,r=this.cellHeight*a,n=this.cellWidth,o=this.cellHeight}if(this._prepareWorkingCanvasForOpaqueDetection(),this._applyStates(t),this._loaded)switch(this._stretch){case e.STRETCH_NONE:case e.STRETCH_FILL:this._drawImage(t,i,r,n,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case e.STRETCH_UNIFORM:var h=this._currentMeasure.width/n,c=this._currentMeasure.height/o,u=Math.min(h,c),d=(this._currentMeasure.width-n*u)/2,p=(this._currentMeasure.height-o*u)/2;this._drawImage(t,i,r,n,o,this._currentMeasure.left+d,this._currentMeasure.top+p,n*u,o*u);break;case e.STRETCH_EXTEND:this._drawImage(t,i,r,n,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case e.STRETCH_NINE_PATCH:this._renderNinePatch(t)}t.restore()},e.prototype._renderCornerPatch=function(t,e,i,r,n,o,s){this._drawImage(t,e,i,r,n,this._currentMeasure.left+o,this._currentMeasure.top+s,r,n)},e.prototype._renderNinePatch=function(t){var e=this._imageHeight,i=this._sliceLeft,r=this._sliceTop,n=this._imageHeight-this._sliceBottom,o=this._imageWidth-this._sliceRight,s=0,a=0;this._populateNinePatchSlicesFromImage&&(s=1,a=1,e-=2,i-=1,r-=1,n-=1,o-=1);var l=this._sliceRight-this._sliceLeft,h=this._currentMeasure.width-o-this.sliceLeft,c=this._currentMeasure.height-e+this._sliceBottom;this._renderCornerPatch(t,s,a,i,r,0,0),this._renderCornerPatch(t,s,this._sliceBottom,i,e-this._sliceBottom,0,c),this._renderCornerPatch(t,this._sliceRight,a,o,r,this._currentMeasure.width-o,0),this._renderCornerPatch(t,this._sliceRight,this._sliceBottom,o,e-this._sliceBottom,this._currentMeasure.width-o,c),this._drawImage(t,this._sliceLeft,this._sliceTop,l,this._sliceBottom-this._sliceTop,this._currentMeasure.left+i,this._currentMeasure.top+r,h,c-r),this._drawImage(t,s,this._sliceTop,i,this._sliceBottom-this._sliceTop,this._currentMeasure.left,this._currentMeasure.top+r,i,c-r),this._drawImage(t,this._sliceRight,this._sliceTop,i,this._sliceBottom-this._sliceTop,this._currentMeasure.left+this._currentMeasure.width-o,this._currentMeasure.top+r,i,c-r),this._drawImage(t,this._sliceLeft,a,l,r,this._currentMeasure.left+i,this._currentMeasure.top,h,r),this._drawImage(t,this._sliceLeft,this._sliceBottom,l,n,this._currentMeasure.left+i,this._currentMeasure.top+c,h,n)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.onImageLoadedObservable.clear(),this.onSVGAttributesComputedObservable.clear()},e.STRETCH_NONE=0,e.STRETCH_FILL=1,e.STRETCH_UNIFORM=2,e.STRETCH_EXTEND=3,e.STRETCH_NINE_PATCH=4,e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Image"]=y;var T=function(t){function e(e){var i=t.call(this,e)||this;i.name=e,i.delegatePickingToChildren=!1,i.thickness=1,i.isPointerBlocker=!0;var r=null;return i.pointerEnterAnimation=function(){r=i.alpha,i.alpha-=.1},i.pointerOutAnimation=function(){null!==r&&(i.alpha=r)},i.pointerDownAnimation=function(){i.scaleX-=.05,i.scaleY-=.05},i.pointerUpAnimation=function(){i.scaleX+=.05,i.scaleY+=.05},i}return n(e,t),Object.defineProperty(e.prototype,"image",{get:function(){return this._image},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Button"},e.prototype._processPicking=function(e,i,r,n,o,s,a,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!t.prototype.contains.call(this,e,i))return!1;if(this.delegatePickingToChildren){for(var h=!1,c=this._children.length-1;c>=0;c--){var u=this._children[c];if(u.isEnabled&&u.isHitTestVisible&&u.isVisible&&!u.notRenderable&&u.contains(e,i)){h=!0;break}}if(!h)return!1}return this._processObservables(n,e,i,r,o,s,a,l),!0},e.prototype._onPointerEnter=function(e,i){return!!t.prototype._onPointerEnter.call(this,e,i)&&(this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},e.prototype._onPointerOut=function(e,i,r){void 0===r&&(r=!1),this.pointerOutAnimation&&this.pointerOutAnimation(),t.prototype._onPointerOut.call(this,e,i,r)},e.prototype._onPointerDown=function(e,i,r,n,o){return!!t.prototype._onPointerDown.call(this,e,i,r,n,o)&&(this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},e.prototype._onPointerUp=function(e,i,r,n,o,s){this.pointerUpAnimation&&this.pointerUpAnimation(),t.prototype._onPointerUp.call(this,e,i,r,n,o,s)},e.CreateImageButton=function(t,i,r){var n=new e(t),o=new v(t+"_button",i);o.textWrapping=!0,o.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,o.paddingLeft="20%",n.addControl(o);var s=new y(t+"_icon",r);return s.width="20%",s.stretch=y.STRETCH_UNIFORM,s.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.addControl(s),n._image=s,n._textBlock=o,n},e.CreateImageOnlyButton=function(t,i){var r=new e(t),n=new y(t+"_icon",i);return n.stretch=y.STRETCH_FILL,n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r.addControl(n),r._image=n,r},e.CreateSimpleButton=function(t,i){var r=new e(t),n=new v(t+"_button",i);return n.textWrapping=!0,n.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,r.addControl(n),r._textBlock=n,r},e.CreateImageWithCenterTextButton=function(t,i,r){var n=new e(t),o=new y(t+"_icon",r);o.stretch=y.STRETCH_FILL,n.addControl(o);var s=new v(t+"_button",i);return s.textWrapping=!0,s.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,n.addControl(s),n._image=o,n._textBlock=s,n},e}(b);s._TypeStore.RegisteredTypes["BABYLON.GUI.Button"]=T;var O=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._isVertical=!0,i._manualWidth=!1,i._manualHeight=!1,i._doNotTrackManualChanges=!1,i.ignoreLayoutWarnings=!1,i}return n(e,t),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(t){this._isVertical!==t&&(this._isVertical=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(t){this._doNotTrackManualChanges||(this._manualWidth=!0),this._width.toString(this._host)!==t&&this._width.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(t){this._doNotTrackManualChanges||(this._manualHeight=!0),this._height.toString(this._host)!==t&&this._height.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"StackPanel"},e.prototype._preMeasure=function(e,i){for(var r=0,n=this._children;r<n.length;r++){var o=n[r];this._isVertical?o.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP:o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT}t.prototype._preMeasure.call(this,e,i)},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._measureForChildren.copyFrom(e),this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this.isVertical&&!this._manualWidth||(this._measureForChildren.width=this._currentMeasure.width),(this.isVertical||this._manualHeight)&&(this._measureForChildren.height=this._currentMeasure.height)},e.prototype._postMeasure=function(){for(var e=0,i=0,r=0,n=this._children;r<n.length;r++){var o=n[r];o.isVisible&&!o.notRenderable&&(this._isVertical?(o.top!==i+"px"&&(o.top=i+"px",this._rebuildLayout=!0,o._top.ignoreAdaptiveScaling=!0),o._height.isPercentage&&!o._automaticSize?this.ignoreLayoutWarnings||s.Tools.Warn("Control (Name:"+o.name+", UniqueId:"+o.uniqueId+") is using height in percentage mode inside a vertical StackPanel"):i+=o._currentMeasure.height+o.paddingTopInPixels+o.paddingBottomInPixels):(o.left!==e+"px"&&(o.left=e+"px",this._rebuildLayout=!0,o._left.ignoreAdaptiveScaling=!0),o._width.isPercentage&&!o._automaticSize?this.ignoreLayoutWarnings||s.Tools.Warn("Control (Name:"+o.name+", UniqueId:"+o.uniqueId+") is using width in percentage mode inside a horizontal StackPanel"):e+=o._currentMeasure.width+o.paddingLeftInPixels+o.paddingRightInPixels))}e+=this.paddingLeftInPixels+this.paddingRightInPixels,i+=this.paddingTopInPixels+this.paddingBottomInPixels,this._doNotTrackManualChanges=!0;var a=!1,l=!1;if(!this._manualHeight&&this._isVertical){var h=this.height;this.height=i+"px",l=h!==this.height||!this._height.ignoreAdaptiveScaling}if(!this._manualWidth&&!this._isVertical){var c=this.width;this.width=e+"px",a=c!==this.width||!this._width.ignoreAdaptiveScaling}l&&(this._height.ignoreAdaptiveScaling=!0),a&&(this._width.ignoreAdaptiveScaling=!0),this._doNotTrackManualChanges=!1,(a||l)&&(this._rebuildLayout=!0),t.prototype._postMeasure.call(this)},e}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.StackPanel"]=O;var E=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.onIsCheckedChangedObservable=new s.Observable,i.isPointerBlocker=!0,i}return n(e,t),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness!==t&&(this._thickness=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(t){t=Math.max(Math.min(1,t),0),this._checkSizeRatio!==t&&(this._checkSizeRatio=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isChecked",{get:function(){return this._isChecked},set:function(t){this._isChecked!==t&&(this._isChecked=t,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(t))},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Checkbox"},e.prototype._draw=function(t,e){t.save(),this._applyStates(t);var i=this._currentMeasure.width-this._thickness,r=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fillStyle=this._isEnabled?this._background:this._disabledColor,t.fillRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,i,r),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),this._isChecked){t.fillStyle=this._isEnabled?this.color:this._disabledColorItem;var n=i*this._checkSizeRatio,o=r*this._checkSizeRatio;t.fillRect(this._currentMeasure.left+this._thickness/2+(i-n)/2,this._currentMeasure.top+this._thickness/2+(r-o)/2,n,o)}t.strokeStyle=this.color,t.lineWidth=this._thickness,t.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,i,r),t.restore()},e.prototype._onPointerDown=function(e,i,r,n,o){return!!t.prototype._onPointerDown.call(this,e,i,r,n,o)&&(this.isChecked=!this.isChecked,!0)},e.AddCheckBoxWithHeader=function(t,i){var r=new O;r.isVertical=!1,r.height="30px";var n=new e;n.width="20px",n.height="20px",n.isChecked=!0,n.color="green",n.onIsCheckedChangedObservable.add(i),r.addControl(n);var o=new v;return o.text=t,o.width="180px",o.paddingLeft="5px",o.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.color="white",r.addControl(o),r},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Checkbox"]=E;var A=function(){function t(){}return Object.defineProperty(t.prototype,"text",{get:function(){return this._characters?this._characters.join(""):this._text},set:function(t){this._text=t,this._characters=Array.from&&Array.from(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._characters?this._characters.length:this._text.length},enumerable:!1,configurable:!0}),t.prototype.removePart=function(t,e,i){var r;if(this._text=this._text.slice(0,t)+(i||"")+this._text.slice(e),this._characters){var n=i?Array.from(i):[];(r=this._characters).splice.apply(r,function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)r[n]=o[s];return r}([t,e-t],n))}},t.prototype.charAt=function(t){return this._characters?this._characters[t]:this._text.charAt(t)},t.prototype.substr=function(t,e){if(this._characters){t=isNaN(t)?0:t>=0?Math.min(t,this._characters.length):this._characters.length+Math.max(t,-this._characters.length),void 0===e?e=this._characters.length-t:(isNaN(e)||e<0)&&(e=0);for(var i=[];--e>=0;)i[e]=this._characters[t+e];return i.join("")}return this._text.substr(t,e)},t.prototype.substring=function(t,e){if(this._characters){isNaN(t)?t=0:t>this._characters.length?t=this._characters.length:t<0&&(t=0),void 0===e?e=this._characters.length:isNaN(e)?e=0:e>this._characters.length?e=this._characters.length:e<0&&(e=0);for(var i=[],r=0;t<e;)i[r++]=this._characters[t++];return i.join("")}return this._text.substring(t,e)},t.prototype.isWord=function(t){var e=/\w/g;return this._characters?-1!==this._characters[t].search(e):-1!==this._text.search(e)},t}(),C=function(t){function e(e,i){void 0===i&&(i="");var r=t.call(this,e)||this;return r.name=e,r._placeholderText="",r._background="#222222",r._focusedBackground="#000000",r._focusedColor="white",r._placeholderColor="gray",r._thickness=1,r._margin=new a(10,a.UNITMODE_PIXEL),r._autoStretchWidth=!0,r._maxWidth=new a(1,a.UNITMODE_PERCENTAGE,!1),r._isFocused=!1,r._blinkIsEven=!1,r._cursorOffset=0,r._deadKey=!1,r._addKey=!0,r._currentKey="",r._isTextHighlightOn=!1,r._textHighlightColor="#d5e0ff",r._highligherOpacity=.4,r._highlightedText="",r._startHighlightIndex=0,r._endHighlightIndex=0,r._cursorIndex=-1,r._onFocusSelectAll=!1,r._isPointerDown=!1,r.promptMessage="Please enter text:",r.disableMobilePrompt=!1,r.onTextChangedObservable=new s.Observable,r.onBeforeKeyAddObservable=new s.Observable,r.onFocusObservable=new s.Observable,r.onBlurObservable=new s.Observable,r.onTextHighlightObservable=new s.Observable,r.onTextCopyObservable=new s.Observable,r.onTextCutObservable=new s.Observable,r.onTextPasteObservable=new s.Observable,r.onKeyboardEventProcessedObservable=new s.Observable,r.text=i,r.isPointerBlocker=!0,r}return n(e,t),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth.toString(this._host)},set:function(t){this._maxWidth.toString(this._host)!==t&&this._maxWidth.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidthInPixels",{get:function(){return this._maxWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highligherOpacity",{get:function(){return this._highligherOpacity},set:function(t){this._highligherOpacity!==t&&(this._highligherOpacity=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onFocusSelectAll",{get:function(){return this._onFocusSelectAll},set:function(t){this._onFocusSelectAll!==t&&(this._onFocusSelectAll=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHighlightColor",{get:function(){return this._textHighlightColor},set:function(t){this._textHighlightColor!==t&&(this._textHighlightColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"margin",{get:function(){return this._margin.toString(this._host)},set:function(t){this._margin.toString(this._host)!==t&&this._margin.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marginInPixels",{get:function(){return this._margin.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoStretchWidth",{get:function(){return this._autoStretchWidth},set:function(t){this._autoStretchWidth!==t&&(this._autoStretchWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness!==t&&(this._thickness=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusedBackground",{get:function(){return this._focusedBackground},set:function(t){this._focusedBackground!==t&&(this._focusedBackground=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusedColor",{get:function(){return this._focusedColor},set:function(t){this._focusedColor!==t&&(this._focusedColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"placeholderColor",{get:function(){return this._placeholderColor},set:function(t){this._placeholderColor!==t&&(this._placeholderColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(t){this._placeholderText!==t&&(this._placeholderText=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deadKey",{get:function(){return this._deadKey},set:function(t){this._deadKey=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightedText",{get:function(){return this._highlightedText},set:function(t){this._highlightedText!==t&&(this._highlightedText=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"addKey",{get:function(){return this._addKey},set:function(t){this._addKey=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentKey",{get:function(){return this._currentKey},set:function(t){this._currentKey=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._textWrapper.text},set:function(t){var e=t.toString();this._textWrapper||(this._textWrapper=new A),this._textWrapper.text!==e&&(this._textWrapper.text=e,this._textHasChanged())},enumerable:!1,configurable:!0}),e.prototype._textHasChanged=function(){this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(t){this._width.toString(this._host)!==t&&(this._width.fromString(t)&&this._markAsDirty(),this.autoStretchWidth=!1)},enumerable:!1,configurable:!0}),e.prototype.onBlur=function(){this._isFocused=!1,this._scrollLeft=null,this._cursorOffset=0,clearTimeout(this._blinkTimeout),this._markAsDirty(),this.onBlurObservable.notifyObservers(this),this._host.unRegisterClipboardEvents(),this._onClipboardObserver&&this._host.onClipboardObservable.remove(this._onClipboardObserver);var t=this._host.getScene();this._onPointerDblTapObserver&&t&&t.onPointerObservable.remove(this._onPointerDblTapObserver)},e.prototype.onFocus=function(){var t=this;if(this._isEnabled){if(this._scrollLeft=null,this._isFocused=!0,this._blinkIsEven=!1,this._cursorOffset=0,this._markAsDirty(),this.onFocusObservable.notifyObservers(this),-1!==navigator.userAgent.indexOf("Mobile")&&!this.disableMobilePrompt){var e=prompt(this.promptMessage);return null!==e&&(this.text=e),void(this._host.focusedControl=null)}this._host.registerClipboardEvents(),this._onClipboardObserver=this._host.onClipboardObservable.add((function(e){switch(e.type){case s.ClipboardEventTypes.COPY:t._onCopyText(e.event),t.onTextCopyObservable.notifyObservers(t);break;case s.ClipboardEventTypes.CUT:t._onCutText(e.event),t.onTextCutObservable.notifyObservers(t);break;case s.ClipboardEventTypes.PASTE:t._onPasteText(e.event),t.onTextPasteObservable.notifyObservers(t);break;default:return}}));var i=this._host.getScene();i&&(this._onPointerDblTapObserver=i.onPointerObservable.add((function(e){t._isFocused&&e.type===s.PointerEventTypes.POINTERDOUBLETAP&&t._processDblClick(e)}))),this._onFocusSelectAll&&this._selectAllText()}},e.prototype._getTypeName=function(){return"InputText"},e.prototype.keepsFocusWith=function(){return this._connectedVirtualKeyboard?[this._connectedVirtualKeyboard]:null},e.prototype.processKey=function(t,e,i){if(!i||!i.ctrlKey&&!i.metaKey||67!==t&&86!==t&&88!==t){if(i&&(i.ctrlKey||i.metaKey)&&65===t)return this._selectAllText(),void i.preventDefault();switch(t){case 32:e=" ";break;case 191:i&&i.preventDefault();break;case 8:if(this._textWrapper.text&&this._textWrapper.length>0){if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._blinkIsEven=!1,void(i&&i.preventDefault());0===this._cursorOffset?this.text=this._textWrapper.substr(0,this._textWrapper.length-1):(r=this._textWrapper.length-this._cursorOffset)>0&&(this._textWrapper.removePart(r-1,r),this._textHasChanged())}return void(i&&i.preventDefault());case 46:if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,void(i&&i.preventDefault());if(this._textWrapper.text&&this._textWrapper.length>0&&this._cursorOffset>0){var r=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(r,r+1),this._textHasChanged(),this._cursorOffset--}return void(i&&i.preventDefault());case 13:return this._host.focusedControl=null,void(this._isTextHighlightOn=!1);case 35:return this._cursorOffset=0,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 36:return this._cursorOffset=this._textWrapper.length,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 37:if(this._cursorOffset++,this._cursorOffset>this._textWrapper.length&&(this._cursorOffset=this._textWrapper.length),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(this._textWrapper.length===this._cursorOffset)return;this._endHighlightIndex=this._textWrapper.length-this._cursorOffset+1}return this._startHighlightIndex=0,this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=this._textWrapper.length,this._isTextHighlightOn=!0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=0===this._startHighlightIndex?this._textWrapper.length:this._textWrapper.length-this._startHighlightIndex+1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset>=this._textWrapper.length?this._textWrapper.length:this._cursorOffset-1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=this._textWrapper.length,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 39:if(this._cursorOffset--,this._cursorOffset<0&&(this._cursorOffset=0),i&&i.shiftKey){if(this._blinkIsEven=!1,i.ctrlKey||i.metaKey){if(!this._isTextHighlightOn){if(0===this._cursorOffset)return;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset-1}return this._endHighlightIndex=this._textWrapper.length,this._isTextHighlightOn=!0,this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=this._textWrapper.length===this._endHighlightIndex?0:this._textWrapper.length-this._endHighlightIndex-1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset<=0?0:this._cursorOffset+1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._endHighlightIndex,this._isTextHighlightOn=!1),i&&(i.ctrlKey||i.metaKey)&&(this._cursorOffset=0,i.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 222:i&&i.preventDefault(),this._cursorIndex=-1,this.deadKey=!0}if(e&&(-1===t||32===t||t>47&&t<64||t>64&&t<91||t>159&&t<193||t>218&&t<223||t>95&&t<112)&&(this._currentKey=e,this.onBeforeKeyAddObservable.notifyObservers(this),e=this._currentKey,this._addKey))if(this._isTextHighlightOn)this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex,e),this._textHasChanged(),this._cursorOffset=this._textWrapper.length-(this._startHighlightIndex+1),this._isTextHighlightOn=!1,this._blinkIsEven=!1,this._markAsDirty();else if(0===this._cursorOffset)this.text+=e;else{var n=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(n,n,e),this._textHasChanged()}}},e.prototype._updateValueFromCursorIndex=function(t){if(this._blinkIsEven=!1,-1===this._cursorIndex)this._cursorIndex=t;else if(this._cursorIndex<this._cursorOffset)this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset;else{if(!(this._cursorIndex>this._cursorOffset))return this._isTextHighlightOn=!1,void this._markAsDirty();this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex}this._isTextHighlightOn=!0,this._markAsDirty()},e.prototype._processDblClick=function(t){var e,i;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset,this._endHighlightIndex=this._startHighlightIndex;do{i=this._endHighlightIndex<this._textWrapper.length&&this._textWrapper.isWord(this._endHighlightIndex)?++this._endHighlightIndex:0,e=this._startHighlightIndex>0&&this._textWrapper.isWord(this._startHighlightIndex-1)?--this._startHighlightIndex:0}while(e||i);this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this.onTextHighlightObservable.notifyObservers(this),this._isTextHighlightOn=!0,this._clickedCoordinate=null,this._blinkIsEven=!0,this._cursorIndex=-1,this._markAsDirty()},e.prototype._selectAllText=function(){this._blinkIsEven=!0,this._isTextHighlightOn=!0,this._startHighlightIndex=0,this._endHighlightIndex=this._textWrapper.length,this._cursorOffset=this._textWrapper.length,this._cursorIndex=-1,this._markAsDirty()},e.prototype.processKeyboard=function(t){this.processKey(t.keyCode,t.key,t),this.onKeyboardEventProcessedObservable.notifyObservers(t)},e.prototype._onCopyText=function(t){this._isTextHighlightOn=!1;try{t.clipboardData&&t.clipboardData.setData("text/plain",this._highlightedText)}catch(t){}this._host.clipboardData=this._highlightedText},e.prototype._onCutText=function(t){if(this._highlightedText){this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex;try{t.clipboardData&&t.clipboardData.setData("text/plain",this._highlightedText)}catch(t){}this._host.clipboardData=this._highlightedText,this._highlightedText=""}},e.prototype._onPasteText=function(t){var e="";e=t.clipboardData&&-1!==t.clipboardData.types.indexOf("text/plain")?t.clipboardData.getData("text/plain"):this._host.clipboardData;var i=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(i,i,e),this._textHasChanged()},e.prototype._draw=function(t,e){var i=this;t.save(),this._applyStates(t),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),this._isFocused?this._focusedBackground&&(t.fillStyle=this._isEnabled?this._focusedBackground:this._disabledColor,t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)):this._background&&(t.fillStyle=this._isEnabled?this._background:this._disabledColor,t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),this._fontOffset||(this._fontOffset=_._GetFontOffset(t.font));var r=this._currentMeasure.left+this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this.color&&(t.fillStyle=this.color);var n=this._beforeRenderText(this._textWrapper);this._isFocused||this._textWrapper.text||!this._placeholderText||((n=new A).text=this._placeholderText,this._placeholderColor&&(t.fillStyle=this._placeholderColor)),this._textWidth=t.measureText(n.text).width;var o=2*this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this._autoStretchWidth&&(this.width=Math.min(this._maxWidth.getValueInPixel(this._host,this._tempParentMeasure.width),this._textWidth+o)+"px");var s=this._fontOffset.ascent+(this._currentMeasure.height-this._fontOffset.height)/2,a=this._width.getValueInPixel(this._host,this._tempParentMeasure.width)-o;if(t.save(),t.beginPath(),t.rect(r,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,a+2,this._currentMeasure.height),t.clip(),this._isFocused&&this._textWidth>a){var l=r-this._textWidth+a;this._scrollLeft||(this._scrollLeft=l)}else this._scrollLeft=r;if(t.fillText(n.text,this._scrollLeft,this._currentMeasure.top+s),this._isFocused){if(this._clickedCoordinate){var h=this._scrollLeft+this._textWidth-this._clickedCoordinate,c=0;this._cursorOffset=0;var u=0;do{this._cursorOffset&&(u=Math.abs(h-c)),this._cursorOffset++,c=t.measureText(n.substr(n.length-this._cursorOffset,this._cursorOffset)).width}while(c<h&&n.length>=this._cursorOffset);Math.abs(h-c)>u&&this._cursorOffset--,this._blinkIsEven=!1,this._clickedCoordinate=null}if(!this._blinkIsEven){var d=n.substr(n.length-this._cursorOffset),p=t.measureText(d).width,f=this._scrollLeft+this._textWidth-p;f<r?(this._scrollLeft+=r-f,f=r,this._markAsDirty()):f>r+a&&(this._scrollLeft+=r+a-f,f=r+a,this._markAsDirty()),this._isTextHighlightOn||t.fillRect(f,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,2,this._fontOffset.height)}if(clearTimeout(this._blinkTimeout),this._blinkTimeout=setTimeout((function(){i._blinkIsEven=!i._blinkIsEven,i._markAsDirty()}),500),this._isTextHighlightOn){clearTimeout(this._blinkTimeout);var g=t.measureText(n.substring(this._startHighlightIndex)).width,m=this._scrollLeft+this._textWidth-g;this._highlightedText=n.substring(this._startHighlightIndex,this._endHighlightIndex);var b=t.measureText(n.substring(this._startHighlightIndex,this._endHighlightIndex)).width;m<r&&((b-=r-m)||(b=t.measureText(n.charAt(n.length-this._cursorOffset)).width),m=r),t.globalAlpha=this._highligherOpacity,t.fillStyle=this._textHighlightColor,t.fillRect(m,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,b,this._fontOffset.height),t.globalAlpha=1}}t.restore(),this._thickness&&(this._isFocused?this.focusedColor&&(t.strokeStyle=this.focusedColor):this.color&&(t.strokeStyle=this.color),t.lineWidth=this._thickness,t.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),t.restore()},e.prototype._onPointerDown=function(e,i,r,n,o){return!!t.prototype._onPointerDown.call(this,e,i,r,n,o)&&(this._clickedCoordinate=i.x,this._isTextHighlightOn=!1,this._highlightedText="",this._cursorIndex=-1,this._isPointerDown=!0,this._host._capturingControl[r]=this,this._host.focusedControl===this?(clearTimeout(this._blinkTimeout),this._markAsDirty(),!0):!!this._isEnabled&&(this._host.focusedControl=this,!0))},e.prototype._onPointerMove=function(e,i,r,n){this._host.focusedControl===this&&this._isPointerDown&&(this._clickedCoordinate=i.x,this._markAsDirty(),this._updateValueFromCursorIndex(this._cursorOffset)),t.prototype._onPointerMove.call(this,e,i,r,n)},e.prototype._onPointerUp=function(e,i,r,n,o){this._isPointerDown=!1,delete this._host._capturingControl[r],t.prototype._onPointerUp.call(this,e,i,r,n,o)},e.prototype._beforeRenderText=function(t){return t},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onTextChangedObservable.clear(),this.onTextCopyObservable.clear(),this.onTextCutObservable.clear(),this.onTextPasteObservable.clear(),this.onTextHighlightObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.InputText"]=C;var x=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._rowDefinitions=new Array,i._columnDefinitions=new Array,i._cells={},i._childControls=new Array,i}return n(e,t),Object.defineProperty(e.prototype,"columnCount",{get:function(){return this._columnDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowCount",{get:function(){return this._rowDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._childControls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cells",{get:function(){return this._cells},enumerable:!1,configurable:!0}),e.prototype.getRowDefinition=function(t){return t<0||t>=this._rowDefinitions.length?null:this._rowDefinitions[t]},e.prototype.getColumnDefinition=function(t){return t<0||t>=this._columnDefinitions.length?null:this._columnDefinitions[t]},e.prototype.addRowDefinition=function(t,e){return void 0===e&&(e=!1),this._rowDefinitions.push(new a(t,e?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},e.prototype.addColumnDefinition=function(t,e){return void 0===e&&(e=!1),this._columnDefinitions.push(new a(t,e?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},e.prototype.setRowDefinition=function(t,e,i){if(void 0===i&&(i=!1),t<0||t>=this._rowDefinitions.length)return this;var r=this._rowDefinitions[t];return r&&r.isPixel===i&&r.internalValue===e||(this._rowDefinitions[t]=new a(e,i?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE),this._markAsDirty()),this},e.prototype.setColumnDefinition=function(t,e,i){if(void 0===i&&(i=!1),t<0||t>=this._columnDefinitions.length)return this;var r=this._columnDefinitions[t];return r&&r.isPixel===i&&r.internalValue===e||(this._columnDefinitions[t]=new a(e,i?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE),this._markAsDirty()),this},e.prototype.getChildrenAt=function(t,e){var i=this._cells[t+":"+e];return i?i.children:null},e.prototype.getChildCellInfo=function(t){return t._tag},e.prototype._removeCell=function(e,i){if(e){t.prototype.removeControl.call(this,e);for(var r=0,n=e.children;r<n.length;r++){var o=n[r],s=this._childControls.indexOf(o);-1!==s&&this._childControls.splice(s,1)}delete this._cells[i]}},e.prototype._offsetCell=function(t,e){if(this._cells[e]){this._cells[t]=this._cells[e];for(var i=0,r=this._cells[t].children;i<r.length;i++)r[i]._tag=t;delete this._cells[e]}},e.prototype.removeColumnDefinition=function(t){if(t<0||t>=this._columnDefinitions.length)return this;for(var e=0;e<this._rowDefinitions.length;e++){var i=e+":"+t,r=this._cells[i];this._removeCell(r,i)}for(e=0;e<this._rowDefinitions.length;e++)for(var n=t+1;n<this._columnDefinitions.length;n++){var o=e+":"+(n-1);i=e+":"+n,this._offsetCell(o,i)}return this._columnDefinitions.splice(t,1),this._markAsDirty(),this},e.prototype.removeRowDefinition=function(t){if(t<0||t>=this._rowDefinitions.length)return this;for(var e=0;e<this._columnDefinitions.length;e++){var i=t+":"+e,r=this._cells[i];this._removeCell(r,i)}for(e=0;e<this._columnDefinitions.length;e++)for(var n=t+1;n<this._rowDefinitions.length;n++){var o=n-1+":"+e;i=n+":"+e,this._offsetCell(o,i)}return this._rowDefinitions.splice(t,1),this._markAsDirty(),this},e.prototype.addControl=function(e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=0),0===this._rowDefinitions.length&&this.addRowDefinition(1,!1),0===this._columnDefinitions.length&&this.addColumnDefinition(1,!1),-1!==this._childControls.indexOf(e))return s.Tools.Warn("Control (Name:"+e.name+", UniqueId:"+e.uniqueId+") is already associated with this grid. You must remove it before reattaching it"),this;var n=Math.min(i,this._rowDefinitions.length-1)+":"+Math.min(r,this._columnDefinitions.length-1),o=this._cells[n];return o||(o=new g(n),this._cells[n]=o,o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,t.prototype.addControl.call(this,o)),o.addControl(e),this._childControls.push(e),e._tag=n,e.parent=this,this._markAsDirty(),this},e.prototype.removeControl=function(t){var e=this._childControls.indexOf(t);-1!==e&&this._childControls.splice(e,1);var i=this._cells[t._tag];return i&&(i.removeControl(t),t._tag=null),this._markAsDirty(),this},e.prototype._getTypeName=function(){return"Grid"},e.prototype._getGridDefinitions=function(t){for(var e=[],i=[],r=[],n=[],o=this._currentMeasure.width,s=0,a=this._currentMeasure.height,l=0,h=0,c=0,u=this._rowDefinitions;c<u.length;c++)(g=u[c]).isPixel?(a-=_=g.getValue(this._host),i[h]=_):l+=g.internalValue,h++;var d=0;h=0;for(var p=0,f=this._rowDefinitions;p<f.length;p++){var _,g=f[p];n.push(d),g.isPixel?d+=g.getValue(this._host):(d+=_=g.internalValue/l*a,i[h]=_),h++}h=0;for(var m=0,b=this._columnDefinitions;m<b.length;m++)(g=b[m]).isPixel?(o-=O=g.getValue(this._host),e[h]=O):s+=g.internalValue,h++;var v=0;h=0;for(var y=0,T=this._columnDefinitions;y<T.length;y++){var O;g=T[y],r.push(v),g.isPixel?v+=g.getValue(this._host):(v+=O=g.internalValue/s*o,e[h]=O),h++}t(r,n,e,i)},e.prototype._additionalProcessing=function(e,i){var r=this;this._getGridDefinitions((function(t,e,i,n){for(var o in r._cells)if(r._cells.hasOwnProperty(o)){var s=o.split(":"),a=parseInt(s[0]),l=parseInt(s[1]),h=r._cells[o];h.left=t[l]+"px",h.top=e[a]+"px",h.width=i[l]+"px",h.height=n[a]+"px",h._left.ignoreAdaptiveScaling=!0,h._top.ignoreAdaptiveScaling=!0,h._width.ignoreAdaptiveScaling=!0,h._height.ignoreAdaptiveScaling=!0}})),t.prototype._additionalProcessing.call(this,e,i)},e.prototype._flagDescendantsAsMatrixDirty=function(){for(var t in this._cells)this._cells.hasOwnProperty(t)&&this._cells[t]._markMatrixAsDirty()},e.prototype._renderHighlightSpecific=function(e){var i=this;t.prototype._renderHighlightSpecific.call(this,e),this._getGridDefinitions((function(t,r,n,o){for(var s=0;s<t.length;s++){var a=i._currentMeasure.left+t[s]+n[s];e.beginPath(),e.moveTo(a,i._currentMeasure.top),e.lineTo(a,i._currentMeasure.top+i._currentMeasure.height),e.stroke()}for(s=0;s<r.length;s++){var l=i._currentMeasure.top+r[s]+o[s];e.beginPath(),e.moveTo(i._currentMeasure.left,l),e.lineTo(i._currentMeasure.left+i._currentMeasure.width,l),e.stroke()}})),e.restore()},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,i=this._childControls;e<i.length;e++)i[e].dispose();this._childControls=[]},e}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Grid"]=x;var w=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._value=s.Color3.Red(),i._tmpColor=new s.Color3,i._pointerStartedOnSquare=!1,i._pointerStartedOnWheel=!1,i._squareLeft=0,i._squareTop=0,i._squareSize=0,i._h=360,i._s=1,i._v=1,i._lastPointerDownID=-1,i.onValueChangedObservable=new s.Observable,i._pointerIsDown=!1,i.value=new s.Color3(.88,.1,.1),i.size="200px",i.isPointerBlocker=!0,i}return n(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value.equals(t)||(this._value.copyFrom(t),this._value.toHSVToRef(this._tmpColor),this._h=this._tmpColor.r,this._s=Math.max(this._tmpColor.g,1e-5),this._v=Math.max(this._tmpColor.b,1e-5),this._markAsDirty(),this._value.r<=e._Epsilon&&(this._value.r=0),this._value.g<=e._Epsilon&&(this._value.g=0),this._value.b<=e._Epsilon&&(this._value.b=0),this._value.r>=1-e._Epsilon&&(this._value.r=1),this._value.g>=1-e._Epsilon&&(this._value.g=1),this._value.b>=1-e._Epsilon&&(this._value.b=1),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(t){this._width.toString(this._host)!==t&&this._width.fromString(t)&&(this._height.fromString(t),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(t){this._height.toString(this._host)!==t&&this._height.fromString(t)&&(this._width.fromString(t),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.width},set:function(t){this.width=t},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"ColorPicker"},e.prototype._preMeasure=function(t,e){t.width<t.height?this._currentMeasure.height=t.width:this._currentMeasure.width=t.height},e.prototype._updateSquareProps=function(){var t=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),e=2*(t-.2*t)/Math.sqrt(2),i=t-.5*e;this._squareLeft=this._currentMeasure.left+i,this._squareTop=this._currentMeasure.top+i,this._squareSize=e},e.prototype._drawGradientSquare=function(t,e,i,r,n,o){var s=o.createLinearGradient(e,i,r+e,i);s.addColorStop(0,"#fff"),s.addColorStop(1,"hsl("+t+", 100%, 50%)"),o.fillStyle=s,o.fillRect(e,i,r,n);var a=o.createLinearGradient(e,i,e,n+i);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"#000"),o.fillStyle=a,o.fillRect(e,i,r,n)},e.prototype._drawCircle=function(t,e,i,r){r.beginPath(),r.arc(t,e,i+1,0,2*Math.PI,!1),r.lineWidth=3,r.strokeStyle="#333333",r.stroke(),r.beginPath(),r.arc(t,e,i,0,2*Math.PI,!1),r.lineWidth=3,r.strokeStyle="#ffffff",r.stroke()},e.prototype._createColorWheelCanvas=function(t,e){var i=document.createElement("canvas");i.width=2*t,i.height=2*t;for(var r=i.getContext("2d"),n=r.getImageData(0,0,2*t,2*t),o=n.data,a=this._tmpColor,l=t*t,h=t-e,c=h*h,u=-t;u<t;u++)for(var d=-t;d<t;d++){var p=u*u+d*d;if(!(p>l||p<c)){var f=Math.sqrt(p),_=Math.atan2(d,u);s.Color3.HSVtoRGBToRef(180*_/Math.PI+180,f/t,1,a);var g=4*(u+t+2*(d+t)*t);o[g]=255*a.r,o[g+1]=255*a.g,o[g+2]=255*a.b;var m=.2;m=t<50?.2:t>150?.04:-.16*(t-50)/100+.2;var b=(f-h)/(t-h);o[g+3]=b<m?b/m*255:b>1-m?255*(1-(b-(1-m))/m):255}}return r.putImageData(n,0,0),i},e.prototype._draw=function(t){t.save(),this._applyStates(t);var e=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),i=.2*e,r=this._currentMeasure.left,n=this._currentMeasure.top;this._colorWheelCanvas&&this._colorWheelCanvas.width==2*e||(this._colorWheelCanvas=this._createColorWheelCanvas(e,i)),this._updateSquareProps(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.fillRect(this._squareLeft,this._squareTop,this._squareSize,this._squareSize)),t.drawImage(this._colorWheelCanvas,r,n),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),this._drawGradientSquare(this._h,this._squareLeft,this._squareTop,this._squareSize,this._squareSize,t);var o=this._squareLeft+this._squareSize*this._s,s=this._squareTop+this._squareSize*(1-this._v);this._drawCircle(o,s,.04*e,t);var a=e-.5*i;o=r+e+Math.cos((this._h-180)*Math.PI/180)*a,s=n+e+Math.sin((this._h-180)*Math.PI/180)*a,this._drawCircle(o,s,.35*i,t),t.restore()},e.prototype._updateValueFromPointer=function(t,i){if(this._pointerStartedOnWheel){var r=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),n=r+this._currentMeasure.left,o=r+this._currentMeasure.top;this._h=180*Math.atan2(i-o,t-n)/Math.PI+180}else this._pointerStartedOnSquare&&(this._updateSquareProps(),this._s=(t-this._squareLeft)/this._squareSize,this._v=1-(i-this._squareTop)/this._squareSize,this._s=Math.min(this._s,1),this._s=Math.max(this._s,e._Epsilon),this._v=Math.min(this._v,1),this._v=Math.max(this._v,e._Epsilon));s.Color3.HSVtoRGBToRef(this._h,this._s,this._v,this._tmpColor),this.value=this._tmpColor},e.prototype._isPointOnSquare=function(t,e){this._updateSquareProps();var i=this._squareLeft,r=this._squareTop,n=this._squareSize;return t>=i&&t<=i+n&&e>=r&&e<=r+n},e.prototype._isPointOnWheel=function(t,e){var i=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),r=i-.2*i,n=t-(i+this._currentMeasure.left),o=e-(i+this._currentMeasure.top),s=n*n+o*o;return s<=i*i&&s>=r*r},e.prototype._onPointerDown=function(e,i,r,n,o){if(!t.prototype._onPointerDown.call(this,e,i,r,n,o))return!1;this._pointerIsDown=!0,this._pointerStartedOnSquare=!1,this._pointerStartedOnWheel=!1,this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var s=this._transformedPosition.x,a=this._transformedPosition.y;return this._isPointOnSquare(s,a)?this._pointerStartedOnSquare=!0:this._isPointOnWheel(s,a)&&(this._pointerStartedOnWheel=!0),this._updateValueFromPointer(s,a),this._host._capturingControl[r]=this,this._lastPointerDownID=r,!0},e.prototype._onPointerMove=function(e,i,r,n){if(r==this._lastPointerDownID){this._invertTransformMatrix.transformCoordinates(i.x,i.y,this._transformedPosition);var o=this._transformedPosition.x,s=this._transformedPosition.y;this._pointerIsDown&&this._updateValueFromPointer(o,s),t.prototype._onPointerMove.call(this,e,i,r,n)}},e.prototype._onPointerUp=function(e,i,r,n,o,s){this._pointerIsDown=!1,delete this._host._capturingControl[r],t.prototype._onPointerUp.call(this,e,i,r,n,o,s)},e.prototype._onCanvasBlur=function(){this._forcePointerUp(),t.prototype._onCanvasBlur.call(this)},e.ShowPickerDialogAsync=function(t,i){return new Promise((function(r,n){i.pickerWidth=i.pickerWidth||"640px",i.pickerHeight=i.pickerHeight||"400px",i.headerHeight=i.headerHeight||"35px",i.lastColor=i.lastColor||"#000000",i.swatchLimit=i.swatchLimit||20,i.numSwatchesPerLine=i.numSwatchesPerLine||10;var o,a,l,h,c,u,d,p,f,g,m,y,O,E,A,w,M,S,I,P=i.swatchLimit/i.numSwatchesPerLine,R=parseFloat(i.pickerWidth)/i.numSwatchesPerLine,L=Math.floor(.25*R),N=L*(i.numSwatchesPerLine+1),k=Math.floor((parseFloat(i.pickerWidth)-N)/i.numSwatchesPerLine),D=k*P+L*(P+1),B=(parseInt(i.pickerHeight)+D+Math.floor(.25*k)).toString()+"px",F=s.Color3.FromHexString("#dddddd"),V=F.r+F.g+F.b,j=["R","G","B"],H=!1;function U(t,e){I=e;var i=t.toHexString();if(M.background=i,g.name!=I&&(g.text=Math.floor(255*t.r).toString()),m.name!=I&&(m.text=Math.floor(255*t.g).toString()),y.name!=I&&(y.text=Math.floor(255*t.b).toString()),O.name!=I&&(O.text=t.r.toString()),E.name!=I&&(E.text=t.g.toString()),A.name!=I&&(A.text=t.b.toString()),w.name!=I){var r=i.split("#");w.text=r[1]}f.name!=I&&(f.value=t)}function G(t,e){var i=t.text;if(/[^0-9]/g.test(i))t.text=S;else if(""!=i&&(Math.floor(parseInt(i))<0?i="0":Math.floor(parseInt(i))>255?i="255":isNaN(parseInt(i))&&(i="0")),I==t.name&&(S=i),""!=i){i=parseInt(i).toString(),t.text=i;var r=s.Color3.FromHexString(M.background);I==t.name&&U("r"==e?new s.Color3(parseInt(i)/255,r.g,r.b):"g"==e?new s.Color3(r.r,parseInt(i)/255,r.b):new s.Color3(r.r,r.g,parseInt(i)/255),t.name)}}function W(t,e){var i=t.text;if(/[^0-9\.]/g.test(i))t.text=S;else{""!=i&&"."!=i&&0!=parseFloat(i)&&(parseFloat(i)<0?i="0.0":parseFloat(i)>1?i="1.0":isNaN(parseFloat(i))&&(i="0.0")),I==t.name&&(S=i),""!=i&&"."!=i&&0!=parseFloat(i)?(i=parseFloat(i).toString(),t.text=i):i="0.0";var r=s.Color3.FromHexString(M.background);I==t.name&&U("r"==e?new s.Color3(parseFloat(i),r.g,r.b):"g"==e?new s.Color3(r.r,parseFloat(i),r.b):new s.Color3(r.r,r.g,parseFloat(i)),t.name)}}function z(){if(i.savedColors&&i.savedColors[d]){if(H)var t="b";else t="";var e=T.CreateSimpleButton("Swatch_"+d,t);e.fontFamily="BabylonJSglyphs";var r=s.Color3.FromHexString(i.savedColors[d]),n=r.r+r.g+r.b;e.color=n>V?"#aaaaaa":"#ffffff",e.fontSize=Math.floor(.7*k),e.textBlock.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,e.height=e.width=k.toString()+"px",e.background=i.savedColors[d],e.thickness=2;var o=d;return e.pointerDownAnimation=function(){e.thickness=4},e.pointerUpAnimation=function(){e.thickness=3},e.pointerEnterAnimation=function(){e.thickness=3},e.pointerOutAnimation=function(){e.thickness=2},e.onPointerClickObservable.add((function(){var t;H?(t=o,i.savedColors&&i.savedColors.splice(t,1),i.savedColors&&0==i.savedColors.length&&(Y(!1),H=!1),$("",Mt)):i.savedColors&&U(s.Color3.FromHexString(i.savedColors[o]),e.name)})),e}return null}function X(t){if(void 0!==t&&(H=t),H){for(var e=0;e<p.children.length;e++)p.children[e].textBlock.text="b";void 0!==l&&(l.textBlock.text="Done")}else{for(e=0;e<p.children.length;e++)p.children[e].textBlock.text="";void 0!==l&&(l.textBlock.text="Edit")}}function $(t,e){if(i.savedColors){""!=t&&i.savedColors.push(t),d=0,p.clearControls();var r=Math.ceil(i.savedColors.length/i.numSwatchesPerLine);if(0==r)var n=0;else n=r+1;if(p.rowCount!=r+n){for(var o=p.rowCount,s=0;s<o;s++)p.removeRowDefinition(0);for(s=0;s<r+n;s++)s%2?p.addRowDefinition(k,!0):p.addRowDefinition(L,!0)}p.height=(k*r+n*L).toString()+"px";for(var a=1,l=1;a<r+n;a+=2,l++){if(i.savedColors.length>l*i.numSwatchesPerLine)var h=i.numSwatchesPerLine;else h=i.savedColors.length-(l-1)*i.numSwatchesPerLine;for(var c=Math.min(Math.max(h,0),i.numSwatchesPerLine),u=0,f=1;u<c;u++)if(!(u>i.numSwatchesPerLine)){var _=z();null!=_&&(p.addControl(_,a,f),f+=2,d++)}}i.savedColors.length>=i.swatchLimit?K(e,!0):K(e,!1)}}function Y(t){t?((l=T.CreateSimpleButton("butEdit","Edit")).width=h,l.height=c,l.left=Math.floor(.1*parseInt(h)).toString()+"px",l.top=(-1*parseFloat(l.left)).toString()+"px",l.verticalAlignment=_.VERTICAL_ALIGNMENT_BOTTOM,l.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,l.thickness=2,l.color="#c0c0c0",l.fontSize=a,l.background="#535353",l.onPointerEnterObservable.add((function(){l.background="#414141"})),l.onPointerOutObservable.add((function(){l.background="#535353"})),l.pointerDownAnimation=function(){l.background="515151"},l.pointerUpAnimation=function(){l.background="#414141"},l.onPointerClickObservable.add((function(){H=!H,X()})),ct.addControl(l,1,0)):ct.removeControl(l)}function K(t,e){e?(t.color="#555555",t.background="#454545"):(t.color="#c0c0c0",t.background="#535353")}function q(e){i.savedColors&&i.savedColors.length>0?r({savedColors:i.savedColors,pickedColor:e}):r({pickedColor:e}),t.removeControl(Z)}var Z=new x;if(Z.name="Dialog Container",Z.width=i.pickerWidth,i.savedColors){Z.height=B;var J=parseInt(i.pickerHeight)/parseInt(B);Z.addRowDefinition(J,!1),Z.addRowDefinition(1-J,!1)}else Z.height=i.pickerHeight,Z.addRowDefinition(1,!1);if(t.addControl(Z),i.savedColors){(p=new x).name="Swatch Drawer",p.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,p.background="#535353",p.width=i.pickerWidth;var Q=i.savedColors.length/i.numSwatchesPerLine;if(0==Q)var tt=0;else tt=Q+1;p.height=(k*Q+tt*L).toString()+"px",p.top=Math.floor(.25*k).toString()+"px";for(var et=0;et<2*Math.ceil(i.savedColors.length/i.numSwatchesPerLine)+1;et++)et%2!=0?p.addRowDefinition(k,!0):p.addRowDefinition(L,!0);for(et=0;et<2*i.numSwatchesPerLine+1;et++)et%2!=0?p.addColumnDefinition(k,!0):p.addColumnDefinition(L,!0);Z.addControl(p,1,0)}var it=new x;it.name="Picker Panel",it.height=i.pickerHeight;var rt=parseInt(i.headerHeight)/parseInt(i.pickerHeight),nt=[rt,1-rt];it.addRowDefinition(nt[0],!1),it.addRowDefinition(nt[1],!1),Z.addControl(it,0,0);var ot=new b;ot.name="Dialogue Header Bar",ot.background="#cccccc",ot.thickness=0,it.addControl(ot,0,0);var st=T.CreateSimpleButton("closeButton","a");st.fontFamily="BabylonJSglyphs";var at=s.Color3.FromHexString(ot.background);o=new s.Color3(1-at.r,1-at.g,1-at.b),st.color=o.toHexString(),st.fontSize=Math.floor(.6*parseInt(i.headerHeight)),st.textBlock.textVerticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,st.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_RIGHT,st.height=st.width=i.headerHeight,st.background=ot.background,st.thickness=0,st.pointerDownAnimation=function(){},st.pointerUpAnimation=function(){st.background=ot.background},st.pointerEnterAnimation=function(){st.color=ot.background,st.background="red"},st.pointerOutAnimation=function(){st.color=o.toHexString(),st.background=ot.background},st.onPointerClickObservable.add((function(){q(Ot.background)})),it.addControl(st,0,0);var lt=new x;lt.name="Dialogue Body",lt.background="#535353";var ht=[.4375,.5625];lt.addRowDefinition(1,!1),lt.addColumnDefinition(ht[0],!1),lt.addColumnDefinition(ht[1],!1),it.addControl(lt,1,0);var ct=new x;ct.name="Picker Grid",ct.addRowDefinition(.85,!1),ct.addRowDefinition(.15,!1),lt.addControl(ct,0,0),(f=new e).name="GUI Color Picker",i.pickerHeight<i.pickerWidth?f.width=.89:f.height=.89,f.value=s.Color3.FromHexString(i.lastColor),f.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,f.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,f.onPointerDownObservable.add((function(){I=f.name,S="",X(!1)})),f.onValueChangedObservable.add((function(t){I==f.name&&U(t,f.name)})),ct.addControl(f,0,0);var ut=new x;ut.name="Dialogue Right Half",ut.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT;var dt=[.514,.486];ut.addRowDefinition(dt[0],!1),ut.addRowDefinition(dt[1],!1),lt.addControl(ut,1,1);var pt=new x;pt.name="Swatches and Buttons";var ft=[.417,.583];pt.addRowDefinition(1,!1),pt.addColumnDefinition(ft[0],!1),pt.addColumnDefinition(ft[1],!1),ut.addControl(pt,0,0);var _t=new x;_t.name="New and Current Swatches";var gt=[.04,.16,.64,.16];_t.addRowDefinition(gt[0],!1),_t.addRowDefinition(gt[1],!1),_t.addRowDefinition(gt[2],!1),_t.addRowDefinition(gt[3],!1),pt.addControl(_t,0,0);var mt=new x;mt.name="Active Swatches",mt.width=.67,mt.addRowDefinition(.5,!1),mt.addRowDefinition(.5,!1),_t.addControl(mt,2,0);var bt=Math.floor(parseInt(i.pickerWidth)*ht[1]*ft[0]*.11),vt=Math.floor(parseInt(i.pickerHeight)*nt[1]*dt[0]*gt[1]*.5);if(i.pickerWidth>i.pickerHeight)var yt=vt;else yt=bt;var Tt=new v;Tt.text="new",Tt.name="New Color Label",Tt.color="#c0c0c0",Tt.fontSize=yt,_t.addControl(Tt,1,0),(M=new b).name="New Color Swatch",M.background=i.lastColor,M.thickness=0,mt.addControl(M,0,0);var Ot=T.CreateSimpleButton("currentSwatch","");Ot.background=i.lastColor,Ot.thickness=0,Ot.onPointerClickObservable.add((function(){U(s.Color3.FromHexString(Ot.background),Ot.name),X(!1)})),Ot.pointerDownAnimation=function(){},Ot.pointerUpAnimation=function(){},Ot.pointerEnterAnimation=function(){},Ot.pointerOutAnimation=function(){},mt.addControl(Ot,1,0);var Et=new b;Et.name="Swatch Outline",Et.width=.67,Et.thickness=2,Et.color="#404040",Et.isHitTestVisible=!1,_t.addControl(Et,2,0);var At=new v;At.name="Current Color Label",At.text="current",At.color="#c0c0c0",At.fontSize=yt,_t.addControl(At,3,0);var Ct=new x;Ct.name="Button Grid",Ct.height=.8,Ct.addRowDefinition(1/3,!1),Ct.addRowDefinition(1/3,!1),Ct.addRowDefinition(1/3,!1),pt.addControl(Ct,0,1),h=Math.floor(parseInt(i.pickerWidth)*ht[1]*ft[1]*.67).toString()+"px",c=Math.floor(parseInt(i.pickerHeight)*nt[1]*dt[0]*(parseFloat(Ct.height.toString())/100)*(1/3)*.7).toString()+"px",a=parseFloat(h)>parseFloat(c)?Math.floor(.45*parseFloat(c)):Math.floor(.11*parseFloat(h));var xt=T.CreateSimpleButton("butOK","OK");xt.width=h,xt.height=c,xt.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,xt.thickness=2,xt.color="#c0c0c0",xt.fontSize=a,xt.background="#535353",xt.onPointerEnterObservable.add((function(){xt.background="#414141"})),xt.onPointerOutObservable.add((function(){xt.background="#535353"})),xt.pointerDownAnimation=function(){xt.background="515151"},xt.pointerUpAnimation=function(){xt.background="#414141"},xt.onPointerClickObservable.add((function(){X(!1),q(M.background)})),Ct.addControl(xt,0,0);var wt=T.CreateSimpleButton("butCancel","Cancel");if(wt.width=h,wt.height=c,wt.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,wt.thickness=2,wt.color="#c0c0c0",wt.fontSize=a,wt.background="#535353",wt.onPointerEnterObservable.add((function(){wt.background="#414141"})),wt.onPointerOutObservable.add((function(){wt.background="#535353"})),wt.pointerDownAnimation=function(){wt.background="515151"},wt.pointerUpAnimation=function(){wt.background="#414141"},wt.onPointerClickObservable.add((function(){X(!1),q(Ot.background)})),Ct.addControl(wt,1,0),i.savedColors){var Mt=T.CreateSimpleButton("butSave","Save");Mt.width=h,Mt.height=c,Mt.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,Mt.thickness=2,Mt.fontSize=a,i.savedColors.length<i.swatchLimit?(Mt.color="#c0c0c0",Mt.background="#535353"):K(Mt,!0),Mt.onPointerEnterObservable.add((function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Mt.background="#414141")})),Mt.onPointerOutObservable.add((function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Mt.background="#535353")})),Mt.pointerDownAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Mt.background="515151")},Mt.pointerUpAnimation=function(){i.savedColors&&i.savedColors.length<i.swatchLimit&&(Mt.background="#414141")},Mt.onPointerClickObservable.add((function(){i.savedColors&&(0==i.savedColors.length&&Y(!0),i.savedColors.length<i.swatchLimit&&$(M.background,Mt),X(!1))})),i.savedColors.length>0&&Y(!0),Ct.addControl(Mt,2,0)}var St=new x;St.name="Dialog Lower Right",St.addRowDefinition(.02,!1),St.addRowDefinition(.63,!1),St.addRowDefinition(.21,!1),St.addRowDefinition(.14,!1),ut.addControl(St,1,0),u=s.Color3.FromHexString(i.lastColor);var It=new x;for(It.name="RGB Values",It.width=.82,It.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,It.addRowDefinition(1/3,!1),It.addRowDefinition(1/3,!1),It.addRowDefinition(1/3,!1),It.addColumnDefinition(.1,!1),It.addColumnDefinition(.2,!1),It.addColumnDefinition(.7,!1),St.addControl(It,1,0),et=0;et<j.length;et++)(Pt=new v).text=j[et],Pt.color="#c0c0c0",Pt.fontSize=a,It.addControl(Pt,et,0);(g=new C).width=.83,g.height=.72,g.name="rIntField",g.fontSize=a,g.text=(255*u.r).toString(),g.color="#f0f0f0",g.background="#454545",g.onFocusObservable.add((function(){I=g.name,S=g.text,X(!1)})),g.onBlurObservable.add((function(){""==g.text&&(g.text="0"),G(g,"r"),I==g.name&&(I="")})),g.onTextChangedObservable.add((function(){I==g.name&&G(g,"r")})),It.addControl(g,0,1),(m=new C).width=.83,m.height=.72,m.name="gIntField",m.fontSize=a,m.text=(255*u.g).toString(),m.color="#f0f0f0",m.background="#454545",m.onFocusObservable.add((function(){I=m.name,S=m.text,X(!1)})),m.onBlurObservable.add((function(){""==m.text&&(m.text="0"),G(m,"g"),I==m.name&&(I="")})),m.onTextChangedObservable.add((function(){I==m.name&&G(m,"g")})),It.addControl(m,1,1),(y=new C).width=.83,y.height=.72,y.name="bIntField",y.fontSize=a,y.text=(255*u.b).toString(),y.color="#f0f0f0",y.background="#454545",y.onFocusObservable.add((function(){I=y.name,S=y.text,X(!1)})),y.onBlurObservable.add((function(){""==y.text&&(y.text="0"),G(y,"b"),I==y.name&&(I="")})),y.onTextChangedObservable.add((function(){I==y.name&&G(y,"b")})),It.addControl(y,2,1),(O=new C).width=.95,O.height=.72,O.name="rDecField",O.fontSize=a,O.text=u.r.toString(),O.color="#f0f0f0",O.background="#454545",O.onFocusObservable.add((function(){I=O.name,S=O.text,X(!1)})),O.onBlurObservable.add((function(){0!=parseFloat(O.text)&&""!=O.text||(O.text="0",W(O,"r")),I==O.name&&(I="")})),O.onTextChangedObservable.add((function(){I==O.name&&W(O,"r")})),It.addControl(O,0,2),(E=new C).width=.95,E.height=.72,E.name="gDecField",E.fontSize=a,E.text=u.g.toString(),E.color="#f0f0f0",E.background="#454545",E.onFocusObservable.add((function(){I=E.name,S=E.text,X(!1)})),E.onBlurObservable.add((function(){0!=parseFloat(E.text)&&""!=E.text||(E.text="0",W(E,"g")),I==E.name&&(I="")})),E.onTextChangedObservable.add((function(){I==E.name&&W(E,"g")})),It.addControl(E,1,2),(A=new C).width=.95,A.height=.72,A.name="bDecField",A.fontSize=a,A.text=u.b.toString(),A.color="#f0f0f0",A.background="#454545",A.onFocusObservable.add((function(){I=A.name,S=A.text,X(!1)})),A.onBlurObservable.add((function(){0!=parseFloat(A.text)&&""!=A.text||(A.text="0",W(A,"b")),I==A.name&&(I="")})),A.onTextChangedObservable.add((function(){I==A.name&&W(A,"b")})),It.addControl(A,2,2);var Pt,Rt=new x;Rt.name="Hex Value",Rt.width=.82,Rt.addRowDefinition(1,!1),Rt.addColumnDefinition(.1,!1),Rt.addColumnDefinition(.9,!1),St.addControl(Rt,2,0),(Pt=new v).text="#",Pt.color="#c0c0c0",Pt.fontSize=a,Rt.addControl(Pt,0,0),(w=new C).width=.96,w.height=.72,w.name="hexField",w.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,w.fontSize=a;var Lt=i.lastColor.split("#");w.text=Lt[1],w.color="#f0f0f0",w.background="#454545",w.onFocusObservable.add((function(){I=w.name,S=w.text,X(!1)})),w.onBlurObservable.add((function(){if(3==w.text.length){var t=w.text.split("");w.text=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]}""==w.text&&(w.text="000000",U(s.Color3.FromHexString(w.text),"b")),I==w.name&&(I="")})),w.onTextChangedObservable.add((function(){var t=w.text,e=/[^0-9A-F]/i.test(t);if((w.text.length>6||e)&&I==w.name)w.text=S;else{if(w.text.length<6)for(var i=6-w.text.length,r=0;r<i;r++)t="0"+t;if(3==w.text.length){var n=w.text.split("");t=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]}t="#"+t,I==w.name&&(S=w.text,U(s.Color3.FromHexString(t),w.name))}})),Rt.addControl(w,0,1),i.savedColors&&i.savedColors.length>0&&$("",Mt)}))},e._Epsilon=1e-6,e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.ColorPicker"]=w;var M=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._thickness=1,i}return n(e,t),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness!==t&&(this._thickness=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Ellipse"},e.prototype._localDraw=function(t){t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,t),this._background&&(t.fillStyle=this._background,t.fill()),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),this._thickness&&(this.color&&(t.strokeStyle=this.color),t.lineWidth=this._thickness,t.stroke()),t.restore()},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},e.prototype._clipForChildren=function(t){_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2,this._currentMeasure.height/2,t),t.clip()},e}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Ellipse"]=M;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype._beforeRenderText=function(t){for(var e=new A,i="",r=0;r<t.length;r++)i+="•";return e.text=i,e},e}(C);s._TypeStore.RegisteredTypes["BABYLON.GUI.InputPassword"]=S;var I=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._lineWidth=1,i._x1=new a(0),i._y1=new a(0),i._x2=new a(0),i._y2=new a(0),i._dash=new Array,i._automaticSize=!0,i.isHitTestVisible=!1,i._horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i}return n(e,t),Object.defineProperty(e.prototype,"dash",{get:function(){return this._dash},set:function(t){this._dash!==t&&(this._dash=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectedControl",{get:function(){return this._connectedControl},set:function(t){var e=this;this._connectedControl!==t&&(this._connectedControlDirtyObserver&&this._connectedControl&&(this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver),this._connectedControlDirtyObserver=null),t&&(this._connectedControlDirtyObserver=t.onDirtyObservable.add((function(){return e._markAsDirty()}))),this._connectedControl=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1.toString(this._host)},set:function(t){this._x1.toString(this._host)!==t&&this._x1.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1.toString(this._host)},set:function(t){this._y1.toString(this._host)!==t&&this._y1.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._x2.toString(this._host)},set:function(t){this._x2.toString(this._host)!==t&&this._x2.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._y2.toString(this._host)},set:function(t){this._y2.toString(this._host)!==t&&this._y2.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(t){this._lineWidth!==t&&(this._lineWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlignment",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_effectiveX2",{get:function(){return(this._connectedControl?this._connectedControl.centerX:0)+this._x2.getValue(this._host)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_effectiveY2",{get:function(){return(this._connectedControl?this._connectedControl.centerY:0)+this._y2.getValue(this._host)},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Line"},e.prototype._draw=function(t){t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),this._applyStates(t),t.strokeStyle=this.color,t.lineWidth=this._lineWidth,t.setLineDash(this._dash),t.beginPath(),t.moveTo(this._cachedParentMeasure.left+this._x1.getValue(this._host),this._cachedParentMeasure.top+this._y1.getValue(this._host)),t.lineTo(this._cachedParentMeasure.left+this._effectiveX2,this._cachedParentMeasure.top+this._effectiveY2),t.stroke(),t.restore()},e.prototype._measure=function(){this._currentMeasure.width=Math.abs(this._x1.getValue(this._host)-this._effectiveX2)+this._lineWidth,this._currentMeasure.height=Math.abs(this._y1.getValue(this._host)-this._effectiveY2)+this._lineWidth},e.prototype._computeAlignment=function(t,e){this._currentMeasure.left=t.left+Math.min(this._x1.getValue(this._host),this._effectiveX2)-this._lineWidth/2,this._currentMeasure.top=t.top+Math.min(this._y1.getValue(this._host),this._effectiveY2)-this._lineWidth/2},e.prototype.moveToVector3=function(t,e,i){if(void 0===i&&(i=!1),this._host&&this.parent===this._host._rootContainer){var r=this._host._getGlobalViewport(e),n=s.Vector3.Project(t,s.Matrix.Identity(),e.getTransformMatrix(),r);this._moveToProjectedPosition(n,i),n.z<0||n.z>1?this.notRenderable=!0:this.notRenderable=!1}else s.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},e.prototype._moveToProjectedPosition=function(t,e){void 0===e&&(e=!1);var i=t.x+this._linkOffsetX.getValue(this._host)+"px",r=t.y+this._linkOffsetY.getValue(this._host)+"px";e?(this.x2=i,this.y2=r,this._x2.ignoreAdaptiveScaling=!0,this._y2.ignoreAdaptiveScaling=!0):(this.x1=i,this.y1=r,this._x1.ignoreAdaptiveScaling=!0,this._y1.ignoreAdaptiveScaling=!0)},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Line"]=I;var P=function(){function t(t){this._multiLine=t,this._x=new a(0),this._y=new a(0),this._point=new s.Vector3(0,0,0)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x.toString(this._multiLine._host)},set:function(t){this._x.toString(this._multiLine._host)!==t&&this._x.fromString(t)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y.toString(this._multiLine._host)},set:function(t){this._y.toString(this._multiLine._host)!==t&&this._y.fromString(t)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"control",{get:function(){return this._control},set:function(t){this._control!==t&&(this._control&&this._controlObserver&&(this._control.onDirtyObservable.remove(this._controlObserver),this._controlObserver=null),this._control=t,this._control&&(this._controlObserver=this._control.onDirtyObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mesh",{get:function(){return this._mesh},set:function(t){this._mesh!==t&&(this._mesh&&this._meshObserver&&this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver),this._mesh=t,this._mesh&&(this._meshObserver=this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.resetLinks=function(){this.control=null,this.mesh=null},t.prototype.translate=function(){return this._point=this._translatePoint(),this._point},t.prototype._translatePoint=function(){if(null!=this._mesh)return this._multiLine._host.getProjectedPositionWithZ(this._mesh.getBoundingInfo().boundingSphere.center,this._mesh.getWorldMatrix());if(null!=this._control)return new s.Vector3(this._control.centerX,this._control.centerY,1-s.Epsilon);var t=this._multiLine._host,e=this._x.getValueInPixel(t,Number(t._canvas.width)),i=this._y.getValueInPixel(t,Number(t._canvas.height));return new s.Vector3(e,i,1-s.Epsilon)},t.prototype.dispose=function(){this.resetLinks()},t}(),R=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._lineWidth=1,i.onPointUpdate=function(){i._markAsDirty()},i._automaticSize=!0,i.isHitTestVisible=!1,i._horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i._dash=[],i._points=[],i}return n(e,t),Object.defineProperty(e.prototype,"dash",{get:function(){return this._dash},set:function(t){this._dash!==t&&(this._dash=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype.getAt=function(t){return this._points[t]||(this._points[t]=new P(this)),this._points[t]},e.prototype.add=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e.map((function(e){return t.push(e)}))},e.prototype.push=function(t){var e=this.getAt(this._points.length);return null==t||(t instanceof s.AbstractMesh?e.mesh=t:t instanceof _?e.control=t:null!=t.x&&null!=t.y&&(e.x=t.x,e.y=t.y)),e},e.prototype.remove=function(t){var e;if(t instanceof P){if(-1===(e=this._points.indexOf(t)))return}else e=t;var i=this._points[e];i&&(i.dispose(),this._points.splice(e,1))},e.prototype.reset=function(){for(;this._points.length>0;)this.remove(this._points.length-1)},e.prototype.resetLinks=function(){this._points.forEach((function(t){null!=t&&t.resetLinks()}))},Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(t){this._lineWidth!==t&&(this._lineWidth=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlignment",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{set:function(t){},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"MultiLine"},e.prototype._draw=function(t,e){t.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),this._applyStates(t),t.strokeStyle=this.color,t.lineWidth=this._lineWidth,t.setLineDash(this._dash),t.beginPath();var i,r=!0;this._points.forEach((function(e){e&&(r?(t.moveTo(e._point.x,e._point.y),r=!1):e._point.z<1&&i.z<1?t.lineTo(e._point.x,e._point.y):t.moveTo(e._point.x,e._point.y),i=e._point)})),t.stroke(),t.restore()},e.prototype._additionalProcessing=function(t,e){var i=this;this._minX=null,this._minY=null,this._maxX=null,this._maxY=null,this._points.forEach((function(t,e){t&&(t.translate(),(null==i._minX||t._point.x<i._minX)&&(i._minX=t._point.x),(null==i._minY||t._point.y<i._minY)&&(i._minY=t._point.y),(null==i._maxX||t._point.x>i._maxX)&&(i._maxX=t._point.x),(null==i._maxY||t._point.y>i._maxY)&&(i._maxY=t._point.y))})),null==this._minX&&(this._minX=0),null==this._minY&&(this._minY=0),null==this._maxX&&(this._maxX=0),null==this._maxY&&(this._maxY=0)},e.prototype._measure=function(){null!=this._minX&&null!=this._maxX&&null!=this._minY&&null!=this._maxY&&(this._currentMeasure.width=Math.abs(this._maxX-this._minX)+this._lineWidth,this._currentMeasure.height=Math.abs(this._maxY-this._minY)+this._lineWidth)},e.prototype._computeAlignment=function(t,e){null!=this._minX&&null!=this._minY&&(this._currentMeasure.left=this._minX-this._lineWidth/2,this._currentMeasure.top=this._minY-this._lineWidth/2)},e.prototype.dispose=function(){this.reset(),t.prototype.dispose.call(this)},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.MultiLine"]=R;var L=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._isChecked=!1,i._background="black",i._checkSizeRatio=.8,i._thickness=1,i.group="",i.onIsCheckedChangedObservable=new s.Observable,i.isPointerBlocker=!0,i}return n(e,t),Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness!==t&&(this._thickness=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(t){t=Math.max(Math.min(1,t),0),this._checkSizeRatio!==t&&(this._checkSizeRatio=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isChecked",{get:function(){return this._isChecked},set:function(t){var e=this;this._isChecked!==t&&(this._isChecked=t,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(t),this._isChecked&&this._host&&this._host.executeOnAllControls((function(t){if(t!==e&&void 0!==t.group){var i=t;i.group===e.group&&(i.isChecked=!1)}})))},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"RadioButton"},e.prototype._draw=function(t){t.save(),this._applyStates(t);var e=this._currentMeasure.width-this._thickness,i=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,t),t.fillStyle=this._isEnabled?this._background:this._disabledColor,t.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.strokeStyle=this.color,t.lineWidth=this._thickness,t.stroke(),this._isChecked){t.fillStyle=this._isEnabled?this.color:this._disabledColor;var r=e*this._checkSizeRatio,n=i*this._checkSizeRatio;_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,r/2-this._thickness/2,n/2-this._thickness/2,t),t.fill()}t.restore()},e.prototype._onPointerDown=function(e,i,r,n,o){return!!t.prototype._onPointerDown.call(this,e,i,r,n,o)&&(this.isChecked||(this.isChecked=!0),!0)},e.AddRadioButtonWithHeader=function(t,i,r,n){var o=new O;o.isVertical=!1,o.height="30px";var s=new e;s.width="20px",s.height="20px",s.isChecked=r,s.color="green",s.group=i,s.onIsCheckedChangedObservable.add((function(t){return n(s,t)})),o.addControl(s);var a=new v;return a.text=t,a.width="180px",a.paddingLeft="5px",a.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,a.color="white",o.addControl(a),o},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.RadioButton"]=L;var N=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._thumbWidth=new a(20,a.UNITMODE_PIXEL,!1),i._minimum=0,i._maximum=100,i._value=50,i._isVertical=!1,i._barOffset=new a(5,a.UNITMODE_PIXEL,!1),i._isThumbClamped=!1,i._displayThumb=!0,i._step=0,i._lastPointerDownID=-1,i._effectiveBarOffset=0,i.onValueChangedObservable=new s.Observable,i._pointerIsDown=!1,i.isPointerBlocker=!0,i}return n(e,t),Object.defineProperty(e.prototype,"displayThumb",{get:function(){return this._displayThumb},set:function(t){this._displayThumb!==t&&(this._displayThumb=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){this._step!==t&&(this._step=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barOffset",{get:function(){return this._barOffset.toString(this._host)},set:function(t){this._barOffset.toString(this._host)!==t&&this._barOffset.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barOffsetInPixels",{get:function(){return this._barOffset.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbWidth",{get:function(){return this._thumbWidth.toString(this._host)},set:function(t){this._thumbWidth.toString(this._host)!==t&&this._thumbWidth.fromString(t)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbWidthInPixels",{get:function(){return this._thumbWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimum",{get:function(){return this._minimum},set:function(t){this._minimum!==t&&(this._minimum=t,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maximum",{get:function(){return this._maximum},set:function(t){this._maximum!==t&&(this._maximum=t,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t=Math.max(Math.min(t,this._maximum),this._minimum),this._value!==t&&(this._value=t,this._markAsDirty(),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(t){this._isVertical!==t&&(this._isVertical=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isThumbClamped",{get:function(){return this._isThumbClamped},set:function(t){this._isThumbClamped!==t&&(this._isThumbClamped=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"BaseSlider"},e.prototype._getThumbPosition=function(){return this.isVertical?(this.maximum-this.value)/(this.maximum-this.minimum)*this._backgroundBoxLength:(this.value-this.minimum)/(this.maximum-this.minimum)*this._backgroundBoxLength},e.prototype._getThumbThickness=function(t){var e=0;switch(t){case"circle":e=this._thumbWidth.isPixel?Math.max(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host);break;case"rectangle":e=this._thumbWidth.isPixel?Math.min(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)}return e},e.prototype._prepareRenderingData=function(t){this._effectiveBarOffset=0,this._renderLeft=this._currentMeasure.left,this._renderTop=this._currentMeasure.top,this._renderWidth=this._currentMeasure.width,this._renderHeight=this._currentMeasure.height,this._backgroundBoxLength=Math.max(this._currentMeasure.width,this._currentMeasure.height),this._backgroundBoxThickness=Math.min(this._currentMeasure.width,this._currentMeasure.height),this._effectiveThumbThickness=this._getThumbThickness(t),this.displayThumb&&(this._backgroundBoxLength-=this._effectiveThumbThickness),this.isVertical&&this._currentMeasure.height<this._currentMeasure.width?console.error("Height should be greater than width"):(this._barOffset.isPixel?this._effectiveBarOffset=Math.min(this._barOffset.getValue(this._host),this._backgroundBoxThickness):this._effectiveBarOffset=this._backgroundBoxThickness*this._barOffset.getValue(this._host),this._backgroundBoxThickness-=2*this._effectiveBarOffset,this.isVertical?(this._renderLeft+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderTop+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxLength,this._renderWidth=this._backgroundBoxThickness):(this._renderTop+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderLeft+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxThickness,this._renderWidth=this._backgroundBoxLength))},e.prototype._updateValueFromPointer=function(t,e){var i;0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(t,e,this._transformedPosition),t=this._transformedPosition.x,e=this._transformedPosition.y),i=this._isVertical?this._minimum+(1-(e-this._currentMeasure.top)/this._currentMeasure.height)*(this._maximum-this._minimum):this._minimum+(t-this._currentMeasure.left)/this._currentMeasure.width*(this._maximum-this._minimum);var r=1/this._step|0;this.value=this._step?(i*r|0)/r:i},e.prototype._onPointerDown=function(e,i,r,n,o){return!!t.prototype._onPointerDown.call(this,e,i,r,n,o)&&(this._pointerIsDown=!0,this._updateValueFromPointer(i.x,i.y),this._host._capturingControl[r]=this,this._lastPointerDownID=r,!0)},e.prototype._onPointerMove=function(e,i,r,n){r==this._lastPointerDownID&&(this._pointerIsDown&&this._updateValueFromPointer(i.x,i.y),t.prototype._onPointerMove.call(this,e,i,r,n))},e.prototype._onPointerUp=function(e,i,r,n,o){this._pointerIsDown=!1,delete this._host._capturingControl[r],t.prototype._onPointerUp.call(this,e,i,r,n,o)},e.prototype._onCanvasBlur=function(){this._forcePointerUp(),t.prototype._onCanvasBlur.call(this)},e}(_),k=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._background="black",i._borderColor="white",i._thumbColor="",i._isThumbCircle=!1,i._displayValueBar=!0,i}return n(e,t),Object.defineProperty(e.prototype,"displayValueBar",{get:function(){return this._displayValueBar},set:function(t){this._displayValueBar!==t&&(this._displayValueBar=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor},set:function(t){this._borderColor!==t&&(this._borderColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbColor",{get:function(){return this._thumbColor},set:function(t){this._thumbColor!==t&&(this._thumbColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isThumbCircle",{get:function(){return this._isThumbCircle},set:function(t){this._isThumbCircle!==t&&(this._isThumbCircle=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Slider"},e.prototype._draw=function(t,e){t.save(),this._applyStates(t),this._prepareRenderingData(this.isThumbCircle?"circle":"rectangle");var i=this._renderLeft,r=this._renderTop,n=this._renderWidth,o=this._renderHeight,s=0;this.isThumbClamped&&this.isThumbCircle?(this.isVertical?r+=this._effectiveThumbThickness/2:i+=this._effectiveThumbThickness/2,s=this._backgroundBoxThickness/2):s=(this._effectiveThumbThickness-this._effectiveBarOffset)/2,(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY);var a=this._getThumbPosition();t.fillStyle=this._background,this.isVertical?this.isThumbClamped?this.isThumbCircle?(t.beginPath(),t.arc(i+this._backgroundBoxThickness/2,r,s,Math.PI,2*Math.PI),t.fill(),t.fillRect(i,r,n,o)):t.fillRect(i,r,n,o+this._effectiveThumbThickness):t.fillRect(i,r,n,o):this.isThumbClamped?this.isThumbCircle?(t.beginPath(),t.arc(i+this._backgroundBoxLength,r+this._backgroundBoxThickness/2,s,0,2*Math.PI),t.fill(),t.fillRect(i,r,n,o)):t.fillRect(i,r,n+this._effectiveThumbThickness,o):t.fillRect(i,r,n,o),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillStyle=this.color,this._displayValueBar&&(this.isVertical?this.isThumbClamped?this.isThumbCircle?(t.beginPath(),t.arc(i+this._backgroundBoxThickness/2,r+this._backgroundBoxLength,s,0,2*Math.PI),t.fill(),t.fillRect(i,r+a,n,o-a)):t.fillRect(i,r+a,n,o-a+this._effectiveThumbThickness):t.fillRect(i,r+a,n,o-a):this.isThumbClamped&&this.isThumbCircle?(t.beginPath(),t.arc(i,r+this._backgroundBoxThickness/2,s,0,2*Math.PI),t.fill(),t.fillRect(i,r,a,o)):t.fillRect(i,r,a,o)),t.fillStyle=this._thumbColor||this.color,this.displayThumb&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),this._isThumbCircle?(t.beginPath(),this.isVertical?t.arc(i+this._backgroundBoxThickness/2,r+a,s,0,2*Math.PI):t.arc(i+a,r+this._backgroundBoxThickness/2,s,0,2*Math.PI),t.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.strokeStyle=this._borderColor,t.stroke()):(this.isVertical?t.fillRect(i-this._effectiveBarOffset,this._currentMeasure.top+a,this._currentMeasure.width,this._effectiveThumbThickness):t.fillRect(this._currentMeasure.left+a,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.strokeStyle=this._borderColor,this.isVertical?t.strokeRect(i-this._effectiveBarOffset,this._currentMeasure.top+a,this._currentMeasure.width,this._effectiveThumbThickness):t.strokeRect(this._currentMeasure.left+a,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height))),t.restore()},e}(N);s._TypeStore.RegisteredTypes["BABYLON.GUI.Slider"]=k;var D=function(){function t(t){this.name=t,this._groupPanel=new O,this._selectors=new Array,this._groupPanel.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,this._groupPanel.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,this._groupHeader=this._addGroupHeader(t)}return Object.defineProperty(t.prototype,"groupPanel",{get:function(){return this._groupPanel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectors",{get:function(){return this._selectors},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return this._groupHeader.text},set:function(t){"label"!==this._groupHeader.text&&(this._groupHeader.text=t)},enumerable:!1,configurable:!0}),t.prototype._addGroupHeader=function(t){var e=new v("groupHead",t);return e.width=.9,e.height="30px",e.textWrapping=!0,e.color="black",e.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,e.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,e.left="2px",this._groupPanel.addControl(e),e},t.prototype._getSelector=function(t){if(!(t<0||t>=this._selectors.length))return this._selectors[t]},t.prototype.removeSelector=function(t){t<0||t>=this._selectors.length||(this._groupPanel.removeControl(this._selectors[t]),this._selectors.splice(t,1))},t}(),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.addCheckbox=function(t,e,i){void 0===e&&(e=function(t){}),void 0===i&&(i=!1),i=i||!1;var r=new E;r.width="20px",r.height="20px",r.color="#364249",r.background="#CCCCCC",r.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r.onIsCheckedChangedObservable.add((function(t){e(t)}));var n=_.AddHeader(r,t,"200px",{isHorizontal:!0,controlFirst:!0});n.height="30px",n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.left="4px",this.groupPanel.addControl(n),this.selectors.push(n),r.isChecked=i,this.groupPanel.parent&&this.groupPanel.parent.parent&&(r.color=this.groupPanel.parent.parent.buttonColor,r.background=this.groupPanel.parent.parent.buttonBackground)},e.prototype._setSelectorLabel=function(t,e){this.selectors[t].children[1].text=e},e.prototype._setSelectorLabelColor=function(t,e){this.selectors[t].children[1].color=e},e.prototype._setSelectorButtonColor=function(t,e){this.selectors[t].children[0].color=e},e.prototype._setSelectorButtonBackground=function(t,e){this.selectors[t].children[0].background=e},e}(D),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectNb=0,e}return n(e,t),e.prototype.addRadio=function(t,e,i){void 0===e&&(e=function(t){}),void 0===i&&(i=!1);var r=this._selectNb++,n=new L;n.name=t,n.width="20px",n.height="20px",n.color="#364249",n.background="#CCCCCC",n.group=this.name,n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.onIsCheckedChangedObservable.add((function(t){t&&e(r)}));var o=_.AddHeader(n,t,"200px",{isHorizontal:!0,controlFirst:!0});o.height="30px",o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.left="4px",this.groupPanel.addControl(o),this.selectors.push(o),n.isChecked=i,this.groupPanel.parent&&this.groupPanel.parent.parent&&(n.color=this.groupPanel.parent.parent.buttonColor,n.background=this.groupPanel.parent.parent.buttonBackground)},e.prototype._setSelectorLabel=function(t,e){this.selectors[t].children[1].text=e},e.prototype._setSelectorLabelColor=function(t,e){this.selectors[t].children[1].color=e},e.prototype._setSelectorButtonColor=function(t,e){this.selectors[t].children[0].color=e},e.prototype._setSelectorButtonBackground=function(t,e){this.selectors[t].children[0].background=e},e}(D),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.addSlider=function(t,e,i,r,n,o,s){void 0===e&&(e=function(t){}),void 0===i&&(i="Units"),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=function(t){return 0|t});var a=new k;a.name=i,a.value=o,a.minimum=r,a.maximum=n,a.width=.9,a.height="20px",a.color="#364249",a.background="#CCCCCC",a.borderColor="black",a.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,a.left="4px",a.paddingBottom="4px",a.onValueChangedObservable.add((function(t){a.parent.children[0].text=a.parent.children[0].name+": "+s(t)+" "+a.name,e(t)}));var l=_.AddHeader(a,t+": "+s(o)+" "+i,"30px",{isHorizontal:!1,controlFirst:!1});l.height="60px",l.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,l.left="4px",l.children[0].name=t,this.groupPanel.addControl(l),this.selectors.push(l),this.groupPanel.parent&&this.groupPanel.parent.parent&&(a.color=this.groupPanel.parent.parent.buttonColor,a.background=this.groupPanel.parent.parent.buttonBackground)},e.prototype._setSelectorLabel=function(t,e){this.selectors[t].children[0].name=e,this.selectors[t].children[0].text=e+": "+this.selectors[t].children[1].value+" "+this.selectors[t].children[1].name},e.prototype._setSelectorLabelColor=function(t,e){this.selectors[t].children[0].color=e},e.prototype._setSelectorButtonColor=function(t,e){this.selectors[t].children[1].color=e},e.prototype._setSelectorButtonBackground=function(t,e){this.selectors[t].children[1].background=e},e}(D),j=function(t){function e(e,i){void 0===i&&(i=[]);var r=t.call(this,e)||this;if(r.name=e,r.groups=i,r._buttonColor="#364249",r._buttonBackground="#CCCCCC",r._headerColor="black",r._barColor="white",r._barHeight="2px",r._spacerHeight="20px",r._bars=new Array,r._groups=i,r.thickness=2,r._panel=new O,r._panel.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r._panel.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._panel.top=5,r._panel.left=5,r._panel.width=.95,i.length>0){for(var n=0;n<i.length-1;n++)r._panel.addControl(i[n].groupPanel),r._addSpacer();r._panel.addControl(i[i.length-1].groupPanel)}return r.addControl(r._panel),r}return n(e,t),e.prototype._getTypeName=function(){return"SelectionPanel"},Object.defineProperty(e.prototype,"panel",{get:function(){return this._panel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headerColor",{get:function(){return this._headerColor},set:function(t){this._headerColor!==t&&(this._headerColor=t,this._setHeaderColor())},enumerable:!1,configurable:!0}),e.prototype._setHeaderColor=function(){for(var t=0;t<this._groups.length;t++)this._groups[t].groupPanel.children[0].color=this._headerColor},Object.defineProperty(e.prototype,"buttonColor",{get:function(){return this._buttonColor},set:function(t){this._buttonColor!==t&&(this._buttonColor=t,this._setbuttonColor())},enumerable:!1,configurable:!0}),e.prototype._setbuttonColor=function(){for(var t=0;t<this._groups.length;t++)for(var e=0;e<this._groups[t].selectors.length;e++)this._groups[t]._setSelectorButtonColor(e,this._buttonColor)},Object.defineProperty(e.prototype,"labelColor",{get:function(){return this._labelColor},set:function(t){this._labelColor!==t&&(this._labelColor=t,this._setLabelColor())},enumerable:!1,configurable:!0}),e.prototype._setLabelColor=function(){for(var t=0;t<this._groups.length;t++)for(var e=0;e<this._groups[t].selectors.length;e++)this._groups[t]._setSelectorLabelColor(e,this._labelColor)},Object.defineProperty(e.prototype,"buttonBackground",{get:function(){return this._buttonBackground},set:function(t){this._buttonBackground!==t&&(this._buttonBackground=t,this._setButtonBackground())},enumerable:!1,configurable:!0}),e.prototype._setButtonBackground=function(){for(var t=0;t<this._groups.length;t++)for(var e=0;e<this._groups[t].selectors.length;e++)this._groups[t]._setSelectorButtonBackground(e,this._buttonBackground)},Object.defineProperty(e.prototype,"barColor",{get:function(){return this._barColor},set:function(t){this._barColor!==t&&(this._barColor=t,this._setBarColor())},enumerable:!1,configurable:!0}),e.prototype._setBarColor=function(){for(var t=0;t<this._bars.length;t++)this._bars[t].children[0].background=this._barColor},Object.defineProperty(e.prototype,"barHeight",{get:function(){return this._barHeight},set:function(t){this._barHeight!==t&&(this._barHeight=t,this._setBarHeight())},enumerable:!1,configurable:!0}),e.prototype._setBarHeight=function(){for(var t=0;t<this._bars.length;t++)this._bars[t].children[0].height=this._barHeight},Object.defineProperty(e.prototype,"spacerHeight",{get:function(){return this._spacerHeight},set:function(t){this._spacerHeight!==t&&(this._spacerHeight=t,this._setSpacerHeight())},enumerable:!1,configurable:!0}),e.prototype._setSpacerHeight=function(){for(var t=0;t<this._bars.length;t++)this._bars[t].height=this._spacerHeight},e.prototype._addSpacer=function(){var t=new g;t.width=1,t.height=this._spacerHeight,t.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT;var e=new b;e.width=1,e.height=this._barHeight,e.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,e.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,e.background=this._barColor,e.color="transparent",t.addControl(e),this._panel.addControl(t),this._bars.push(t)},e.prototype.addGroup=function(t){this._groups.length>0&&this._addSpacer(),this._panel.addControl(t.groupPanel),this._groups.push(t),t.groupPanel.children[0].color=this._headerColor;for(var e=0;e<t.selectors.length;e++)t._setSelectorButtonColor(e,this._buttonColor),t._setSelectorButtonBackground(e,this._buttonBackground)},e.prototype.removeGroup=function(t){if(!(t<0||t>=this._groups.length)){var e=this._groups[t];this._panel.removeControl(e.groupPanel),this._groups.splice(t,1),t<this._bars.length&&(this._panel.removeControl(this._bars[t]),this._bars.splice(t,1))}},e.prototype.setHeaderName=function(t,e){e<0||e>=this._groups.length||(this._groups[e].groupPanel.children[0].text=t)},e.prototype.relabel=function(t,e,i){if(!(e<0||e>=this._groups.length)){var r=this._groups[e];i<0||i>=r.selectors.length||r._setSelectorLabel(i,t)}},e.prototype.removeFromGroupSelector=function(t,e){if(!(t<0||t>=this._groups.length)){var i=this._groups[t];e<0||e>=i.selectors.length||i.removeSelector(e)}},e.prototype.addToGroupCheckbox=function(t,e,i,r){void 0===i&&(i=function(){}),void 0===r&&(r=!1),t<0||t>=this._groups.length||this._groups[t].addCheckbox(e,i,r)},e.prototype.addToGroupRadio=function(t,e,i,r){void 0===i&&(i=function(){}),void 0===r&&(r=!1),t<0||t>=this._groups.length||this._groups[t].addRadio(e,i,r)},e.prototype.addToGroupSlider=function(t,e,i,r,n,o,s,a){void 0===i&&(i=function(){}),void 0===r&&(r="Units"),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=function(t){return 0|t}),t<0||t>=this._groups.length||this._groups[t].addSlider(e,i,r,n,o,s,a)},e}(b),H=function(t){function e(e){var i=t.call(this,e)||this;return i._freezeControls=!1,i._bucketWidth=0,i._bucketHeight=0,i._buckets={},i}return n(e,t),Object.defineProperty(e.prototype,"freezeControls",{get:function(){return this._freezeControls},set:function(t){if(this._freezeControls!==t){t||this._restoreMeasures(),this._freezeControls=!1;var e=this.host.getSize(),i=e.width,r=e.height,n=this.host.getContext(),o=new d(0,0,i,r);this.host._numLayoutCalls=0,this.host._rootContainer._layout(o,n),t&&(this._updateMeasures(),this._useBuckets()&&this._makeBuckets()),this._freezeControls=t,this.host.markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucketWidth",{get:function(){return this._bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucketHeight",{get:function(){return this._bucketHeight},enumerable:!1,configurable:!0}),e.prototype.setBucketSizes=function(t,e){this._bucketWidth=t,this._bucketHeight=e,this._useBuckets()?this._freezeControls&&this._makeBuckets():this._buckets={}},e.prototype._useBuckets=function(){return this._bucketWidth>0&&this._bucketHeight>0},e.prototype._makeBuckets=function(){this._buckets={},this._bucketLen=Math.ceil(this.widthInPixels/this._bucketWidth),this._dispatchInBuckets(this._children),this._oldLeft=null,this._oldTop=null},e.prototype._dispatchInBuckets=function(t){for(var e=0;e<t.length;++e){for(var i=t[e],r=Math.max(0,Math.floor((i._customData._origLeft-this._customData.origLeft)/this._bucketWidth)),n=Math.floor((i._customData._origLeft-this._customData.origLeft+i._currentMeasure.width-1)/this._bucketWidth),o=Math.max(0,Math.floor((i._customData._origTop-this._customData.origTop)/this._bucketHeight)),s=Math.floor((i._customData._origTop-this._customData.origTop+i._currentMeasure.height-1)/this._bucketHeight);o<=s;){for(var a=r;a<=n;++a){var l=o*this._bucketLen+a,h=this._buckets[l];h||(h=[],this._buckets[l]=h),h.push(i)}o++}i instanceof g&&i._children.length>0&&this._dispatchInBuckets(i._children)}},e.prototype._updateMeasures=function(){var t=0|this.leftInPixels,e=0|this.topInPixels;this._measureForChildren.left-=t,this._measureForChildren.top-=e,this._currentMeasure.left-=t,this._currentMeasure.top-=e,this._customData.origLeftForChildren=this._measureForChildren.left,this._customData.origTopForChildren=this._measureForChildren.top,this._customData.origLeft=this._currentMeasure.left,this._customData.origTop=this._currentMeasure.top,this._updateChildrenMeasures(this._children,t,e)},e.prototype._updateChildrenMeasures=function(t,e,i){for(var r=0;r<t.length;++r){var n=t[r];n._currentMeasure.left-=e,n._currentMeasure.top-=i,n._customData._origLeft=n._currentMeasure.left,n._customData._origTop=n._currentMeasure.top,n instanceof g&&n._children.length>0&&this._updateChildrenMeasures(n._children,e,i)}},e.prototype._restoreMeasures=function(){var t=0|this.leftInPixels,e=0|this.topInPixels;this._measureForChildren.left=this._customData.origLeftForChildren+t,this._measureForChildren.top=this._customData.origTopForChildren+e,this._currentMeasure.left=this._customData.origLeft+t,this._currentMeasure.top=this._customData.origTop+e},e.prototype._getTypeName=function(){return"ScrollViewerWindow"},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._parentMeasure=e,this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this._measureForChildren.width=e.width,this._measureForChildren.height=e.height},e.prototype._layout=function(e,i){return this._freezeControls?(this.invalidateRect(),!1):t.prototype._layout.call(this,e,i)},e.prototype._scrollChildren=function(t,e,i){for(var r=0;r<t.length;++r){var n=t[r];n._currentMeasure.left=n._customData._origLeft+e,n._currentMeasure.top=n._customData._origTop+i,n._isClipped=!1,n instanceof g&&n._children.length>0&&this._scrollChildren(n._children,e,i)}},e.prototype._scrollChildrenWithBuckets=function(t,e,i,r){for(var n=Math.max(0,Math.floor(-t/this._bucketWidth)),o=Math.floor((-t+this._parentMeasure.width-1)/this._bucketWidth),s=Math.max(0,Math.floor(-e/this._bucketHeight)),a=Math.floor((-e+this._parentMeasure.height-1)/this._bucketHeight);s<=a;){for(var l=n;l<=o;++l){var h=s*this._bucketLen+l,c=this._buckets[h];if(c)for(var u=0;u<c.length;++u){var d=c[u];d._currentMeasure.left=d._customData._origLeft+i,d._currentMeasure.top=d._customData._origTop+r,d._isClipped=!1}}s++}},e.prototype._draw=function(e,i){if(this._freezeControls){this._localDraw(e),this.clipChildren&&this._clipForChildren(e);var r=0|this.leftInPixels,n=0|this.topInPixels;this._useBuckets()&&null!==this._oldLeft&&null!==this._oldTop?(this._scrollChildrenWithBuckets(this._oldLeft,this._oldTop,r,n),this._scrollChildrenWithBuckets(r,n,r,n)):this._scrollChildren(this._children,r,n),this._oldLeft=r,this._oldTop=n;for(var o=0,s=this._children;o<s.length;o++){var a=s[o];a._intersectsRect(this._parentMeasure)&&a._render(e,this._parentMeasure)}}else t.prototype._draw.call(this,e,i)},e.prototype._postMeasure=function(){if(this._freezeControls)t.prototype._postMeasure.call(this);else{for(var e=this.parentClientWidth,i=this.parentClientHeight,r=0,n=this.children;r<n.length;r++){var o=n[r];o.isVisible&&!o.notRenderable&&(o.horizontalAlignment===_.HORIZONTAL_ALIGNMENT_CENTER&&o._offsetLeft(this._currentMeasure.left-o._currentMeasure.left),o.verticalAlignment===_.VERTICAL_ALIGNMENT_CENTER&&o._offsetTop(this._currentMeasure.top-o._currentMeasure.top),e=Math.max(e,o._currentMeasure.left-this._currentMeasure.left+o._currentMeasure.width+o.paddingRightInPixels),i=Math.max(i,o._currentMeasure.top-this._currentMeasure.top+o._currentMeasure.height+o.paddingBottomInPixels))}this._currentMeasure.width!==e&&(this._width.updateInPlace(e,a.UNITMODE_PIXEL),this._currentMeasure.width=e,this._rebuildLayout=!0,this._isDirty=!0),this._currentMeasure.height!==i&&(this._height.updateInPlace(i,a.UNITMODE_PIXEL),this._currentMeasure.height=i,this._rebuildLayout=!0,this._isDirty=!0),t.prototype._postMeasure.call(this)}},e}(g),U=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._background="black",i._borderColor="white",i._tempMeasure=new d(0,0,0,0),i}return n(e,t),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor},set:function(t){this._borderColor!==t&&(this._borderColor=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Scrollbar"},e.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},e.prototype._draw=function(t){t.save(),this._applyStates(t),this._prepareRenderingData("rectangle");var e=this._renderLeft,i=this._getThumbPosition();t.fillStyle=this._background,t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),t.fillStyle=this.color,this.isVertical?(this._tempMeasure.left=e-this._effectiveBarOffset,this._tempMeasure.top=this._currentMeasure.top+i,this._tempMeasure.width=this._currentMeasure.width,this._tempMeasure.height=this._effectiveThumbThickness):(this._tempMeasure.left=this._currentMeasure.left+i,this._tempMeasure.top=this._currentMeasure.top,this._tempMeasure.width=this._effectiveThumbThickness,this._tempMeasure.height=this._currentMeasure.height),t.fillRect(this._tempMeasure.left,this._tempMeasure.top,this._tempMeasure.width,this._tempMeasure.height),t.restore()},e.prototype._updateValueFromPointer=function(t,e){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(t,e,this._transformedPosition),t=this._transformedPosition.x,e=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=t,this._originY=e,(t<this._tempMeasure.left||t>this._tempMeasure.left+this._tempMeasure.width||e<this._tempMeasure.top||e>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(e-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(t-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var i=0;i=this.isVertical?-(e-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(t-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=i*(this.maximum-this.minimum),this._originX=t,this._originY=e},e.prototype._onPointerDown=function(e,i,r,n,o){return this._first=!0,t.prototype._onPointerDown.call(this,e,i,r,n,o)},e}(N),G=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._thumbLength=.5,i._thumbHeight=1,i._barImageHeight=1,i._tempMeasure=new d(0,0,0,0),i.num90RotationInVerticalMode=1,i}return n(e,t),Object.defineProperty(e.prototype,"backgroundImage",{get:function(){return this._backgroundBaseImage},set:function(t){var e=this;this._backgroundBaseImage!==t&&(this._backgroundBaseImage=t,this.isVertical&&0!==this.num90RotationInVerticalMode?t.isLoaded?(this._backgroundImage=t._rotate90(this.num90RotationInVerticalMode,!0),this._markAsDirty()):t.onImageLoadedObservable.addOnce((function(){var i=t._rotate90(e.num90RotationInVerticalMode,!0);e._backgroundImage=i,i.isLoaded||i.onImageLoadedObservable.addOnce((function(){e._markAsDirty()})),e._markAsDirty()})):(this._backgroundImage=t,t&&!t.isLoaded&&t.onImageLoadedObservable.addOnce((function(){e._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbImage",{get:function(){return this._thumbBaseImage},set:function(t){var e=this;this._thumbBaseImage!==t&&(this._thumbBaseImage=t,this.isVertical&&0!==this.num90RotationInVerticalMode?t.isLoaded?(this._thumbImage=t._rotate90(-this.num90RotationInVerticalMode,!0),this._markAsDirty()):t.onImageLoadedObservable.addOnce((function(){var i=t._rotate90(-e.num90RotationInVerticalMode,!0);e._thumbImage=i,i.isLoaded||i.onImageLoadedObservable.addOnce((function(){e._markAsDirty()})),e._markAsDirty()})):(this._thumbImage=t,t&&!t.isLoaded&&t.onImageLoadedObservable.addOnce((function(){e._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(t){this._thumbLength!==t&&(this._thumbLength=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(t){this._thumbLength!==t&&(this._thumbHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(t){this._barImageHeight!==t&&(this._barImageHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"ImageScrollBar"},e.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},e.prototype._draw=function(t){t.save(),this._applyStates(t),this._prepareRenderingData("rectangle");var e=this._getThumbPosition(),i=this._renderLeft,r=this._renderTop,n=this._renderWidth,o=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(i,r,n,o),this.isVertical?(this._tempMeasure.copyFromFloats(i+n*(1-this._barImageHeight)*.5,this._currentMeasure.top,n*this._barImageHeight,o),this._tempMeasure.height+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)):(this._tempMeasure.copyFromFloats(this._currentMeasure.left,r+o*(1-this._barImageHeight)*.5,n,o*this._barImageHeight),this._tempMeasure.width+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)),this._backgroundImage._draw(t)),this.isVertical?this._tempMeasure.copyFromFloats(i-this._effectiveBarOffset+this._currentMeasure.width*(1-this._thumbHeight)*.5,this._currentMeasure.top+e,this._currentMeasure.width*this._thumbHeight,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+e,this._currentMeasure.top+this._currentMeasure.height*(1-this._thumbHeight)*.5,this._effectiveThumbThickness,this._currentMeasure.height*this._thumbHeight),this._thumbImage&&(this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(t)),t.restore()},e.prototype._updateValueFromPointer=function(t,e){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(t,e,this._transformedPosition),t=this._transformedPosition.x,e=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=t,this._originY=e,(t<this._tempMeasure.left||t>this._tempMeasure.left+this._tempMeasure.width||e<this._tempMeasure.top||e>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(e-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(t-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var i=0;i=this.isVertical?-(e-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(t-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=i*(this.maximum-this.minimum),this._originX=t,this._originY=e},e.prototype._onPointerDown=function(e,i,r,n,o){return this._first=!0,t.prototype._onPointerDown.call(this,e,i,r,n,o)},e}(N),W=function(t){function e(e,i){var r=t.call(this,e)||this;return r._barSize=20,r._pointerIsOver=!1,r._wheelPrecision=.05,r._thumbLength=.5,r._thumbHeight=1,r._barImageHeight=1,r._horizontalBarImageHeight=1,r._verticalBarImageHeight=1,r._oldWindowContentsWidth=0,r._oldWindowContentsHeight=0,r._forceHorizontalBar=!1,r._forceVerticalBar=!1,r._useImageBar=i||!1,r.onDirtyObservable.add((function(){r._horizontalBarSpace.color=r.color,r._verticalBarSpace.color=r.color,r._dragSpace.color=r.color})),r.onPointerEnterObservable.add((function(){r._pointerIsOver=!0})),r.onPointerOutObservable.add((function(){r._pointerIsOver=!1})),r._grid=new x,r._useImageBar?(r._horizontalBar=new G,r._verticalBar=new G):(r._horizontalBar=new U,r._verticalBar=new U),r._window=new H("scrollViewer_window"),r._window.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._window.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r._grid.addColumnDefinition(1),r._grid.addColumnDefinition(0,!0),r._grid.addRowDefinition(1),r._grid.addRowDefinition(0,!0),t.prototype.addControl.call(r,r._grid),r._grid.addControl(r._window,0,0),r._verticalBarSpace=new b,r._verticalBarSpace.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._verticalBarSpace.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r._verticalBarSpace.thickness=1,r._grid.addControl(r._verticalBarSpace,0,1),r._addBar(r._verticalBar,r._verticalBarSpace,!0,Math.PI),r._horizontalBarSpace=new b,r._horizontalBarSpace.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._horizontalBarSpace.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r._horizontalBarSpace.thickness=1,r._grid.addControl(r._horizontalBarSpace,1,0),r._addBar(r._horizontalBar,r._horizontalBarSpace,!1,0),r._dragSpace=new b,r._dragSpace.thickness=1,r._grid.addControl(r._dragSpace,1,1),r._useImageBar||(r.barColor="grey",r.barBackground="transparent"),r}return n(e,t),Object.defineProperty(e.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!1,configurable:!0}),e.prototype.addControl=function(t){return t?(this._window.addControl(t),this):this},e.prototype.removeControl=function(t){return this._window.removeControl(t),this},Object.defineProperty(e.prototype,"children",{get:function(){return this._window.children},enumerable:!1,configurable:!0}),e.prototype._flagDescendantsAsMatrixDirty=function(){for(var t=0,e=this._children;t<e.length;t++)e[t]._markMatrixAsDirty()},Object.defineProperty(e.prototype,"freezeControls",{get:function(){return this._window.freezeControls},set:function(t){this._window.freezeControls=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucketWidth",{get:function(){return this._window.bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucketHeight",{get:function(){return this._window.bucketHeight},enumerable:!1,configurable:!0}),e.prototype.setBucketSizes=function(t,e){this._window.setBucketSizes(t,e)},Object.defineProperty(e.prototype,"forceHorizontalBar",{get:function(){return this._forceHorizontalBar},set:function(t){this._grid.setRowDefinition(1,t?this._barSize:0,!0),this._horizontalBar.isVisible=t,this._forceHorizontalBar=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forceVerticalBar",{get:function(){return this._forceVerticalBar},set:function(t){this._grid.setColumnDefinition(1,t?this._barSize:0,!0),this._verticalBar.isVisible=t,this._forceVerticalBar=t},enumerable:!1,configurable:!0}),e.prototype.resetWindow=function(){this._window.width="100%",this._window.height="100%"},e.prototype._getTypeName=function(){return"ScrollViewer"},e.prototype._buildClientSizes=function(){var t=this.host.idealRatio;this._window.parentClientWidth=this._currentMeasure.width-(this._verticalBar.isVisible||this.forceVerticalBar?this._barSize*t:0)-2*this.thickness,this._window.parentClientHeight=this._currentMeasure.height-(this._horizontalBar.isVisible||this.forceHorizontalBar?this._barSize*t:0)-2*this.thickness,this._clientWidth=this._window.parentClientWidth,this._clientHeight=this._window.parentClientHeight},e.prototype._additionalProcessing=function(e,i){t.prototype._additionalProcessing.call(this,e,i),this._buildClientSizes()},e.prototype._postMeasure=function(){t.prototype._postMeasure.call(this),this._updateScroller(),this._setWindowPosition(!1)},Object.defineProperty(e.prototype,"wheelPrecision",{get:function(){return this._wheelPrecision},set:function(t){this._wheelPrecision!==t&&(t<0&&(t=0),t>1&&(t=1),this._wheelPrecision=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollBackground",{get:function(){return this._horizontalBarSpace.background},set:function(t){this._horizontalBarSpace.background!==t&&(this._horizontalBarSpace.background=t,this._verticalBarSpace.background=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barColor",{get:function(){return this._barColor},set:function(t){this._barColor!==t&&(this._barColor=t,this._horizontalBar.color=t,this._verticalBar.color=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbImage",{get:function(){return this._barImage},set:function(t){if(this._barImage!==t){this._barImage=t;var e=this._horizontalBar,i=this._verticalBar;e.thumbImage=t,i.thumbImage=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalThumbImage",{get:function(){return this._horizontalBarImage},set:function(t){this._horizontalBarImage!==t&&(this._horizontalBarImage=t,this._horizontalBar.thumbImage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalThumbImage",{get:function(){return this._verticalBarImage},set:function(t){this._verticalBarImage!==t&&(this._verticalBarImage=t,this._verticalBar.thumbImage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barSize",{get:function(){return this._barSize},set:function(t){this._barSize!==t&&(this._barSize=t,this._markAsDirty(),this._horizontalBar.isVisible&&this._grid.setRowDefinition(1,this._barSize,!0),this._verticalBar.isVisible&&this._grid.setColumnDefinition(1,this._barSize,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(t){if(this._thumbLength!==t){t<=0&&(t=.1),t>1&&(t=1),this._thumbLength=t;var e=this._horizontalBar,i=this._verticalBar;e.thumbLength=t,i.thumbLength=t,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(t){if(this._thumbHeight!==t){t<=0&&(t=.1),t>1&&(t=1),this._thumbHeight=t;var e=this._horizontalBar,i=this._verticalBar;e.thumbHeight=t,i.thumbHeight=t,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(t){if(this._barImageHeight!==t){t<=0&&(t=.1),t>1&&(t=1),this._barImageHeight=t;var e=this._horizontalBar,i=this._verticalBar;e.barImageHeight=t,i.barImageHeight=t,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalBarImageHeight",{get:function(){return this._horizontalBarImageHeight},set:function(t){this._horizontalBarImageHeight!==t&&(t<=0&&(t=.1),t>1&&(t=1),this._horizontalBarImageHeight=t,this._horizontalBar.barImageHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalBarImageHeight",{get:function(){return this._verticalBarImageHeight},set:function(t){this._verticalBarImageHeight!==t&&(t<=0&&(t=.1),t>1&&(t=1),this._verticalBarImageHeight=t,this._verticalBar.barImageHeight=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barBackground",{get:function(){return this._barBackground},set:function(t){if(this._barBackground!==t){this._barBackground=t;var e=this._horizontalBar,i=this._verticalBar;e.background=t,i.background=t,this._dragSpace.background=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barImage",{get:function(){return this._barBackgroundImage},set:function(t){this._barBackgroundImage,this._barBackgroundImage=t;var e=this._horizontalBar,i=this._verticalBar;e.backgroundImage=t,i.backgroundImage=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalBarImage",{get:function(){return this._horizontalBarBackgroundImage},set:function(t){this._horizontalBarBackgroundImage,this._horizontalBarBackgroundImage=t,this._horizontalBar.backgroundImage=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalBarImage",{get:function(){return this._verticalBarBackgroundImage},set:function(t){this._verticalBarBackgroundImage,this._verticalBarBackgroundImage=t,this._verticalBar.backgroundImage=t},enumerable:!1,configurable:!0}),e.prototype._setWindowPosition=function(t){void 0===t&&(t=!0);var e=this.host.idealRatio,i=this._window._currentMeasure.width,r=this._window._currentMeasure.height;if(t||this._oldWindowContentsWidth!==i||this._oldWindowContentsHeight!==r){this._oldWindowContentsWidth=i,this._oldWindowContentsHeight=r;var n=this._clientWidth-i,o=this._clientHeight-r,s=this._horizontalBar.value/e*n+"px",a=this._verticalBar.value/e*o+"px";s!==this._window.left&&(this._window.left=s,this.freezeControls||(this._rebuildLayout=!0)),a!==this._window.top&&(this._window.top=a,this.freezeControls||(this._rebuildLayout=!0))}},e.prototype._updateScroller=function(){var t=this._window._currentMeasure.width,e=this._window._currentMeasure.height;this._horizontalBar.isVisible&&t<=this._clientWidth&&!this.forceHorizontalBar?(this._grid.setRowDefinition(1,0,!0),this._horizontalBar.isVisible=!1,this._horizontalBar.value=0,this._rebuildLayout=!0):!this._horizontalBar.isVisible&&(t>this._clientWidth||this.forceHorizontalBar)&&(this._grid.setRowDefinition(1,this._barSize,!0),this._horizontalBar.isVisible=!0,this._rebuildLayout=!0),this._verticalBar.isVisible&&e<=this._clientHeight&&!this.forceVerticalBar?(this._grid.setColumnDefinition(1,0,!0),this._verticalBar.isVisible=!1,this._verticalBar.value=0,this._rebuildLayout=!0):!this._verticalBar.isVisible&&(e>this._clientHeight||this.forceVerticalBar)&&(this._grid.setColumnDefinition(1,this._barSize,!0),this._verticalBar.isVisible=!0,this._rebuildLayout=!0),this._buildClientSizes();var i=this.host.idealRatio;this._horizontalBar.thumbWidth=.9*this._thumbLength*(this._clientWidth/i)+"px",this._verticalBar.thumbWidth=.9*this._thumbLength*(this._clientHeight/i)+"px"},e.prototype._link=function(e){t.prototype._link.call(this,e),this._attachWheel()},e.prototype._addBar=function(t,e,i,r){var n=this;t.paddingLeft=0,t.width="100%",t.height="100%",t.barOffset=0,t.value=0,t.maximum=1,t.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,t.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,t.isVertical=i,t.rotation=r,t.isVisible=!1,e.addControl(t),t.onValueChangedObservable.add((function(t){n._setWindowPosition()}))},e.prototype._attachWheel=function(){var t=this;this._host&&!this._onWheelObserver&&(this._onWheelObserver=this.onWheelObservable.add((function(e){t._pointerIsOver&&(1==t._verticalBar.isVisible&&(e.y<0&&t._verticalBar.value>0?t._verticalBar.value-=t._wheelPrecision:e.y>0&&t._verticalBar.value<t._verticalBar.maximum&&(t._verticalBar.value+=t._wheelPrecision)),1==t._horizontalBar.isVisible&&(e.x<0&&t._horizontalBar.value<t._horizontalBar.maximum?t._horizontalBar.value+=t._wheelPrecision:e.x>0&&t._horizontalBar.value>0&&(t._horizontalBar.value-=t._wheelPrecision)))})))},e.prototype._renderHighlightSpecific=function(e){this.isHighlighted&&(t.prototype._renderHighlightSpecific.call(this,e),this._grid._renderHighlightSpecific(e),e.restore())},e.prototype.dispose=function(){this.onWheelObservable.remove(this._onWheelObserver),this._onWheelObserver=null,t.prototype.dispose.call(this)},e}(b);s._TypeStore.RegisteredTypes["BABYLON.GUI.ScrollViewer"]=W;var z=function(){},X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onKeyPressObservable=new s.Observable,e.defaultButtonWidth="40px",e.defaultButtonHeight="40px",e.defaultButtonPaddingLeft="2px",e.defaultButtonPaddingRight="2px",e.defaultButtonPaddingTop="2px",e.defaultButtonPaddingBottom="2px",e.defaultButtonColor="#DDD",e.defaultButtonBackground="#070707",e.shiftButtonColor="#7799FF",e.selectedShiftThickness=1,e.shiftState=0,e._currentlyConnectedInputText=null,e._connectedInputTexts=[],e._onKeyPressObserver=null,e}return n(e,t),e.prototype._getTypeName=function(){return"VirtualKeyboard"},e.prototype._createKey=function(t,e){var i=this,r=T.CreateSimpleButton(t,t);return r.width=e&&e.width?e.width:this.defaultButtonWidth,r.height=e&&e.height?e.height:this.defaultButtonHeight,r.color=e&&e.color?e.color:this.defaultButtonColor,r.background=e&&e.background?e.background:this.defaultButtonBackground,r.paddingLeft=e&&e.paddingLeft?e.paddingLeft:this.defaultButtonPaddingLeft,r.paddingRight=e&&e.paddingRight?e.paddingRight:this.defaultButtonPaddingRight,r.paddingTop=e&&e.paddingTop?e.paddingTop:this.defaultButtonPaddingTop,r.paddingBottom=e&&e.paddingBottom?e.paddingBottom:this.defaultButtonPaddingBottom,r.thickness=0,r.isFocusInvisible=!0,r.shadowColor=this.shadowColor,r.shadowBlur=this.shadowBlur,r.shadowOffsetX=this.shadowOffsetX,r.shadowOffsetY=this.shadowOffsetY,r.onPointerUpObservable.add((function(){i.onKeyPressObservable.notifyObservers(t)})),r},e.prototype.addKeysRow=function(t,e){var i=new O;i.isVertical=!1,i.isFocusInvisible=!0;for(var r=null,n=0;n<t.length;n++){var o=null;e&&e.length===t.length&&(o=e[n]);var s=this._createKey(t[n],o);(!r||s.heightInPixels>r.heightInPixels)&&(r=s),i.addControl(s)}i.height=r?r.height:this.defaultButtonHeight,this.addControl(i)},e.prototype.applyShiftState=function(t){if(this.children)for(var e=0;e<this.children.length;e++){var i=this.children[e];if(i&&i.children)for(var r=i,n=0;n<r.children.length;n++){var o=r.children[n];if(o&&o.children[0]){var s=o.children[0];"⇧"===s.text&&(o.color=t?this.shiftButtonColor:this.defaultButtonColor,o.thickness=t>1?this.selectedShiftThickness:0),s.text=t>0?s.text.toUpperCase():s.text.toLowerCase()}}}},Object.defineProperty(e.prototype,"connectedInputText",{get:function(){return this._currentlyConnectedInputText},enumerable:!1,configurable:!0}),e.prototype.connect=function(t){var e=this;if(!this._connectedInputTexts.some((function(e){return e.input===t}))){null===this._onKeyPressObserver&&(this._onKeyPressObserver=this.onKeyPressObservable.add((function(t){if(e._currentlyConnectedInputText){switch(e._currentlyConnectedInputText._host.focusedControl=e._currentlyConnectedInputText,t){case"⇧":return e.shiftState++,e.shiftState>2&&(e.shiftState=0),void e.applyShiftState(e.shiftState);case"←":return void e._currentlyConnectedInputText.processKey(8);case"↵":return void e._currentlyConnectedInputText.processKey(13)}e._currentlyConnectedInputText.processKey(-1,e.shiftState?t.toUpperCase():t),1===e.shiftState&&(e.shiftState=0,e.applyShiftState(e.shiftState))}}))),this.isVisible=!1,this._currentlyConnectedInputText=t,t._connectedVirtualKeyboard=this;var i=t.onFocusObservable.add((function(){e._currentlyConnectedInputText=t,t._connectedVirtualKeyboard=e,e.isVisible=!0})),r=t.onBlurObservable.add((function(){t._connectedVirtualKeyboard=null,e._currentlyConnectedInputText=null,e.isVisible=!1}));this._connectedInputTexts.push({input:t,onBlurObserver:r,onFocusObserver:i})}},e.prototype.disconnect=function(t){var e=this;if(t){var i=this._connectedInputTexts.filter((function(e){return e.input===t}));1===i.length&&(this._removeConnectedInputObservables(i[0]),this._connectedInputTexts=this._connectedInputTexts.filter((function(e){return e.input!==t})),this._currentlyConnectedInputText===t&&(this._currentlyConnectedInputText=null))}else this._connectedInputTexts.forEach((function(t){e._removeConnectedInputObservables(t)})),this._connectedInputTexts=[];0===this._connectedInputTexts.length&&(this._currentlyConnectedInputText=null,this.onKeyPressObservable.remove(this._onKeyPressObserver),this._onKeyPressObserver=null)},e.prototype._removeConnectedInputObservables=function(t){t.input._connectedVirtualKeyboard=null,t.input.onFocusObservable.remove(t.onFocusObserver),t.input.onBlurObservable.remove(t.onBlurObserver)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disconnect()},e.CreateDefaultLayout=function(t){var i=new e(t);return i.addKeysRow(["1","2","3","4","5","6","7","8","9","0","←"]),i.addKeysRow(["q","w","e","r","t","y","u","i","o","p"]),i.addKeysRow(["a","s","d","f","g","h","j","k","l",";","'","↵"]),i.addKeysRow(["⇧","z","x","c","v","b","n","m",",",".","/"]),i.addKeysRow([" "],[{width:"200px"}]),i},e}(O);s._TypeStore.RegisteredTypes["BABYLON.GUI.VirtualKeyboard"]=X;var $=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._cellWidth=20,i._cellHeight=20,i._minorLineTickness=1,i._minorLineColor="DarkGray",i._majorLineTickness=2,i._majorLineColor="White",i._majorLineFrequency=5,i._background="Black",i._displayMajorLines=!0,i._displayMinorLines=!0,i}return n(e,t),Object.defineProperty(e.prototype,"displayMinorLines",{get:function(){return this._displayMinorLines},set:function(t){this._displayMinorLines!==t&&(this._displayMinorLines=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayMajorLines",{get:function(){return this._displayMajorLines},set:function(t){this._displayMajorLines!==t&&(this._displayMajorLines=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(t){this._cellWidth=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(t){this._cellHeight=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minorLineTickness",{get:function(){return this._minorLineTickness},set:function(t){this._minorLineTickness=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minorLineColor",{get:function(){return this._minorLineColor},set:function(t){this._minorLineColor=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"majorLineTickness",{get:function(){return this._majorLineTickness},set:function(t){this._majorLineTickness=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"majorLineColor",{get:function(){return this._majorLineColor},set:function(t){this._majorLineColor=t,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"majorLineFrequency",{get:function(){return this._majorLineFrequency},set:function(t){this._majorLineFrequency=t,this._markAsDirty()},enumerable:!1,configurable:!0}),e.prototype._draw=function(t,e){if(t.save(),this._applyStates(t),this._isEnabled){this._background&&(t.fillStyle=this._background,t.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));var i=this._currentMeasure.width/this._cellWidth,r=this._currentMeasure.height/this._cellHeight,n=this._currentMeasure.left+this._currentMeasure.width/2,o=this._currentMeasure.top+this._currentMeasure.height/2;if(this._displayMinorLines){t.strokeStyle=this._minorLineColor,t.lineWidth=this._minorLineTickness;for(var s=-i/2;s<i/2;s++){var a=n+s*this.cellWidth;t.beginPath(),t.moveTo(a,this._currentMeasure.top),t.lineTo(a,this._currentMeasure.top+this._currentMeasure.height),t.stroke()}for(var l=-r/2;l<r/2;l++){var h=o+l*this.cellHeight;t.beginPath(),t.moveTo(this._currentMeasure.left,h),t.lineTo(this._currentMeasure.left+this._currentMeasure.width,h),t.stroke()}}if(this._displayMajorLines){for(t.strokeStyle=this._majorLineColor,t.lineWidth=this._majorLineTickness,s=-i/2+this._majorLineFrequency;s<i/2;s+=this._majorLineFrequency)a=n+s*this.cellWidth,t.beginPath(),t.moveTo(a,this._currentMeasure.top),t.lineTo(a,this._currentMeasure.top+this._currentMeasure.height),t.stroke();for(l=-r/2+this._majorLineFrequency;l<r/2;l+=this._majorLineFrequency)h=o+l*this.cellHeight,t.moveTo(this._currentMeasure.left,h),t.lineTo(this._currentMeasure.left+this._currentMeasure.width,h),t.closePath(),t.stroke()}}t.restore()},e.prototype._getTypeName=function(){return"DisplayGrid"},e}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.DisplayGrid"]=$;var Y=function(t){function e(e){var i=t.call(this,e)||this;return i.name=e,i._tempMeasure=new d(0,0,0,0),i}return n(e,t),Object.defineProperty(e.prototype,"displayThumb",{get:function(){return this._displayThumb&&null!=this.thumbImage},set:function(t){this._displayThumb!==t&&(this._displayThumb=t,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundImage",{get:function(){return this._backgroundImage},set:function(t){var e=this;this._backgroundImage!==t&&(this._backgroundImage=t,t&&!t.isLoaded&&t.onImageLoadedObservable.addOnce((function(){return e._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueBarImage",{get:function(){return this._valueBarImage},set:function(t){var e=this;this._valueBarImage!==t&&(this._valueBarImage=t,t&&!t.isLoaded&&t.onImageLoadedObservable.addOnce((function(){return e._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbImage",{get:function(){return this._thumbImage},set:function(t){var e=this;this._thumbImage!==t&&(this._thumbImage=t,t&&!t.isLoaded&&t.onImageLoadedObservable.addOnce((function(){return e._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"ImageBasedSlider"},e.prototype._draw=function(t,e){t.save(),this._applyStates(t),this._prepareRenderingData("rectangle");var i=this._getThumbPosition(),r=this._renderLeft,n=this._renderTop,o=this._renderWidth,s=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(r,n,o,s),this.isThumbClamped&&this.displayThumb&&(this.isVertical?this._tempMeasure.height+=this._effectiveThumbThickness:this._tempMeasure.width+=this._effectiveThumbThickness),this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure),this._backgroundImage._draw(t)),this._valueBarImage&&(this.isVertical?this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(r,n+i,o,s-i+this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(r,n+i,o,s-i):this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(r,n,i+this._effectiveThumbThickness/2,s):this._tempMeasure.copyFromFloats(r,n,i,s),this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure),this._valueBarImage._draw(t)),this.displayThumb&&(this.isVertical?this._tempMeasure.copyFromFloats(r-this._effectiveBarOffset,this._currentMeasure.top+i,this._currentMeasure.width,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+i,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(t)),t.restore()},e}(N);s._TypeStore.RegisteredTypes["BABYLON.GUI.ImageBasedSlider"]=Y;var K="Statics";_.AddHeader=function(t,e,i,r){var n=new O("panel"),o=!r||r.isHorizontal,s=!r||r.controlFirst;n.isVertical=!o;var a=new v("header");return a.text=e,a.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o?a.width=i:a.height=i,s?(n.addControl(t),n.addControl(a),a.paddingLeft="5px"):(n.addControl(a),n.addControl(t),a.paddingRight="5px"),a.shadowBlur=t.shadowBlur,a.shadowColor=t.shadowColor,a.shadowOffsetX=t.shadowOffsetX,a.shadowOffsetY=t.shadowOffsetY,n};var q=function(){function t(t){this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new a(18,a.UNITMODE_PIXEL,!1),this.onChangedObservable=new s.Observable,this._host=t}return Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(t){this._fontSize.toString(this._host)!==t&&this._fontSize.fromString(t)&&this.onChangedObservable.notifyObservers(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.onChangedObservable.clear()},t}(),Z=function(t){function e(e,i,r,n,o,a,l){void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=!1),void 0===a&&(a=s.Texture.NEAREST_SAMPLINGMODE);var h=t.call(this,e,{width:i,height:r},n,o,a,s.Constants.TEXTUREFORMAT_RGBA,l)||this;return h._isDirty=!1,h._rootContainer=new g("root"),h._lastControlOver={},h._lastControlDown={},h._capturingControl={},h._linkedControls=new Array,h._isFullscreen=!1,h._fullscreenViewport=new s.Viewport(0,0,1,1),h._idealWidth=0,h._idealHeight=0,h._useSmallestIdeal=!1,h._renderAtIdealSize=!1,h._blockNextFocusCheck=!1,h._renderScale=1,h._cursorChanged=!1,h._defaultMousePointerId=0,h._numLayoutCalls=0,h._numRenderCalls=0,h._clipboardData="",h.onClipboardObservable=new s.Observable,h.onControlPickedObservable=new s.Observable,h.onBeginLayoutObservable=new s.Observable,h.onEndLayoutObservable=new s.Observable,h.onBeginRenderObservable=new s.Observable,h.onEndRenderObservable=new s.Observable,h.premulAlpha=!1,h.applyYInversionOnUpdate=!0,h._useInvalidateRectOptimization=!0,h._invalidatedRectangle=null,h._clearMeasure=new d(0,0,0,0),h.onClipboardCopy=function(t){var e=t,i=new s.ClipboardInfo(s.ClipboardEventTypes.COPY,e);h.onClipboardObservable.notifyObservers(i),e.preventDefault()},h.onClipboardCut=function(t){var e=t,i=new s.ClipboardInfo(s.ClipboardEventTypes.CUT,e);h.onClipboardObservable.notifyObservers(i),e.preventDefault()},h.onClipboardPaste=function(t){var e=t,i=new s.ClipboardInfo(s.ClipboardEventTypes.PASTE,e);h.onClipboardObservable.notifyObservers(i),e.preventDefault()},(n=h.getScene())&&h._texture?(h._rootElement=n.getEngine().getInputElement(),h._renderObserver=n.onBeforeCameraRenderObservable.add((function(t){return h._checkUpdate(t)})),h._preKeyboardObserver=n.onPreKeyboardObservable.add((function(t){h._focusedControl&&(t.type===s.KeyboardEventTypes.KEYDOWN&&h._focusedControl.processKeyboard(t.event),t.skipOnPointerObservable=!0)})),h._rootContainer._link(h),h.hasAlpha=!0,i&&r||(h._resizeObserver=n.getEngine().onResizeObservable.add((function(){return h._onResize()})),h._onResize()),h._texture.isReady=!0,h):h}return n(e,t),Object.defineProperty(e.prototype,"numLayoutCalls",{get:function(){return this._numLayoutCalls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numRenderCalls",{get:function(){return this._numRenderCalls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderScale",{get:function(){return this._renderScale},set:function(t){t!==this._renderScale&&(this._renderScale=t,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._background},set:function(t){this._background!==t&&(this._background=t,this.markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idealWidth",{get:function(){return this._idealWidth},set:function(t){this._idealWidth!==t&&(this._idealWidth=t,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idealHeight",{get:function(){return this._idealHeight},set:function(t){this._idealHeight!==t&&(this._idealHeight=t,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useSmallestIdeal",{get:function(){return this._useSmallestIdeal},set:function(t){this._useSmallestIdeal!==t&&(this._useSmallestIdeal=t,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderAtIdealSize",{get:function(){return this._renderAtIdealSize},set:function(t){this._renderAtIdealSize!==t&&(this._renderAtIdealSize=t,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idealRatio",{get:function(){var t=0,e=0;return this._idealWidth&&(t=this.getSize().width/this._idealWidth),this._idealHeight&&(e=this.getSize().height/this._idealHeight),this._useSmallestIdeal&&this._idealWidth&&this._idealHeight?window.innerWidth<window.innerHeight?t:e:this._idealWidth?t:this._idealHeight?e:1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layer",{get:function(){return this._layerToDispose},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),e.prototype.getChildren=function(){return[this._rootContainer]},e.prototype.getDescendants=function(t,e){return this._rootContainer.getDescendants(t,e)},Object.defineProperty(e.prototype,"focusedControl",{get:function(){return this._focusedControl},set:function(t){this._focusedControl!=t&&(this._focusedControl&&this._focusedControl.onBlur(),t&&t.onFocus(),this._focusedControl=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isForeground",{get:function(){return!this.layer||!this.layer.isBackground},set:function(t){this.layer&&this.layer.isBackground!==!t&&(this.layer.isBackground=!t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipboardData",{get:function(){return this._clipboardData},set:function(t){this._clipboardData=t},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"AdvancedDynamicTexture"},e.prototype.executeOnAllControls=function(t,e){e||(e=this._rootContainer),t(e);for(var i=0,r=e.children;i<r.length;i++){var n=r[i];n.children?this.executeOnAllControls(t,n):t(n)}},Object.defineProperty(e.prototype,"useInvalidateRectOptimization",{get:function(){return this._useInvalidateRectOptimization},set:function(t){this._useInvalidateRectOptimization=t},enumerable:!1,configurable:!0}),e.prototype.invalidateRect=function(t,e,i,r){if(this._useInvalidateRectOptimization)if(this._invalidatedRectangle){var n=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,i)),o=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,r));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,t)),this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,e)),this._invalidatedRectangle.width=n-this._invalidatedRectangle.left+1,this._invalidatedRectangle.height=o-this._invalidatedRectangle.top+1}else this._invalidatedRectangle=new d(t,e,i-t+1,r-e+1)},e.prototype.markAsDirty=function(){this._isDirty=!0},e.prototype.createStyle=function(){return new q(this)},e.prototype.addControl=function(t){return this._rootContainer.addControl(t),this},e.prototype.removeControl=function(t){return this._rootContainer.removeControl(t),this},e.prototype.dispose=function(){var e=this.getScene();e&&(this._rootElement=null,e.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&e.getEngine().onResizeObservable.remove(this._resizeObserver),this._pointerMoveObserver&&e.onPrePointerObservable.remove(this._pointerMoveObserver),this._pointerObserver&&e.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&e.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&e.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._canvasBlurObserver&&e.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),t.prototype.dispose.call(this))},e.prototype._onResize=function(){var t=this.getScene();if(t){var e=t.getEngine(),i=this.getSize(),r=e.getRenderWidth()*this._renderScale,n=e.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(n=n*this._idealWidth/r,r=this._idealWidth):this._idealHeight&&(r=r*this._idealHeight/n,n=this._idealHeight)),i.width===r&&i.height===n||(this.scaleTo(r,n),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty()),this.invalidateRect(0,0,i.width-1,i.height-1)}},e.prototype._getGlobalViewport=function(t){var e=t.getEngine();return this._fullscreenViewport.toGlobal(e.getRenderWidth(),e.getRenderHeight())},e.prototype.getProjectedPosition=function(t,e){var i=this.getScene();if(!i)return s.Vector2.Zero();var r=this._getGlobalViewport(i),n=s.Vector3.Project(t,e,i.getTransformMatrix(),r);return n.scaleInPlace(this.renderScale),new s.Vector2(n.x,n.y)},e.prototype.getProjectedPositionWithZ=function(t,e){var i=this.getScene();if(!i)return s.Vector3.Zero();var r=this._getGlobalViewport(i),n=s.Vector3.Project(t,e,i.getTransformMatrix(),r);return n.scaleInPlace(this.renderScale),new s.Vector3(n.x,n.y,n.z)},e.prototype._checkUpdate=function(t){if(!this._layerToDispose||0!=(t.layerMask&this._layerToDispose.layerMask)){if(this._isFullscreen&&this._linkedControls.length){var e=this.getScene();if(!e)return;for(var i=this._getGlobalViewport(e),r=function(t){if(!t.isVisible)return"continue";var r=t._linkedMesh;if(!r||r.isDisposed())return s.Tools.SetImmediate((function(){t.linkWithMesh(null)})),"continue";var o=r.getBoundingInfo?r.getBoundingInfo().boundingSphere.center:s.Vector3.ZeroReadOnly,a=s.Vector3.Project(o,r.getWorldMatrix(),e.getTransformMatrix(),i);if(a.z<0||a.z>1)return t.notRenderable=!0,"continue";t.notRenderable=!1,a.scaleInPlace(n.renderScale),t._moveToProjectedPosition(a)},n=this,o=0,a=this._linkedControls;o<a.length;o++)r(a[o])}(this._isDirty||this._rootContainer.isDirty)&&(this._isDirty=!1,this._render(),this.update(this.applyYInversionOnUpdate,this.premulAlpha))}},e.prototype._render=function(){var t=this.getSize(),e=t.width,i=t.height,r=this.getContext();r.font="18px Arial",r.strokeStyle="white",this.onBeginLayoutObservable.notifyObservers(this);var n=new d(0,0,e,i);this._numLayoutCalls=0,this._rootContainer._layout(n,r),this.onEndLayoutObservable.notifyObservers(this),this._isDirty=!1,this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,e,i),r.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),this._background&&(r.save(),r.fillStyle=this._background,r.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),r.restore()),this.onBeginRenderObservable.notifyObservers(this),this._numRenderCalls=0,this._rootContainer._render(r,this._invalidatedRectangle),this.onEndRenderObservable.notifyObservers(this),this._invalidatedRectangle=null},e.prototype._changeCursor=function(t){this._rootElement&&(this._rootElement.style.cursor=t,this._cursorChanged=!0)},e.prototype._registerLastControlDown=function(t,e){this._lastControlDown[e]=t,this.onControlPickedObservable.notifyObservers(t)},e.prototype._doPicking=function(t,e,i,r,n,o,a,l){var h=this.getScene();if(h){var c=h.getEngine(),u=this.getSize();if(this._isFullscreen){var d=(h.cameraToUseForPointers||h.activeCamera).viewport;t*=u.width/(c.getRenderWidth()*d.width),e*=u.height/(c.getRenderHeight()*d.height)}this._capturingControl[n]?this._capturingControl[n]._processObservables(r,t,e,i,n,o):(this._cursorChanged=!1,this._rootContainer._processPicking(t,e,i,r,n,o,a,l)||(this._changeCursor(""),r===s.PointerEventTypes.POINTERMOVE&&this._lastControlOver[n]&&(this._lastControlOver[n]._onPointerOut(this._lastControlOver[n],i),delete this._lastControlOver[n])),this._cursorChanged||this._changeCursor(""),this._manageFocus())}},e.prototype._cleanControlAfterRemovalFromList=function(t,e){for(var i in t)t.hasOwnProperty(i)&&t[i]===e&&delete t[i]},e.prototype._cleanControlAfterRemoval=function(t){this._cleanControlAfterRemovalFromList(this._lastControlDown,t),this._cleanControlAfterRemovalFromList(this._lastControlOver,t)},e.prototype.attach=function(){var t=this,e=this.getScene();if(e){var i=new s.Viewport(0,0,0,0);this._pointerMoveObserver=e.onPrePointerObservable.add((function(r,n){if(!e.isPointerCaptured(r.event.pointerId)&&(r.type===s.PointerEventTypes.POINTERMOVE||r.type===s.PointerEventTypes.POINTERUP||r.type===s.PointerEventTypes.POINTERDOWN||r.type===s.PointerEventTypes.POINTERWHEEL)&&e){r.type===s.PointerEventTypes.POINTERMOVE&&r.event.pointerId&&(t._defaultMousePointerId=r.event.pointerId);var o=e.cameraToUseForPointers||e.activeCamera,a=e.getEngine();o?o.viewport.toGlobalToRef(a.getRenderWidth(),a.getRenderHeight(),i):(i.x=0,i.y=0,i.width=a.getRenderWidth(),i.height=a.getRenderHeight());var l=e.pointerX/a.getHardwareScalingLevel()-i.x,h=e.pointerY/a.getHardwareScalingLevel()-(a.getRenderHeight()-i.y-i.height);t._shouldBlockPointer=!1;var c=r.event.pointerId||t._defaultMousePointerId;t._doPicking(l,h,r,r.type,c,r.event.button,r.event.deltaX,r.event.deltaY),t._shouldBlockPointer&&(r.skipOnPointerObservable=t._shouldBlockPointer)}})),this._attachToOnPointerOut(e),this._attachToOnBlur(e)}},e.prototype.registerClipboardEvents=function(){self.addEventListener("copy",this.onClipboardCopy,!1),self.addEventListener("cut",this.onClipboardCut,!1),self.addEventListener("paste",this.onClipboardPaste,!1)},e.prototype.unRegisterClipboardEvents=function(){self.removeEventListener("copy",this.onClipboardCopy),self.removeEventListener("cut",this.onClipboardCut),self.removeEventListener("paste",this.onClipboardPaste)},e.prototype.attachToMesh=function(t,e){var i=this;void 0===e&&(e=!0);var r=this.getScene();r&&(this._pointerObserver=r.onPointerObservable.add((function(e,r){if(e.type===s.PointerEventTypes.POINTERMOVE||e.type===s.PointerEventTypes.POINTERUP||e.type===s.PointerEventTypes.POINTERDOWN){var n=e.event.pointerId||i._defaultMousePointerId;if(e.pickInfo&&e.pickInfo.hit&&e.pickInfo.pickedMesh===t){var o=e.pickInfo.getTextureCoordinates();if(o){var a=i.getSize();i._doPicking(o.x*a.width,(i.applyYInversionOnUpdate?1-o.y:o.y)*a.height,e,e.type,n,e.event.button)}}else if(e.type===s.PointerEventTypes.POINTERUP){if(i._lastControlDown[n]&&i._lastControlDown[n]._forcePointerUp(n),delete i._lastControlDown[n],i.focusedControl){var l=i.focusedControl.keepsFocusWith(),h=!0;if(l)for(var c=0,u=l;c<u.length;c++){var d=u[c];if(i!==d._host){var p=d._host;if(p._lastControlOver[n]&&p._lastControlOver[n].isAscendant(d)){h=!1;break}}}h&&(i.focusedControl=null)}}else e.type===s.PointerEventTypes.POINTERMOVE&&(i._lastControlOver[n]&&i._lastControlOver[n]._onPointerOut(i._lastControlOver[n],e,!0),delete i._lastControlOver[n])}})),t.enablePointerMoveEvents=e,this._attachToOnPointerOut(r),this._attachToOnBlur(r))},e.prototype.moveFocusToControl=function(t){this.focusedControl=t,this._lastPickedControl=t,this._blockNextFocusCheck=!0},e.prototype._manageFocus=function(){if(this._blockNextFocusCheck)return this._blockNextFocusCheck=!1,void(this._lastPickedControl=this._focusedControl);if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}},e.prototype._attachToOnPointerOut=function(t){var e=this;this._canvasPointerOutObserver=t.getEngine().onCanvasPointerOutObservable.add((function(t){e._lastControlOver[t.pointerId]&&e._lastControlOver[t.pointerId]._onPointerOut(e._lastControlOver[t.pointerId],null),delete e._lastControlOver[t.pointerId],e._lastControlDown[t.pointerId]&&e._lastControlDown[t.pointerId]!==e._capturingControl[t.pointerId]&&(e._lastControlDown[t.pointerId]._forcePointerUp(),delete e._lastControlDown[t.pointerId])}))},e.prototype._attachToOnBlur=function(t){var e=this;this._canvasBlurObserver=t.getEngine().onCanvasBlurObservable.add((function(t){Object.entries(e._lastControlDown).forEach((function(t){t[0],t[1]._onCanvasBlur()})),e._lastControlDown={}}))},e.CreateForMesh=function(t,i,r,n,o,a){void 0===i&&(i=1024),void 0===r&&(r=1024),void 0===n&&(n=!0),void 0===o&&(o=!1);var l=new e(t.name+" AdvancedDynamicTexture",i,r,t.getScene(),!0,s.Texture.TRILINEAR_SAMPLINGMODE,a),h=new s.StandardMaterial("AdvancedDynamicTextureMaterial",t.getScene());return h.backFaceCulling=!1,h.diffuseColor=s.Color3.Black(),h.specularColor=s.Color3.Black(),o?(h.diffuseTexture=l,h.emissiveTexture=l,l.hasAlpha=!0):(h.emissiveTexture=l,h.opacityTexture=l),t.material=h,l.attachToMesh(t,n),l},e.CreateForMeshTexture=function(t,i,r,n,o){void 0===i&&(i=1024),void 0===r&&(r=1024),void 0===n&&(n=!0);var a=new e(t.name+" AdvancedDynamicTexture",i,r,t.getScene(),!0,s.Texture.TRILINEAR_SAMPLINGMODE,o);return a.attachToMesh(t,n),a},e.CreateFullscreenUI=function(t,i,r,n){void 0===i&&(i=!0),void 0===r&&(r=null),void 0===n&&(n=s.Texture.BILINEAR_SAMPLINGMODE);var o=new e(t,0,0,r,!1,n),a=new s.Layer(t+"_layer",null,r,!i);return a.texture=o,o._layerToDispose=a,o._isFullscreen=!0,o.attach(),o},e}(s.DynamicTexture),J=function(){function t(t){this.texture=t,this._captureRenderTime=!1,this._renderTime=new s.PerfCounter,this._captureLayoutTime=!1,this._layoutTime=new s.PerfCounter,this._onBeginRenderObserver=null,this._onEndRenderObserver=null,this._onBeginLayoutObserver=null,this._onEndLayoutObserver=null}return Object.defineProperty(t.prototype,"renderTimeCounter",{get:function(){return this._renderTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layoutTimeCounter",{get:function(){return this._layoutTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"captureRenderTime",{get:function(){return this._captureRenderTime},set:function(t){var e=this;t!==this._captureRenderTime&&(this._captureRenderTime=t,t?(this._onBeginRenderObserver=this.texture.onBeginRenderObservable.add((function(){e._renderTime.beginMonitoring()})),this._onEndRenderObserver=this.texture.onEndRenderObservable.add((function(){e._renderTime.endMonitoring(!0)}))):(this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"captureLayoutTime",{get:function(){return this._captureLayoutTime},set:function(t){var e=this;t!==this._captureLayoutTime&&(this._captureLayoutTime=t,t?(this._onBeginLayoutObserver=this.texture.onBeginLayoutObservable.add((function(){e._layoutTime.beginMonitoring()})),this._onEndLayoutObserver=this.texture.onEndLayoutObservable.add((function(){e._layoutTime.endMonitoring(!0)}))):(this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null))},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null,this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null,this.texture=null},t}(),Q=function(){function t(t){void 0===t&&(t=null),this._nodes={},this._nodeTypes={element:1,attribute:2,text:3},this._isLoaded=!1,this._objectAttributes={textHorizontalAlignment:1,textVerticalAlignment:2,horizontalAlignment:3,verticalAlignment:4,stretch:5},t&&(this._parentClass=t)}return t.prototype._getChainElement=function(t){var e=window;this._parentClass&&(e=this._parentClass);var i=t;i=i.split(".");for(var r=0;r<i.length;r++)e=e[i[r]];return e},t.prototype._getClassAttribute=function(t){var e=t.split(".");return s._TypeStore.GetClass("BABYLON.GUI."+e[0])[e[1]]},t.prototype._createGuiElement=function(t,e,i){void 0===i&&(i=!0);try{var r=new(s._TypeStore.GetClass("BABYLON.GUI."+t.nodeName));e&&i&&e.addControl(r);for(var n=0;n<t.attributes.length;n++)if(!t.attributes[n].name.toLowerCase().includes("datasource"))if(t.attributes[n].name.toLowerCase().includes("observable")){var o=this._getChainElement(t.attributes[n].value);r[t.attributes[n].name].add(o)}else"linkWithMesh"==t.attributes[n].name?this._parentClass?r.linkWithMesh(this._parentClass[t.attributes[n].value]):r.linkWithMesh(window[t.attributes[n].value]):t.attributes[n].value.startsWith("{{")&&t.attributes[n].value.endsWith("}}")?(o=this._getChainElement(t.attributes[n].value.substring(2,t.attributes[n].value.length-2)),r[t.attributes[n].name]=o):this._objectAttributes[t.attributes[n].name]?r[t.attributes[n].name]=this._getClassAttribute(t.attributes[n].value):"true"==t.attributes[n].value||"false"==t.attributes[n].value?r[t.attributes[n].name]="true"==t.attributes[n].value:r[t.attributes[n].name]=isNaN(Number(t.attributes[n].value))?t.attributes[n].value:Number(t.attributes[n].value);if(!t.attributes.getNamedItem("id"))return this._nodes[t.nodeName+Object.keys(this._nodes).length+"_gen"]=r,r;var a=t.attributes.getNamedItem("id").value;if(a.startsWith("{{")&&a.endsWith("}}")&&(a=this._getChainElement(a.substring(2,a.length-2))),this._nodes[a])throw"XmlLoader Exception : Duplicate ID, every element should have an unique ID attribute";return this._nodes[a]=r,r}catch(e){throw"XmlLoader Exception : Error parsing Control "+t.nodeName+","+e+"."}},t.prototype._parseGrid=function(t,e,i){for(var r,n,o,s,a,l=t.children,h=!1,c=-1,u=-1,d=0,p=0;p<l.length;p++)if(l[p].nodeType==this._nodeTypes.element){if("Row"!=l[p].nodeName)throw"XmlLoader Exception : Expecting Row node, received "+l[p].nodeName;if(c+=1,o=l[p].children,!l[p].attributes.getNamedItem("height"))throw"XmlLoader Exception : Height must be defined for grid rows";n=Number(l[p].attributes.getNamedItem("height").nodeValue),h=!!l[p].attributes.getNamedItem("isPixel")&&JSON.parse(l[p].attributes.getNamedItem("isPixel").nodeValue),e.addRowDefinition(n,h);for(var f=0;f<o.length;f++)if(o[f].nodeType==this._nodeTypes.element){if("Column"!=o[f].nodeName)throw"XmlLoader Exception : Expecting Column node, received "+o[f].nodeName;if(u+=1,c>0&&u>d)throw"XmlLoader Exception : In the Grid element, the number of columns is defined in the first row, do not add more columns in the subsequent rows.";if(0==c){if(!o[f].attributes.getNamedItem("width"))throw"XmlLoader Exception : Width must be defined for all the grid columns in the first row";r=Number(o[f].attributes.getNamedItem("width").nodeValue),h=!!o[f].attributes.getNamedItem("isPixel")&&JSON.parse(o[f].attributes.getNamedItem("isPixel").nodeValue),e.addColumnDefinition(r,h)}s=o[f].children;for(var _=0;_<s.length;_++)s[_].nodeType==this._nodeTypes.element&&(a=this._createGuiElement(s[_],e,!1),e.addControl(a,c,u),s[_].firstChild&&this._parseXml(s[_].firstChild,a))}0==c&&(d=u),u=-1}t.nextSibling&&this._parseXml(t.nextSibling,i)},t.prototype._parseElement=function(t,e,i){t.firstChild&&this._parseXml(t.firstChild,e),t.nextSibling&&this._parseXml(t.nextSibling,i)},t.prototype._prepareSourceElement=function(t,e,i,r,n){this._parentClass?this._parentClass[i]=r[n]:window[i]=r[n],t.firstChild&&this._parseXml(t.firstChild,e,!0)},t.prototype._parseElementsFromSource=function(t,e,i){var r=t.attributes.getNamedItem("dataSource").value;if(!r.includes(" in "))throw"XmlLoader Exception : Malformed XML, Data Source must include an in";var n=!0,o=r.split(" in ");if(o.length<2)throw"XmlLoader Exception : Malformed XML, Data Source must an iterator and a source";var s=o[1];if(s.startsWith("{")&&s.endsWith("}")&&(n=!1),(!n||s.startsWith("[")&&s.endsWith("]"))&&(s=s.substring(1,s.length-1)),s=this._parentClass?this._parentClass[s]:window[s],n)for(var a=0;a<s.length;a++)this._prepareSourceElement(t,e,o[0],s,a);else for(var a in s)this._prepareSourceElement(t,e,o[0],s,a);t.nextSibling&&this._parseXml(t.nextSibling,i)},t.prototype._parseXml=function(t,e,i){if(void 0===i&&(i=!1),t.nodeType==this._nodeTypes.element){i&&t.setAttribute("id",e.id+(e._children.length+1));var r=this._createGuiElement(t,e);"Grid"==t.nodeName?this._parseGrid(t,r,e):t.attributes.getNamedItem("dataSource")?this._parseElementsFromSource(t,r,e):this._parseElement(t,r,e)}else t.nextSibling&&this._parseXml(t.nextSibling,e,i)},t.prototype.isLoaded=function(){return this._isLoaded},t.prototype.getNodeById=function(t){return this._nodes[t]},t.prototype.getNodes=function(){return this._nodes},t.prototype.loadLayout=function(t,e,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){if(!r.responseXML)throw"XmlLoader Exception : XML file is malformed or corrupted.";var t=r.responseXML.documentElement;this._parseXml(t.firstChild,e),this._isLoaded=!0,i&&i()}}.bind(this),r.open("GET",t,!0),r.send()},t}(),tt=function(t){function e(e,i){void 0===i&&(i=0);var r=t.call(this,e.x,e.y,e.z)||this;return r.buttonIndex=i,r}return n(e,t),e}(s.Vector3),et=function(){function t(t){this.name=t,this._downCount=0,this._enterCount=-1,this._downPointerIds={},this._isVisible=!0,this.onPointerMoveObservable=new s.Observable,this.onPointerOutObservable=new s.Observable,this.onPointerDownObservable=new s.Observable,this.onPointerUpObservable=new s.Observable,this.onPointerClickObservable=new s.Observable,this.onPointerEnterObservable=new s.Observable,this._behaviors=new Array}return Object.defineProperty(t.prototype,"position",{get:function(){return this._node?this._node.position:s.Vector3.Zero()},set:function(t){this._node&&(this._node.position=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaling",{get:function(){return this._node?this._node.scaling:new s.Vector3(1,1,1)},set:function(t){this._node&&(this._node.scaling=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),t.prototype.addBehavior=function(t){var e=this;if(-1!==this._behaviors.indexOf(t))return this;t.init();var i=this._host.scene;return i.isLoading?i.onDataLoadedObservable.addOnce((function(){t.attach(e)})):t.attach(this),this._behaviors.push(t),this},t.prototype.removeBehavior=function(t){var e=this._behaviors.indexOf(t);return-1===e||(this._behaviors[e].detach(),this._behaviors.splice(e,1)),this},t.prototype.getBehaviorByName=function(t){for(var e=0,i=this._behaviors;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){if(this._isVisible!==t){this._isVisible=t;var e=this.mesh;e&&e.setEnabled(t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return this._getTypeName()},t.prototype._getTypeName=function(){return"Control3D"},Object.defineProperty(t.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mesh",{get:function(){return this._node instanceof s.AbstractMesh?this._node:null},enumerable:!1,configurable:!0}),t.prototype.linkToTransformNode=function(t){return this._node&&(this._node.parent=t),this},t.prototype._prepareNode=function(t){if(!this._node){if(this._node=this._createNode(t),!this.node)return;this._node.metadata=this,this._node.position=this.position,this._node.scaling=this.scaling;var e=this.mesh;e&&(e.isPickable=!0,this._affectMaterial(e))}},t.prototype._createNode=function(t){return null},t.prototype._affectMaterial=function(t){t.material=null},t.prototype._onPointerMove=function(t,e){this.onPointerMoveObservable.notifyObservers(e,-1,t,this)},t.prototype._onPointerEnter=function(t){return!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,t,this),this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},t.prototype._onPointerOut=function(t){this._enterCount=0,this.onPointerOutObservable.notifyObservers(this,-1,t,this),this.pointerOutAnimation&&this.pointerOutAnimation()},t.prototype._onPointerDown=function(t,e,i,r){return 0!==this._downCount?(this._downCount++,!1):(this._downCount++,this._downPointerIds[i]=!0,this.onPointerDownObservable.notifyObservers(new tt(e,r),-1,t,this),this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},t.prototype._onPointerUp=function(t,e,i,r,n){this._downCount--,delete this._downPointerIds[i],this._downCount<0?this._downCount=0:0==this._downCount&&(n&&(this._enterCount>0||-1===this._enterCount)&&this.onPointerClickObservable.notifyObservers(new tt(e,r),-1,t,this),this.onPointerUpObservable.notifyObservers(new tt(e,r),-1,t,this),this.pointerUpAnimation&&this.pointerUpAnimation())},t.prototype.forcePointerUp=function(t){if(void 0===t&&(t=null),null!==t)this._onPointerUp(this,s.Vector3.Zero(),t,0,!0);else{for(var e in this._downPointerIds)this._onPointerUp(this,s.Vector3.Zero(),+e,0,!0);this._downCount>0&&(this._downCount=1,this._onPointerUp(this,s.Vector3.Zero(),0,0,!0))}},t.prototype._processObservables=function(t,e,i,r){if(t===s.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,e);var n=this._host._lastControlOver[i];return n&&n!==this&&n._onPointerOut(this),n!==this&&this._onPointerEnter(this),this._host._lastControlOver[i]=this,!0}return t===s.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,e,i,r),this._host._lastControlDown[i]=this,this._host._lastPickedControl=this,!0):(t===s.PointerEventTypes.POINTERUP||t===s.PointerEventTypes.POINTERDOUBLETAP)&&(this._host._lastControlDown[i]&&this._host._lastControlDown[i]._onPointerUp(this,e,i,r,!0),delete this._host._lastControlDown[i],!0)},t.prototype._disposeNode=function(){this._node&&(this._node.dispose(),this._node=null)},t.prototype.dispose=function(){this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this._disposeNode();for(var t=0,e=this._behaviors;t<e.length;t++)e[t].detach()},t}(),it=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype._getTypeName=function(){return"AbstractButton3D"},e.prototype._createNode=function(t){return new s.TransformNode("button"+this.name)},e}(et),rt=function(t){function e(e){var i=t.call(this,e)||this;return i._contentResolution=512,i._contentScaleRatio=2,i.pointerEnterAnimation=function(){i.mesh&&(i._currentMaterial.emissiveColor=s.Color3.Red())},i.pointerOutAnimation=function(){i._currentMaterial.emissiveColor=s.Color3.Black()},i.pointerDownAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(.95)},i.pointerUpAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1/.95)},i}return n(e,t),Object.defineProperty(e.prototype,"contentResolution",{get:function(){return this._contentResolution},set:function(t){this._contentResolution!==t&&(this._contentResolution=t,this._resetContent())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentScaleRatio",{get:function(){return this._contentScaleRatio},set:function(t){this._contentScaleRatio!==t&&(this._contentScaleRatio=t,this._resetContent())},enumerable:!1,configurable:!0}),e.prototype._disposeFacadeTexture=function(){this._facadeTexture&&(this._facadeTexture.dispose(),this._facadeTexture=null)},e.prototype._resetContent=function(){this._disposeFacadeTexture(),this.content=this._content},Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(t){this._content=t,this._host&&this._host.utilityLayer&&(this._facadeTexture?this._facadeTexture.rootContainer.clearControls():(this._facadeTexture=new Z("Facade",this._contentResolution,this._contentResolution,this._host.utilityLayer.utilityLayerScene,!0,s.Texture.TRILINEAR_SAMPLINGMODE),this._facadeTexture.rootContainer.scaleX=this._contentScaleRatio,this._facadeTexture.rootContainer.scaleY=this._contentScaleRatio,this._facadeTexture.premulAlpha=!0),this._facadeTexture.addControl(t),this._applyFacade(this._facadeTexture))},enumerable:!1,configurable:!0}),e.prototype._applyFacade=function(t){this._currentMaterial.emissiveTexture=t},e.prototype._getTypeName=function(){return"Button3D"},e.prototype._createNode=function(t){for(var e=new Array(6),i=0;i<6;i++)e[i]=new s.Vector4(0,0,0,0);return e[1]=new s.Vector4(0,0,1,1),s.BoxBuilder.CreateBox(this.name+"_rootMesh",{width:1,height:1,depth:.08,faceUV:e},t)},e.prototype._affectMaterial=function(t){var e=new s.StandardMaterial(this.name+"Material",t.getScene());e.specularColor=s.Color3.Black(),t.material=e,this._currentMaterial=e,this._resetContent()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._disposeFacadeTexture(),this._currentMaterial&&this._currentMaterial.dispose()},e}(it),nt=function(t){function e(e){var i=t.call(this,e)||this;return i._blockLayout=!1,i._children=new Array,i}return n(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blockLayout",{get:function(){return this._blockLayout},set:function(t){this._blockLayout!==t&&(this._blockLayout=t,this._blockLayout||this._arrangeChildren())},enumerable:!1,configurable:!0}),e.prototype.updateLayout=function(){return this._arrangeChildren(),this},e.prototype.containsControl=function(t){return-1!==this._children.indexOf(t)},e.prototype.addControl=function(t){return-1!==this._children.indexOf(t)||(t.parent=this,t._host=this._host,this._children.push(t),this._host.utilityLayer&&(t._prepareNode(this._host.utilityLayer.utilityLayerScene),t.node&&(t.node.parent=this.node),this.blockLayout||this._arrangeChildren())),this},e.prototype._arrangeChildren=function(){},e.prototype._createNode=function(t){return new s.TransformNode("ContainerNode",t)},e.prototype.removeControl=function(t){var e=this._children.indexOf(t);return-1!==e&&(this._children.splice(e,1),t.parent=null,t._disposeNode()),this},e.prototype._getTypeName=function(){return"Container3D"},e.prototype.dispose=function(){for(var e=0,i=this._children;e<i.length;e++)i[e].dispose();this._children=[],t.prototype.dispose.call(this)},e.UNSET_ORIENTATION=0,e.FACEORIGIN_ORIENTATION=1,e.FACEORIGINREVERSED_ORIENTATION=2,e.FACEFORWARD_ORIENTATION=3,e.FACEFORWARDREVERSED_ORIENTATION=4,e}(et),ot=function(t){function e(){var e=t.call(this)||this;return e._columns=10,e._rows=0,e._rowThenColum=!0,e._orientation=nt.FACEORIGIN_ORIENTATION,e.margin=0,e}return n(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return this._orientation},set:function(t){var e=this;this._orientation!==t&&(this._orientation=t,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},set:function(t){var e=this;this._columns!==t&&(this._columns=t,this._rowThenColum=!0,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._rows},set:function(t){var e=this;this._rows!==t&&(this._rows=t,this._rowThenColum=!1,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),e.prototype._arrangeChildren=function(){this._cellWidth=0,this._cellHeight=0;for(var t=0,e=0,i=0,r=s.Matrix.Invert(this.node.computeWorldMatrix(!0)),n=0,o=this._children;n<o.length;n++)if((b=o[n]).mesh){i++,b.mesh.computeWorldMatrix(!0);var a=b.mesh.getHierarchyBoundingVectors(),l=s.TmpVectors.Vector3[0],h=s.TmpVectors.Vector3[1];a.max.subtractToRef(a.min,h),h.scaleInPlace(.5),s.Vector3.TransformNormalToRef(h,r,l),this._cellWidth=Math.max(this._cellWidth,2*l.x),this._cellHeight=Math.max(this._cellHeight,2*l.y)}this._cellWidth+=2*this.margin,this._cellHeight+=2*this.margin,this._rowThenColum?(e=this._columns,t=Math.ceil(i/this._columns)):(t=this._rows,e=Math.ceil(i/this._rows));var c=.5*e*this._cellWidth,u=.5*t*this._cellHeight,d=[],p=0;if(this._rowThenColum)for(var f=0;f<t;f++)for(var _=0;_<e&&(d.push(new s.Vector3(_*this._cellWidth-c+this._cellWidth/2,f*this._cellHeight-u+this._cellHeight/2,0)),!(++p>i));_++);else for(_=0;_<e;_++)for(f=0;f<t&&(d.push(new s.Vector3(_*this._cellWidth-c+this._cellWidth/2,f*this._cellHeight-u+this._cellHeight/2,0)),!(++p>i));f++);p=0;for(var g=0,m=this._children;g<m.length;g++){var b;(b=m[g]).mesh&&(this._mapGridNode(b,d[p]),p++)}this._finalProcessing()},e.prototype._finalProcessing=function(){},e}(nt),st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._radius=5,e}return n(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){var e=this;this._radius!==t&&(this._radius=t,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),e.prototype._mapGridNode=function(t,e){var i=t.mesh;if(i){var r=this._cylindricalMapping(e);switch(t.position=r,this.orientation){case nt.FACEORIGIN_ORIENTATION:i.lookAt(new s.Vector3(2*r.x,r.y,2*r.z));break;case nt.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new s.Vector3(-r.x,r.y,-r.z));break;case nt.FACEFORWARD_ORIENTATION:break;case nt.FACEFORWARDREVERSED_ORIENTATION:i.rotate(s.Axis.Y,Math.PI,s.Space.LOCAL)}}},e.prototype._cylindricalMapping=function(t){var e=new s.Vector3(0,t.y,this._radius),i=t.x/this._radius;return s.Matrix.RotationYawPitchRollToRef(i,0,0,s.TmpVectors.Matrix[0]),s.Vector3.TransformNormal(e,s.TmpVectors.Matrix[0])},e}(ot),at="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 world;\nuniform mat4 viewProjection;\nvarying vec2 vUV;\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float borderWidth;\nuniform vec3 scaleFactor;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\n#endif\nvoid main(void) {\nvUV=uv;\n#ifdef BORDER\nvec3 scale=scaleFactor;\nfloat minScale=min(min(scale.x,scale.y),scale.z);\nfloat maxScale=max(max(scale.x,scale.y),scale.z);\nfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\nfloat areaYZ=scale.y*scale.z;\nfloat areaXZ=scale.x*scale.z;\nfloat areaXY=scale.x*scale.y;\nfloat scaledBorderWidth=borderWidth;\nif (abs(normal.x) == 1.0)\n{\nscale.x=scale.y;\nscale.y=scale.z;\nif (areaYZ>areaXZ && areaYZ>areaXY)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse if (abs(normal.y) == 1.0)\n{\nscale.x=scale.z;\nif (areaXZ>areaXY && areaXZ>areaYZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse\n{\nif (areaXY>areaYZ && areaXY>areaXZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\nif (scale.x>scale.y)\n{\nscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\nscaleInfo.y=1.0-scaledBorderWidth;\n}\nelse\n{\nscaleInfo.x=1.0-scaledBorderWidth;\nscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\n}\n#endif\nvec4 worldPos=world*vec4(position,1.0);\n#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\n#endif\ngl_Position=viewProjection*worldPos;\n}\n";s.Effect.ShadersStore.fluentVertexShader=at;var lt="precision highp float;\nvarying vec2 vUV;\nuniform vec4 albedoColor;\n#ifdef INNERGLOW\nuniform vec4 innerGlowColor;\n#endif\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float edgeSmoothingValue;\nuniform float borderMinValue;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\nuniform vec3 hoverPosition;\nuniform vec4 hoverColor;\nuniform float hoverRadius;\n#endif\n#ifdef TEXTURE\nuniform sampler2D albedoSampler;\n#endif\nvoid main(void) {\nvec3 albedo=albedoColor.rgb;\nfloat alpha=albedoColor.a;\n#ifdef TEXTURE\nalbedo=texture2D(albedoSampler,vUV).rgb;\n#endif\n#ifdef HOVERLIGHT\nfloat pointToHover=(1.0-clamp(length(hoverPosition-worldPosition)/hoverRadius,0.,1.))*hoverColor.a;\nalbedo=clamp(albedo+hoverColor.rgb*pointToHover,0.,1.);\n#else\nfloat pointToHover=1.0;\n#endif\n#ifdef BORDER\nfloat borderPower=10.0;\nfloat inverseBorderPower=1.0/borderPower;\nvec3 borderColor=albedo*borderPower;\nvec2 distanceToEdge;\ndistanceToEdge.x=abs(vUV.x-0.5)*2.0;\ndistanceToEdge.y=abs(vUV.y-0.5)*2.0;\nfloat borderValue=max(smoothstep(scaleInfo.x-edgeSmoothingValue,scaleInfo.x+edgeSmoothingValue,distanceToEdge.x),\nsmoothstep(scaleInfo.y-edgeSmoothingValue,scaleInfo.y+edgeSmoothingValue,distanceToEdge.y));\nborderColor=borderColor*borderValue*max(borderMinValue*inverseBorderPower,pointToHover);\nalbedo+=borderColor;\nalpha=max(alpha,borderValue);\n#endif\n#ifdef INNERGLOW\n\nvec2 uvGlow=(vUV-vec2(0.5,0.5))*(innerGlowColor.a*2.0);\nuvGlow=uvGlow*uvGlow;\nuvGlow=uvGlow*uvGlow;\nalbedo+=mix(vec3(0.0,0.0,0.0),innerGlowColor.rgb,uvGlow.x+uvGlow.y);\n#endif\ngl_FragColor=vec4(albedo,alpha);\n}";s.Effect.ShadersStore.fluentPixelShader=lt;var ht=function(t){function e(){var e=t.call(this)||this;return e.INNERGLOW=!1,e.BORDER=!1,e.HOVERLIGHT=!1,e.TEXTURE=!1,e.rebuild(),e}return n(e,t),e}(s.MaterialDefines),ct=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.innerGlowColorIntensity=.5,r.innerGlowColor=new s.Color3(1,1,1),r.albedoColor=new s.Color3(.3,.35,.4),r.renderBorders=!1,r.borderWidth=.5,r.edgeSmoothingValue=.02,r.borderMinValue=.1,r.renderHoverLight=!1,r.hoverRadius=1,r.hoverColor=new s.Color4(.3,.3,.3,1),r.hoverPosition=s.Vector3.Zero(),r}return n(e,t),e.prototype.needAlphaBlending=function(){return 1!==this.alpha},e.prototype.needAlphaTesting=function(){return!1},e.prototype.getAlphaTestTexture=function(){return null},e.prototype.isReadyForSubMesh=function(t,e,i){if(this.isFrozen&&e.effect&&e.effect._wasPreviouslyReady)return!0;e._materialDefines||(e._materialDefines=new ht);var r=this.getScene(),n=e._materialDefines;if(!this.checkReadyOnEveryCall&&e.effect&&n._renderId===r.getRenderId())return!0;if(n._areTexturesDirty)if(n.INNERGLOW=this.innerGlowColorIntensity>0,n.BORDER=this.renderBorders,n.HOVERLIGHT=this.renderHoverLight,this._albedoTexture){if(!this._albedoTexture.isReadyOrNotBlocking())return!1;n.TEXTURE=!0}else n.TEXTURE=!1;var o=r.getEngine();if(n.isDirty){n.markAsProcessed(),r.resetCachedMaterial();var a=[s.VertexBuffer.PositionKind];a.push(s.VertexBuffer.NormalKind),a.push(s.VertexBuffer.UVKind);var l=["world","viewProjection","innerGlowColor","albedoColor","borderWidth","edgeSmoothingValue","scaleFactor","borderMinValue","hoverColor","hoverPosition","hoverRadius"],h=["albedoSampler"],c=new Array;s.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:l,uniformBuffersNames:c,samplers:h,defines:n,maxSimultaneousLights:4});var u=n.toString();e.setEffect(r.getEngine().createEffect("fluent",{attributes:a,uniformsNames:l,uniformBuffersNames:c,samplers:h,defines:u,fallbacks:null,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},o))}return!(!e.effect||!e.effect.isReady())&&(n._renderId=r.getRenderId(),e.effect._wasPreviouslyReady=!0,!0)},e.prototype.bindForSubMesh=function(t,e,i){var r=this.getScene(),n=i._materialDefines;if(n){var o=i.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(t),this._activeEffect.setMatrix("viewProjection",r.getTransformMatrix()),this._mustRebind(r,o)&&(this._activeEffect.setColor4("albedoColor",this.albedoColor,this.alpha),n.INNERGLOW&&this._activeEffect.setColor4("innerGlowColor",this.innerGlowColor,this.innerGlowColorIntensity),n.BORDER&&(this._activeEffect.setFloat("borderWidth",this.borderWidth),this._activeEffect.setFloat("edgeSmoothingValue",this.edgeSmoothingValue),this._activeEffect.setFloat("borderMinValue",this.borderMinValue),e.getBoundingInfo().boundingBox.extendSize.multiplyToRef(e.scaling,s.TmpVectors.Vector3[0]),this._activeEffect.setVector3("scaleFactor",s.TmpVectors.Vector3[0])),n.HOVERLIGHT&&(this._activeEffect.setDirectColor4("hoverColor",this.hoverColor),this._activeEffect.setFloat("hoverRadius",this.hoverRadius),this._activeEffect.setVector3("hoverPosition",this.hoverPosition)),n.TEXTURE&&this._activeEffect.setTexture("albedoSampler",this._albedoTexture)),this._afterBind(e,this._activeEffect))}},e.prototype.getActiveTextures=function(){return t.prototype.getActiveTextures.call(this)},e.prototype.hasTexture=function(e){return!!t.prototype.hasTexture.call(this,e)},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e)},e.prototype.clone=function(t){var i=this;return s.SerializationHelper.Clone((function(){return new e(t,i.getScene())}),this)},e.prototype.serialize=function(){var t=s.SerializationHelper.Serialize(this);return t.customType="BABYLON.GUI.FluentMaterial",t},e.prototype.getClassName=function(){return"FluentMaterial"},e.Parse=function(t,i,r){return s.SerializationHelper.Parse((function(){return new e(t.name,i)}),t,i,r)},o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"innerGlowColorIntensity",void 0),o([Object(s.serializeAsColor3)()],e.prototype,"innerGlowColor",void 0),o([Object(s.serializeAsColor3)()],e.prototype,"albedoColor",void 0),o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"renderBorders",void 0),o([Object(s.serialize)()],e.prototype,"borderWidth",void 0),o([Object(s.serialize)()],e.prototype,"edgeSmoothingValue",void 0),o([Object(s.serialize)()],e.prototype,"borderMinValue",void 0),o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"renderHoverLight",void 0),o([Object(s.serialize)()],e.prototype,"hoverRadius",void 0),o([Object(s.serializeAsColor4)()],e.prototype,"hoverColor",void 0),o([Object(s.serializeAsVector3)()],e.prototype,"hoverPosition",void 0),o([Object(s.serializeAsTexture)("albedoTexture")],e.prototype,"_albedoTexture",void 0),o([Object(s.expandToProperty)("_markAllSubMeshesAsTexturesAndMiscDirty")],e.prototype,"albedoTexture",void 0),e}(s.PushMaterial);s._TypeStore.RegisteredTypes["BABYLON.GUI.FluentMaterial"]=ct;var ut=function(t){function e(e,i){void 0===i&&(i=!0);var r=t.call(this,e)||this;return r._shareMaterials=!0,r._shareMaterials=i,r.pointerEnterAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!0)},r.pointerOutAnimation=function(){r.mesh&&r._frontPlate.setEnabled(!1)},r}return n(e,t),e.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(e.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(t){this._backPlate.renderingGroupId=t,this._textPlate.renderingGroupId=t,this._frontPlate.renderingGroupId=t,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(t){var e=this;if(t){if(!this._tooltipFade){this._tooltipMesh=s.PlaneBuilder.CreatePlane("",{size:1},this._backPlate._scene);var i=s.PlaneBuilder.CreatePlane("",{size:1,sideOrientation:s.Mesh.DOUBLESIDE},this._backPlate._scene),r=new s.StandardMaterial("",this._backPlate._scene);r.diffuseColor=s.Color3.FromHexString("#212121"),i.material=r,i.isPickable=!1,this._tooltipMesh.addChild(i),i.position.z=.05,this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position.y=.7,this._tooltipMesh.position.z=-.15,this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=Z.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new v,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new s.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add((function(){e._tooltipFade&&e._tooltipFade.fadeIn(!0)})),this._tooltipOutObserver=this.onPointerOutObservable.add((function(){e._tooltipFade&&e._tooltipFade.fadeIn(!1)}))}this._tooltipTextBlock&&(this._tooltipTextBlock.text=t)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(t){this._imageUrl!==t&&(this._imageUrl=t,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"HolographicButton"},e.prototype._rebuildContent=function(){this._disposeFacadeTexture();var t=new O;if(t.isVertical=!0,this._imageUrl){var e=new y;e.source=this._imageUrl,e.paddingTop="40px",e.height="180px",e.width="100px",e.paddingBottom="40px",t.addControl(e)}if(this._text){var i=new v;i.text=this._text,i.color="white",i.height="30px",i.fontSize=24,t.addControl(i)}this._frontPlate&&(this.content=t)},e.prototype._createNode=function(e){return this._backPlate=s.BoxBuilder.CreateBox(this.name+"BackMesh",{width:1,height:1,depth:.08},e),this._frontPlate=s.BoxBuilder.CreateBox(this.name+"FrontMesh",{width:1,height:1,depth:.08},e),this._frontPlate.parent=this._backPlate,this._frontPlate.position.z=-.08,this._frontPlate.isPickable=!1,this._frontPlate.setEnabled(!1),this._textPlate=t.prototype._createNode.call(this,e),this._textPlate.parent=this._backPlate,this._textPlate.position.z=-.08,this._textPlate.isPickable=!1,this._backPlate},e.prototype._applyFacade=function(t){this._plateMaterial.emissiveTexture=t,this._plateMaterial.opacityTexture=t},e.prototype._createBackMaterial=function(t){var e=this;this._backMaterial=new ct(this.name+"Back Material",t.getScene()),this._backMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add((function(t){t?(e._backMaterial.hoverPosition=t,e._backMaterial.hoverColor.a=1):e._backMaterial.hoverColor.a=0}))},e.prototype._createFrontMaterial=function(t){this._frontMaterial=new ct(this.name+"Front Material",t.getScene()),this._frontMaterial.innerGlowColorIntensity=0,this._frontMaterial.alpha=.5,this._frontMaterial.renderBorders=!0},e.prototype._createPlateMaterial=function(t){this._plateMaterial=new s.StandardMaterial(this.name+"Plate Material",t.getScene()),this._plateMaterial.specularColor=s.Color3.Black()},e.prototype._affectMaterial=function(t){this._shareMaterials?(this._host._sharedMaterials.backFluentMaterial?this._backMaterial=this._host._sharedMaterials.backFluentMaterial:(this._createBackMaterial(t),this._host._sharedMaterials.backFluentMaterial=this._backMaterial),this._host._sharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._sharedMaterials.frontFluentMaterial:(this._createFrontMaterial(t),this._host._sharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(t),this._createFrontMaterial(t)),this._createPlateMaterial(t),this._backPlate.material=this._backMaterial,this._frontPlate.material=this._frontMaterial,this._textPlate.material=this._plateMaterial,this._rebuildContent()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._disposeTooltip(),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},e}(rt),dt=function(t){function e(e,i){var r=t.call(this,i)||this;return r._currentMesh=e,r.pointerEnterAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1.1)},r.pointerOutAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/1.1)},r.pointerDownAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(.95)},r.pointerUpAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/.95)},r}return n(e,t),e.prototype._getTypeName=function(){return"MeshButton3D"},e.prototype._createNode=function(t){var e=this;return this._currentMesh.getChildMeshes().forEach((function(t){t.metadata=e})),this._currentMesh},e.prototype._affectMaterial=function(t){},e}(rt),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype._mapGridNode=function(t,e){var i=t.mesh;if(i){t.position=e.clone();var r=s.TmpVectors.Vector3[0];switch(r.copyFrom(e),this.orientation){case nt.FACEORIGIN_ORIENTATION:case nt.FACEFORWARD_ORIENTATION:r.addInPlace(new s.Vector3(0,0,1)),i.lookAt(r);break;case nt.FACEFORWARDREVERSED_ORIENTATION:case nt.FACEORIGINREVERSED_ORIENTATION:r.addInPlace(new s.Vector3(0,0,-1)),i.lookAt(r)}}},e}(ot),ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._iteration=100,e}return n(e,t),Object.defineProperty(e.prototype,"iteration",{get:function(){return this._iteration},set:function(t){var e=this;this._iteration!==t&&(this._iteration=t,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),e.prototype._mapGridNode=function(t,e){var i=t.mesh,r=this._scatterMapping(e);if(i){switch(this.orientation){case nt.FACEORIGIN_ORIENTATION:case nt.FACEFORWARD_ORIENTATION:i.lookAt(new s.Vector3(0,0,1));break;case nt.FACEFORWARDREVERSED_ORIENTATION:case nt.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new s.Vector3(0,0,-1))}t.position=r}},e.prototype._scatterMapping=function(t){return t.x=(1-2*Math.random())*this._cellWidth,t.y=(1-2*Math.random())*this._cellHeight,t},e.prototype._finalProcessing=function(){for(var t=[],e=0,i=this._children;e<i.length;e++){var r=i[e];r.mesh&&t.push(r.mesh)}for(var n=0;n<this._iteration;n++){t.sort((function(t,e){var i=t.position.lengthSquared(),r=e.position.lengthSquared();return i<r?1:i>r?-1:0}));for(var o=Math.pow(this.margin,2),a=Math.max(this._cellWidth,this._cellHeight),l=s.TmpVectors.Vector2[0],h=s.TmpVectors.Vector3[0],c=0;c<t.length-1;c++)for(var u=c+1;u<t.length;u++)if(c!=u){t[u].position.subtractToRef(t[c].position,h),l.x=h.x,l.y=h.y;var d=a,p=l.lengthSquared()-o;(p-=Math.min(p,o))<Math.pow(d,2)&&(l.normalize(),h.scaleInPlace(.5*(d-Math.sqrt(p))),t[u].position.addInPlace(h),t[c].position.subtractInPlace(h))}}},e}(ot),_t=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._radius=5,e}return n(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){var e=this;this._radius!==t&&(this._radius=t,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),e.prototype._mapGridNode=function(t,e){var i=t.mesh;if(i){var r=this._sphericalMapping(e);switch(t.position=r,this.orientation){case nt.FACEORIGIN_ORIENTATION:i.lookAt(new s.Vector3(2*r.x,2*r.y,2*r.z));break;case nt.FACEORIGINREVERSED_ORIENTATION:i.lookAt(new s.Vector3(-r.x,-r.y,-r.z));break;case nt.FACEFORWARD_ORIENTATION:break;case nt.FACEFORWARDREVERSED_ORIENTATION:i.rotate(s.Axis.Y,Math.PI,s.Space.LOCAL)}}},e.prototype._sphericalMapping=function(t){var e=new s.Vector3(0,0,this._radius),i=t.y/this._radius,r=-t.x/this._radius;return s.Matrix.RotationYawPitchRollToRef(r,i,0,s.TmpVectors.Matrix[0]),s.Vector3.TransformNormal(e,s.TmpVectors.Matrix[0])},e}(ot),gt=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i._isVertical=!1,i.margin=.1,i._isVertical=e,i}return n(e,t),Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._isVertical},set:function(t){var e=this;this._isVertical!==t&&(this._isVertical=t,s.Tools.SetImmediate((function(){e._arrangeChildren()})))},enumerable:!1,configurable:!0}),e.prototype._arrangeChildren=function(){for(var t,e=0,i=0,r=0,n=[],o=s.Matrix.Invert(this.node.computeWorldMatrix(!0)),a=0,l=this._children;a<l.length;a++)if((f=l[a]).mesh){r++,f.mesh.computeWorldMatrix(!0),f.mesh.getWorldMatrix().multiplyToRef(o,s.TmpVectors.Matrix[0]);var h=f.mesh.getBoundingInfo().boundingBox,c=s.Vector3.TransformNormal(h.extendSize,s.TmpVectors.Matrix[0]);n.push(c),this._isVertical?i+=c.y:e+=c.x}this._isVertical?i+=(r-1)*this.margin/2:e+=(r-1)*this.margin/2,t=this._isVertical?-i:-e;for(var u=0,d=0,p=this._children;d<p.length;d++){var f;(f=p[d]).mesh&&(r--,c=n[u++],this._isVertical?(f.position.y=t+c.y,f.position.x=0,t+=2*c.y):(f.position.x=t+c.x,f.position.y=0,t+=2*c.x),t+=r>0?this.margin:0)}},e}(nt),mt=function(){function t(t){var e=this;this._lastControlOver={},this._lastControlDown={},this.onPickedPointChangedObservable=new s.Observable,this._sharedMaterials={},this._scene=t||s.EngineStore.LastCreatedScene,this._sceneDisposeObserver=this._scene.onDisposeObservable.add((function(){e._sceneDisposeObserver=null,e._utilityLayer=null,e.dispose()})),this._utilityLayer=new s.UtilityLayerRenderer(this._scene),this._utilityLayer.onlyCheckPointerDownEvents=!1,this._utilityLayer.pickUtilitySceneFirst=!1,this._utilityLayer.mainSceneTrackerPredicate=function(t){return t&&t.metadata&&t.metadata._node},this._rootContainer=new nt("RootContainer"),this._rootContainer._host=this;var i=this._utilityLayer.utilityLayerScene;this._pointerOutObserver=this._utilityLayer.onPointerOutObservable.add((function(t){e._handlePointerOut(t,!0)})),this._pointerObserver=i.onPointerObservable.add((function(t,i){e._doPicking(t)})),this._utilityLayer.utilityLayerScene.autoClear=!1,this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!1,new s.HemisphericLight("hemi",s.Vector3.Up(),this._utilityLayer.utilityLayerScene)}return Object.defineProperty(t.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!1,configurable:!0}),t.prototype._handlePointerOut=function(t,e){var i=this._lastControlOver[t];i&&(i._onPointerOut(i),delete this._lastControlOver[t]),e&&this._lastControlDown[t]&&(this._lastControlDown[t].forcePointerUp(),delete this._lastControlDown[t]),this.onPickedPointChangedObservable.notifyObservers(null)},t.prototype._doPicking=function(t){if(!this._utilityLayer||!this._utilityLayer.shouldRender||!this._utilityLayer.utilityLayerScene.activeCamera)return!1;var e=t.event,i=e.pointerId||0,r=e.button,n=t.pickInfo;if(!n||!n.hit)return this._handlePointerOut(i,t.type===s.PointerEventTypes.POINTERUP),!1;var o=n.pickedMesh.metadata;return n.pickedPoint&&this.onPickedPointChangedObservable.notifyObservers(n.pickedPoint),o._processObservables(t.type,n.pickedPoint,i,r)||t.type===s.PointerEventTypes.POINTERMOVE&&(this._lastControlOver[i]&&this._lastControlOver[i]._onPointerOut(this._lastControlOver[i]),delete this._lastControlOver[i]),t.type===s.PointerEventTypes.POINTERUP&&(this._lastControlDown[e.pointerId]&&(this._lastControlDown[e.pointerId].forcePointerUp(),delete this._lastControlDown[e.pointerId]),"touch"===e.pointerType&&this._handlePointerOut(i,!1)),!0},Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),t.prototype.containsControl=function(t){return this._rootContainer.containsControl(t)},t.prototype.addControl=function(t){return this._rootContainer.addControl(t),this},t.prototype.removeControl=function(t){return this._rootContainer.removeControl(t),this},t.prototype.dispose=function(){for(var t in this._rootContainer.dispose(),this._sharedMaterials)this._sharedMaterials.hasOwnProperty(t)&&this._sharedMaterials[t].dispose();this._sharedMaterials={},this._pointerOutObserver&&this._utilityLayer&&(this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver),this._pointerOutObserver=null),this.onPickedPointChangedObservable.clear();var e=this._utilityLayer?this._utilityLayer.utilityLayerScene:null;e&&this._pointerObserver&&(e.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=null),this._scene&&this._sceneDisposeObserver&&(this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null),this._utilityLayer&&this._utilityLayer.dispose()},t}()},function(t,e,i){"use strict";i.r(e),function(t){var r=i(1);i.d(e,"Button",(function(){return r.Button})),i.d(e,"Checkbox",(function(){return r.Checkbox})),i.d(e,"ColorPicker",(function(){return r.ColorPicker})),i.d(e,"Container",(function(){return r.Container})),i.d(e,"Control",(function(){return r.Control})),i.d(e,"Ellipse",(function(){return r.Ellipse})),i.d(e,"Grid",(function(){return r.Grid})),i.d(e,"Image",(function(){return r.Image})),i.d(e,"InputText",(function(){return r.InputText})),i.d(e,"InputPassword",(function(){return r.InputPassword})),i.d(e,"Line",(function(){return r.Line})),i.d(e,"MultiLine",(function(){return r.MultiLine})),i.d(e,"RadioButton",(function(){return r.RadioButton})),i.d(e,"StackPanel",(function(){return r.StackPanel})),i.d(e,"SelectorGroup",(function(){return r.SelectorGroup})),i.d(e,"CheckboxGroup",(function(){return r.CheckboxGroup})),i.d(e,"RadioGroup",(function(){return r.RadioGroup})),i.d(e,"SliderGroup",(function(){return r.SliderGroup})),i.d(e,"SelectionPanel",(function(){return r.SelectionPanel})),i.d(e,"ScrollViewer",(function(){return r.ScrollViewer})),i.d(e,"TextWrapping",(function(){return r.TextWrapping})),i.d(e,"TextBlock",(function(){return r.TextBlock})),i.d(e,"TextWrapper",(function(){return r.TextWrapper})),i.d(e,"KeyPropertySet",(function(){return r.KeyPropertySet})),i.d(e,"VirtualKeyboard",(function(){return r.VirtualKeyboard})),i.d(e,"Rectangle",(function(){return r.Rectangle})),i.d(e,"DisplayGrid",(function(){return r.DisplayGrid})),i.d(e,"BaseSlider",(function(){return r.BaseSlider})),i.d(e,"Slider",(function(){return r.Slider})),i.d(e,"ImageBasedSlider",(function(){return r.ImageBasedSlider})),i.d(e,"ScrollBar",(function(){return r.ScrollBar})),i.d(e,"ImageScrollBar",(function(){return r.ImageScrollBar})),i.d(e,"name",(function(){return r.name})),i.d(e,"AdvancedDynamicTexture",(function(){return r.AdvancedDynamicTexture})),i.d(e,"AdvancedDynamicTextureInstrumentation",(function(){return r.AdvancedDynamicTextureInstrumentation})),i.d(e,"Vector2WithInfo",(function(){return r.Vector2WithInfo})),i.d(e,"Matrix2D",(function(){return r.Matrix2D})),i.d(e,"Measure",(function(){return r.Measure})),i.d(e,"MultiLinePoint",(function(){return r.MultiLinePoint})),i.d(e,"Style",(function(){return r.Style})),i.d(e,"ValueAndUnit",(function(){return r.ValueAndUnit})),i.d(e,"XmlLoader",(function(){return r.XmlLoader})),i.d(e,"AbstractButton3D",(function(){return r.AbstractButton3D})),i.d(e,"Button3D",(function(){return r.Button3D})),i.d(e,"Container3D",(function(){return r.Container3D})),i.d(e,"Control3D",(function(){return r.Control3D})),i.d(e,"CylinderPanel",(function(){return r.CylinderPanel})),i.d(e,"HolographicButton",(function(){return r.HolographicButton})),i.d(e,"MeshButton3D",(function(){return r.MeshButton3D})),i.d(e,"PlanePanel",(function(){return r.PlanePanel})),i.d(e,"ScatterPanel",(function(){return r.ScatterPanel})),i.d(e,"SpherePanel",(function(){return r.SpherePanel})),i.d(e,"StackPanel3D",(function(){return r.StackPanel3D})),i.d(e,"VolumeBasedPanel",(function(){return r.VolumeBasedPanel})),i.d(e,"FluentMaterialDefines",(function(){return r.FluentMaterialDefines})),i.d(e,"FluentMaterial",(function(){return r.FluentMaterial})),i.d(e,"GUI3DManager",(function(){return r.GUI3DManager})),i.d(e,"Vector3WithInfo",(function(){return r.Vector3WithInfo}));var n=void 0!==t?t:"undefined"!=typeof window?window:void 0;void 0!==n&&(n.BABYLON=n.BABYLON||{},n.BABYLON.GUI=r)}.call(this,i(3))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i}])}))}).call(this,i("c8ba"))},"714b":function(t,e,i){"use strict";var r=i("8336"),n=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"modal-bg",on:{click:t.hideModal}},[e("div",{staticClass:"modal-container",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-header"},[t._v(" "+t._s(t.title)+" ")]),e("div",{staticClass:"modal-main"},[t._t("default")],2),e("div",{staticClass:"modal-footer"},[e(r["a"],{attrs:{color:"green darken-1",text:""},on:{click:function(e){return e.stopPropagation(),t.submit.apply(null,arguments)}}},[t._v(" 保存 ")])],1)])])},o=[],s={name:"modal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""}},methods:{hideModal(){this.$emit("hideModal")},submit(){this.$emit("submit")}}},a=s,l=(i("6cd8"),i("2877")),h=Object(l["a"])(a,n,o,!1,null,"84d82d18",null);e["a"]=h.exports},"75eb":function(t,e,i){"use strict";var r=i("9d65"),n=i("80d2"),o=i("58df"),s=i("d9bd");function a(t){const e=typeof t;return"boolean"===e||"string"===e||t.nodeType===Node.ELEMENT_NODE}function l(t){t.forEach(t=>{t.elm&&t.elm.parentNode&&t.elm.parentNode.removeChild(t.elm)})}e["a"]=Object(o["a"])(r["a"]).extend({name:"detachable",props:{attach:{default:!1,validator:a},contentClass:{type:String,default:""}},data:()=>({activatorNode:null,hasDetached:!1}),watch:{attach(){this.hasDetached=!1,this.initDetach()},hasContent(){this.$nextTick(this.initDetach)}},beforeMount(){this.$nextTick(()=>{if(this.activatorNode){const t=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];t.forEach(t=>{if(!t.elm)return;if(!this.$el.parentNode)return;const e=this.$el===this.$el.parentNode.firstChild?this.$el:this.$el.nextSibling;this.$el.parentNode.insertBefore(t.elm,e)})}})},mounted(){this.hasContent&&this.initDetach()},deactivated(){this.isActive=!1},beforeDestroy(){this.$refs.content&&this.$refs.content.parentNode&&this.$refs.content.parentNode.removeChild(this.$refs.content)},destroyed(){if(this.activatorNode){const t=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];if(this.$el.isConnected){const e=new MutationObserver(i=>{i.some(t=>Array.from(t.removedNodes).includes(this.$el))&&(e.disconnect(),l(t))});e.observe(this.$el.parentNode,{subtree:!1,childList:!0})}else l(t)}},methods:{getScopeIdAttrs(){const t=Object(n["o"])(this.$vnode,"context.$options._scopeId");return t&&{[t]:""}},initDetach(){if(this._isDestroyed||!this.$refs.content||this.hasDetached||""===this.attach||!0===this.attach||"attach"===this.attach)return;let t;t=!1===this.attach?document.querySelector("[data-app]"):"string"===typeof this.attach?document.querySelector(this.attach):this.attach,t?(t.appendChild(this.$refs.content),this.hasDetached=!0):Object(s["c"])("Unable to locate target "+(this.attach||"[data-app]"),this)}}})},7724:function(module,exports,__webpack_require__){(function(t,e){module.exports=e()})(0,(function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="./src/js-interpreter.js")}({"./node_modules/vm-browserify/index.js":
/*!*********************************************!*\
  !*** ./node_modules/vm-browserify/index.js ***!
  \*********************************************/
/*! no static exports found */function(module,exports){var indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)e.push(i);return e},forEach=function(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i++)e(t[i],i,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,e,i){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:i})}}catch(t){return function(t,e,i){t[e]=i}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var i=e.contentWindow,r=i.eval,n=i.execScript;!r&&n&&(n.call(i,"null"),r=i.eval),forEach(Object_keys(t),(function(e){i[e]=t[e]})),forEach(globals,(function(e){t[e]&&(i[e]=t[e])}));var o=Object_keys(i),s=r.call(i,this.code);return forEach(Object_keys(i),(function(e){(e in t||-1===indexOf(o,e))&&(t[e]=i[e])})),forEach(globals,(function(e){e in t||defineProp(t,e,i[e])})),document.body.removeChild(e),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var e=Script.createContext(t),i=this.runInContext(e);return t&&forEach(Object_keys(e),(function(i){t[i]=e[i]})),i},forEach(Object_keys(Script.prototype),(function(t){exports[t]=Script[t]=function(e){var i=Script(e);return i[t].apply(i,[].slice.call(arguments,1))}})),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var e=new Context;return"object"===typeof t&&forEach(Object_keys(t),(function(i){e[i]=t[i]})),e}},"./original-repo/acorn.js":
/*!********************************!*\
  !*** ./original-repo/acorn.js ***!
  \********************************/
/*! no static exports found */function(t,e,i){(function(t,i){i(e)})(0,(function(t){"use strict";var e,i,r,n;t.version="0.4.1",t.parse=function(t,n){return i=String(t),r=i.length,s(n),$t(),Pe(e.program)};var o=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function s(t){for(var i in e=t||{},o)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=o[i]);n=e.sourceFile||null}var a,l,h,c,u,d,p,f,_,g,m,b,v,y,T,O,E=t.getLineInfo=function(t,e){for(var i=1,r=0;;){Gt.lastIndex=r;var n=Gt.exec(t);if(!(n&&n.index<e))break;++i,r=n.index+n[0].length}return{line:i,column:e-r}};function A(t,e){var r=E(i,t);e+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(e);throw n.pos=t,n.loc=r,n.raisedAt=a,n}t.tokenize=function(t,n){i=String(t),r=i.length,s(n),$t();var o={};function m(t){return ae(t),o.start=l,o.end=h,o.startLoc=c,o.endLoc=u,o.type=d,o.value=p,o}return m.jumpTo=function(t,r){if(a=t,e.locations){var n;_=1,g=Gt.lastIndex=0;while((n=Gt.exec(i))&&n.index<t)++_,g=n.index+n[0].length}f=r,Zt()},m};var C=[],x={type:"num"},w={type:"regexp"},M={type:"string"},S={type:"name"},I={type:"eof"},P={keyword:"break"},R={keyword:"case",beforeExpr:!0},L={keyword:"catch"},N={keyword:"continue"},k={keyword:"debugger"},D={keyword:"default"},B={keyword:"do",isLoop:!0},F={keyword:"else",beforeExpr:!0},V={keyword:"finally"},j={keyword:"for",isLoop:!0},H={keyword:"function"},U={keyword:"if"},G={keyword:"return",beforeExpr:!0},W={keyword:"switch"},z={keyword:"throw",beforeExpr:!0},X={keyword:"try"},$={keyword:"var"},Y={keyword:"while",isLoop:!0},K={keyword:"with"},q={keyword:"new",beforeExpr:!0},Z={keyword:"this"},J={keyword:"null",atomValue:null},Q={keyword:"true",atomValue:!0},tt={keyword:"false",atomValue:!1},et={keyword:"in",binop:7,beforeExpr:!0},it={break:P,case:R,catch:L,continue:N,debugger:k,default:D,do:B,else:F,finally:V,for:j,function:H,if:U,return:G,switch:W,throw:z,try:X,var:$,while:Y,with:K,null:J,true:Q,false:tt,new:q,in:et,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Z,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},rt={type:"[",beforeExpr:!0},nt={type:"]"},ot={type:"{",beforeExpr:!0},st={type:"}"},at={type:"(",beforeExpr:!0},lt={type:")"},ht={type:",",beforeExpr:!0},ct={type:";",beforeExpr:!0},ut={type:":",beforeExpr:!0},dt={type:"."},pt={type:"?",beforeExpr:!0},ft={binop:10,beforeExpr:!0},_t={isAssign:!0,beforeExpr:!0},gt={isAssign:!0,beforeExpr:!0},mt={postfix:!0,prefix:!0,isUpdate:!0},bt={prefix:!0,beforeExpr:!0},vt={binop:1,beforeExpr:!0},yt={binop:2,beforeExpr:!0},Tt={binop:3,beforeExpr:!0},Ot={binop:4,beforeExpr:!0},Et={binop:5,beforeExpr:!0},At={binop:6,beforeExpr:!0},Ct={binop:7,beforeExpr:!0},xt={binop:8,beforeExpr:!0},wt={binop:9,prefix:!0,beforeExpr:!0},Mt={binop:10,beforeExpr:!0};for(var St in t.tokTypes={bracketL:rt,bracketR:nt,braceL:ot,braceR:st,parenL:at,parenR:lt,comma:ht,semi:ct,colon:ut,dot:dt,question:pt,slash:ft,eq:_t,name:S,eof:I,num:x,regexp:w,string:M},it)t.tokTypes["_"+St]=it[St];function It(t){t=t.split(" ");var e="",i=[];t:for(var r=0;r<t.length;++r){for(var n=0;n<i.length;++n)if(i[n][0].length==t[r].length){i[n].push(t[r]);continue t}i.push([t[r]])}function o(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var i=0;i<t.length;++i)e+="case "+JSON.stringify(t[i])+":";e+="return true}return false;"}if(i.length>3){i.sort((function(t,e){return e.length-t.length})),e+="switch(str.length){";for(r=0;r<i.length;++r){var s=i[r];e+="case "+s[0].length+":",o(s)}e+="}"}else o(t);return new Function("str",e)}var Pt,Rt=It("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Lt=It("class enum extends super const export import"),Nt=It("implements interface let package private protected public static yield"),kt=It("eval arguments"),Dt=It("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Bt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ft="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Vt="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",jt=new RegExp("["+Ft+"]"),Ht=new RegExp("["+Ft+Vt+"]"),Ut=/[\n\r\u2028\u2029]/,Gt=/\r\n|[\n\r\u2028\u2029]/g,Wt=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&jt.test(String.fromCharCode(t)))},zt=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&Ht.test(String.fromCharCode(t))))};function Xt(){this.line=_,this.column=a-g}function $t(){_=1,a=g=0,f=!0,Zt()}function Yt(t,i){h=a,e.locations&&(u=new Xt),d=t,Zt(),p=i,f=t.beforeExpr}function Kt(){var t=e.onComment&&e.locations&&new Xt,r=a,n=i.indexOf("*/",a+=2);if(-1===n&&A(a-2,"Unterminated comment"),a=n+2,e.locations){var o;Gt.lastIndex=r;while((o=Gt.exec(i))&&o.index<a)++_,g=o.index+o[0].length}e.onComment&&e.onComment(!0,i.slice(r+2,n),r,a,t,e.locations&&new Xt)}function qt(){var t=a,n=e.onComment&&e.locations&&new Xt,o=i.charCodeAt(a+=2);while(a<r&&10!==o&&13!==o&&8232!==o&&8233!==o)++a,o=i.charCodeAt(a);e.onComment&&e.onComment(!1,i.slice(t+2,a),t,a,n,e.locations&&new Xt)}function Zt(){while(a<r){var t=i.charCodeAt(a);if(32===t)++a;else if(13===t){++a;var n=i.charCodeAt(a);10===n&&++a,e.locations&&(++_,g=a)}else if(10===t||8232===t||8233===t)++a,e.locations&&(++_,g=a);else if(t>8&&t<14)++a;else if(47===t){n=i.charCodeAt(a+1);if(42===n)Kt();else{if(47!==n)break;qt()}}else if(160===t)++a;else{if(!(t>=5760&&Bt.test(String.fromCharCode(t))))break;++a}}}function Jt(){var t=i.charCodeAt(a+1);return t>=48&&t<=57?de(!0):(++a,Yt(dt))}function Qt(){var t=i.charCodeAt(a+1);return f?(++a,he()):61===t?le(gt,2):le(ft,1)}function te(){var t=i.charCodeAt(a+1);return 61===t?le(gt,2):le(Mt,1)}function ee(t){var e=i.charCodeAt(a+1);return e===t?le(124===t?vt:yt,2):61===e?le(gt,2):le(124===t?Tt:Et,1)}function ie(){var t=i.charCodeAt(a+1);return 61===t?le(gt,2):le(Ot,1)}function re(t){var e=i.charCodeAt(a+1);return e===t?45==e&&62==i.charCodeAt(a+2)&&Ut.test(i.slice(b,a))?(a+=3,qt(),Zt(),ae()):le(mt,2):61===e?le(gt,2):le(wt,1)}function ne(t){var e=i.charCodeAt(a+1),r=1;return e===t?(r=62===t&&62===i.charCodeAt(a+2)?3:2,61===i.charCodeAt(a+r)?le(gt,r+1):le(xt,r)):33==e&&60==t&&45==i.charCodeAt(a+2)&&45==i.charCodeAt(a+3)?(a+=4,qt(),Zt(),ae()):(61===e&&(r=61===i.charCodeAt(a+2)?3:2),le(Ct,r))}function oe(t){var e=i.charCodeAt(a+1);return 61===e?le(At,61===i.charCodeAt(a+2)?3:2):le(61===t?_t:bt,1)}function se(t){switch(t){case 46:return Jt();case 40:return++a,Yt(at);case 41:return++a,Yt(lt);case 59:return++a,Yt(ct);case 44:return++a,Yt(ht);case 91:return++a,Yt(rt);case 93:return++a,Yt(nt);case 123:return++a,Yt(ot);case 125:return++a,Yt(st);case 58:return++a,Yt(ut);case 63:return++a,Yt(pt);case 48:var e=i.charCodeAt(a+1);if(120===e||88===e)return ue();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return de(!1);case 34:case 39:return pe(t);case 47:return Qt(t);case 37:case 42:return te();case 124:case 38:return ee(t);case 94:return ie();case 43:case 45:return re(t);case 60:case 62:return ne(t);case 61:case 33:return oe(t);case 126:return le(bt,1)}return!1}function ae(t){if(t?a=l+1:l=a,e.locations&&(c=new Xt),t)return he();if(a>=r)return Yt(I);var n=i.charCodeAt(a);if(Wt(n)||92===n)return ge();var o=se(n);if(!1===o){var s=String.fromCharCode(n);if("\\"===s||jt.test(s))return ge();A(a,"Unexpected character '"+s+"'")}return o}function le(t,e){var r=i.slice(a,a+e);a+=e,Yt(t,r)}function he(){for(var t,e,n="",o=a;;){a>=r&&A(o,"Unterminated regular expression");var s=i.charAt(a);if(Ut.test(s)&&A(o,"Unterminated regular expression"),t)t=!1;else{if("["===s)e=!0;else if("]"===s&&e)e=!1;else if("/"===s&&!e)break;t="\\"===s}++a}n=i.slice(o,a);++a;var l=_e();return l&&!/^[gmsiy]*$/.test(l)&&A(o,"Invalid regexp flag"),Yt(w,new RegExp(n,l))}function ce(t,e){for(var r=a,n=0,o=0,s=null==e?1/0:e;o<s;++o){var l,h=i.charCodeAt(a);if(l=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0,l>=t)break;++a,n=n*t+l}return a===r||null!=e&&a-r!==e?null:n}function ue(){a+=2;var t=ce(16);return null==t&&A(l+2,"Expected hexadecimal number"),Wt(i.charCodeAt(a))&&A(a,"Identifier directly after number"),Yt(x,t)}function de(t){var e=a,r=!1,n=48===i.charCodeAt(a);t||null!==ce(10)||A(e,"Invalid number"),46===i.charCodeAt(a)&&(++a,ce(10),r=!0);var o=i.charCodeAt(a);69!==o&&101!==o||(o=i.charCodeAt(++a),43!==o&&45!==o||++a,null===ce(10)&&A(e,"Invalid number"),r=!0),Wt(i.charCodeAt(a))&&A(a,"Identifier directly after number");var s,l=i.slice(e,a);return r?s=parseFloat(l):n&&1!==l.length?/[89]/.test(l)||O?A(e,"Invalid number"):s=parseInt(l,8):s=parseInt(l,10),Yt(x,s)}function pe(t){a++;for(var n="";;){a>=r&&A(l,"Unterminated string constant");var o=i.charCodeAt(a);if(o===t)return++a,Yt(M,n);if(92===o){o=i.charCodeAt(++a);var s=/^[0-7]+/.exec(i.slice(a,a+3));s&&(s=s[0]);while(s&&parseInt(s,8)>255)s=s.slice(0,-1);if("0"===s&&(s=null),++a,s)O&&A(a-2,"Octal literal in strict mode"),n+=String.fromCharCode(parseInt(s,8)),a+=s.length-1;else switch(o){case 110:n+="\n";break;case 114:n+="\r";break;case 120:n+=String.fromCharCode(fe(2));break;case 117:n+=String.fromCharCode(fe(4));break;case 85:n+=String.fromCharCode(fe(8));break;case 116:n+="\t";break;case 98:n+="\b";break;case 118:n+="\v";break;case 102:n+="\f";break;case 48:n+="\0";break;case 13:10===i.charCodeAt(a)&&++a;case 10:e.locations&&(g=a,++_);break;default:n+=String.fromCharCode(o);break}}else 13!==o&&10!==o&&8232!==o&&8233!==o||A(l,"Unterminated string constant"),n+=String.fromCharCode(o),++a}}function fe(t){var e=ce(16,t);return null===e&&A(l,"Bad character escape sequence"),e}function _e(){Pt=!1;for(var t,e=!0,r=a;;){var n=i.charCodeAt(a);if(zt(n))Pt&&(t+=i.charAt(a)),++a;else{if(92!==n)break;Pt||(t=i.slice(r,a)),Pt=!0,117!=i.charCodeAt(++a)&&A(a,"Expecting Unicode escape sequence \\uXXXX"),++a;var o=fe(4),s=String.fromCharCode(o);s||A(a-1,"Invalid Unicode escape"),(e?Wt(o):zt(o))||A(a-4,"Invalid Unicode escape"),t+=s}e=!1}return Pt?t:i.slice(r,a)}function ge(){var t=_e(),i=S;return Pt||(Dt(t)?i=it[t]:(e.forbidReserved&&(3===e.ecmaVersion?Rt:Lt)(t)||O&&Nt(t))&&A(l,"The keyword '"+t+"' is reserved")),Yt(i,t)}function me(){m=l,b=h,v=u,ae()}function be(t){if(O=t,a=b,e.locations)while(a<g)g=i.lastIndexOf("\n",g-2)+1,--_;Zt(),ae()}function ve(){this.type=null,this.start=l,this.end=null}function ye(){this.start=c,this.end=null,null!==n&&(this.source=n)}function Te(){var t=new ve;return e.locations&&(t.loc=new ye),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[l,0]),t}function Oe(t){var i=new ve;return i.start=t.start,e.locations&&(i.loc=new ye,i.loc.start=t.loc.start),e.ranges&&(i.range=[t.range[0],0]),i}function Ee(t,i){return t.type=i,t.end=b,e.locations&&(t.loc.end=v),e.ranges&&(t.range[1]=b),t}function Ae(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function Ce(t){if(d===t)return me(),!0}function xe(){return!e.strictSemicolons&&(d===I||d===st||Ut.test(i.slice(b,l)))}function we(){Ce(ct)||xe()||Se()}function Me(t){d===t?me():Se()}function Se(){A(l,"Unexpected token")}function Ie(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&A(t.start,"Assigning to rvalue"),O&&"Identifier"===t.type&&kt(t.name)&&A(t.start,"Assigning to "+t.name+" in strict mode")}function Pe(t){m=b=a,e.locations&&(v=new Xt),y=O=null,T=[],ae();var i=t||Te(),r=!0;t||(i.body=[]);while(d!==I){var n=Ne();i.body.push(n),r&&Ae(n)&&be(!0),r=!1}return Ee(i,"Program")}var Re={kind:"loop"},Le={kind:"switch"};function Ne(){(d===ft||d===gt&&"/="==p)&&ae(!0);var t=d,e=Te();switch(t){case P:case N:me();var r=t===P;Ce(ct)||xe()?e.label=null:d!==S?Se():(e.label=ti(),we());for(var n=0;n<T.length;++n){var o=T[n];if(null==e.label||o.name===e.label.name){if(null!=o.kind&&(r||"loop"===o.kind))break;if(e.label&&r)break}}return n===T.length&&A(e.start,"Unsyntactic "+t.keyword),Ee(e,r?"BreakStatement":"ContinueStatement");case k:return me(),we(),Ee(e,"DebuggerStatement");case B:return me(),T.push(Re),e.body=Ne(),T.pop(),Me(Y),e.test=ke(),we(),Ee(e,"DoWhileStatement");case j:if(me(),T.push(Re),Me(at),d===ct)return Be(e,null);if(d===$){var s=Te();return me(),Ve(s,!0),Ee(s,"VariableDeclaration"),1===s.declarations.length&&Ce(et)?Fe(e,s):Be(e,s)}s=je(!1,!0);return Ce(et)?(Ie(s),Fe(e,s)):Be(e,s);case H:return me(),Je(e,!0);case U:return me(),e.test=ke(),e.consequent=Ne(),e.alternate=Ce(F)?Ne():null,Ee(e,"IfStatement");case G:return y||A(l,"'return' outside of function"),me(),Ce(ct)||xe()?e.argument=null:(e.argument=je(),we()),Ee(e,"ReturnStatement");case W:me(),e.discriminant=ke(),e.cases=[],Me(ot),T.push(Le);for(var a,h;d!=st;)if(d===R||d===D){var c=d===R;a&&Ee(a,"SwitchCase"),e.cases.push(a=Te()),a.consequent=[],me(),c?a.test=je():(h&&A(m,"Multiple default clauses"),h=!0,a.test=null),Me(ut)}else a||Se(),a.consequent.push(Ne());return a&&Ee(a,"SwitchCase"),me(),T.pop(),Ee(e,"SwitchStatement");case z:return me(),Ut.test(i.slice(b,l))&&A(b,"Illegal newline after throw"),e.argument=je(),we(),Ee(e,"ThrowStatement");case X:if(me(),e.block=De(),e.handler=null,d===L){var u=Te();me(),Me(at),u.param=ti(),O&&kt(u.param.name)&&A(u.param.start,"Binding "+u.param.name+" in strict mode"),Me(lt),u.guard=null,u.body=De(),e.handler=Ee(u,"CatchClause")}return e.guardedHandlers=C,e.finalizer=Ce(V)?De():null,e.handler||e.finalizer||A(e.start,"Missing catch or finally clause"),Ee(e,"TryStatement");case $:return me(),Ve(e),we(),Ee(e,"VariableDeclaration");case Y:return me(),e.test=ke(),T.push(Re),e.body=Ne(),T.pop(),Ee(e,"WhileStatement");case K:return O&&A(l,"'with' in strict mode"),me(),e.object=ke(),e.body=Ne(),Ee(e,"WithStatement");case ot:return De();case ct:return me(),Ee(e,"EmptyStatement");default:var f=p,_=je();if(t===S&&"Identifier"===_.type&&Ce(ut)){for(n=0;n<T.length;++n)T[n].name===f&&A(_.start,"Label '"+f+"' is already declared");var g=d.isLoop?"loop":d===W?"switch":null;return T.push({name:f,kind:g}),e.body=Ne(),T.pop(),e.label=_,Ee(e,"LabeledStatement")}return e.expression=_,we(),Ee(e,"ExpressionStatement")}}function ke(){Me(at);var t=je();return Me(lt),t}function De(t){var e,i=Te(),r=!0,n=!1;i.body=[],Me(ot);while(!Ce(st)){var o=Ne();i.body.push(o),r&&t&&Ae(o)&&(e=n,be(n=!0)),r=!1}return n&&!e&&be(!1),Ee(i,"BlockStatement")}function Be(t,e){return t.init=e,Me(ct),t.test=d===ct?null:je(),Me(ct),t.update=d===lt?null:je(),Me(lt),t.body=Ne(),T.pop(),Ee(t,"ForStatement")}function Fe(t,e){return t.left=e,t.right=je(),Me(lt),t.body=Ne(),T.pop(),Ee(t,"ForInStatement")}function Ve(t,e){for(t.declarations=[],t.kind="var";;){var i=Te();if(i.id=ti(),O&&kt(i.id.name)&&A(i.id.start,"Binding "+i.id.name+" in strict mode"),i.init=Ce(_t)?je(!0,e):null,t.declarations.push(Ee(i,"VariableDeclarator")),!Ce(ht))break}return t}function je(t,e){var i=He(e);if(!t&&d===ht){var r=Oe(i);r.expressions=[i];while(Ce(ht))r.expressions.push(He(e));return Ee(r,"SequenceExpression")}return i}function He(t){var e=Ue(t);if(d.isAssign){var i=Oe(e);return i.operator=p,i.left=e,me(),i.right=He(t),Ie(e),Ee(i,"AssignmentExpression")}return e}function Ue(t){var e=Ge(t);if(Ce(pt)){var i=Oe(e);return i.test=e,i.consequent=je(!0),Me(ut),i.alternate=je(!0,t),Ee(i,"ConditionalExpression")}return e}function Ge(t){return We(ze(),-1,t)}function We(t,e,i){var r=d.binop;if(null!=r&&(!i||d!==et)&&r>e){var n=Oe(t);n.left=t,n.operator=p;var o=d;me(),n.right=We(ze(),r,i);var s=Ee(n,o===vt||o===yt?"LogicalExpression":"BinaryExpression");return We(s,e,i)}return t}function ze(){if(d.prefix){var t=Te(),e=d.isUpdate;return t.operator=p,t.prefix=!0,f=!0,me(),t.argument=ze(),e?Ie(t.argument):O&&"delete"===t.operator&&"Identifier"===t.argument.type&&A(t.start,"Deleting local variable in strict mode"),Ee(t,e?"UpdateExpression":"UnaryExpression")}var i=Xe();while(d.postfix&&!xe()){t=Oe(i);t.operator=p,t.prefix=!1,t.argument=i,Ie(i),me(),i=Ee(t,"UpdateExpression")}return i}function Xe(){return $e(Ye())}function $e(t,e){if(Ce(dt)){var i=Oe(t);return i.object=t,i.property=ti(!0),i.computed=!1,$e(Ee(i,"MemberExpression"),e)}if(Ce(rt)){i=Oe(t);return i.object=t,i.property=je(),i.computed=!0,Me(nt),$e(Ee(i,"MemberExpression"),e)}if(!e&&Ce(at)){i=Oe(t);return i.callee=t,i.arguments=Qe(lt,!1),$e(Ee(i,"CallExpression"),e)}return t}function Ye(){switch(d){case Z:var t=Te();return me(),Ee(t,"ThisExpression");case S:return ti();case x:case M:case w:t=Te();return t.value=p,t.raw=i.slice(l,h),me(),Ee(t,"Literal");case J:case Q:case tt:t=Te();return t.value=d.atomValue,t.raw=d.keyword,me(),Ee(t,"Literal");case at:var r=c,n=l;me();var o=je();return o.start=n,o.end=h,e.locations&&(o.loc.start=r,o.loc.end=u),e.ranges&&(o.range=[n,h]),Me(lt),o;case rt:t=Te();return me(),t.elements=Qe(nt,!0,!0),Ee(t,"ArrayExpression");case ot:return qe();case H:t=Te();return me(),Je(t,!1);case q:return Ke();default:Se()}}function Ke(){var t=Te();return me(),t.callee=$e(Ye(),!0),Ce(at)?t.arguments=Qe(lt,!1):t.arguments=C,Ee(t,"NewExpression")}function qe(){var t=Te(),i=!0,r=!1;t.properties=[],me();while(!Ce(st)){if(i)i=!1;else if(Me(ht),e.allowTrailingCommas&&Ce(st))break;var n,o={key:Ze()},s=!1;if(Ce(ut)?(o.value=je(!0),n=o.kind="init"):e.ecmaVersion>=5&&"Identifier"===o.key.type&&("get"===o.key.name||"set"===o.key.name)?(s=r=!0,n=o.kind=o.key.name,o.key=Ze(),d!==at&&Se(),o.value=Je(Te(),!1)):Se(),"Identifier"===o.key.type&&(O||r))for(var a=0;a<t.properties.length;++a){var l=t.properties[a];if(l.key.name===o.key.name){var h=n==l.kind||s&&"init"===l.kind||"init"===n&&("get"===l.kind||"set"===l.kind);h&&!O&&"init"===n&&"init"===l.kind&&(h=!1),h&&A(o.key.start,"Redefinition of property")}}t.properties.push(o)}return Ee(t,"ObjectExpression")}function Ze(){return d===x||d===M?Ye():ti(!0)}function Je(t,e){d===S?t.id=ti():e?Se():t.id=null,t.params=[];var i=!0;Me(at);while(!Ce(lt))i?i=!1:Me(ht),t.params.push(ti());var r=y,n=T;if(y=!0,T=[],t.body=De(!0),y=r,T=n,O||t.body.body.length&&Ae(t.body.body[0]))for(var o=t.id?-1:0;o<t.params.length;++o){var s=o<0?t.id:t.params[o];if((Nt(s.name)||kt(s.name))&&A(s.start,"Defining '"+s.name+"' in strict mode"),o>=0)for(var a=0;a<o;++a)s.name===t.params[a].name&&A(s.start,"Argument name clash in strict mode")}return Ee(t,e?"FunctionDeclaration":"FunctionExpression")}function Qe(t,i,r){var n=[],o=!0;while(!Ce(t)){if(o)o=!1;else if(Me(ht),i&&e.allowTrailingCommas&&Ce(t))break;r&&d===ht?n.push(null):n.push(je(!0))}return n}function ti(t){var i=Te();return i.name=d===S?p:t&&!e.forbidReserved&&d.keyword||Se(),f=!1,me(),Ee(i,"Identifier")}}))},"./original-repo/interpreter.js":
/*!**************************************!*\
  !*** ./original-repo/interpreter.js ***!
  \**************************************/
/*! no static exports found */function(t,e,i){"use strict";(function(t){
/**
 * @license
 * Copyright 2013 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
var e=function(i,r){"string"===typeof i&&(i=t.parse(i,e.PARSE_OPTIONS)),this.nodeConstructor=i.constructor;var n=new this.nodeConstructor({options:{}});for(var o in i)n[o]="body"===o?i[o].slice():i[o];this.ast=n,this.initFunc_=r,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var s,a=/^step([A-Z]\w*)$/;for(var l in this)"function"===typeof this[l]&&(s=l.match(a))&&(this.stepFunctions_[s[1]]=this[l].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=t.parse(this.polyfills_.join("\n"),e.PARSE_OPTIONS),this.polyfills_=void 0,e.stripLocations_(this.ast,void 0,void 0);var h=new e.State(this.ast,this.globalScope);h.done=!1,this.stateStack=[h],this.run(),this.value=void 0,this.ast=n;h=new e.State(this.ast,this.globalScope);h.done=!1,this.stateStack.length=0,this.stateStack[0]=h,this["stateStack"]=this.stateStack};e.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},e.PARSE_OPTIONS={ecmaVersion:5},e.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},e.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},e.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},e.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},e.STEP_ERROR={STEP_ERROR:!0},e.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},e.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},e.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},e.toStringCycles_=[],e.vm=null,e.nativeGlobal=this,e.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","};"],e.legalArrayLength=function(t){var e=t>>>0;return e===Number(t)?e:NaN},e.legalArrayIndex=function(t){var e=t>>>0;return String(e)===String(t)&&4294967295!==e?e:NaN},e.stripLocations_=function(t,i,r){for(var n in i?t["start"]=i:delete t["start"],r?t["end"]=r:delete t["end"],t)if(t.hasOwnProperty(n)){var o=t[n];o&&"object"===typeof o&&e.stripLocations_(o,i,r)}},e.prototype["REGEXP_MODE"]=2,e.prototype["REGEXP_THREAD_TIMEOUT"]=1e3,e.prototype["POLYFILL_TIMEOUT"]=1e3,e.prototype.getterStep_=!1,e.prototype.setterStep_=!1,e.prototype.appendCode=function(i){var r=this.stateStack[0];if(!r||"Program"!==r.node["type"])throw Error("Expecting original AST to start with a Program node.");if("string"===typeof i&&(i=t.parse(i,e.PARSE_OPTIONS)),!i||"Program"!==i["type"])throw Error("Expecting new AST to start with a Program node.");this.populateScope_(i,r.scope),Array.prototype.push.apply(r.node["body"],i["body"]),r.done=!1},e.prototype.step=function(){var t=this.stateStack,i=Date.now();do{var r=t[t.length-1];if(!r)return!1;var n=r.node,o=n["type"];if("Program"===o&&r.done)return!1;if(this.paused_)return!0;try{var s=this.stepFunctions_[o](t,r,n)}catch(a){if(a!==e.STEP_ERROR)throw a}if(s&&t.push(s),this.getterStep_)throw Error("Getter not supported in this context");if(this.setterStep_)throw Error("Setter not supported in this context")}while(!n["end"]&&i+this["POLYFILL_TIMEOUT"]>Date.now());return!0},e.prototype.run=function(){while(!this.paused_&&this.step());return this.paused_},e.prototype.initGlobal=function(t){this.setProperty(t,"NaN",NaN,e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"Infinity",1/0,e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"undefined",void 0,e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"window",t,e.READONLY_DESCRIPTOR),this.setProperty(t,"this",t,e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"self",t),this.OBJECT_PROTO=new e.Object(null),this.FUNCTION_PROTO=new e.Object(this.OBJECT_PROTO),this.initFunction(t),this.initObject(t),t.proto=this.OBJECT_PROTO,this.setProperty(t,"constructor",this.OBJECT,e.NONENUMERABLE_DESCRIPTOR),this.initArray(t),this.initString(t),this.initBoolean(t),this.initNumber(t),this.initDate(t),this.initRegExp(t),this.initError(t),this.initMath(t),this.initJSON(t);var i=this,r=this.createNativeFunction((function(t){throw EvalError("Can't happen")}),!1);r.eval=!0,this.setProperty(t,"eval",r,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"parseInt",this.createNativeFunction(parseInt,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"parseFloat",this.createNativeFunction(parseFloat,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"isNaN",this.createNativeFunction(isNaN,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"isFinite",this.createNativeFunction(isFinite,!1),e.NONENUMERABLE_DESCRIPTOR);for(var n=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],o=0;o<n.length;o++){var s=function(t){return function(e){try{return t(e)}catch(r){i.throwException(i.URI_ERROR,r.message)}}}(n[o][0]);this.setProperty(t,n[o][1],this.createNativeFunction(s,!1),e.NONENUMERABLE_DESCRIPTOR)}this["OBJECT"]=this.OBJECT,this["OBJECT_PROTO"]=this.OBJECT_PROTO,this["FUNCTION"]=this.FUNCTION,this["FUNCTION_PROTO"]=this.FUNCTION_PROTO,this["ARRAY"]=this.ARRAY,this["ARRAY_PROTO"]=this.ARRAY_PROTO,this["REGEXP"]=this.REGEXP,this["REGEXP_PROTO"]=this.REGEXP_PROTO,this["DATE"]=this.DATE,this["DATE_PROTO"]=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,t)},e.prototype.initFunction=function(i){var r,n=this,o=/^[A-Za-z_$][\w$]*$/;r=function(i){if(arguments.length)var r=String(arguments[arguments.length-1]);else r="";var s=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(s){for(var a=s.split(/\s*,\s*/),l=0;l<a.length;l++){var h=a[l];o.test(h)||n.throwException(n.SYNTAX_ERROR,"Invalid function argument: "+h)}s=a.join(", ")}try{var c=t.parse("(function("+s+") {"+r+"})",e.PARSE_OPTIONS)}catch(d){n.throwException(n.SYNTAX_ERROR,"Invalid code: "+d.message)}1!==c["body"].length&&n.throwException(n.SYNTAX_ERROR,"Invalid code in function body.");var u=c["body"][0]["expression"];return n.createFunction(u,n.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(r,!0),this.setProperty(i,"Function",this.FUNCTION,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,e.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",r=function(t,i){var r=n.stateStack[n.stateStack.length-1];r.func_=this,r.funcThis_=t,r.arguments_=[],null!==i&&void 0!==i&&(i instanceof e.Object?r.arguments_=n.arrayPseudoToNative(i):n.throwException(n.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),r.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"apply",r),r=function(t){var e=n.stateStack[n.stateStack.length-1];e.func_=this,e.funcThis_=t,e.arguments_=[];for(var i=1;i<arguments.length;i++)e.arguments_.push(arguments[i]);e.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",r),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),r=function(){return String(this)},this.setNativeFunctionPrototype(this.FUNCTION,"toString",r),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(r,!1),e.NONENUMERABLE_DESCRIPTOR),r=function(){return this.valueOf()},this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",r),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(r,!1),e.NONENUMERABLE_DESCRIPTOR)},e.prototype.initObject=function(t){var i,r=this;i=function(t){if(void 0===t||null===t)return r.calledWithNew()?this:r.createObjectProto(r.OBJECT_PROTO);if(!(t instanceof e.Object)){var i=r.createObjectProto(r.getPrototype(t));return i.data=t,i}return t},this.OBJECT=this.createNativeFunction(i,!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"Object",this.OBJECT,e.NONENUMERABLE_DESCRIPTOR);var n=function(t){void 0!==t&&null!==t||r.throwException(r.TYPE_ERROR,"Cannot convert '"+t+"' to object")};i=function(t){n(t);var i=t instanceof e.Object?t.properties:t;return r.arrayNativeToPseudo(Object.getOwnPropertyNames(i))},this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),i=function(t){return n(t),t instanceof e.Object&&(t=t.properties),r.arrayNativeToPseudo(Object.keys(t))},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),i=function(t){return null===t?r.createObjectProto(null):(t instanceof e.Object||r.throwException(r.TYPE_ERROR,"Object prototype may only be an Object or null"),r.createObjectProto(t))},this.setProperty(this.OBJECT,"create",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),i=function(t,i,n){return i=String(i),t instanceof e.Object||r.throwException(r.TYPE_ERROR,"Object.defineProperty called on non-object"),n instanceof e.Object||r.throwException(r.TYPE_ERROR,"Property description must be an object"),!t.properties[i]&&t.preventExtensions&&r.throwException(r.TYPE_ERROR,"Can't define property '"+i+"', object is not extensible"),r.setProperty(t,i,e.VALUE_IN_DESCRIPTOR,n.properties),t},this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),i=function(t,i){if(t instanceof e.Object||r.throwException(r.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object"),i=String(i),i in t.properties){var n=Object.getOwnPropertyDescriptor(t.properties,i),o=t.getter[i],s=t.setter[i],a=r.createObjectProto(r.OBJECT_PROTO);return o||s?(r.setProperty(a,"get",o),r.setProperty(a,"set",s)):(r.setProperty(a,"value",n.value),r.setProperty(a,"writable",n.writable)),r.setProperty(a,"configurable",n.configurable),r.setProperty(a,"enumerable",n.enumerable),a}},this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),i=function(t){return n(t),r.getPrototype(t)},this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),i=function(t){return Boolean(t)&&!t.preventExtensions},this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),i=function(t){return t instanceof e.Object&&(t.preventExtensions=!0),t},this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",e.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",e.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",e.Object.prototype.valueOf),i=function(t){return n(this),this instanceof e.Object?String(t)in this.properties:this.hasOwnProperty(t)},this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",i),i=function(t){return n(this),this instanceof e.Object?Object.prototype.propertyIsEnumerable.call(this.properties,t):this.propertyIsEnumerable(t)},this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",i),i=function(t){while(1){if(t=r.getPrototype(t),!t)return!1;if(t===this)return!0}},this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",i)},e.prototype.initArray=function(t){var i,r=this;i=function(t){if(r.calledWithNew())var i=this;else i=r.createArray();var n=arguments[0];if(1===arguments.length&&"number"===typeof n)isNaN(e.legalArrayLength(n))&&r.throwException(r.RANGE_ERROR,"Invalid array length"),i.properties.length=n;else{for(var o=0;o<arguments.length;o++)i.properties[o]=arguments[o];i.properties.length=o}return i},this.ARRAY=this.createNativeFunction(i,!0),this.ARRAY_PROTO=this.ARRAY.properties["prototype"],this.setProperty(t,"Array",this.ARRAY,e.NONENUMERABLE_DESCRIPTOR),i=function(t){return t&&"Array"===t.class},this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(i,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("Object.defineProperty(Array.prototype, 'pop',","{configurable: true, writable: true, value:","function pop() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}","});","Object.defineProperty(Array.prototype, 'push',","{configurable: true, writable: true, value:","function push(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}","});","Object.defineProperty(Array.prototype, 'shift',","{configurable: true, writable: true, value:","function shift() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","o[i] = o[i + 1];","}","delete o[i];","o.length = len - 1;","return value;","}","});","Object.defineProperty(Array.prototype, 'unshift',","{configurable: true, writable: true, value:","function unshift(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","o[i + arguments.length] = o[i];","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return o.length = len + arguments.length;","}","});","Object.defineProperty(Array.prototype, 'reverse',","{configurable: true, writable: true, value:","function reverse() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","o[i] = o[len - i - 1];","o[len - i - 1] = x;","}","return o;","}","});","Object.defineProperty(Array.prototype, 'indexOf',","{configurable: true, writable: true, value:","function indexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}","});","Object.defineProperty(Array.prototype, 'lastIndexOf',","{configurable: true, writable: true, value:","function lastIndexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}","});","Object.defineProperty(Array.prototype, 'slice',","{configurable: true, writable: true, value:","function slice(start, end) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = [];","for (var i = 0; i < size; i++) {","cloned[i] = o[start + i];","}","return cloned;","}","});","Object.defineProperty(Array.prototype, 'splice',","{configurable: true, writable: true, value:","function splice(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 1) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","removed[removed.length++] = o[i];","o[i] = o[i + deleteCount];","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","o[i] = o[i + deleteCount];","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","for (var i = len - 1; i >= start; i--) {","o[i + arguments.length - 2] = o[i];","}","len += arguments.length - 2;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","o.length = len;","return removed;","}","});","Object.defineProperty(Array.prototype, 'concat',","{configurable: true, writable: true, value:","function concat(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","cloned.push.apply(cloned, value);","} else {","cloned.push(value);","}","}","return cloned;","}","});","Object.defineProperty(Array.prototype, 'join',","{configurable: true, writable: true, value:","function join(opt_separator) {","if (!this) throw TypeError();","var o = Object(this);","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < o.length; i++) {","if (i && sep) {","str += sep;","}","str += o[i];","}","return str;","}","});","Object.defineProperty(Array.prototype, 'every',","{configurable: true, writable: true, value:","function every(callbackfn, thisArg) {","if (!this || typeof callbackfn !== 'function') throw TypeError();","var t, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","k = 0;","while (k < len) {","if (k in o && !callbackfn.call(t, o[k], k, o)) return false;","k++;","}","return true;","}","});","Object.defineProperty(Array.prototype, 'filter',","{configurable: true, writable: true, value:","function filter(fun, var_args) {","if (this === void 0 || this === null || typeof fun !== 'function') throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (fun.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}","});","Object.defineProperty(Array.prototype, 'forEach',","{configurable: true, writable: true, value:","function forEach(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","k = 0;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}","});","Object.defineProperty(Array.prototype, 'map',","{configurable: true, writable: true, value:","function map(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, a, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","a = new Array(len);","k = 0;","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}","});","Object.defineProperty(Array.prototype, 'reduce',","{configurable: true, writable: true, value:","function reduce(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0, k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'reduceRight',","{configurable: true, writable: true, value:","function reduceRight(callback /*, initialValue*/) {","if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw TypeError();","var o = Object(this), len = o.length >>> 0, k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'some',","{configurable: true, writable: true, value:","function some(fun/*, thisArg*/) {","if (!this || typeof fun !== 'function') throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && fun.call(thisArg, o[i], i, o)) {","return true;","}","}","return false;","}","});","Object.defineProperty(Array.prototype, 'sort',","{configurable: true, writable: true, value:","function sort(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","this[j] = this[j + 1];","this[j + 1] = swap;","changes++;","}","}","if (!changes) break;","}","return this;","}","});","Object.defineProperty(Array.prototype, 'toLocaleString',","{configurable: true, writable: true, value:","function toLocaleString() {","if (!this) throw TypeError();","var o = Object(this);","var out = [];","for (var i = 0; i < o.length; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}","});","")},e.prototype.initString=function(t){var i,r=this;i=function(t){return t=arguments.length?e.nativeGlobal.String(t):"",r.calledWithNew()?(this.data=t,this):t},this.STRING=this.createNativeFunction(i,!0),this.setProperty(t,"String",this.STRING,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),e.NONENUMERABLE_DESCRIPTOR);for(var n=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],o=0;o<n.length;o++)this.setNativeFunctionPrototype(this.STRING,n[o],String.prototype[n[o]]);i=function(t,e,i){e=r.pseudoToNative(e),i=r.pseudoToNative(i);try{return String(this).localeCompare(t,e,i)}catch(n){r.throwException(r.ERROR,"localeCompare: "+n.message)}},this.setNativeFunctionPrototype(this.STRING,"localeCompare",i),i=function(t,i,n){var o=String(this);if(i=i?Number(i):void 0,r.isa(t,r.REGEXP)&&(t=t.data,r.maybeThrowRegExp(t,n),2===r["REGEXP_MODE"]))if(e.vm){var s={string:o,separator:t,limit:i},a="string.split(separator, limit)",l=r.vmCall(a,s,t,n);l!==e.REGEXP_TIMEOUT&&n(r.arrayNativeToPseudo(l))}else{var h=r.createWorker(),c=r.regExpTimeout(t,h,n);h.onmessage=function(t){clearTimeout(c),n(r.arrayNativeToPseudo(t.data))},h.postMessage(["split",o,t,i])}else{l=o.split(t,i);n(r.arrayNativeToPseudo(l))}},this.setAsyncFunctionPrototype(this.STRING,"split",i),i=function(t,i){var n=String(this);if(t=r.isa(t,r.REGEXP)?t.data:new RegExp(t),r.maybeThrowRegExp(t,i),2!==r["REGEXP_MODE"]){a=n.match(t);i(a&&r.arrayNativeToPseudo(a))}else if(e.vm){var o={string:n,regexp:t},s="string.match(regexp)",a=r.vmCall(s,o,t,i);a!==e.REGEXP_TIMEOUT&&i(a&&r.arrayNativeToPseudo(a))}else{var l=r.createWorker(),h=r.regExpTimeout(t,l,i);l.onmessage=function(t){clearTimeout(h),i(t.data&&r.arrayNativeToPseudo(t.data))},l.postMessage(["match",n,t])}},this.setAsyncFunctionPrototype(this.STRING,"match",i),i=function(t,i){var n=String(this);if(t=r.isa(t,r.REGEXP)?t.data:new RegExp(t),r.maybeThrowRegExp(t,i),2!==r["REGEXP_MODE"])i(n.search(t));else if(e.vm){var o={string:n,regexp:t},s="string.search(regexp)",a=r.vmCall(s,o,t,i);a!==e.REGEXP_TIMEOUT&&i(a)}else{var l=r.createWorker(),h=r.regExpTimeout(t,l,i);l.onmessage=function(t){clearTimeout(h),i(t.data)},l.postMessage(["search",n,t])}},this.setAsyncFunctionPrototype(this.STRING,"search",i),i=function(t,i,n){var o=String(this);if(i=String(i),r.isa(t,r.REGEXP)&&(t=t.data,r.maybeThrowRegExp(t,n),2===r["REGEXP_MODE"]))if(e.vm){var s={string:o,substr:t,newSubstr:i},a="string.replace(substr, newSubstr)",l=r.vmCall(a,s,t,n);l!==e.REGEXP_TIMEOUT&&n(l)}else{var h=r.createWorker(),c=r.regExpTimeout(t,h,n);h.onmessage=function(t){clearTimeout(c),n(t.data)},h.postMessage(["replace",o,t,i])}else n(o.replace(t,i))},this.setAsyncFunctionPrototype(this.STRING,"replace",i),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + str.substring(i + substr.length);","}","}","return str;","};","})();","")},e.prototype.initBoolean=function(t){var i,r=this;i=function(t){return t=e.nativeGlobal.Boolean(t),r.calledWithNew()?(this.data=t,this):t},this.BOOLEAN=this.createNativeFunction(i,!0),this.setProperty(t,"Boolean",this.BOOLEAN,e.NONENUMERABLE_DESCRIPTOR)},e.prototype.initNumber=function(t){var i,r=this;i=function(t){return t=arguments.length?e.nativeGlobal.Number(t):0,r.calledWithNew()?(this.data=t,this):t},this.NUMBER=this.createNativeFunction(i,!0),this.setProperty(t,"Number",this.NUMBER,e.NONENUMERABLE_DESCRIPTOR);for(var n=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],o=0;o<n.length;o++)this.setProperty(this.NUMBER,n[o],Number[n[o]],e.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);i=function(t){try{return Number(this).toExponential(t)}catch(e){r.throwException(r.ERROR,e.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toExponential",i),i=function(t){try{return Number(this).toFixed(t)}catch(e){r.throwException(r.ERROR,e.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toFixed",i),i=function(t){try{return Number(this).toPrecision(t)}catch(e){r.throwException(r.ERROR,e.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",i),i=function(t){try{return Number(this).toString(t)}catch(e){r.throwException(r.ERROR,e.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toString",i),i=function(t,e){return t=t?r.pseudoToNative(t):void 0,e=e?r.pseudoToNative(e):void 0,Number(this).toLocaleString(t,e)},this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",i)},e.prototype.initDate=function(t){var i,r=this;i=function(t,i){if(!r.calledWithNew())return e.nativeGlobal.Date();var n=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(e.nativeGlobal.Date,n)),this},this.DATE=this.createNativeFunction(i,!0),this.DATE_PROTO=this.DATE.properties["prototype"],this.setProperty(t,"Date",this.DATE,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),e.NONENUMERABLE_DESCRIPTOR);for(var n=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toISOString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],o=0;o<n.length;o++)i=function(t){return function(e){var i=this.data;i instanceof Date||r.throwException(r.TYPE_ERROR,t+" not called on a Date");for(var n=[],o=0;o<arguments.length;o++)n[o]=r.pseudoToNative(arguments[o]);return i[t].apply(i,n)}}(n[o]),this.setNativeFunctionPrototype(this.DATE,n[o],i)},e.prototype.initRegExp=function(t){var i,r=this;i=function(t,i){if(r.calledWithNew())var n=this;else n=r.createObjectProto(r.REGEXP_PROTO);return t=t?String(t):"",i=i?String(i):"",r.populateRegExp(n,new e.nativeGlobal.RegExp(t,i)),n},this.REGEXP=this.createNativeFunction(i,!0),this.REGEXP_PROTO=this.REGEXP.properties["prototype"],this.setProperty(t,"RegExp",this.REGEXP,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"global",void 0,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"ignoreCase",void 0,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"multiline",void 0,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"source","(?:)",e.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return String(str).search(this) !== -1","}","});"),i=function(t,i){var n=this.data;if(t=String(t),n.lastIndex=Number(r.getProperty(this,"lastIndex")),r.maybeThrowRegExp(n,i),2!==r["REGEXP_MODE"]){a=n.exec(t);r.setProperty(this,"lastIndex",n.lastIndex),i(u(a))}else if(e.vm){var o={string:t,regexp:n},s="regexp.exec(string)",a=r.vmCall(s,o,n,i);a!==e.REGEXP_TIMEOUT&&(r.setProperty(this,"lastIndex",n.lastIndex),i(u(a)))}else{var l=r.createWorker(),h=r.regExpTimeout(n,l,i),c=this;l.onmessage=function(t){clearTimeout(h),r.setProperty(c,"lastIndex",t.data[1]),i(u(t.data[0]))},l.postMessage(["exec",n,n.lastIndex,t])}function u(t){if(t){var e=r.arrayNativeToPseudo(t);return r.setProperty(e,"index",t.index),r.setProperty(e,"input",t.input),e}return null}},this.setAsyncFunctionPrototype(this.REGEXP,"exec",i)},e.prototype.initError=function(t){var i=this;this.ERROR=this.createNativeFunction((function(t){if(i.calledWithNew())var r=this;else r=i.createObject(i.ERROR);return t&&i.setProperty(r,"message",String(t),e.NONENUMERABLE_DESCRIPTOR),r}),!0),this.setProperty(t,"Error",this.ERROR,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties["prototype"],"message","",e.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties["prototype"],"name","Error",e.NONENUMERABLE_DESCRIPTOR);var r=function(r){var n=i.createNativeFunction((function(t){if(i.calledWithNew())var r=this;else r=i.createObject(n);return t&&i.setProperty(r,"message",String(t),e.NONENUMERABLE_DESCRIPTOR),r}),!0);return i.setProperty(n,"prototype",i.createObject(i.ERROR),e.NONENUMERABLE_DESCRIPTOR),i.setProperty(n.properties["prototype"],"name",r,e.NONENUMERABLE_DESCRIPTOR),i.setProperty(t,r,n,e.NONENUMERABLE_DESCRIPTOR),n};this.EVAL_ERROR=r("EvalError"),this.RANGE_ERROR=r("RangeError"),this.REFERENCE_ERROR=r("ReferenceError"),this.SYNTAX_ERROR=r("SyntaxError"),this.TYPE_ERROR=r("TypeError"),this.URI_ERROR=r("URIError")},e.prototype.initMath=function(t){var i=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(t,"Math",i,e.NONENUMERABLE_DESCRIPTOR);for(var r=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],n=0;n<r.length;n++)this.setProperty(i,r[n],Math[r[n]],e.READONLY_NONENUMERABLE_DESCRIPTOR);var o=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];for(n=0;n<o.length;n++)this.setProperty(i,o[n],this.createNativeFunction(Math[o[n]],!1),e.NONENUMERABLE_DESCRIPTOR)},e.prototype.initJSON=function(t){var i=this,r=i.createObjectProto(this.OBJECT_PROTO);this.setProperty(t,"JSON",r,e.NONENUMERABLE_DESCRIPTOR);var n=function(t){try{var e=JSON.parse(String(t))}catch(r){i.throwException(i.SYNTAX_ERROR,r.message)}return i.nativeToPseudo(e)};this.setProperty(r,"parse",this.createNativeFunction(n,!1)),n=function(t,e,r){e&&"Function"===e.class?i.throwException(i.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):e&&"Array"===e.class?(e=i.arrayPseudoToNative(e),e=e.filter((function(t){return"string"===typeof t||"number"===typeof t}))):e=null,"string"!==typeof r&&"number"!==typeof r&&(r=void 0);var n=i.pseudoToNative(t);try{var o=JSON.stringify(n,e,r)}catch(s){i.throwException(i.TYPE_ERROR,s.message)}return o},this.setProperty(r,"stringify",this.createNativeFunction(n,!1))},e.prototype.isa=function(t,e){if(null===t||void 0===t||!e)return!1;var i=e.properties["prototype"];if(t===i)return!0;t=this.getPrototype(t);while(t){if(t===i)return!0;t=t.proto}return!1},e.prototype.populateRegExp=function(t,i){t.data=new RegExp(i.source,i.flags),this.setProperty(t,"lastIndex",i.lastIndex,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"source",i.source,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"global",i.global,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"ignoreCase",i.ignoreCase,e.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"multiline",i.multiline,e.READONLY_NONENUMERABLE_DESCRIPTOR)},e.prototype.createWorker=function(){var t=this.createWorker.blob_;return t||(t=new Blob([e.WORKER_CODE.join("\n")],{type:"application/javascript"}),this.createWorker.blob_=t),new Worker(URL.createObjectURL(t))},e.prototype.vmCall=function(t,i,r,n){var o={timeout:this["REGEXP_THREAD_TIMEOUT"]};try{return e.vm["runInNewContext"](t,i,o)}catch(s){n(null),this.throwException(this.ERROR,"RegExp Timeout: "+r)}return e.REGEXP_TIMEOUT},e.prototype.maybeThrowRegExp=function(t,r){var n;if(0===this["REGEXP_MODE"])n=!1;else if(1===this["REGEXP_MODE"])n=!0;else if(e.vm)n=!0;else if("function"===typeof Worker&&"function"===typeof URL)n=!0;else{try{e.vm=i(/*! vm */"./node_modules/vm-browserify/index.js")}catch(o){}n=!!e.vm}n||(r(null),this.throwException(this.ERROR,"Regular expressions not supported: "+t))},e.prototype.regExpTimeout=function(t,e,i){var r=this;return setTimeout((function(){e.terminate(),i(null);try{r.throwException(r.ERROR,"RegExp Timeout: "+t)}catch(n){}}),this["REGEXP_THREAD_TIMEOUT"])},e.prototype.createObject=function(t){return this.createObjectProto(t&&t.properties["prototype"])},e.prototype.createObjectProto=function(t){if("object"!==typeof t)throw Error("Non object prototype");var i=new e.Object(t);return this.isa(i,this.ERROR)&&(i.class="Error"),i},e.prototype.createArray=function(){var t=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(t,"length",0,{configurable:!1,enumerable:!1,writable:!0}),t.class="Array",t},e.prototype.createFunctionBase_=function(t,i){var r=this.createObjectProto(this.FUNCTION_PROTO);if(i){var n=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(r,"prototype",n,e.NONENUMERABLE_DESCRIPTOR),this.setProperty(n,"constructor",r,e.NONENUMERABLE_DESCRIPTOR)}else r.illegalConstructor=!0;return this.setProperty(r,"length",t,e.READONLY_NONENUMERABLE_DESCRIPTOR),r.class="Function",r},e.prototype.createFunction=function(t,i,r){var n=this.createFunctionBase_(t["params"].length,!0);n.parentScope=i,n.node=t;var o=t["id"]?String(t["id"]["name"]):r||"";return this.setProperty(n,"name",o,e.READONLY_NONENUMERABLE_DESCRIPTOR),n},e.prototype.createNativeFunction=function(t,i){var r=this.createFunctionBase_(t.length,i);return r.nativeFunc=t,t.id=this.functionCounter_++,this.setProperty(r,"name",t.name,e.READONLY_NONENUMERABLE_DESCRIPTOR),r},e.prototype.createAsyncFunction=function(t){var i=this.createFunctionBase_(t.length,!0);return i.asyncFunc=t,t.id=this.functionCounter_++,this.setProperty(i,"name",t.name,e.READONLY_NONENUMERABLE_DESCRIPTOR),i},e.prototype.nativeToPseudo=function(t){if(t instanceof e.Object)throw Error("Object is already pseudo");if("object"!==typeof t&&"function"!==typeof t||null===t)return t;if(t instanceof RegExp){var i=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(i,t),i}if(t instanceof Date){var r=this.createObjectProto(this.DATE_PROTO);return r.data=new Date(t.valueOf()),r}if("function"===typeof t){var n=this,o=function(){var e=Array.prototype.slice.call(arguments).map((function(t){return n.pseudoToNative(t)})),i=t.apply(n,e);return n.nativeToPseudo(i)},s=Object.getOwnPropertyDescriptor(t,"prototype");return this.createNativeFunction(o,!!s)}if(Array.isArray(t)){for(var a=this.createArray(),l=0;l<t.length;l++)l in t&&this.setProperty(a,l,this.nativeToPseudo(t[l]));return a}var h=this.createObjectProto(this.OBJECT_PROTO);for(var c in t)this.setProperty(h,c,this.nativeToPseudo(t[c]));return h},e.prototype.pseudoToNative=function(t,i){if("object"!==typeof t&&"function"!==typeof t||null===t)return t;if(!(t instanceof e.Object))throw Error("Object is not pseudo");if(this.isa(t,this.REGEXP)){var r=new RegExp(t.data.source,t.data.flags);return r.lastIndex=t.data.lastIndex,r}if(this.isa(t,this.DATE))return new Date(t.data.valueOf());var n,o=i||{pseudo:[],native:[]},s=o.pseudo.indexOf(t);if(-1!==s)return o.native[s];if(o.pseudo.push(t),this.isa(t,this.ARRAY)){n=[],o.native.push(n);var a=this.getProperty(t,"length");for(s=0;s<a;s++)this.hasProperty(t,s)&&(n[s]=this.pseudoToNative(this.getProperty(t,s),o))}else{var l;for(var h in n={},o.native.push(n),t.properties)l=this.pseudoToNative(t.properties[h],o),Object.defineProperty(n,h,{value:l,writable:!0,enumerable:!0,configurable:!0})}return o.pseudo.pop(),o.native.pop(),n},e.prototype.arrayNativeToPseudo=function(t){for(var e=this.createArray(),i=Object.getOwnPropertyNames(t),r=0;r<i.length;r++)this.setProperty(e,i[r],t[i[r]]);return e},e.prototype.arrayPseudoToNative=function(t){var i=[];for(var r in t.properties)i[r]=this.getProperty(t,r);return i.length=e.legalArrayLength(this.getProperty(t,"length"))||0,i},e.prototype.getPrototype=function(t){switch(typeof t){case"number":return this.NUMBER.properties["prototype"];case"boolean":return this.BOOLEAN.properties["prototype"];case"string":return this.STRING.properties["prototype"]}return t?t.proto:null},e.prototype.getProperty=function(t,i){if(this.getterStep_)throw Error("Getter not supported in that context");if(i=String(i),void 0!==t&&null!==t||this.throwException(this.TYPE_ERROR,"Cannot read property '"+i+"' of "+t),"object"===typeof t&&!(t instanceof e.Object))throw TypeError("Expecting native value or pseudo object");if("length"===i){if(this.isa(t,this.STRING))return String(t).length}else if(i.charCodeAt(0)<64&&this.isa(t,this.STRING)){var r=e.legalArrayIndex(i);if(!isNaN(r)&&r<String(t).length)return String(t)[r]}do{if(t.properties&&i in t.properties){var n=t.getter[i];return n?(this.getterStep_=!0,n):t.properties[i]}}while(t=this.getPrototype(t))},e.prototype.hasProperty=function(t,i){if(!(t instanceof e.Object))throw TypeError("Primitive data type has no properties");if(i=String(i),"length"===i&&this.isa(t,this.STRING))return!0;if(this.isa(t,this.STRING)){var r=e.legalArrayIndex(i);if(!isNaN(r)&&r<String(t).length)return!0}do{if(t.properties&&i in t.properties)return!0}while(t=this.getPrototype(t));return!1},e.prototype.setProperty=function(t,i,r,n){if(this.setterStep_)throw Error("Setter not supported in that context");if(i=String(i),void 0!==t&&null!==t||this.throwException(this.TYPE_ERROR,"Cannot set property '"+i+"' of "+t),"object"===typeof t&&!(t instanceof e.Object))throw TypeError("Expecting native value or pseudo object");n&&("get"in n||"set"in n)&&("value"in n||"writable"in n)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var o=!this.stateStack||this.getScope().strict;if(t instanceof e.Object){if(this.isa(t,this.STRING)){var s=e.legalArrayIndex(i);if("length"===i||!isNaN(s)&&s<String(t).length)return void(o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+i+"' of String '"+t.data+"'"))}if("Array"===t.class){var a,l=t.properties.length;if("length"===i){if(n){if(!("value"in n))return;r=n.value}if(r=e.legalArrayLength(r),isNaN(r)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),r<l)for(a in t.properties)a=e.legalArrayIndex(a),!isNaN(a)&&r<=a&&delete t.properties[a]}else isNaN(a=e.legalArrayIndex(i))||(t.properties.length=Math.max(l,a+1))}if(!t.preventExtensions||i in t.properties)if(n){var h={};"get"in n&&n.get&&(t.getter[i]=n.get,h.get=this.setProperty.placeholderGet_),"set"in n&&n.set&&(t.setter[i]=n.set,h.set=this.setProperty.placeholderSet_),"configurable"in n&&(h.configurable=n.configurable),"enumerable"in n&&(h.enumerable=n.enumerable),"writable"in n&&(h.writable=n.writable,delete t.getter[i],delete t.setter[i]),"value"in n?(h.value=n.value,delete t.getter[i],delete t.setter[i]):r!==e.VALUE_IN_DESCRIPTOR&&(h.value=r,delete t.getter[i],delete t.setter[i]);try{Object.defineProperty(t.properties,i,h)}catch(u){this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+i)}"get"in n&&!n.get&&delete t.getter[i],"set"in n&&!n.set&&delete t.setter[i]}else{if(r===e.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified.");var c=t;while(!(i in c.properties))if(c=this.getPrototype(c),!c){c=t;break}if(c.setter&&c.setter[i])return this.setterStep_=!0,c.setter[i];if(c.getter&&c.getter[i])o&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+i+"' of object '"+t+"' which only has a getter");else try{t.properties[i]=r}catch(u){o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+i+"' of object '"+t+"'")}}else o&&this.throwException(this.TYPE_ERROR,"Can't add property '"+i+"', object is not extensible")}else o&&this.throwException(this.TYPE_ERROR,"Can't create property '"+i+"' on '"+t+"'")},e.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},e.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},e.prototype.setNativeFunctionPrototype=function(t,i,r){this.setProperty(t.properties["prototype"],i,this.createNativeFunction(r,!1),e.NONENUMERABLE_DESCRIPTOR)},e.prototype.setAsyncFunctionPrototype=function(t,i,r){this.setProperty(t.properties["prototype"],i,this.createAsyncFunction(r),e.NONENUMERABLE_DESCRIPTOR)},e.prototype.getScope=function(){var t=this.stateStack[this.stateStack.length-1].scope;if(!t)throw Error("No scope found.");return t},e.prototype.createScope=function(t,i){var r=!1;if(i&&i.strict)r=!0;else{var n=t["body"]&&t["body"][0];n&&n.expression&&"Literal"===n.expression["type"]&&"use strict"===n.expression.value&&(r=!0)}var o=this.createObjectProto(null),s=new e.Scope(i,r,o);return i||this.initGlobal(s.object),this.populateScope_(t,s),s},e.prototype.createSpecialScope=function(t,i){if(!t)throw Error("parentScope required");var r=i||this.createObjectProto(null);return new e.Scope(t,t.strict,r)},e.prototype.getValueFromScope=function(t){var e=this.getScope();while(e&&e!==this.globalScope){if(t in e.object.properties)return e.object.properties[t];e=e.parentScope}if(e===this.globalScope&&this.hasProperty(e.object,t))return this.getProperty(e.object,t);var i=this.stateStack[this.stateStack.length-1].node;"UnaryExpression"===i["type"]&&"typeof"===i["operator"]||this.throwException(this.REFERENCE_ERROR,t+" is not defined")},e.prototype.setValueToScope=function(t,e){var i=this.getScope(),r=i.strict;while(i&&i!==this.globalScope){if(t in i.object.properties)return void(i.object.properties[t]=e);i=i.parentScope}if(i===this.globalScope&&(!r||this.hasProperty(i.object,t)))return this.setProperty(i.object,t,e);this.throwException(this.REFERENCE_ERROR,t+" is not defined")},e.prototype.populateScope_=function(t,i){if("VariableDeclaration"===t["type"])for(var r=0;r<t["declarations"].length;r++)this.setProperty(i.object,t["declarations"][r]["id"]["name"],void 0,e.VARIABLE_DESCRIPTOR);else{if("FunctionDeclaration"===t["type"])return void this.setProperty(i.object,t["id"]["name"],this.createFunction(t,i),e.VARIABLE_DESCRIPTOR);if("FunctionExpression"===t["type"])return;if("ExpressionStatement"===t["type"])return}var n=t["constructor"];for(var o in t){var s=t[o];if(s&&"object"===typeof s)if(Array.isArray(s))for(r=0;r<s.length;r++)s[r]&&s[r].constructor===n&&this.populateScope_(s[r],i);else s.constructor===n&&this.populateScope_(s,i)}},e.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},e.prototype.getValue=function(t){return t[0]===e.SCOPE_REFERENCE?this.getValueFromScope(t[1]):this.getProperty(t[0],t[1])},e.prototype.setValue=function(t,i){return t[0]===e.SCOPE_REFERENCE?this.setValueToScope(t[1],i):this.setProperty(t[0],t[1],i)},e.prototype.throwException=function(t,i){if(void 0===i)var r=t;else{r=this.createObject(t);this.setProperty(r,"message",i,e.NONENUMERABLE_DESCRIPTOR)}throw this.unwind(e.Completion.THROW,r,void 0),e.STEP_ERROR},e.prototype.unwind=function(t,i,r){if(t===e.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");t:for(var n=this.stateStack;n.length>0;n.pop()){var o=n[n.length-1];switch(o.node["type"]){case"TryStatement":return void(o.cv={type:t,value:i,label:r});case"CallExpression":case"NewExpression":if(t===e.Completion.RETURN)return void(o.value=i);if(t!==e.Completion.THROW)throw Error("Unsynatctic break/continue not rejected by Acorn");break;case"Program":o.done=!0;break t}if(t===e.Completion.BREAK){if(r?o.labels&&-1!==o.labels.indexOf(r):o.isLoop||o.isSwitch)return void n.pop()}else if(t===e.Completion.CONTINUE&&(r?o.labels&&-1!==o.labels.indexOf(r):o.isLoop))return}var s;if(this.isa(i,this.ERROR)){var a={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},l=String(this.getProperty(i,"name")),h=this.getProperty(i,"message").valueOf(),c=a[l]||Error;s=c(h)}else s=String(i);throw s},e.prototype.createGetter_=function(t,i){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var r=Array.isArray(i)?i[0]:i,n=new this.nodeConstructor({options:{}});n["type"]="CallExpression";var o=new e.State(n,this.stateStack[this.stateStack.length-1].scope);return o.doneCallee_=!0,o.funcThis_=r,o.func_=t,o.doneArgs_=!0,o.arguments_=[],o},e.prototype.createSetter_=function(t,i,r){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var n=Array.isArray(i)?i[0]:this.globalObject,o=new this.nodeConstructor({options:{}});o["type"]="CallExpression";var s=new e.State(o,this.stateStack[this.stateStack.length-1].scope);return s.doneCallee_=!0,s.funcThis_=n,s.func_=t,s.doneArgs_=!0,s.arguments_=[r],s},e.prototype.boxThis_=function(t){if(void 0===t||null===t)return this.globalObject;if(!(t instanceof e.Object)){var i=this.createObjectProto(this.getPrototype(t));return i.data=t,i}return t},e.Value,e.State=function(t,e){this.node=t,this.scope=e},e.Scope=function(t,e,i){this.parentScope=t,this.strict=e,this.object=i},e.Object=function(t){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=t},e.Object.prototype.proto=null,e.Object.prototype.class="Object",e.Object.prototype.data=null,e.Object.prototype.toString=function(){if(!(this instanceof e.Object))return String(this);if("Array"===this.class){var t=e.toStringCycles_;t.push(this);try{var i=[],r=this.properties.length,n=!1;r>1024&&(r=1e3,n=!0);for(var o=0;o<r;o++){var s=this.properties[o];i[o]=s instanceof e.Object&&-1!==t.indexOf(s)?"...":s}n&&i.push("...")}finally{t.pop()}return i.join(",")}if("Error"===this.class){var a,l;t=e.toStringCycles_;if(-1!==t.indexOf(this))return"[object Error]";var h=this;do{if("name"in h.properties){a=h.properties["name"];break}}while(h=h.proto);h=this;do{if("message"in h.properties){l=h.properties["message"];break}}while(h=h.proto);t.push(this);try{a=a&&String(a),l=l&&String(l)}finally{t.pop()}return l?a+": "+l:String(a)}return null!==this.data?String(this.data):"[object "+this.class+"]"},e.Object.prototype.valueOf=function(){return void 0===this.data||null===this.data||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data},e.prototype["stepArrayExpression"]=function(t,i,r){var n=r["elements"],o=i.n_||0;i.array_?(this.setProperty(i.array_,o,i.value),o++):(i.array_=this.createArray(),i.array_.properties.length=n.length);while(o<n.length){if(n[o])return i.n_=o,new e.State(n[o],i.scope);o++}t.pop(),t[t.length-1].value=i.array_},e.prototype["stepAssignmentExpression"]=function(t,i,r){if(!i.doneLeft_){i.doneLeft_=!0;var n=new e.State(r["left"],i.scope);return n.components=!0,n}if(!i.doneRight_){if(i.leftReference_||(i.leftReference_=i.value),i.doneGetter_&&(i.leftValue_=i.value),!i.doneGetter_&&"="!==r["operator"]){var o=this.getValue(i.leftReference_);if(i.leftValue_=o,this.getterStep_){i.doneGetter_=!0;var s=o;return this.createGetter_(s,i.leftReference_)}}return i.doneRight_=!0,"="===r["operator"]&&"Identifier"===r["left"]["type"]&&(i.destinationName=r["left"]["name"]),new e.State(r["right"],i.scope)}if(i.doneSetter_)return t.pop(),void(t[t.length-1].value=i.setterValue_);var a=i.leftValue_,l=i.value;switch(r["operator"]){case"=":a=l;break;case"+=":a+=l;break;case"-=":a-=l;break;case"*=":a*=l;break;case"/=":a/=l;break;case"%=":a%=l;break;case"<<=":a<<=l;break;case">>=":a>>=l;break;case">>>=":a>>>=l;break;case"&=":a&=l;break;case"^=":a^=l;break;case"|=":a|=l;break;default:throw SyntaxError("Unknown assignment expression: "+r["operator"])}var h=this.setValue(i.leftReference_,a);if(h)return i.doneSetter_=!0,i.setterValue_=a,this.createSetter_(h,i.leftReference_,a);t.pop(),t[t.length-1].value=a},e.prototype["stepBinaryExpression"]=function(t,i,r){if(!i.doneLeft_)return i.doneLeft_=!0,new e.State(r["left"],i.scope);if(!i.doneRight_)return i.doneRight_=!0,i.leftValue_=i.value,new e.State(r["right"],i.scope);t.pop();var n,o=i.leftValue_,s=i.value;switch(r["operator"]){case"==":n=o==s;break;case"!=":n=o!=s;break;case"===":n=o===s;break;case"!==":n=o!==s;break;case">":n=o>s;break;case">=":n=o>=s;break;case"<":n=o<s;break;case"<=":n=o<=s;break;case"+":n=o+s;break;case"-":n=o-s;break;case"*":n=o*s;break;case"/":n=o/s;break;case"%":n=o%s;break;case"&":n=o&s;break;case"|":n=o|s;break;case"^":n=o^s;break;case"<<":n=o<<s;break;case">>":n=o>>s;break;case">>>":n=o>>>s;break;case"in":s instanceof e.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+s+"'"),n=this.hasProperty(s,o);break;case"instanceof":this.isa(s,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"Right-hand side of instanceof is not an object"),n=o instanceof e.Object&&this.isa(o,s);break;default:throw SyntaxError("Unknown binary operator: "+r["operator"])}t[t.length-1].value=n},e.prototype["stepBlockStatement"]=function(t,i,r){var n=i.n_||0,o=r["body"][n];if(o)return i.n_=n+1,new e.State(o,i.scope);t.pop()},e.prototype["stepBreakStatement"]=function(t,i,r){var n=r["label"]&&r["label"]["name"];this.unwind(e.Completion.BREAK,void 0,n)},e.prototype["stepCallExpression"]=function(i,r,n){if(!r.doneCallee_){r.doneCallee_=1;var o=new e.State(n["callee"],r.scope);return o.components=!0,o}if(1===r.doneCallee_){r.doneCallee_=2;var s=r.value;if(Array.isArray(s)){if(r.func_=this.getValue(s),s[0]===e.SCOPE_REFERENCE?r.directEval_="eval"===s[1]:r.funcThis_=s[0],s=r.func_,this.getterStep_)return r.doneCallee_=1,this.createGetter_(s,r.value)}else r.func_=s;r.arguments_=[],r.n_=0}s=r.func_;if(!r.doneArgs_){if(0!==r.n_&&r.arguments_.push(r.value),n["arguments"][r.n_])return new e.State(n["arguments"][r.n_++],r.scope);if("NewExpression"===n["type"]){if(s instanceof e.Object&&!s.illegalConstructor||this.throwException(this.TYPE_ERROR,s+" is not a constructor"),s===this.ARRAY)r.funcThis_=this.createArray();else{var a=s.properties["prototype"];"object"===typeof a&&null!==a||(a=this.OBJECT_PROTO),r.funcThis_=this.createObjectProto(a)}r.isConstructor=!0}r.doneArgs_=!0}if(r.doneExec_)i.pop(),r.isConstructor&&"object"!==typeof r.value?i[i.length-1].value=r.funcThis_:i[i.length-1].value=r.value;else{r.doneExec_=!0,s instanceof e.Object||this.throwException(this.TYPE_ERROR,s+" is not a function");var l=s.node;if(l){for(var h=this.createScope(l["body"],s.parentScope),c=0;c<l["params"].length;c++){var u=l["params"][c]["name"],d=r.arguments_.length>c?r.arguments_[c]:void 0;this.setProperty(h.object,u,d)}var p=this.createArray();for(c=0;c<r.arguments_.length;c++)this.setProperty(p,c,r.arguments_[c]);this.setProperty(h.object,"arguments",p);var f=l["id"]&&l["id"]["name"];return f&&this.setProperty(h.object,f,s),h.strict||(r.funcThis_=this.boxThis_(r.funcThis_)),this.setProperty(h.object,"this",r.funcThis_,e.READONLY_DESCRIPTOR),r.value=void 0,new e.State(l["body"],h)}if(s.eval){var _=r.arguments_[0];if("string"===typeof _){try{var g=t.parse(String(_),e.PARSE_OPTIONS)}catch(O){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+O.message)}var m=new this.nodeConstructor({options:{}});m["type"]="EvalProgram_",m["body"]=g["body"],e.stripLocations_(m,n["start"],n["end"]);h=r.directEval_?r.scope:this.globalScope;return h.strict?h=this.createScope(g,h):this.populateScope_(g,h),this.value=void 0,new e.State(m,h)}r.value=_}else if(s.nativeFunc)r.scope.strict||(r.funcThis_=this.boxThis_(r.funcThis_)),r.value=s.nativeFunc.apply(r.funcThis_,r.arguments_);else{if(s.asyncFunc){var b=this,v=function(t){r.value=t,b.paused_=!1},y=s.asyncFunc.length-1,T=r.arguments_.concat(new Array(y)).slice(0,y);return T.push(v),this.paused_=!0,r.scope.strict||(r.funcThis_=this.boxThis_(r.funcThis_)),void s.asyncFunc.apply(r.funcThis_,T)}this.throwException(this.TYPE_ERROR,s.class+" is not callable")}}},e.prototype["stepCatchClause"]=function(t,i,r){if(!i.done_){i.done_=!0;var n=this.createSpecialScope(i.scope);return this.setProperty(n.object,r["param"]["name"],i.throwValue),new e.State(r["body"],n)}t.pop()},e.prototype["stepConditionalExpression"]=function(t,i,r){var n=i.mode_||0;if(0===n)return i.mode_=1,new e.State(r["test"],i.scope);if(1===n){i.mode_=2;var o=Boolean(i.value);if(o&&r["consequent"])return new e.State(r["consequent"],i.scope);if(!o&&r["alternate"])return new e.State(r["alternate"],i.scope);this.value=void 0}t.pop(),"ConditionalExpression"===r["type"]&&(t[t.length-1].value=i.value)},e.prototype["stepContinueStatement"]=function(t,i,r){var n=r["label"]&&r["label"]["name"];this.unwind(e.Completion.CONTINUE,void 0,n)},e.prototype["stepDebuggerStatement"]=function(t,e,i){t.pop()},e.prototype["stepDoWhileStatement"]=function(t,i,r){if("DoWhileStatement"===r["type"]&&void 0===i.test_&&(i.value=!0,i.test_=!0),!i.test_)return i.test_=!0,new e.State(r["test"],i.scope);if(i.value){if(r["body"])return i.test_=!1,i.isLoop=!0,new e.State(r["body"],i.scope)}else t.pop()},e.prototype["stepEmptyStatement"]=function(t,e,i){t.pop()},e.prototype["stepEvalProgram_"]=function(t,i,r){var n=i.n_||0,o=r["body"][n];if(o)return i.n_=n+1,new e.State(o,i.scope);t.pop(),t[t.length-1].value=this.value},e.prototype["stepExpressionStatement"]=function(t,i,r){if(!i.done_)return i.done_=!0,new e.State(r["expression"],i.scope);t.pop(),this.value=i.value},e.prototype["stepForInStatement"]=function(t,i,r){if(!i.doneInit_&&(i.doneInit_=!0,r["left"]["declarations"]&&r["left"]["declarations"][0]["init"]))return i.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer."),new e.State(r["left"],i.scope);if(!i.doneObject_)return i.doneObject_=!0,i.variable_||(i.variable_=i.value),new e.State(r["right"],i.scope);if(i.isLoop||(i.isLoop=!0,i.object_=i.value,i.visited_=Object.create(null)),void 0===i.name_)t:while(1){if(i.object_ instanceof e.Object){i.props_||(i.props_=Object.getOwnPropertyNames(i.object_.properties));while(1){var n=i.props_.shift();if(void 0===n)break;if(Object.prototype.hasOwnProperty.call(i.object_.properties,n)&&(!i.visited_[n]&&(i.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(i.object_.properties,n)))){i.name_=n;break t}}}else if(null!==i.object_&&void 0!==i.object_){i.props_||(i.props_=Object.getOwnPropertyNames(i.object_));while(1){n=i.props_.shift();if(void 0===n)break;if(i.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(i.object_,n)){i.name_=n;break t}}}if(i.object_=this.getPrototype(i.object_),i.props_=null,null===i.object_)return void t.pop()}if(!i.doneVariable_){i.doneVariable_=!0;var o=r["left"];if("VariableDeclaration"!==o["type"]){i.variable_=null;var s=new e.State(o,i.scope);return s.components=!0,s}i.variable_=[e.SCOPE_REFERENCE,o["declarations"][0]["id"]["name"]]}if(i.variable_||(i.variable_=i.value),!i.doneSetter_){i.doneSetter_=!0;var a=i.name_,l=this.setValue(i.variable_,a);if(l)return this.createSetter_(l,i.variable_,a)}return i.name_=void 0,i.doneVariable_=!1,i.doneSetter_=!1,r["body"]?new e.State(r["body"],i.scope):void 0},e.prototype["stepForStatement"]=function(t,i,r){var n=i.mode_||0;if(0===n){if(i.mode_=1,r["init"])return new e.State(r["init"],i.scope)}else if(1===n){if(i.mode_=2,r["test"])return new e.State(r["test"],i.scope)}else if(2===n){if(i.mode_=3,!r["test"]||i.value)return i.isLoop=!0,new e.State(r["body"],i.scope);t.pop()}else if(3===n&&(i.mode_=1,r["update"]))return new e.State(r["update"],i.scope)},e.prototype["stepFunctionDeclaration"]=function(t,e,i){t.pop()},e.prototype["stepFunctionExpression"]=function(t,e,i){t.pop(),e=t[t.length-1],e.value=this.createFunction(i,e.scope,e.destinationName)},e.prototype["stepIdentifier"]=function(t,i,r){if(t.pop(),i.components)t[t.length-1].value=[e.SCOPE_REFERENCE,r["name"]];else{var n=this.getValueFromScope(r["name"]);if(this.getterStep_){var o=n;return this.createGetter_(o,this.globalObject)}t[t.length-1].value=n}},e.prototype["stepIfStatement"]=e.prototype["stepConditionalExpression"],e.prototype["stepLabeledStatement"]=function(t,i,r){t.pop();var n=i.labels||[];n.push(r["label"]["name"]);var o=new e.State(r["body"],i.scope);return o.labels=n,o},e.prototype["stepLiteral"]=function(t,e,i){t.pop();var r=i["value"];if(r instanceof RegExp){var n=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(n,r),r=n}t[t.length-1].value=r},e.prototype["stepLogicalExpression"]=function(t,i,r){if("&&"!==r["operator"]&&"||"!==r["operator"])throw SyntaxError("Unknown logical operator: "+r["operator"]);if(!i.doneLeft_)return i.doneLeft_=!0,new e.State(r["left"],i.scope);if(i.doneRight_)t.pop(),t[t.length-1].value=i.value;else{if(!("&&"===r["operator"]&&!i.value||"||"===r["operator"]&&i.value))return i.doneRight_=!0,new e.State(r["right"],i.scope);t.pop(),t[t.length-1].value=i.value}},e.prototype["stepMemberExpression"]=function(t,i,r){if(!i.doneObject_)return i.doneObject_=!0,new e.State(r["object"],i.scope);var n;if(r["computed"]){if(!i.doneProperty_)return i.object_=i.value,i.doneProperty_=!0,new e.State(r["property"],i.scope);n=i.value}else i.object_=i.value,n=r["property"]["name"];if(t.pop(),i.components)t[t.length-1].value=[i.object_,n];else{var o=this.getProperty(i.object_,n);if(this.getterStep_){var s=o;return this.createGetter_(s,i.object_)}t[t.length-1].value=o}},e.prototype["stepNewExpression"]=e.prototype["stepCallExpression"],e.prototype["stepObjectExpression"]=function(t,i,r){var n=i.n_||0,o=r["properties"][n];if(i.object_){var s=i.destinationName;i.properties_[s]||(i.properties_[s]={}),i.properties_[s][o["kind"]]=i.value,i.n_=++n,o=r["properties"][n]}else i.object_=this.createObjectProto(this.OBJECT_PROTO),i.properties_=Object.create(null);if(o){var a=o["key"];if("Identifier"===a["type"])s=a["name"];else{if("Literal"!==a["type"])throw SyntaxError("Unknown object structure: "+a["type"]);s=a["value"]}return i.destinationName=s,new e.State(o["value"],i.scope)}for(var a in i.properties_){var l=i.properties_[a];if("get"in l||"set"in l){var h={configurable:!0,enumerable:!0,get:l["get"],set:l["set"]};this.setProperty(i.object_,a,e.VALUE_IN_DESCRIPTOR,h)}else this.setProperty(i.object_,a,l["init"])}t.pop(),t[t.length-1].value=i.object_},e.prototype["stepProgram"]=function(t,i,r){var n=r["body"].shift();if(n)return i.done=!1,new e.State(n,i.scope);i.done=!0},e.prototype["stepReturnStatement"]=function(t,i,r){if(r["argument"]&&!i.done_)return i.done_=!0,new e.State(r["argument"],i.scope);this.unwind(e.Completion.RETURN,i.value,void 0)},e.prototype["stepSequenceExpression"]=function(t,i,r){var n=i.n_||0,o=r["expressions"][n];if(o)return i.n_=n+1,new e.State(o,i.scope);t.pop(),t[t.length-1].value=i.value},e.prototype["stepSwitchStatement"]=function(t,i,r){if(!i.test_)return i.test_=1,new e.State(r["discriminant"],i.scope);1===i.test_&&(i.test_=2,i.switchValue_=i.value,i.defaultCase_=-1);while(1){var n=i.index_||0,o=r["cases"][n];if(i.matched_||!o||o["test"])if(o||i.matched_||-1===i.defaultCase_){if(!o)return void t.pop();if(!i.matched_&&!i.tested_&&o["test"])return i.tested_=!0,new e.State(o["test"],i.scope);if(i.matched_||i.value===i.switchValue_){i.matched_=!0;var s=i.n_||0;if(o["consequent"][s])return i.isSwitch=!0,i.n_=s+1,new e.State(o["consequent"][s],i.scope)}i.tested_=!1,i.n_=0,i.index_=n+1}else i.matched_=!0,i.index_=i.defaultCase_;else i.defaultCase_=n,i.index_=n+1}},e.prototype["stepThisExpression"]=function(t,e,i){t.pop(),t[t.length-1].value=this.getValueFromScope("this")},e.prototype["stepThrowStatement"]=function(t,i,r){if(!i.done_)return i.done_=!0,new e.State(r["argument"],i.scope);this.throwException(i.value)},e.prototype["stepTryStatement"]=function(t,i,r){if(!i.doneBlock_)return i.doneBlock_=!0,new e.State(r["block"],i.scope);if(i.cv&&i.cv.type===e.Completion.THROW&&!i.doneHandler_&&r["handler"]){i.doneHandler_=!0;var n=new e.State(r["handler"],i.scope);return n.throwValue=i.cv.value,i.cv=void 0,n}if(!i.doneFinalizer_&&r["finalizer"])return i.doneFinalizer_=!0,new e.State(r["finalizer"],i.scope);t.pop(),i.cv&&this.unwind(i.cv.type,i.cv.value,i.cv.label)},e.prototype["stepUnaryExpression"]=function(t,i,r){if(!i.done_){i.done_=!0;var n=new e.State(r["argument"],i.scope);return n.components="delete"===r["operator"],n}t.pop();var o=i.value;if("-"===r["operator"])o=-o;else if("+"===r["operator"])o=+o;else if("!"===r["operator"])o=!o;else if("~"===r["operator"])o=~o;else if("delete"===r["operator"]){var s=!0;if(Array.isArray(o)){var a=o[0];a===e.SCOPE_REFERENCE&&(a=i.scope);var l=String(o[1]);try{delete a.properties[l]}catch(h){i.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+l+"' of '"+a+"'"):s=!1}}o=s}else if("typeof"===r["operator"])o=o&&"Function"===o.class?"function":typeof o;else{if("void"!==r["operator"])throw SyntaxError("Unknown unary operator: "+r["operator"]);o=void 0}t[t.length-1].value=o},e.prototype["stepUpdateExpression"]=function(t,i,r){if(!i.doneLeft_){i.doneLeft_=!0;var n=new e.State(r["argument"],i.scope);return n.components=!0,n}if(i.leftSide_||(i.leftSide_=i.value),i.doneGetter_&&(i.leftValue_=i.value),!i.doneGetter_){var o=this.getValue(i.leftSide_);if(i.leftValue_=o,this.getterStep_){i.doneGetter_=!0;var s=o;return this.createGetter_(s,i.leftSide_)}}if(i.doneSetter_)return t.pop(),void(t[t.length-1].value=i.setterValue_);var a;o=Number(i.leftValue_);if("++"===r["operator"])a=o+1;else{if("--"!==r["operator"])throw SyntaxError("Unknown update expression: "+r["operator"]);a=o-1}var l=r["prefix"]?a:o,h=this.setValue(i.leftSide_,a);if(h)return i.doneSetter_=!0,i.setterValue_=l,this.createSetter_(h,i.leftSide_,a);t.pop(),t[t.length-1].value=l},e.prototype["stepVariableDeclaration"]=function(t,i,r){var n=r["declarations"],o=i.n_||0,s=n[o];i.init_&&s&&(this.setValueToScope(s["id"]["name"],i.value),i.init_=!1,s=n[++o]);while(s){if(s["init"])return i.n_=o,i.init_=!0,i.destinationName=s["id"]["name"],new e.State(s["init"],i.scope);s=n[++o]}t.pop()},e.prototype["stepWithStatement"]=function(t,i,r){if(!i.doneObject_)return i.doneObject_=!0,new e.State(r["object"],i.scope);if(!i.doneBody_){i.doneBody_=!0;var n=this.createSpecialScope(i.scope,i.value);return new e.State(r["body"],n)}t.pop()},e.prototype["stepWhileStatement"]=e.prototype["stepDoWhileStatement"],this["Interpreter"]=e,e.prototype["step"]=e.prototype.step,e.prototype["run"]=e.prototype.run,e.prototype["appendCode"]=e.prototype.appendCode,e.prototype["createObject"]=e.prototype.createObject,e.prototype["createObjectProto"]=e.prototype.createObjectProto,e.prototype["createAsyncFunction"]=e.prototype.createAsyncFunction,e.prototype["createNativeFunction"]=e.prototype.createNativeFunction,e.prototype["getProperty"]=e.prototype.getProperty,e.prototype["setProperty"]=e.prototype.setProperty,e.prototype["nativeToPseudo"]=e.prototype.nativeToPseudo,e.prototype["pseudoToNative"]=e.prototype.pseudoToNative}).call(this,i(/*! ./original-repo/acorn.js */"./original-repo/acorn.js"))},"./src/js-interpreter.js":
/*!*******************************!*\
  !*** ./src/js-interpreter.js ***!
  \*******************************/
/*! exports provided: default */function(t,e,i){"use strict";i.r(e);var r=i(/*! ../original-repo/interpreter */"./original-repo/interpreter.js");e["default"]=r["Interpreter"]}})["default"]}))},7958:function(t,e,i){},8464:function(t,e,i){"use strict";var r=i("b7fd"),n=i("d722");r["defineBlocksWithJsonArray"]([{type:"while_program_start",message0:"当程序运行 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"while_content"}],previousStatement:null,nextStatement:null,colour:"#609FD6",strokeColour:"#4088C8",tooltip:"123",helpUrl:"1"},{type:"move",message0:"移动 %1 CM",args0:[{type:"field_input",name:"move_distance",text:"50"}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"turn",message0:"向 %1 %2",args0:[{type:"field_dropdown",name:"dirction",options:[["左转","0"],["右转","1"]]},{type:"field_angle",name:"degree",angle:90}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"arc",message0:"弧形 %1 %2 ，半径 %3 CM",args0:[{type:"field_dropdown",name:"dirction",options:[["向左","0"],["向右","1"]]},{type:"field_angle",name:"degree",angle:90},{type:"field_number",name:"radius",value:50,min:1,max:100}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"draw",message0:"设置 %1",args0:[{type:"field_dropdown",name:"pencilState",options:[[{src:n["a"].simulatorUrl+"pencil_down.png",width:50,height:50,alt:"pencil down"},"1"],[{src:n["a"].simulatorUrl+"pencil_up.png",width:50,height:50,alt:"pencil up"},"0"]]}],previousStatement:null,nextStatement:null,colour:"#81C679",tooltip:"",helpUrl:""},{type:"pencilcolor",message0:"设置笔颜色： 红 %1 绿 %2 蓝 %3",args0:[{type:"field_number",name:"red",value:100,min:0,max:255},{type:"field_number",name:"green",value:100,min:0,max:255},{type:"field_number",name:"blue",value:100,min:0,max:255}],previousStatement:null,nextStatement:null,colour:"#81C679",tooltip:"",helpUrl:""}]),r["JavaScript"]["while_program_start"]=function(t){var e=r["JavaScript"].statementToCode(t,"while_content"),i="robot.init();\n"+e+"robot.stop();\n";return i},r["JavaScript"]["move"]=function(t){var e=t.getFieldValue("move_distance"),i="robot.move("+e+");\n";return i},r["JavaScript"]["turn"]=function(t){var e=t.getFieldValue("dirction"),i=t.getFieldValue("degree"),r="robot.turn("+e+", "+i+");\n";return r},r["JavaScript"]["arc"]=function(t){var e=t.getFieldValue("dirction"),i=t.getFieldValue("degree"),r=t.getFieldValue("radius"),n="robot.arc("+e+", "+i+","+r+");\n";return n},r["JavaScript"]["draw"]=function(t){var e=t.getFieldValue("pencilState"),i="robot.drawable("+e+");\n";return i},r["JavaScript"]["pencilcolor"]=function(t){var e=t.getFieldValue("red")/255,i=t.getFieldValue("green")/255,r=t.getFieldValue("blue")/255,n="await robot.pencilcolor("+e+","+i+","+r+");\n";return n}},8547:function(t,e,i){"use strict";var r=i("2b0e"),n=i("80d2");e["a"]=r["a"].extend({name:"comparable",props:{valueComparator:{type:Function,default:n["j"]}}})},8654:function(t,e,i){"use strict";i("4ff9");var r=i("c37a"),n=(i("e9b1"),i("7560")),o=i("58df"),s=Object(o["a"])(n["a"]).extend({name:"v-counter",functional:!0,props:{value:{type:[Number,String],default:""},max:[Number,String]},render(t,e){const{props:i}=e,r=parseInt(i.max,10),o=parseInt(i.value,10),s=r?`${o} / ${r}`:String(i.value),a=r&&o>r;return t("div",{staticClass:"v-counter",class:{"error--text":a,...Object(n["b"])(e)}},s)}}),a=s,l=i("ba87"),h=i("90a2"),c=i("d9bd"),u=i("2b0e");function d(t){return u["a"].extend({name:"intersectable",data:()=>({isIntersecting:!1}),mounted(){h["a"].inserted(this.$el,{name:"intersect",value:this.onObserve},this.$vnode)},destroyed(){h["a"].unbind(this.$el,{name:"intersect",value:this.onObserve},this.$vnode)},methods:{onObserve(e,i,r){if(this.isIntersecting=r,r)for(let n=0,o=t.onVisible.length;n<o;n++){const e=this[t.onVisible[n]];"function"!==typeof e?Object(c["c"])(t.onVisible[n]+" method is not available on the instance but referenced in intersectable mixin options"):e()}}}})}var p=i("297c"),f=i("38cb"),_=i("dc22"),g=i("5607"),m=i("dd89"),b=i("80d2");const v=Object(o["a"])(r["a"],d({onVisible:["onResize","tryAutofocus"]}),p["a"]),y=["color","file","time","date","datetime-local","week","month"];e["a"]=v.extend().extend({name:"v-text-field",directives:{resize:_["a"],ripple:g["a"]},inheritAttrs:!1,props:{appendOuterIcon:String,autofocus:Boolean,clearable:Boolean,clearIcon:{type:String,default:"$clear"},counter:[Boolean,Number,String],counterValue:Function,filled:Boolean,flat:Boolean,fullWidth:Boolean,label:String,outlined:Boolean,placeholder:String,prefix:String,prependInnerIcon:String,persistentPlaceholder:Boolean,reverse:Boolean,rounded:Boolean,shaped:Boolean,singleLine:Boolean,solo:Boolean,soloInverted:Boolean,suffix:String,type:{type:String,default:"text"}},data:()=>({badInput:!1,labelWidth:0,prefixWidth:0,prependWidth:0,initialValue:null,isBooted:!1,isClearing:!1}),computed:{classes(){return{...r["a"].options.computed.classes.call(this),"v-text-field":!0,"v-text-field--full-width":this.fullWidth,"v-text-field--prefix":this.prefix,"v-text-field--single-line":this.isSingle,"v-text-field--solo":this.isSolo,"v-text-field--solo-inverted":this.soloInverted,"v-text-field--solo-flat":this.flat,"v-text-field--filled":this.filled,"v-text-field--is-booted":this.isBooted,"v-text-field--enclosed":this.isEnclosed,"v-text-field--reverse":this.reverse,"v-text-field--outlined":this.outlined,"v-text-field--placeholder":this.placeholder,"v-text-field--rounded":this.rounded,"v-text-field--shaped":this.shaped}},computedColor(){const t=f["a"].options.computed.computedColor.call(this);return this.soloInverted&&this.isFocused?this.color||"primary":t},computedCounterValue(){return"function"===typeof this.counterValue?this.counterValue(this.internalValue):[...(this.internalValue||"").toString()].length},hasCounter(){return!1!==this.counter&&null!=this.counter},hasDetails(){return r["a"].options.computed.hasDetails.call(this)||this.hasCounter},internalValue:{get(){return this.lazyValue},set(t){this.lazyValue=t,this.$emit("input",this.lazyValue)}},isDirty(){var t;return(null===(t=this.lazyValue)||void 0===t?void 0:t.toString().length)>0||this.badInput},isEnclosed(){return this.filled||this.isSolo||this.outlined},isLabelActive(){return this.isDirty||y.includes(this.type)},isSingle(){return this.isSolo||this.singleLine||this.fullWidth||this.filled&&!this.hasLabel},isSolo(){return this.solo||this.soloInverted},labelPosition(){let t=this.prefix&&!this.labelValue?this.prefixWidth:0;return this.labelValue&&this.prependWidth&&(t-=this.prependWidth),this.$vuetify.rtl===this.reverse?{left:t,right:"auto"}:{left:"auto",right:t}},showLabel(){return this.hasLabel&&!(this.isSingle&&this.labelValue)},labelValue(){return this.isFocused||this.isLabelActive||this.persistentPlaceholder}},watch:{outlined:"setLabelWidth",label(){this.$nextTick(this.setLabelWidth)},prefix(){this.$nextTick(this.setPrefixWidth)},isFocused:"updateValue",value(t){this.lazyValue=t}},created(){this.$attrs.hasOwnProperty("box")&&Object(c["a"])("box","filled",this),this.$attrs.hasOwnProperty("browser-autocomplete")&&Object(c["a"])("browser-autocomplete","autocomplete",this),this.shaped&&!(this.filled||this.outlined||this.isSolo)&&Object(c["c"])("shaped should be used with either filled or outlined",this)},mounted(){this.$watch(()=>this.labelValue,this.setLabelWidth),this.autofocus&&this.tryAutofocus(),requestAnimationFrame(()=>{this.isBooted=!0,requestAnimationFrame(()=>{this.isIntersecting||this.onResize()})})},methods:{focus(){this.onFocus()},blur(t){window.requestAnimationFrame(()=>{this.$refs.input&&this.$refs.input.blur()})},clearableCallback(){this.$refs.input&&this.$refs.input.focus(),this.$nextTick(()=>this.internalValue=null)},genAppendSlot(){const t=[];return this.$slots["append-outer"]?t.push(this.$slots["append-outer"]):this.appendOuterIcon&&t.push(this.genIcon("appendOuter")),this.genSlot("append","outer",t)},genPrependInnerSlot(){const t=[];return this.$slots["prepend-inner"]?t.push(this.$slots["prepend-inner"]):this.prependInnerIcon&&t.push(this.genIcon("prependInner")),this.genSlot("prepend","inner",t)},genIconSlot(){const t=[];return this.$slots.append?t.push(this.$slots.append):this.appendIcon&&t.push(this.genIcon("append")),this.genSlot("append","inner",t)},genInputSlot(){const t=r["a"].options.methods.genInputSlot.call(this),e=this.genPrependInnerSlot();return e&&(t.children=t.children||[],t.children.unshift(e)),t},genClearIcon(){return this.clearable?this.isDirty?this.genSlot("append","inner",[this.genIcon("clear",this.clearableCallback)]):this.genSlot("append","inner",[this.$createElement("div")]):null},genCounter(){var t,e,i;if(!this.hasCounter)return null;const r=!0===this.counter?this.attrs$.maxlength:this.counter,n={dark:this.dark,light:this.light,max:r,value:this.computedCounterValue};return null!==(i=null===(e=(t=this.$scopedSlots).counter)||void 0===e?void 0:e.call(t,{props:n}))&&void 0!==i?i:this.$createElement(a,{props:n})},genControl(){return r["a"].options.methods.genControl.call(this)},genDefaultSlot(){return[this.genFieldset(),this.genTextFieldSlot(),this.genClearIcon(),this.genIconSlot(),this.genProgress()]},genFieldset(){return this.outlined?this.$createElement("fieldset",{attrs:{"aria-hidden":!0}},[this.genLegend()]):null},genLabel(){if(!this.showLabel)return null;const t={props:{absolute:!0,color:this.validationState,dark:this.dark,disabled:this.isDisabled,focused:!this.isSingle&&(this.isFocused||!!this.validationState),for:this.computedId,left:this.labelPosition.left,light:this.light,right:this.labelPosition.right,value:this.labelValue}};return this.$createElement(l["a"],t,this.$slots.label||this.label)},genLegend(){const t=this.singleLine||!this.labelValue&&!this.isDirty?0:this.labelWidth,e=this.$createElement("span",{domProps:{innerHTML:"&#8203;"},staticClass:"notranslate"});return this.$createElement("legend",{style:{width:this.isSingle?void 0:Object(b["h"])(t)}},[e])},genInput(){const t=Object.assign({},this.listeners$);delete t.change;const{title:e,...i}=this.attrs$;return this.$createElement("input",{style:{},domProps:{value:"number"===this.type&&Object.is(this.lazyValue,-0)?"-0":this.lazyValue},attrs:{...i,autofocus:this.autofocus,disabled:this.isDisabled,id:this.computedId,placeholder:this.persistentPlaceholder||this.isFocused||!this.hasLabel?this.placeholder:void 0,readonly:this.isReadonly,type:this.type},on:Object.assign(t,{blur:this.onBlur,input:this.onInput,focus:this.onFocus,keydown:this.onKeyDown}),ref:"input",directives:[{name:"resize",modifiers:{quiet:!0},value:this.onResize}]})},genMessages(){if(!this.showDetails)return null;const t=r["a"].options.methods.genMessages.call(this),e=this.genCounter();return this.$createElement("div",{staticClass:"v-text-field__details"},[t,e])},genTextFieldSlot(){return this.$createElement("div",{staticClass:"v-text-field__slot"},[this.genLabel(),this.prefix?this.genAffix("prefix"):null,this.genInput(),this.suffix?this.genAffix("suffix"):null])},genAffix(t){return this.$createElement("div",{class:"v-text-field__"+t,ref:t},this[t])},onBlur(t){this.isFocused=!1,t&&this.$nextTick(()=>this.$emit("blur",t))},onClick(){this.isFocused||this.isDisabled||!this.$refs.input||this.$refs.input.focus()},onFocus(t){if(!this.$refs.input)return;const e=Object(m["a"])(this.$el);return e?e.activeElement!==this.$refs.input?this.$refs.input.focus():void(this.isFocused||(this.isFocused=!0,t&&this.$emit("focus",t))):void 0},onInput(t){const e=t.target;this.internalValue=e.value,this.badInput=e.validity&&e.validity.badInput},onKeyDown(t){t.keyCode===b["w"].enter&&this.lazyValue!==this.initialValue&&(this.initialValue=this.lazyValue,this.$emit("change",this.initialValue)),this.$emit("keydown",t)},onMouseDown(t){t.target!==this.$refs.input&&(t.preventDefault(),t.stopPropagation()),r["a"].options.methods.onMouseDown.call(this,t)},onMouseUp(t){this.hasMouseDown&&this.focus(),r["a"].options.methods.onMouseUp.call(this,t)},setLabelWidth(){this.outlined&&(this.labelWidth=this.$refs.label?Math.min(.75*this.$refs.label.scrollWidth+6,this.$el.offsetWidth-24):0)},setPrefixWidth(){this.$refs.prefix&&(this.prefixWidth=this.$refs.prefix.offsetWidth)},setPrependWidth(){this.outlined&&this.$refs["prepend-inner"]&&(this.prependWidth=this.$refs["prepend-inner"].offsetWidth)},tryAutofocus(){if(!this.autofocus||"undefined"===typeof document||!this.$refs.input)return!1;const t=Object(m["a"])(this.$el);return!(!t||t.activeElement===this.$refs.input)&&(this.$refs.input.focus(),!0)},updateValue(t){this.hasColor=t,t?this.initialValue=this.lazyValue:this.initialValue!==this.lazyValue&&this.$emit("change",this.lazyValue)},onResize(){this.setLabelWidth(),this.setPrefixWidth(),this.setPrependWidth()}}})},8860:function(t,e,i){"use strict";i("3ad0");var r=i("8dd9");e["a"]=r["a"].extend().extend({name:"v-list",provide(){return{isInList:!0,list:this}},inject:{isInMenu:{default:!1},isInNav:{default:!1}},props:{dense:Boolean,disabled:Boolean,expand:Boolean,flat:Boolean,nav:Boolean,rounded:Boolean,subheader:Boolean,threeLine:Boolean,twoLine:Boolean},data:()=>({groups:[]}),computed:{classes(){return{...r["a"].options.computed.classes.call(this),"v-list--dense":this.dense,"v-list--disabled":this.disabled,"v-list--flat":this.flat,"v-list--nav":this.nav,"v-list--rounded":this.rounded,"v-list--subheader":this.subheader,"v-list--two-line":this.twoLine,"v-list--three-line":this.threeLine}}},methods:{register(t){this.groups.push(t)},unregister(t){const e=this.groups.findIndex(e=>e._uid===t._uid);e>-1&&this.groups.splice(e,1)},listClick(t){if(!this.expand)for(const e of this.groups)e.toggle(t)}},render(t){const e={staticClass:"v-list",class:this.classes,style:this.styles,attrs:{role:this.isInNav||this.isInMenu?void 0:"list",...this.attrs$}};return t(this.tag,this.setBackgroundColor(this.color,e),[this.$slots.default])}})},"899c":function(t,e,i){},"8adc":function(t,e,i){},"8ce9":function(t,e,i){},"8efc":function(t,e,i){},"8ff2":function(t,e,i){},"99d9":function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return l}));var r=i("b0af"),n=i("80d2");const o=Object(n["i"])("v-card__actions"),s=Object(n["i"])("v-card__subtitle"),a=Object(n["i"])("v-card__text"),l=Object(n["i"])("v-card__title");r["a"]},"9a63":function(t,e){var i={utf8:{stringToBytes:function(t){return i.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(i.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}}};t.exports=i},"9d26":function(t,e,i){"use strict";var r=i("132d");e["a"]=r["a"]},"9d65":function(t,e,i){"use strict";var r=i("d9bd"),n=i("2b0e");e["a"]=n["a"].extend().extend({name:"bootable",props:{eager:Boolean},data:()=>({isBooted:!1}),computed:{hasContent(){return this.isBooted||this.eager||this.isActive}},watch:{isActive(){this.isBooted=!0}},created(){"lazy"in this.$attrs&&Object(r["e"])("lazy",this)},methods:{showLazyContent(t){return this.hasContent&&t?t():[this.$createElement()]}}})},"9e88":function(t,e,i){"use strict";i("cf36");var r=i("5607"),n=i("2b0e"),o=i("132d"),s=i("a9ad"),a=i("7560"),l=i("d9f7"),h=i("80d2");e["a"]=n["a"].extend({name:"v-simple-checkbox",functional:!0,directives:{Ripple:r["a"]},props:{...s["a"].options.props,...a["a"].options.props,disabled:Boolean,ripple:{type:Boolean,default:!0},value:Boolean,indeterminate:Boolean,indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},onIcon:{type:String,default:"$checkboxOn"},offIcon:{type:String,default:"$checkboxOff"}},render(t,{props:e,data:i,listeners:n}){const a=[];let c=e.offIcon;if(e.indeterminate?c=e.indeterminateIcon:e.value&&(c=e.onIcon),a.push(t(o["a"],s["a"].options.methods.setTextColor(e.value&&e.color,{props:{disabled:e.disabled,dark:e.dark,light:e.light}}),c)),e.ripple&&!e.disabled){const i=t("div",s["a"].options.methods.setTextColor(e.color,{staticClass:"v-input--selection-controls__ripple",directives:[{def:r["a"],name:"ripple",value:{center:!0}}]}));a.push(i)}return t("div",Object(l["a"])(i,{class:{"v-simple-checkbox":!0,"v-simple-checkbox--disabled":e.disabled},on:{click:t=>{t.stopPropagation(),i.on&&i.on.input&&!e.disabled&&Object(h["E"])(i.on.input).forEach(t=>t(!e.value))}}}),[t("div",{staticClass:"v-input--selection-controls__input"},a)])}})},a293:function(t,e,i){"use strict";var r=i("dd89");function n(){return!0}function o(t,e,i){if(!t||!1===s(t,i))return!1;const n=Object(r["a"])(e);if("undefined"!==typeof ShadowRoot&&n instanceof ShadowRoot&&n.host===t.target)return!1;const o=("object"===typeof i.value&&i.value.include||(()=>[]))();return o.push(e),!o.some(e=>e.contains(t.target))}function s(t,e){const i="object"===typeof e.value&&e.value.closeConditional||n;return i(t)}function a(t,e,i){const r="function"===typeof i.value?i.value:i.value.handler;e._clickOutside.lastMousedownWasOutside&&o(t,e,i)&&setTimeout(()=>{s(t,i)&&r&&r(t)},0)}function l(t,e){const i=Object(r["a"])(t);e(document),"undefined"!==typeof ShadowRoot&&i instanceof ShadowRoot&&e(i)}const h={inserted(t,e,i){const r=i=>a(i,t,e),n=i=>{t._clickOutside.lastMousedownWasOutside=o(i,t,e)};l(t,t=>{t.addEventListener("click",r,!0),t.addEventListener("mousedown",n,!0)}),t._clickOutside||(t._clickOutside={lastMousedownWasOutside:!0}),t._clickOutside[i.context._uid]={onClick:r,onMousedown:n}},unbind(t,e,i){t._clickOutside&&(l(t,e=>{var r;if(!e||!(null===(r=t._clickOutside)||void 0===r?void 0:r[i.context._uid]))return;const{onClick:n,onMousedown:o}=t._clickOutside[i.context._uid];e.removeEventListener("click",n,!0),e.removeEventListener("mousedown",o,!0)}),delete t._clickOutside[i.context._uid])}};e["a"]=h},a452:function(t,e,i){"use strict";var r=i("2b0e");function n(t="value",e="change"){return r["a"].extend({name:"proxyable",model:{prop:t,event:e},props:{[t]:{required:!1}},data(){return{internalLazyValue:this[t]}},computed:{internalValue:{get(){return this.internalLazyValue},set(t){t!==this.internalLazyValue&&(this.internalLazyValue=t,this.$emit(e,t))}}},watch:{[t](t){this.internalLazyValue=t}}})}const o=n();e["a"]=o},adda:function(t,e,i){"use strict";i("8efc");var r=i("90a2"),n=(i("36a7"),i("24b2")),o=i("58df"),s=i("80d2"),a=Object(o["a"])(n["a"]).extend({name:"v-responsive",props:{aspectRatio:[String,Number],contentClass:String},computed:{computedAspectRatio(){return Number(this.aspectRatio)},aspectStyle(){return this.computedAspectRatio?{paddingBottom:1/this.computedAspectRatio*100+"%"}:void 0},__cachedSizer(){return this.aspectStyle?this.$createElement("div",{style:this.aspectStyle,staticClass:"v-responsive__sizer"}):[]}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-responsive__content",class:this.contentClass},Object(s["r"])(this))}},render(t){return t("div",{staticClass:"v-responsive",style:this.measurableStyles,on:this.$listeners},[this.__cachedSizer,this.genContent()])}}),l=a,h=i("7560"),c=i("d9f7"),u=i("d9bd");const d="undefined"!==typeof window&&"IntersectionObserver"in window;e["a"]=Object(o["a"])(l,h["a"]).extend({name:"v-img",directives:{intersect:r["a"]},props:{alt:String,contain:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},position:{type:String,default:"center center"},sizes:String,src:{type:[String,Object],default:""},srcset:String,transition:{type:[Boolean,String],default:"fade-transition"}},data(){return{currentSrc:"",image:null,isLoading:!0,calculatedAspectRatio:void 0,naturalWidth:void 0,hasError:!1}},computed:{computedAspectRatio(){return Number(this.normalisedSrc.aspect||this.calculatedAspectRatio)},normalisedSrc(){return this.src&&"object"===typeof this.src?{src:this.src.src,srcset:this.srcset||this.src.srcset,lazySrc:this.lazySrc||this.src.lazySrc,aspect:Number(this.aspectRatio||this.src.aspect)}:{src:this.src,srcset:this.srcset,lazySrc:this.lazySrc,aspect:Number(this.aspectRatio||0)}},__cachedImage(){if(!(this.normalisedSrc.src||this.normalisedSrc.lazySrc||this.gradient))return[];const t=[],e=this.isLoading?this.normalisedSrc.lazySrc:this.currentSrc;this.gradient&&t.push(`linear-gradient(${this.gradient})`),e&&t.push(`url("${e}")`);const i=this.$createElement("div",{staticClass:"v-image__image",class:{"v-image__image--preload":this.isLoading,"v-image__image--contain":this.contain,"v-image__image--cover":!this.contain},style:{backgroundImage:t.join(", "),backgroundPosition:this.position},key:+this.isLoading});return this.transition?this.$createElement("transition",{attrs:{name:this.transition,mode:"in-out"}},[i]):i}},watch:{src(){this.isLoading?this.loadImage():this.init(void 0,void 0,!0)},"$vuetify.breakpoint.width":"getSrc"},mounted(){this.init()},methods:{init(t,e,i){if(!d||i||this.eager){if(this.normalisedSrc.lazySrc){const t=new Image;t.src=this.normalisedSrc.lazySrc,this.pollForSize(t,null)}this.normalisedSrc.src&&this.loadImage()}},onLoad(){this.getSrc(),this.isLoading=!1,this.$emit("load",this.src),this.image&&(this.normalisedSrc.src.endsWith(".svg")||this.normalisedSrc.src.startsWith("data:image/svg+xml"))&&(this.image.naturalHeight&&this.image.naturalWidth?(this.naturalWidth=this.image.naturalWidth,this.calculatedAspectRatio=this.image.naturalWidth/this.image.naturalHeight):this.calculatedAspectRatio=1)},onError(){this.hasError=!0,this.$emit("error",this.src)},getSrc(){this.image&&(this.currentSrc=this.image.currentSrc||this.image.src)},loadImage(){const t=new Image;this.image=t,t.onload=()=>{t.decode?t.decode().catch(t=>{Object(u["c"])("Failed to decode image, trying to render anyway\n\nsrc: "+this.normalisedSrc.src+(t.message?"\nOriginal error: "+t.message:""),this)}).then(this.onLoad):this.onLoad()},t.onerror=this.onError,this.hasError=!1,this.sizes&&(t.sizes=this.sizes),this.normalisedSrc.srcset&&(t.srcset=this.normalisedSrc.srcset),t.src=this.normalisedSrc.src,this.$emit("loadstart",this.normalisedSrc.src),this.aspectRatio||this.pollForSize(t),this.getSrc()},pollForSize(t,e=100){const i=()=>{const{naturalHeight:r,naturalWidth:n}=t;r||n?(this.naturalWidth=n,this.calculatedAspectRatio=n/r):t.complete||!this.isLoading||this.hasError||null==e||setTimeout(i,e)};i()},genContent(){const t=l.options.methods.genContent.call(this);return this.naturalWidth&&this._b(t.data,"div",{style:{width:this.naturalWidth+"px"}}),t},__genPlaceholder(){const t=Object(s["r"])(this,"placeholder");if(t){const e=this.isLoading?[this.$createElement("div",{staticClass:"v-image__placeholder"},t)]:[];return this.transition?this.$createElement("transition",{props:{appear:!0,name:this.transition}},e):e[0]}}},render(t){const e=l.options.render.call(this,t),i=Object(c["a"])(e.data,{staticClass:"v-image",attrs:{"aria-label":this.alt,role:this.alt?"img":void 0},class:this.themeClasses,directives:d?[{name:"intersect",modifiers:{once:!0},value:{handler:this.init,options:this.options}}]:void 0});return e.children=[this.__cachedSizer,this.__cachedImage,this.__genPlaceholder(),this.genContent()],t(e.tag,i,e.children)}})},b0af:function(t,e,i){"use strict";i("615b");var r=i("10d2"),n=i("297c"),o=i("1c87"),s=i("58df");e["a"]=Object(s["a"])(n["a"],o["a"],r["a"]).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes(){return{"v-card":!0,...o["a"].options.computed.classes.call(this),"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised,...r["a"].options.computed.classes.call(this)}},styles(){const t={...r["a"].options.computed.styles.call(this)};return this.img&&(t.background=`url("${this.img}") center center / cover no-repeat`),t}},methods:{genProgress(){const t=n["a"].options.methods.genProgress.call(this);return t?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[t]):null}},render(t){const{tag:e,data:i}=this.generateRouteLink();return i.style=this.styles,this.isClickable&&(i.attrs=i.attrs||{},i.attrs.tabindex=0),t(e,this.setBackgroundColor(this.color,i),[this.genProgress(),this.$slots.default])}})},b234:function(t,e,i){(function(e){!function(e,r){t.exports=r(i("633b"))}("undefined"!=typeof self&&self,(function(t){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=20)}([function(e,i){e.exports=t},function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return s}));var r=i(0),n=i(2),o=function(){function t(){}return t.Get=function(t,e,i){if(!e||null==i||!e[i])throw new Error(t+": Failed to find index ("+i+")");return e[i]},t.Assign=function(t){if(t)for(var e=0;e<t.length;e++)t[e].index=e},t}(),s=function(){function t(t){this._completePromises=new Array,this._forAssetContainer=!1,this._babylonLights=[],this._disableInstancedMesh=0,this._disposed=!1,this._state=null,this._extensions=new Array,this._defaultBabylonMaterialData={},this._parent=t}return t.RegisterExtension=function(e,i){t.UnregisterExtension(e)&&r.Logger.Warn("Extension with the name '"+e+"' already exists"),t._RegisteredExtensions[e]={factory:i}},t.UnregisterExtension=function(e){return!!t._RegisteredExtensions[e]&&(delete t._RegisteredExtensions[e],!0)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gltf",{get:function(){return this._gltf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bin",{get:function(){return this._bin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"babylonScene",{get:function(){return this._babylonScene},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootBabylonMesh",{get:function(){return this._rootBabylonMesh},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){if(!this._disposed){for(var t in this._disposed=!0,this._completePromises.length=0,this._extensions){var e=this._extensions[t];e.dispose&&e.dispose(),delete this._extensions[t]}this._gltf=null,this._babylonScene=null,this._rootBabylonMesh=null,this._parent.dispose()}},t.prototype.importMeshAsync=function(t,e,i,r,n,o,s){var a=this;return Promise.resolve().then((function(){a._babylonScene=e,a._rootUrl=n,a._fileName=s||"scene",a._forAssetContainer=i,a._loadData(r);var o=null;if(t){var l={};if(a._gltf.nodes)for(var h=0,c=a._gltf.nodes;h<c.length;h++){var u=c[h];u.name&&(l[u.name]=u.index)}o=(t instanceof Array?t:[t]).map((function(t){var e=l[t];if(void 0===e)throw new Error("Failed to find node '"+t+"'");return e}))}return a._loadAsync(o,(function(){return{meshes:a._getMeshes(),particleSystems:[],skeletons:a._getSkeletons(),animationGroups:a._getAnimationGroups(),lights:a._babylonLights,transformNodes:a._getTransformNodes(),geometries:a._getGeometries()}}))}))},t.prototype.loadAsync=function(t,e,i,r,n){var o=this;return Promise.resolve().then((function(){return o._babylonScene=t,o._rootUrl=i,o._fileName=n||"scene",o._loadData(e),o._loadAsync(null,(function(){}))}))},t.prototype._loadAsync=function(t,e){var i=this;return Promise.resolve().then((function(){i._uniqueRootUrl=-1===i._rootUrl.indexOf("file:")&&i._fileName?i._rootUrl:""+i._rootUrl+Date.now()+"/",i._loadExtensions(),i._checkExtensions();var s=n.GLTFLoaderState[n.GLTFLoaderState.LOADING]+" => "+n.GLTFLoaderState[n.GLTFLoaderState.READY],a=n.GLTFLoaderState[n.GLTFLoaderState.LOADING]+" => "+n.GLTFLoaderState[n.GLTFLoaderState.COMPLETE];i._parent._startPerformanceCounter(s),i._parent._startPerformanceCounter(a),i._setState(n.GLTFLoaderState.LOADING),i._extensionsOnLoading();var l=new Array,h=i._babylonScene.blockMaterialDirtyMechanism;if(i._babylonScene.blockMaterialDirtyMechanism=!0,t)l.push(i.loadSceneAsync("/nodes",{nodes:t,index:-1}));else if(null!=i._gltf.scene||i._gltf.scenes&&i._gltf.scenes[0]){var c=o.Get("/scene",i._gltf.scenes,i._gltf.scene||0);l.push(i.loadSceneAsync("/scenes/"+c.index,c))}if(i.parent.loadAllMaterials&&i._gltf.materials)for(var u=0;u<i._gltf.materials.length;++u){var d=i._gltf.materials[u],p="/materials/"+u,f=r.Material.TriangleFillMode;l.push(i._loadMaterialAsync(p,d,null,f,(function(t){})))}i._babylonScene.blockMaterialDirtyMechanism=h,i._parent.compileMaterials&&l.push(i._compileMaterialsAsync()),i._parent.compileShadowGenerators&&l.push(i._compileShadowGeneratorsAsync());var _=Promise.all(l).then((function(){return i._rootBabylonMesh&&i._rootBabylonMesh.setEnabled(!0),i._extensionsOnReady(),i._setState(n.GLTFLoaderState.READY),i._startAnimations(),e()}));return _.then((function(){i._parent._endPerformanceCounter(s),r.Tools.SetImmediate((function(){i._disposed||Promise.all(i._completePromises).then((function(){i._parent._endPerformanceCounter(a),i._setState(n.GLTFLoaderState.COMPLETE),i._parent.onCompleteObservable.notifyObservers(void 0),i._parent.onCompleteObservable.clear(),i.dispose()}),(function(t){i._parent.onErrorObservable.notifyObservers(t),i._parent.onErrorObservable.clear(),i.dispose()}))}))})),_})).catch((function(t){throw i._disposed||(i._parent.onErrorObservable.notifyObservers(t),i._parent.onErrorObservable.clear(),i.dispose()),t}))},t.prototype._loadData=function(t){if(this._gltf=t.json,this._setupData(),t.bin){var e=this._gltf.buffers;if(e&&e[0]&&!e[0].uri){var i=e[0];(i.byteLength<t.bin.byteLength-3||i.byteLength>t.bin.byteLength)&&r.Logger.Warn("Binary buffer length ("+i.byteLength+") from JSON does not match chunk length ("+t.bin.byteLength+")"),this._bin=t.bin}else r.Logger.Warn("Unexpected BIN chunk")}},t.prototype._setupData=function(){if(o.Assign(this._gltf.accessors),o.Assign(this._gltf.animations),o.Assign(this._gltf.buffers),o.Assign(this._gltf.bufferViews),o.Assign(this._gltf.cameras),o.Assign(this._gltf.images),o.Assign(this._gltf.materials),o.Assign(this._gltf.meshes),o.Assign(this._gltf.nodes),o.Assign(this._gltf.samplers),o.Assign(this._gltf.scenes),o.Assign(this._gltf.skins),o.Assign(this._gltf.textures),this._gltf.nodes){for(var t={},e=0,i=this._gltf.nodes;e<i.length;e++)if((h=i[e]).children)for(var r=0,n=h.children;r<n.length;r++)t[n[r]]=h.index;for(var s=this._createRootNode(),a=0,l=this._gltf.nodes;a<l.length;a++){var h,c=t[(h=l[a]).index];h.parent=void 0===c?s:this._gltf.nodes[c]}}},t.prototype._loadExtensions=function(){for(var e in t._RegisteredExtensions){var i=t._RegisteredExtensions[e].factory(this);i.name!==e&&r.Logger.Warn("The name of the glTF loader extension instance does not match the registered name: "+i.name+" !== "+e),this._extensions.push(i),this._parent.onExtensionLoadedObservable.notifyObservers(i)}this._extensions.sort((function(t,e){return(t.order||Number.MAX_VALUE)-(e.order||Number.MAX_VALUE)})),this._parent.onExtensionLoadedObservable.clear()},t.prototype._checkExtensions=function(){if(this._gltf.extensionsRequired)for(var t=function(t){if(!e._extensions.some((function(e){return e.name===t&&e.enabled})))throw new Error("Require extension "+t+" is not available")},e=this,i=0,r=this._gltf.extensionsRequired;i<r.length;i++)t(r[i])},t.prototype._setState=function(t){this._state=t,this.log(n.GLTFLoaderState[this._state])},t.prototype._createRootNode=function(){this._babylonScene._blockEntityCollection=this._forAssetContainer,this._rootBabylonMesh=new r.Mesh("__root__",this._babylonScene),this._babylonScene._blockEntityCollection=!1,this._rootBabylonMesh.setEnabled(!1);var e={_babylonTransformNode:this._rootBabylonMesh,index:-1};switch(this._parent.coordinateSystemMode){case n.GLTFLoaderCoordinateSystemMode.AUTO:this._babylonScene.useRightHandedSystem||(e.rotation=[0,1,0,0],e.scale=[1,1,-1],t._LoadTransform(e,this._rootBabylonMesh));break;case n.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED:this._babylonScene.useRightHandedSystem=!0;break;default:throw new Error("Invalid coordinate system mode ("+this._parent.coordinateSystemMode+")")}return this._parent.onMeshLoadedObservable.notifyObservers(this._rootBabylonMesh),e},t.prototype.loadSceneAsync=function(t,e){var i=this,r=this._extensionsLoadSceneAsync(t,e);if(r)return r;var n=new Array;if(this.logOpen(t+" "+(e.name||"")),e.nodes)for(var s=0,a=e.nodes;s<a.length;s++){var l=a[s],h=o.Get(t+"/nodes/"+l,this._gltf.nodes,l);n.push(this.loadNodeAsync("/nodes/"+h.index,h,(function(t){t.parent=i._rootBabylonMesh})))}if(this._gltf.nodes)for(var c=0,u=this._gltf.nodes;c<u.length;c++)if((h=u[c])._babylonTransformNode&&h._babylonBones)for(var d=0,p=h._babylonBones;d<p.length;d++)p[d].linkTransformNode(h._babylonTransformNode);return n.push(this._loadAnimationsAsync()),this.logClose(),Promise.all(n).then((function(){}))},t.prototype._forEachPrimitive=function(t,e){if(t._primitiveBabylonMeshes)for(var i=0,r=t._primitiveBabylonMeshes;i<r.length;i++)e(r[i])},t.prototype._getGeometries=function(){var t=new Array,e=this._gltf.nodes;if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];this._forEachPrimitive(n,(function(e){var i=e.geometry;i&&-1===t.indexOf(i)&&t.push(i)}))}return t},t.prototype._getMeshes=function(){var t=new Array;t.push(this._rootBabylonMesh);var e=this._gltf.nodes;if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];this._forEachPrimitive(n,(function(e){t.push(e)}))}return t},t.prototype._getTransformNodes=function(){var t=new Array,e=this._gltf.nodes;if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];n._babylonTransformNode&&"TransformNode"===n._babylonTransformNode.getClassName()&&t.push(n._babylonTransformNode)}return t},t.prototype._getSkeletons=function(){var t=new Array,e=this._gltf.skins;if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];n._data&&t.push(n._data.babylonSkeleton)}return t},t.prototype._getAnimationGroups=function(){var t=new Array,e=this._gltf.animations;if(e)for(var i=0,r=e;i<r.length;i++){var n=r[i];n._babylonAnimationGroup&&t.push(n._babylonAnimationGroup)}return t},t.prototype._startAnimations=function(){switch(this._parent.animationStartMode){case n.GLTFLoaderAnimationStartMode.NONE:break;case n.GLTFLoaderAnimationStartMode.FIRST:0!==(t=this._getAnimationGroups()).length&&t[0].start(!0);break;case n.GLTFLoaderAnimationStartMode.ALL:for(var t,e=0,i=t=this._getAnimationGroups();e<i.length;e++)i[e].start(!0);break;default:return void r.Logger.Error("Invalid animation start mode ("+this._parent.animationStartMode+")")}},t.prototype.loadNodeAsync=function(e,i,n){var s=this;void 0===n&&(n=function(){});var a=this._extensionsLoadNodeAsync(e,i,n);if(a)return a;if(i._babylonTransformNode)throw new Error(e+": Invalid recursive node hierarchy");var l=new Array;this.logOpen(e+" "+(i.name||""));var h=function(r){if(t.AddPointerMetadata(r,e),t._LoadTransform(i,r),null!=i.camera){var a=o.Get(e+"/camera",s._gltf.cameras,i.camera);l.push(s.loadCameraAsync("/cameras/"+a.index,a,(function(t){t.parent=r})))}if(i.children)for(var h=0,c=i.children;h<c.length;h++){var u=c[h],d=o.Get(e+"/children/"+u,s._gltf.nodes,u);l.push(s.loadNodeAsync("/nodes/"+d.index,d,(function(t){t.parent=r})))}n(r)};if(null==i.mesh){var c=i.name||"node"+i.index;this._babylonScene._blockEntityCollection=this._forAssetContainer,i._babylonTransformNode=new r.TransformNode(c,this._babylonScene),this._babylonScene._blockEntityCollection=!1,h(i._babylonTransformNode)}else{var u=o.Get(e+"/mesh",this._gltf.meshes,i.mesh);l.push(this._loadMeshAsync("/meshes/"+u.index,i,u,h))}return this.logClose(),Promise.all(l).then((function(){return s._forEachPrimitive(i,(function(t){t.geometry&&t.geometry.useBoundingInfoFromGeometry?t._updateBoundingInfo():t.refreshBoundingInfo(!0)})),i._babylonTransformNode}))},t.prototype._loadMeshAsync=function(t,e,i,n){var s=i.primitives;if(!s||!s.length)throw new Error(t+": Primitives are missing");null==s[0].index&&o.Assign(s);var a=new Array;this.logOpen(t+" "+(i.name||""));var l=e.name||"node"+e.index;if(1===s.length){var h=i.primitives[0];a.push(this._loadMeshPrimitiveAsync(t+"/primitives/"+h.index,l,e,i,h,(function(t){e._babylonTransformNode=t,e._primitiveBabylonMeshes=[t]})))}else{this._babylonScene._blockEntityCollection=this._forAssetContainer,e._babylonTransformNode=new r.TransformNode(l,this._babylonScene),this._babylonScene._blockEntityCollection=!1,e._primitiveBabylonMeshes=[];for(var c=0,u=s;c<u.length;c++)h=u[c],a.push(this._loadMeshPrimitiveAsync(t+"/primitives/"+h.index,l+"_primitive"+h.index,e,i,h,(function(t){t.parent=e._babylonTransformNode,e._primitiveBabylonMeshes.push(t)})))}if(null!=e.skin){var d=o.Get(t+"/skin",this._gltf.skins,e.skin);a.push(this._loadSkinAsync("/skins/"+d.index,e,d))}return n(e._babylonTransformNode),this.logClose(),Promise.all(a).then((function(){return e._babylonTransformNode}))},t.prototype._loadMeshPrimitiveAsync=function(e,i,n,s,a,l){var h=this,c=this._extensionsLoadMeshPrimitiveAsync(e,i,n,s,a,l);if(c)return c;this.logOpen(""+e);var u,d,p=0===this._disableInstancedMesh&&this._parent.createInstances&&null==n.skin&&!s.primitives[0].targets;if(p&&a._instanceData)u=a._instanceData.babylonSourceMesh.createInstance(i),d=a._instanceData.promise;else{var f=new Array;this._babylonScene._blockEntityCollection=this._forAssetContainer;var _=new r.Mesh(i,this._babylonScene);this._babylonScene._blockEntityCollection=!1,_.overrideMaterialSideOrientation=this._babylonScene.useRightHandedSystem?r.Material.CounterClockWiseSideOrientation:r.Material.ClockWiseSideOrientation,this._createMorphTargets(e,n,s,a,_),f.push(this._loadVertexDataAsync(e,a,_).then((function(t){return h._loadMorphTargetsAsync(e,a,_,t).then((function(){h._babylonScene._blockEntityCollection=h._forAssetContainer,t.applyToMesh(_),h._babylonScene._blockEntityCollection=!1}))})));var g=t._GetDrawMode(e,a.mode);if(null==a.material){var m=this._defaultBabylonMaterialData[g];m||(m=this._createDefaultMaterial("__GLTFLoader._default",g),this._parent.onMaterialLoadedObservable.notifyObservers(m),this._defaultBabylonMaterialData[g]=m),_.material=m}else{var b=o.Get(e+"/material",this._gltf.materials,a.material);f.push(this._loadMaterialAsync("/materials/"+b.index,b,_,g,(function(t){_.material=t})))}d=Promise.all(f),p&&(a._instanceData={babylonSourceMesh:_,promise:d}),u=_}return t.AddPointerMetadata(u,e),this._parent.onMeshLoadedObservable.notifyObservers(u),l(u),this.logClose(),d.then((function(){return u}))},t.prototype._loadVertexDataAsync=function(t,e,i){var n=this,s=this._extensionsLoadVertexDataAsync(t,e,i);if(s)return s;var a=e.attributes;if(!a)throw new Error(t+": Attributes are missing");var l=new Array,h=new r.Geometry(i.name,this._babylonScene);if(null==e.indices)i.isUnIndexed=!0;else{var c=o.Get(t+"/indices",this._gltf.accessors,e.indices);l.push(this._loadIndicesAccessorAsync("/accessors/"+c.index,c).then((function(t){h.setIndices(t)})))}var u=function(e,s,c){if(null!=a[e]){i._delayInfo=i._delayInfo||[],-1===i._delayInfo.indexOf(s)&&i._delayInfo.push(s);var u=o.Get(t+"/attributes/"+e,n._gltf.accessors,a[e]);l.push(n._loadVertexAccessorAsync("/accessors/"+u.index,u,s).then((function(t){if(t.getKind()===r.VertexBuffer.PositionKind&&!n.parent.alwaysComputeBoundingBox&&!i.skeleton){var e=u.min,o=u.max;if(void 0!==e&&void 0!==o){var s=r.TmpVectors.Vector3[0],a=r.TmpVectors.Vector3[1];s.copyFromFloats.apply(s,e),a.copyFromFloats.apply(a,o),h._boundingInfo=new r.BoundingInfo(s,a),h.useBoundingInfoFromGeometry=!0}}h.setVerticesBuffer(t,u.count)}))),s==r.VertexBuffer.MatricesIndicesExtraKind&&(i.numBoneInfluencers=8),c&&c(u)}};return u("POSITION",r.VertexBuffer.PositionKind),u("NORMAL",r.VertexBuffer.NormalKind),u("TANGENT",r.VertexBuffer.TangentKind),u("TEXCOORD_0",r.VertexBuffer.UVKind),u("TEXCOORD_1",r.VertexBuffer.UV2Kind),u("JOINTS_0",r.VertexBuffer.MatricesIndicesKind),u("WEIGHTS_0",r.VertexBuffer.MatricesWeightsKind),u("JOINTS_1",r.VertexBuffer.MatricesIndicesExtraKind),u("WEIGHTS_1",r.VertexBuffer.MatricesWeightsExtraKind),u("COLOR_0",r.VertexBuffer.ColorKind,(function(t){"VEC4"===t.type&&(i.hasVertexAlpha=!0)})),Promise.all(l).then((function(){return h}))},t.prototype._createMorphTargets=function(t,e,i,n,o){if(n.targets){if(null==e._numMorphTargets)e._numMorphTargets=n.targets.length;else if(n.targets.length!==e._numMorphTargets)throw new Error(t+": Primitives do not have the same number of targets");var s=i.extras?i.extras.targetNames:null;o.morphTargetManager=new r.MorphTargetManager(o.getScene());for(var a=0;a<n.targets.length;a++){var l=e.weights?e.weights[a]:i.weights?i.weights[a]:0,h=s?s[a]:"morphTarget"+a;o.morphTargetManager.addTarget(new r.MorphTarget(h,l,o.getScene()))}}},t.prototype._loadMorphTargetsAsync=function(t,e,i,r){if(!e.targets)return Promise.resolve();for(var n=new Array,o=i.morphTargetManager,s=0;s<o.numTargets;s++){var a=o.getTarget(s);n.push(this._loadMorphTargetVertexDataAsync(t+"/targets/"+s,r,e.targets[s],a))}return Promise.all(n).then((function(){}))},t.prototype._loadMorphTargetVertexDataAsync=function(t,e,i,n){var s=this,a=new Array,l=function(r,n,l){if(null!=i[r]){var h=e.getVertexBuffer(n);if(h){var c=o.Get(t+"/"+r,s._gltf.accessors,i[r]);a.push(s._loadFloatAccessorAsync("/accessors/"+c.index,c).then((function(t){l(h,t)})))}}};return l("POSITION",r.VertexBuffer.PositionKind,(function(t,e){var i=new Float32Array(e.length);t.forEach(e.length,(function(t,r){i[r]=e[r]+t})),n.setPositions(i)})),l("NORMAL",r.VertexBuffer.NormalKind,(function(t,e){var i=new Float32Array(e.length);t.forEach(i.length,(function(t,r){i[r]=e[r]+t})),n.setNormals(i)})),l("TANGENT",r.VertexBuffer.TangentKind,(function(t,e){var i=new Float32Array(e.length/3*4),r=0;t.forEach(e.length/3*4,(function(t,n){(n+1)%4!=0&&(i[r]=e[r]+t,r++)})),n.setTangents(i)})),Promise.all(a).then((function(){}))},t._LoadTransform=function(t,e){if(null==t.skin){var i=r.Vector3.Zero(),n=r.Quaternion.Identity(),o=r.Vector3.One();t.matrix?r.Matrix.FromArray(t.matrix).decompose(o,n,i):(t.translation&&(i=r.Vector3.FromArray(t.translation)),t.rotation&&(n=r.Quaternion.FromArray(t.rotation)),t.scale&&(o=r.Vector3.FromArray(t.scale))),e.position=i,e.rotationQuaternion=n,e.scaling=o}},t.prototype._loadSkinAsync=function(t,e,i){var n=this,o=this._extensionsLoadSkinAsync(t,e,i);if(o)return o;var s=function(t){n._forEachPrimitive(e,(function(e){e.skeleton=t}))};if(i._data)return s(i._data.babylonSkeleton),i._data.promise;var a="skeleton"+i.index;this._babylonScene._blockEntityCollection=this._forAssetContainer;var l=new r.Skeleton(i.name||a,a,this._babylonScene);this._babylonScene._blockEntityCollection=!1,l.overrideMesh=this._rootBabylonMesh,this._loadBones(t,i,l),s(l);var h=this._loadSkinInverseBindMatricesDataAsync(t,i).then((function(t){n._updateBoneMatrices(l,t)}));return i._data={babylonSkeleton:l,promise:h},h},t.prototype._loadBones=function(t,e,i){for(var r={},n=0,s=e.joints;n<s.length;n++){var a=s[n],l=o.Get(t+"/joints/"+a,this._gltf.nodes,a);this._loadBone(l,e,i,r)}},t.prototype._loadBone=function(t,e,i,n){var o=n[t.index];if(o)return o;var s=null;t.parent&&t.parent._babylonTransformNode!==this._rootBabylonMesh&&(s=this._loadBone(t.parent,e,i,n));var a=e.joints.indexOf(t.index);return o=new r.Bone(t.name||"joint"+t.index,i,s,this._getNodeMatrix(t),null,null,a),n[t.index]=o,t._babylonBones=t._babylonBones||[],t._babylonBones.push(o),o},t.prototype._loadSkinInverseBindMatricesDataAsync=function(t,e){if(null==e.inverseBindMatrices)return Promise.resolve(null);var i=o.Get(t+"/inverseBindMatrices",this._gltf.accessors,e.inverseBindMatrices);return this._loadFloatAccessorAsync("/accessors/"+i.index,i)},t.prototype._updateBoneMatrices=function(t,e){for(var i=0,n=t.bones;i<n.length;i++){var o=n[i],s=r.Matrix.Identity(),a=o._index;e&&-1!==a&&(r.Matrix.FromArrayToRef(e,16*a,s),s.invertToRef(s));var l=o.getParent();l&&s.multiplyToRef(l.getInvertedAbsoluteTransform(),s),o.setBindPose(s),o.updateMatrix(s,!1,!1),o._updateDifferenceMatrix(void 0,!1)}},t.prototype._getNodeMatrix=function(t){return t.matrix?r.Matrix.FromArray(t.matrix):r.Matrix.Compose(t.scale?r.Vector3.FromArray(t.scale):r.Vector3.One(),t.rotation?r.Quaternion.FromArray(t.rotation):r.Quaternion.Identity(),t.translation?r.Vector3.FromArray(t.translation):r.Vector3.Zero())},t.prototype.loadCameraAsync=function(e,i,n){void 0===n&&(n=function(){});var o=this._extensionsLoadCameraAsync(e,i,n);if(o)return o;var s=new Array;this.logOpen(e+" "+(i.name||"")),this._babylonScene._blockEntityCollection=this._forAssetContainer;var a=new r.FreeCamera(i.name||"camera"+i.index,r.Vector3.Zero(),this._babylonScene,!1);switch(this._babylonScene._blockEntityCollection=!1,a.ignoreParentScaling=!0,a.rotation=new r.Vector3(0,Math.PI,0),i.type){case"perspective":var l=i.perspective;if(!l)throw new Error(e+": Camera perspective properties are missing");a.fov=l.yfov,a.minZ=l.znear,a.maxZ=l.zfar||Number.MAX_VALUE;break;case"orthographic":if(!i.orthographic)throw new Error(e+": Camera orthographic properties are missing");a.mode=r.Camera.ORTHOGRAPHIC_CAMERA,a.orthoLeft=-i.orthographic.xmag,a.orthoRight=i.orthographic.xmag,a.orthoBottom=-i.orthographic.ymag,a.orthoTop=i.orthographic.ymag,a.minZ=i.orthographic.znear,a.maxZ=i.orthographic.zfar;break;default:throw new Error(e+": Invalid camera type ("+i.type+")")}return t.AddPointerMetadata(a,e),this._parent.onCameraLoadedObservable.notifyObservers(a),n(a),this.logClose(),Promise.all(s).then((function(){return a}))},t.prototype._loadAnimationsAsync=function(){var t=this._gltf.animations;if(!t)return Promise.resolve();for(var e=new Array,i=0;i<t.length;i++){var r=t[i];e.push(this.loadAnimationAsync("/animations/"+r.index,r))}return Promise.all(e).then((function(){}))},t.prototype.loadAnimationAsync=function(t,e){var i=this._extensionsLoadAnimationAsync(t,e);if(i)return i;this._babylonScene._blockEntityCollection=this._forAssetContainer;var n=new r.AnimationGroup(e.name||"animation"+e.index,this._babylonScene);this._babylonScene._blockEntityCollection=!1,e._babylonAnimationGroup=n;var s=new Array;o.Assign(e.channels),o.Assign(e.samplers);for(var a=0,l=e.channels;a<l.length;a++){var h=l[a];s.push(this._loadAnimationChannelAsync(t+"/channels/"+h.index,t,e,h,n))}return Promise.all(s).then((function(){return n.normalize(0),n}))},t.prototype._loadAnimationChannelAsync=function(t,e,i,n,s,a){var l=this;if(void 0===a&&(a=null),null==n.target.node)return Promise.resolve();var h=o.Get(t+"/target/node",this._gltf.nodes,n.target.node);if("weights"===n.target.path&&!h._numMorphTargets||"weights"!==n.target.path&&!h._babylonTransformNode)return Promise.resolve();var c=o.Get(t+"/sampler",i.samplers,n.sampler);return this._loadAnimationSamplerAsync(e+"/samplers/"+n.sampler,c).then((function(e){var i,o;switch(n.target.path){case"translation":i="position",o=r.Animation.ANIMATIONTYPE_VECTOR3;break;case"rotation":i="rotationQuaternion",o=r.Animation.ANIMATIONTYPE_QUATERNION;break;case"scale":i="scaling",o=r.Animation.ANIMATIONTYPE_VECTOR3;break;case"weights":i="influence",o=r.Animation.ANIMATIONTYPE_FLOAT;break;default:throw new Error(t+"/target/path: Invalid value ("+n.target.path+")")}var c,u,d=0;switch(i){case"position":c=function(){var t=r.Vector3.FromArray(e.output,d);return d+=3,t};break;case"rotationQuaternion":c=function(){var t=r.Quaternion.FromArray(e.output,d);return d+=4,t};break;case"scaling":c=function(){var t=r.Vector3.FromArray(e.output,d);return d+=3,t};break;case"influence":c=function(){for(var t=new Array(h._numMorphTargets),i=0;i<h._numMorphTargets;i++)t[i]=e.output[d++];return t}}switch(e.interpolation){case"STEP":u=function(t){return{frame:e.input[t],value:c(),interpolation:r.AnimationKeyInterpolation.STEP}};break;case"LINEAR":u=function(t){return{frame:e.input[t],value:c()}};break;case"CUBICSPLINE":u=function(t){return{frame:e.input[t],inTangent:c(),value:c(),outTangent:c()}}}for(var p=new Array(e.input.length),f=0;f<e.input.length;f++)p[f]=u(f);if("influence"===i)for(var _=function(t){var e=s.name+"_channel"+s.targetedAnimations.length,n=new r.Animation(e,i,1,o);n.setKeys(p.map((function(e){return{frame:e.frame,inTangent:e.inTangent?e.inTangent[t]:void 0,value:e.value[t],outTangent:e.outTangent?e.outTangent[t]:void 0}}))),l._forEachPrimitive(h,(function(e){var i=e.morphTargetManager.getTarget(t),r=n.clone();i.animations.push(r),s.addTargetedAnimation(r,i)}))},g=0;g<h._numMorphTargets;g++)_(g);else{var m=s.name+"_channel"+s.targetedAnimations.length,b=new r.Animation(m,i,1,o);b.setKeys(p),null!=a&&null!=a.animations?(a.animations.push(b),s.addTargetedAnimation(b,a)):(h._babylonTransformNode.animations.push(b),s.addTargetedAnimation(b,h._babylonTransformNode))}}))},t.prototype._loadAnimationSamplerAsync=function(t,e){if(e._data)return e._data;var i=e.interpolation||"LINEAR";switch(i){case"STEP":case"LINEAR":case"CUBICSPLINE":break;default:throw new Error(t+"/interpolation: Invalid value ("+e.interpolation+")")}var r=o.Get(t+"/input",this._gltf.accessors,e.input),n=o.Get(t+"/output",this._gltf.accessors,e.output);return e._data=Promise.all([this._loadFloatAccessorAsync("/accessors/"+r.index,r),this._loadFloatAccessorAsync("/accessors/"+n.index,n)]).then((function(t){var e=t[0],r=t[1];return{input:e,interpolation:i,output:r}})),e._data},t.prototype._loadBufferAsync=function(t,e,i,r){var n=this._extensionsLoadBufferAsync(t,e,i,r);if(n)return n;if(!e._data)if(e.uri)e._data=this.loadUriAsync(t+"/uri",e,e.uri);else{if(!this._bin)throw new Error(t+": Uri is missing or the binary glTF is missing its binary chunk");e._data=this._bin.readAsync(0,e.byteLength)}return e._data.then((function(e){try{return new Uint8Array(e.buffer,e.byteOffset+i,r)}catch(e){throw new Error(t+": "+e.message)}}))},t.prototype.loadBufferViewAsync=function(t,e){var i=this._extensionsLoadBufferViewAsync(t,e);if(i)return i;if(e._data)return e._data;var r=o.Get(t+"/buffer",this._gltf.buffers,e.buffer);return e._data=this._loadBufferAsync("/buffers/"+r.index,r,e.byteOffset||0,e.byteLength),e._data},t.prototype._loadAccessorAsync=function(e,i,n){var s=this;if(i._data)return i._data;var a=t._GetNumComponents(e,i.type),l=a*r.VertexBuffer.GetTypeByteLength(i.componentType),h=a*i.count;if(null==i.bufferView)i._data=Promise.resolve(new n(h));else{var c=o.Get(e+"/bufferView",this._gltf.bufferViews,i.bufferView);i._data=this.loadBufferViewAsync("/bufferViews/"+c.index,c).then((function(o){if(5126!==i.componentType||i.normalized||c.byteStride&&c.byteStride!==l){var s=new n(h);return r.VertexBuffer.ForEach(o,i.byteOffset||0,c.byteStride||l,a,i.componentType,s.length,i.normalized||!1,(function(t,e){s[e]=t})),s}return t._GetTypedArray(e,i.componentType,o,i.byteOffset,h)}))}if(i.sparse){var u=i.sparse;i._data=i._data.then((function(h){var c=h,d=o.Get(e+"/sparse/indices/bufferView",s._gltf.bufferViews,u.indices.bufferView),p=o.Get(e+"/sparse/values/bufferView",s._gltf.bufferViews,u.values.bufferView);return Promise.all([s.loadBufferViewAsync("/bufferViews/"+d.index,d),s.loadBufferViewAsync("/bufferViews/"+p.index,p)]).then((function(o){var s,h=o[0],d=o[1],p=t._GetTypedArray(e+"/sparse/indices",u.indices.componentType,h,u.indices.byteOffset,u.count),f=a*u.count;if(5126!==i.componentType||i.normalized){var _=t._GetTypedArray(e+"/sparse/values",i.componentType,d,u.values.byteOffset,f);s=new n(f),r.VertexBuffer.ForEach(_,0,l,a,i.componentType,s.length,i.normalized||!1,(function(t,e){s[e]=t}))}else s=t._GetTypedArray(e+"/sparse/values",i.componentType,d,u.values.byteOffset,f);for(var g=0,m=0;m<p.length;m++)for(var b=p[m]*a,v=0;v<a;v++)c[b++]=s[g++];return c}))}))}return i._data},t.prototype._loadFloatAccessorAsync=function(t,e){return this._loadAccessorAsync(t,e,Float32Array)},t.prototype._loadIndicesAccessorAsync=function(e,i){if("SCALAR"!==i.type)throw new Error(e+"/type: Invalid value "+i.type);if(5121!==i.componentType&&5123!==i.componentType&&5125!==i.componentType)throw new Error(e+"/componentType: Invalid value "+i.componentType);if(i._data)return i._data;if(i.sparse){var r=t._GetTypedArrayConstructor(e+"/componentType",i.componentType);i._data=this._loadAccessorAsync(e,i,r)}else{var n=o.Get(e+"/bufferView",this._gltf.bufferViews,i.bufferView);i._data=this.loadBufferViewAsync("/bufferViews/"+n.index,n).then((function(r){return t._GetTypedArray(e,i.componentType,r,i.byteOffset,i.count)}))}return i._data},t.prototype._loadVertexBufferViewAsync=function(t,e){var i=this;return t._babylonBuffer||(t._babylonBuffer=this.loadBufferViewAsync("/bufferViews/"+t.index,t).then((function(t){return new r.Buffer(i._babylonScene.getEngine(),t,!1)}))),t._babylonBuffer},t.prototype._loadVertexAccessorAsync=function(e,i,n){var s=this;if(i._babylonVertexBuffer)return i._babylonVertexBuffer;if(i.sparse)i._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+i.index,i).then((function(t){return new r.VertexBuffer(s._babylonScene.getEngine(),t,n,!1)}));else if(i.byteOffset&&i.byteOffset%r.VertexBuffer.GetTypeByteLength(i.componentType)!=0)r.Logger.Warn("Accessor byte offset is not a multiple of component type byte length"),i._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+i.index,i).then((function(t){return new r.VertexBuffer(s._babylonScene.getEngine(),t,n,!1)}));else if(n===r.VertexBuffer.MatricesIndicesKind||n===r.VertexBuffer.MatricesIndicesExtraKind)i._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+i.index,i).then((function(t){return new r.VertexBuffer(s._babylonScene.getEngine(),t,n,!1)}));else{var a=o.Get(e+"/bufferView",this._gltf.bufferViews,i.bufferView);i._babylonVertexBuffer=this._loadVertexBufferViewAsync(a,n).then((function(o){var l=t._GetNumComponents(e,i.type);return new r.VertexBuffer(s._babylonScene.getEngine(),o,n,!1,!1,a.byteStride,!1,i.byteOffset,l,i.componentType,i.normalized,!0,1,!0)}))}return i._babylonVertexBuffer},t.prototype._loadMaterialMetallicRoughnessPropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;return e&&(e.baseColorFactor?(i.albedoColor=r.Color3.FromArray(e.baseColorFactor),i.alpha=e.baseColorFactor[3]):i.albedoColor=r.Color3.White(),i.metallic=null==e.metallicFactor?1:e.metallicFactor,i.roughness=null==e.roughnessFactor?1:e.roughnessFactor,e.baseColorTexture&&n.push(this.loadTextureInfoAsync(t+"/baseColorTexture",e.baseColorTexture,(function(t){t.name=i.name+" (Base Color)",i.albedoTexture=t}))),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(t+"/metallicRoughnessTexture",e.metallicRoughnessTexture,(function(t){t.name=i.name+" (Metallic Roughness)",i.metallicTexture=t}))),i.useMetallnessFromMetallicTextureBlue=!0,i.useRoughnessFromMetallicTextureGreen=!0,i.useRoughnessFromMetallicTextureAlpha=!1)),Promise.all(n).then((function(){}))},t.prototype._loadMaterialAsync=function(e,i,r,n,o){void 0===o&&(o=function(){});var s=this._extensionsLoadMaterialAsync(e,i,r,n,o);if(s)return s;i._data=i._data||{};var a=i._data[n];if(!a){this.logOpen(e+" "+(i.name||""));var l=this.createMaterial(e,i,n);a={babylonMaterial:l,babylonMeshes:[],promise:this.loadMaterialPropertiesAsync(e,i,l)},i._data[n]=a,t.AddPointerMetadata(l,e),this._parent.onMaterialLoadedObservable.notifyObservers(l),this.logClose()}return r&&(a.babylonMeshes.push(r),r.onDisposeObservable.addOnce((function(){var t=a.babylonMeshes.indexOf(r);-1!==t&&a.babylonMeshes.splice(t,1)}))),o(a.babylonMaterial),a.promise.then((function(){return a.babylonMaterial}))},t.prototype._createDefaultMaterial=function(t,e){this._babylonScene._blockEntityCollection=this._forAssetContainer;var i=new r.PBRMaterial(t,this._babylonScene);return this._babylonScene._blockEntityCollection=!1,i.fillMode=e,i.enableSpecularAntiAliasing=!0,i.useRadianceOverAlpha=!this._parent.transparencyAsCoverage,i.useSpecularOverAlpha=!this._parent.transparencyAsCoverage,i.transparencyMode=r.PBRMaterial.PBRMATERIAL_OPAQUE,i.metallic=1,i.roughness=1,i},t.prototype.createMaterial=function(t,e,i){var r=this._extensionsCreateMaterial(t,e,i);if(r)return r;var n=e.name||"material"+e.index;return this._createDefaultMaterial(n,i)},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this._extensionsLoadMaterialPropertiesAsync(t,e,i);if(r)return r;var n=new Array;return n.push(this.loadMaterialBasePropertiesAsync(t,e,i)),e.pbrMetallicRoughness&&n.push(this._loadMaterialMetallicRoughnessPropertiesAsync(t+"/pbrMetallicRoughness",e.pbrMetallicRoughness,i)),this.loadMaterialAlphaProperties(t,e,i),Promise.all(n).then((function(){}))},t.prototype.loadMaterialBasePropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;return i.emissiveColor=e.emissiveFactor?r.Color3.FromArray(e.emissiveFactor):new r.Color3(0,0,0),e.doubleSided&&(i.backFaceCulling=!1,i.twoSidedLighting=!0),e.normalTexture&&(e.normalTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(t+"/normalTexture",e.normalTexture,(function(t){t.name=i.name+" (Normal)",i.bumpTexture=t}))),i.invertNormalMapX=!this._babylonScene.useRightHandedSystem,i.invertNormalMapY=this._babylonScene.useRightHandedSystem,null!=e.normalTexture.scale&&(i.bumpTexture.level=e.normalTexture.scale),i.forceIrradianceInFragment=!0),e.occlusionTexture&&(e.occlusionTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(t+"/occlusionTexture",e.occlusionTexture,(function(t){t.name=i.name+" (Occlusion)",i.ambientTexture=t}))),i.useAmbientInGrayScale=!0,null!=e.occlusionTexture.strength&&(i.ambientTextureStrength=e.occlusionTexture.strength)),e.emissiveTexture&&n.push(this.loadTextureInfoAsync(t+"/emissiveTexture",e.emissiveTexture,(function(t){t.name=i.name+" (Emissive)",i.emissiveTexture=t}))),Promise.all(n).then((function(){}))},t.prototype.loadMaterialAlphaProperties=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");switch(e.alphaMode||"OPAQUE"){case"OPAQUE":i.transparencyMode=r.PBRMaterial.PBRMATERIAL_OPAQUE;break;case"MASK":i.transparencyMode=r.PBRMaterial.PBRMATERIAL_ALPHATEST,i.alphaCutOff=null==e.alphaCutoff?.5:e.alphaCutoff,i.albedoTexture&&(i.albedoTexture.hasAlpha=!0);break;case"BLEND":i.transparencyMode=r.PBRMaterial.PBRMATERIAL_ALPHABLEND,i.albedoTexture&&(i.albedoTexture.hasAlpha=!0,i.useAlphaFromAlbedoTexture=!0);break;default:throw new Error(t+"/alphaMode: Invalid value ("+e.alphaMode+")")}},t.prototype.loadTextureInfoAsync=function(e,i,r){var n=this;void 0===r&&(r=function(){});var s=this._extensionsLoadTextureInfoAsync(e,i,r);if(s)return s;if(this.logOpen(""+e),i.texCoord>=2)throw new Error(e+"/texCoord: Invalid value ("+i.texCoord+")");var a=o.Get(e+"/index",this._gltf.textures,i.index);a._textureInfo=i;var l=this._loadTextureAsync("/textures/"+i.index,a,(function(o){o.coordinatesIndex=i.texCoord||0,t.AddPointerMetadata(o,e),n._parent.onTextureLoadedObservable.notifyObservers(o),r(o)}));return this.logClose(),l},t.prototype._loadTextureAsync=function(e,i,r){void 0===r&&(r=function(){});var n=this._extensionsLoadTextureAsync(e,i,r);if(n)return n;this.logOpen(e+" "+(i.name||""));var s=null==i.sampler?t.DefaultSampler:o.Get(e+"/sampler",this._gltf.samplers,i.sampler),a=o.Get(e+"/source",this._gltf.images,i.source),l=this._createTextureAsync(e,s,a,r);return this.logClose(),l},t.prototype._createTextureAsync=function(t,e,i,n,o){var s=this;void 0===n&&(n=function(){});var a=this._loadSampler("/samplers/"+e.index,e),l=new Array,h=new r.Deferred;this._babylonScene._blockEntityCollection=this._forAssetContainer;var c=new r.Texture(null,this._babylonScene,a.noMipMaps,!1,a.samplingMode,(function(){s._disposed||h.resolve()}),(function(e,i){s._disposed||h.reject(new Error(t+": "+(i&&i.message?i.message:e||"Failed to load texture")))}),void 0,void 0,void 0,i.mimeType,o);return this._babylonScene._blockEntityCollection=!1,l.push(h.promise),l.push(this.loadImageAsync("/images/"+i.index,i).then((function(t){var e=i.uri||s._fileName+"#image"+i.index,r="data:"+s._uniqueRootUrl+e;c.updateURL(r,t)}))),c.wrapU=a.wrapU,c.wrapV=a.wrapV,n(c),Promise.all(l).then((function(){return c}))},t.prototype._loadSampler=function(e,i){return i._data||(i._data={noMipMaps:9728===i.minFilter||9729===i.minFilter,samplingMode:t._GetTextureSamplingMode(e,i),wrapU:t._GetTextureWrapMode(e+"/wrapS",i.wrapS),wrapV:t._GetTextureWrapMode(e+"/wrapT",i.wrapT)}),i._data},t.prototype.loadImageAsync=function(t,e){if(!e._data){if(this.logOpen(t+" "+(e.name||"")),e.uri)e._data=this.loadUriAsync(t+"/uri",e,e.uri);else{var i=o.Get(t+"/bufferView",this._gltf.bufferViews,e.bufferView);e._data=this.loadBufferViewAsync("/bufferViews/"+i.index,i)}this.logClose()}return e._data},t.prototype.loadUriAsync=function(e,i,n){var o=this,s=this._extensionsLoadUriAsync(e,i,n);if(s)return s;if(!t._ValidateUri(n))throw new Error(e+": '"+n+"' is invalid");if(r.Tools.IsBase64(n)){var a=new Uint8Array(r.Tools.DecodeBase64(n));return this.log("Decoded "+n.substr(0,64)+"... ("+a.length+" bytes)"),Promise.resolve(a)}return this.log("Loading "+n),this._parent.preprocessUrlAsync(this._rootUrl+n).then((function(t){return new Promise((function(i,s){o._parent._loadFile(t,o._babylonScene,(function(t){o._disposed||(o.log("Loaded "+n+" ("+t.byteLength+" bytes)"),i(new Uint8Array(t)))}),!0,(function(t){s(new r.LoadFileError(e+": Failed to load '"+n+"'"+(t?": "+t.status+" "+t.statusText:""),t))}))}))}))},t.AddPointerMetadata=function(t,e){var i=t.metadata=t.metadata||{},r=i.gltf=i.gltf||{};(r.pointers=r.pointers||[]).push(e)},t._GetTextureWrapMode=function(t,e){switch(e=null==e?10497:e){case 33071:return r.Texture.CLAMP_ADDRESSMODE;case 33648:return r.Texture.MIRROR_ADDRESSMODE;case 10497:return r.Texture.WRAP_ADDRESSMODE;default:return r.Logger.Warn(t+": Invalid value ("+e+")"),r.Texture.WRAP_ADDRESSMODE}},t._GetTextureSamplingMode=function(t,e){var i=null==e.magFilter?9729:e.magFilter,n=null==e.minFilter?9987:e.minFilter;if(9729===i)switch(n){case 9728:return r.Texture.LINEAR_NEAREST;case 9729:return r.Texture.LINEAR_LINEAR;case 9984:return r.Texture.LINEAR_NEAREST_MIPNEAREST;case 9985:return r.Texture.LINEAR_LINEAR_MIPNEAREST;case 9986:return r.Texture.LINEAR_NEAREST_MIPLINEAR;case 9987:return r.Texture.LINEAR_LINEAR_MIPLINEAR;default:return r.Logger.Warn(t+"/minFilter: Invalid value ("+n+")"),r.Texture.LINEAR_LINEAR_MIPLINEAR}else switch(9728!==i&&r.Logger.Warn(t+"/magFilter: Invalid value ("+i+")"),n){case 9728:return r.Texture.NEAREST_NEAREST;case 9729:return r.Texture.NEAREST_LINEAR;case 9984:return r.Texture.NEAREST_NEAREST_MIPNEAREST;case 9985:return r.Texture.NEAREST_LINEAR_MIPNEAREST;case 9986:return r.Texture.NEAREST_NEAREST_MIPLINEAR;case 9987:return r.Texture.NEAREST_LINEAR_MIPLINEAR;default:return r.Logger.Warn(t+"/minFilter: Invalid value ("+n+")"),r.Texture.NEAREST_NEAREST_MIPNEAREST}},t._GetTypedArrayConstructor=function(t,e){switch(e){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw new Error(t+": Invalid component type "+e)}},t._GetTypedArray=function(e,i,r,n,o){var s=r.buffer;n=r.byteOffset+(n||0);var a=t._GetTypedArrayConstructor(e+"/componentType",i);try{return new a(s,n,o)}catch(t){throw new Error(e+": "+t)}},t._GetNumComponents=function(t,e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw new Error(t+": Invalid type ("+e+")")},t._ValidateUri=function(t){return r.Tools.IsBase64(t)||-1===t.indexOf("..")},t._GetDrawMode=function(t,e){switch(null==e&&(e=4),e){case 0:return r.Material.PointListDrawMode;case 1:return r.Material.LineListDrawMode;case 2:return r.Material.LineLoopDrawMode;case 3:return r.Material.LineStripDrawMode;case 4:return r.Material.TriangleFillMode;case 5:return r.Material.TriangleStripDrawMode;case 6:return r.Material.TriangleFanDrawMode}throw new Error(t+": Invalid mesh primitive mode ("+e+")")},t.prototype._compileMaterialsAsync=function(){var t=this;this._parent._startPerformanceCounter("Compile materials");var e=new Array;if(this._gltf.materials)for(var i=0,r=this._gltf.materials;i<r.length;i++){var n=r[i];if(n._data)for(var o in n._data)for(var s=n._data[o],a=0,l=s.babylonMeshes;a<l.length;a++){var h=l[a];h.computeWorldMatrix(!0);var c=s.babylonMaterial;e.push(c.forceCompilationAsync(h)),e.push(c.forceCompilationAsync(h,{useInstances:!0})),this._parent.useClipPlane&&(e.push(c.forceCompilationAsync(h,{clipPlane:!0})),e.push(c.forceCompilationAsync(h,{clipPlane:!0,useInstances:!0})))}}return Promise.all(e).then((function(){t._parent._endPerformanceCounter("Compile materials")}))},t.prototype._compileShadowGeneratorsAsync=function(){var t=this;this._parent._startPerformanceCounter("Compile shadow generators");for(var e=new Array,i=0,r=this._babylonScene.lights;i<r.length;i++){var n=r[i].getShadowGenerator();n&&e.push(n.forceCompilationAsync())}return Promise.all(e).then((function(){t._parent._endPerformanceCounter("Compile shadow generators")}))},t.prototype._forEachExtensions=function(t){for(var e=0,i=this._extensions;e<i.length;e++){var r=i[e];r.enabled&&t(r)}},t.prototype._applyExtensions=function(t,e,i){for(var r=0,n=this._extensions;r<n.length;r++){var o=n[r];if(o.enabled){var s=o.name+"."+e,a=t;a._activeLoaderExtensionFunctions=a._activeLoaderExtensionFunctions||{};var l=a._activeLoaderExtensionFunctions;if(!l[s]){l[s]=!0;try{var h=i(o);if(h)return h}finally{delete l[s]}}}}return null},t.prototype._extensionsOnLoading=function(){this._forEachExtensions((function(t){return t.onLoading&&t.onLoading()}))},t.prototype._extensionsOnReady=function(){this._forEachExtensions((function(t){return t.onReady&&t.onReady()}))},t.prototype._extensionsLoadSceneAsync=function(t,e){return this._applyExtensions(e,"loadScene",(function(i){return i.loadSceneAsync&&i.loadSceneAsync(t,e)}))},t.prototype._extensionsLoadNodeAsync=function(t,e,i){return this._applyExtensions(e,"loadNode",(function(r){return r.loadNodeAsync&&r.loadNodeAsync(t,e,i)}))},t.prototype._extensionsLoadCameraAsync=function(t,e,i){return this._applyExtensions(e,"loadCamera",(function(r){return r.loadCameraAsync&&r.loadCameraAsync(t,e,i)}))},t.prototype._extensionsLoadVertexDataAsync=function(t,e,i){return this._applyExtensions(e,"loadVertexData",(function(r){return r._loadVertexDataAsync&&r._loadVertexDataAsync(t,e,i)}))},t.prototype._extensionsLoadMeshPrimitiveAsync=function(t,e,i,r,n,o){return this._applyExtensions(n,"loadMeshPrimitive",(function(s){return s._loadMeshPrimitiveAsync&&s._loadMeshPrimitiveAsync(t,e,i,r,n,o)}))},t.prototype._extensionsLoadMaterialAsync=function(t,e,i,r,n){return this._applyExtensions(e,"loadMaterial",(function(o){return o._loadMaterialAsync&&o._loadMaterialAsync(t,e,i,r,n)}))},t.prototype._extensionsCreateMaterial=function(t,e,i){return this._applyExtensions(e,"createMaterial",(function(r){return r.createMaterial&&r.createMaterial(t,e,i)}))},t.prototype._extensionsLoadMaterialPropertiesAsync=function(t,e,i){return this._applyExtensions(e,"loadMaterialProperties",(function(r){return r.loadMaterialPropertiesAsync&&r.loadMaterialPropertiesAsync(t,e,i)}))},t.prototype._extensionsLoadTextureInfoAsync=function(t,e,i){return this._applyExtensions(e,"loadTextureInfo",(function(r){return r.loadTextureInfoAsync&&r.loadTextureInfoAsync(t,e,i)}))},t.prototype._extensionsLoadTextureAsync=function(t,e,i){return this._applyExtensions(e,"loadTexture",(function(r){return r._loadTextureAsync&&r._loadTextureAsync(t,e,i)}))},t.prototype._extensionsLoadAnimationAsync=function(t,e){return this._applyExtensions(e,"loadAnimation",(function(i){return i.loadAnimationAsync&&i.loadAnimationAsync(t,e)}))},t.prototype._extensionsLoadSkinAsync=function(t,e,i){return this._applyExtensions(i,"loadSkin",(function(r){return r._loadSkinAsync&&r._loadSkinAsync(t,e,i)}))},t.prototype._extensionsLoadUriAsync=function(t,e,i){return this._applyExtensions(e,"loadUri",(function(r){return r._loadUriAsync&&r._loadUriAsync(t,e,i)}))},t.prototype._extensionsLoadBufferViewAsync=function(t,e){return this._applyExtensions(e,"loadBufferView",(function(i){return i.loadBufferViewAsync&&i.loadBufferViewAsync(t,e)}))},t.prototype._extensionsLoadBufferAsync=function(t,e,i,r){return this._applyExtensions(e,"loadBuffer",(function(n){return n.loadBufferAsync&&n.loadBufferAsync(t,e,i,r)}))},t.LoadExtensionAsync=function(t,e,i,r){if(!e.extensions)return null;var n=e.extensions[i];return n?r(t+"/extensions/"+i,n):null},t.LoadExtraAsync=function(t,e,i,r){if(!e.extras)return null;var n=e.extras[i];return n?r(t+"/extras/"+i,n):null},t.prototype.isExtensionUsed=function(t){return!!this._gltf.extensionsUsed&&-1!==this._gltf.extensionsUsed.indexOf(t)},t.prototype.logOpen=function(t){this._parent._logOpen(t)},t.prototype.logClose=function(){this._parent._logClose()},t.prototype.log=function(t){this._parent._log(t)},t.prototype.startPerformanceCounter=function(t){this._parent._startPerformanceCounter(t)},t.prototype.endPerformanceCounter=function(t){this._parent._endPerformanceCounter(t)},t._RegisteredExtensions={},t.DefaultSampler={index:-1},t}();n.GLTFFileLoader._CreateGLTF2Loader=function(t){return new s(t)}},function(t,e,i){"use strict";i.r(e),i.d(e,"GLTFLoaderCoordinateSystemMode",(function(){return r})),i.d(e,"GLTFLoaderAnimationStartMode",(function(){return n})),i.d(e,"GLTFLoaderState",(function(){return o})),i.d(e,"GLTFFileLoader",(function(){return l}));var r,n,o,s=i(0),a=i(3);!function(t){t[t.AUTO=0]="AUTO",t[t.FORCE_RIGHT_HANDED=1]="FORCE_RIGHT_HANDED"}(r||(r={})),function(t){t[t.NONE=0]="NONE",t[t.FIRST=1]="FIRST",t[t.ALL=2]="ALL"}(n||(n={})),function(t){t[t.LOADING=0]="LOADING",t[t.READY=1]="READY",t[t.COMPLETE=2]="COMPLETE"}(o||(o={}));var l=function(){function t(){this.onParsedObservable=new s.Observable,this.coordinateSystemMode=r.AUTO,this.animationStartMode=n.FIRST,this.compileMaterials=!1,this.useClipPlane=!1,this.compileShadowGenerators=!1,this.transparencyAsCoverage=!1,this.useRangeRequests=!1,this.createInstances=!0,this.alwaysComputeBoundingBox=!1,this.loadAllMaterials=!1,this.preprocessUrlAsync=function(t){return Promise.resolve(t)},this.onMeshLoadedObservable=new s.Observable,this.onTextureLoadedObservable=new s.Observable,this.onMaterialLoadedObservable=new s.Observable,this.onCameraLoadedObservable=new s.Observable,this.onCompleteObservable=new s.Observable,this.onErrorObservable=new s.Observable,this.onDisposeObservable=new s.Observable,this.onExtensionLoadedObservable=new s.Observable,this.validate=!1,this.onValidatedObservable=new s.Observable,this._loader=null,this._requests=new Array,this.name="gltf",this.extensions={".gltf":{isBinary:!1},".glb":{isBinary:!0}},this._logIndentLevel=0,this._loggingEnabled=!1,this._log=this._logDisabled,this._capturePerformanceCounters=!1,this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled}return Object.defineProperty(t.prototype,"onParsed",{set:function(t){this._onParsedObserver&&this.onParsedObservable.remove(this._onParsedObserver),this._onParsedObserver=this.onParsedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onMeshLoaded",{set:function(t){this._onMeshLoadedObserver&&this.onMeshLoadedObservable.remove(this._onMeshLoadedObserver),this._onMeshLoadedObserver=this.onMeshLoadedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTextureLoaded",{set:function(t){this._onTextureLoadedObserver&&this.onTextureLoadedObservable.remove(this._onTextureLoadedObserver),this._onTextureLoadedObserver=this.onTextureLoadedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onMaterialLoaded",{set:function(t){this._onMaterialLoadedObserver&&this.onMaterialLoadedObservable.remove(this._onMaterialLoadedObserver),this._onMaterialLoadedObserver=this.onMaterialLoadedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCameraLoaded",{set:function(t){this._onCameraLoadedObserver&&this.onCameraLoadedObservable.remove(this._onCameraLoadedObserver),this._onCameraLoadedObserver=this.onCameraLoadedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onComplete",{set:function(t){this._onCompleteObserver&&this.onCompleteObservable.remove(this._onCompleteObserver),this._onCompleteObserver=this.onCompleteObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onError",{set:function(t){this._onErrorObserver&&this.onErrorObservable.remove(this._onErrorObserver),this._onErrorObserver=this.onErrorObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onExtensionLoaded",{set:function(t){this._onExtensionLoadedObserver&&this.onExtensionLoadedObservable.remove(this._onExtensionLoadedObserver),this._onExtensionLoadedObserver=this.onExtensionLoadedObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loggingEnabled",{get:function(){return this._loggingEnabled},set:function(t){this._loggingEnabled!==t&&(this._loggingEnabled=t,this._loggingEnabled?this._log=this._logEnabled:this._log=this._logDisabled)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capturePerformanceCounters",{get:function(){return this._capturePerformanceCounters},set:function(t){this._capturePerformanceCounters!==t&&(this._capturePerformanceCounters=t,this._capturePerformanceCounters?(this._startPerformanceCounter=this._startPerformanceCounterEnabled,this._endPerformanceCounter=this._endPerformanceCounterEnabled):(this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onValidated",{set:function(t){this._onValidatedObserver&&this.onValidatedObservable.remove(this._onValidatedObserver),this._onValidatedObserver=this.onValidatedObservable.add(t)},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._loader&&(this._loader.dispose(),this._loader=null);for(var t=0,e=this._requests;t<e.length;t++)e[t].abort();this._requests.length=0,delete this._progressCallback,this.preprocessUrlAsync=function(t){return Promise.resolve(t)},this.onMeshLoadedObservable.clear(),this.onTextureLoadedObservable.clear(),this.onMaterialLoadedObservable.clear(),this.onCameraLoadedObservable.clear(),this.onCompleteObservable.clear(),this.onExtensionLoadedObservable.clear(),this.onDisposeObservable.notifyObservers(void 0),this.onDisposeObservable.clear()},t.prototype.requestFile=function(t,e,i,r,n,o){var a=this;if(this._progressCallback=r,n){if(this.useRangeRequests){this.validate&&s.Logger.Warn("glTF validation is not supported when range requests are enabled");var l={abort:function(){},onCompleteObservable:new s.Observable},h={readAsync:function(i,r){return new Promise((function(n,o){a._requestFile(e,t,(function(t){n(new Uint8Array(t))}),!0,(function(t){o(t)}),(function(t){t.setRequestHeader("Range","bytes="+i+"-"+(i+r-1))}))}))},byteLength:0};return this._unpackBinaryAsync(new s.DataReader(h)).then((function(t){l.onCompleteObservable.notifyObservers(l),i(t)}),o),l}return this._requestFile(e,t,(function(t,e){var r=t;a._unpackBinaryAsync(new s.DataReader({readAsync:function(t,e){return Promise.resolve(new Uint8Array(r,t,e))},byteLength:r.byteLength})).then((function(t){i(t,e)}),o)}),!0,o)}return this._requestFile(e,t,(function(r,n){a._validate(t,r,s.Tools.GetFolderPath(e),s.Tools.GetFilename(e)),i({json:a._parseJson(r)},n)}),n,o)},t.prototype.readFile=function(t,e,i,r,n,o){var a=this;return t._readFile(e,(function(r){if(a._validate(t,r,"file:",e.name),n){var l=r;a._unpackBinaryAsync(new s.DataReader({readAsync:function(t,e){return Promise.resolve(new Uint8Array(l,t,e))},byteLength:l.byteLength})).then(i,o)}else i({json:a._parseJson(r)})}),r,n,o)},t.prototype.importMeshAsync=function(t,e,i,r,n,o){var s=this;return Promise.resolve().then((function(){return s.onParsedObservable.notifyObservers(i),s.onParsedObservable.clear(),s._log("Loading "+(o||"")),s._loader=s._getLoader(i),s._loader.importMeshAsync(t,e,!1,i,r,n,o)}))},t.prototype.loadAsync=function(t,e,i,r,n){var o=this;return Promise.resolve().then((function(){return o.onParsedObservable.notifyObservers(e),o.onParsedObservable.clear(),o._log("Loading "+(n||"")),o._loader=o._getLoader(e),o._loader.loadAsync(t,e,i,r,n)}))},t.prototype.loadAssetContainerAsync=function(t,e,i,r,n){var o=this;return Promise.resolve().then((function(){o.onParsedObservable.notifyObservers(e),o.onParsedObservable.clear(),o._log("Loading "+(n||"")),o._loader=o._getLoader(e);var a=new s.AssetContainer(t),l=[];o.onMaterialLoadedObservable.add((function(t){l.push(t),t.onDisposeObservable.addOnce((function(){var e=a.materials.indexOf(t);e>-1&&a.materials.splice(e,1),(e=l.indexOf(t))>-1&&l.splice(e,1)}))}));var h=[];o.onTextureLoadedObservable.add((function(t){h.push(t),t.onDisposeObservable.addOnce((function(){var e=a.textures.indexOf(t);e>-1&&a.textures.splice(e,1),(e=h.indexOf(t))>-1&&h.splice(e,1)}))}));var c=[];return o.onCameraLoadedObservable.add((function(t){c.push(t)})),o._loader.importMeshAsync(null,t,!0,e,i,r,n).then((function(t){return Array.prototype.push.apply(a.geometries,t.geometries),Array.prototype.push.apply(a.meshes,t.meshes),Array.prototype.push.apply(a.particleSystems,t.particleSystems),Array.prototype.push.apply(a.skeletons,t.skeletons),Array.prototype.push.apply(a.animationGroups,t.animationGroups),Array.prototype.push.apply(a.materials,l),Array.prototype.push.apply(a.textures,h),Array.prototype.push.apply(a.lights,t.lights),Array.prototype.push.apply(a.transformNodes,t.transformNodes),Array.prototype.push.apply(a.cameras,c),a}))}))},t.prototype.canDirectLoad=function(e){return-1!==e.indexOf("asset")&&-1!==e.indexOf("version")||s.StringTools.StartsWith(e,"data:base64,"+t.magicBase64Encoded)||s.StringTools.StartsWith(e,"data:application/octet-stream;base64,"+t.magicBase64Encoded)||s.StringTools.StartsWith(e,"data:model/gltf-binary;base64,"+t.magicBase64Encoded)},t.prototype.directLoad=function(e,i){if(s.StringTools.StartsWith(i,"base64,"+t.magicBase64Encoded)||s.StringTools.StartsWith(i,"application/octet-stream;base64,"+t.magicBase64Encoded)||s.StringTools.StartsWith(i,"model/gltf-binary;base64,"+t.magicBase64Encoded)){var r=s.Tools.DecodeBase64(i);return this._validate(e,r),this._unpackBinaryAsync(new s.DataReader({readAsync:function(t,e){return Promise.resolve(new Uint8Array(r,t,e))},byteLength:r.byteLength}))}return this._validate(e,i),Promise.resolve({json:this._parseJson(i)})},t.prototype.createPlugin=function(){return new t},Object.defineProperty(t.prototype,"loaderState",{get:function(){return this._loader?this._loader.state:null},enumerable:!1,configurable:!0}),t.prototype.whenCompleteAsync=function(){var t=this;return new Promise((function(e,i){t.onCompleteObservable.addOnce((function(){e()})),t.onErrorObservable.addOnce((function(t){i(t)}))}))},t.prototype._loadFile=function(t,e,i,r,n){var o=this,s=e._loadFile(t,i,(function(t){o._onProgress(t,s)}),void 0,r,n);return s.onCompleteObservable.add((function(t){o._requests.splice(o._requests.indexOf(t),1)})),this._requests.push(s),s},t.prototype._requestFile=function(t,e,i,r,n,o){var s=this,a=e._requestFile(t,i,(function(t){s._onProgress(t,a)}),void 0,r,n,o);return a.onCompleteObservable.add((function(t){s._requests.splice(s._requests.indexOf(t),1)})),this._requests.push(a),a},t.prototype._onProgress=function(t,e){if(this._progressCallback){e._lengthComputable=t.lengthComputable,e._loaded=t.loaded,e._total=t.total;for(var i=!0,r=0,n=0,o=0,s=this._requests;o<s.length;o++){var a=s[o];if(void 0===a._lengthComputable||void 0===a._loaded||void 0===a._total)return;i=i&&a._lengthComputable,r+=a._loaded,n+=a._total}this._progressCallback({lengthComputable:i,loaded:r,total:i?n:0})}},t.prototype._validate=function(t,e,i,r){var n=this;void 0===i&&(i=""),void 0===r&&(r=""),this.validate&&(this._startPerformanceCounter("Validate JSON"),a.GLTFValidation.ValidateAsync(e,i,r,(function(e){return n.preprocessUrlAsync(i+e).then((function(e){return t._loadFileAsync(e,void 0,!0,!0)}))})).then((function(t){n._endPerformanceCounter("Validate JSON"),n.onValidatedObservable.notifyObservers(t),n.onValidatedObservable.clear()}),(function(t){n._endPerformanceCounter("Validate JSON"),s.Tools.Warn("Failed to validate: "+t.message),n.onValidatedObservable.clear()})))},t.prototype._getLoader=function(e){var i=e.json.asset||{};this._log("Asset version: "+i.version),i.minVersion&&this._log("Asset minimum version: "+i.minVersion),i.generator&&this._log("Asset generator: "+i.generator);var r=t._parseVersion(i.version);if(!r)throw new Error("Invalid version: "+i.version);if(void 0!==i.minVersion){var n=t._parseVersion(i.minVersion);if(!n)throw new Error("Invalid minimum version: "+i.minVersion);if(t._compareVersion(n,{major:2,minor:0})>0)throw new Error("Incompatible minimum version: "+i.minVersion)}var o={1:t._CreateGLTF1Loader,2:t._CreateGLTF2Loader}[r.major];if(!o)throw new Error("Unsupported version: "+i.version);return o(this)},t.prototype._parseJson=function(t){this._startPerformanceCounter("Parse JSON"),this._log("JSON length: "+t.length);var e=JSON.parse(t);return this._endPerformanceCounter("Parse JSON"),e},t.prototype._unpackBinaryAsync=function(t){var e=this;return this._startPerformanceCounter("Unpack Binary"),t.loadAsync(20).then((function(){var i=t.readUint32();if(1179937895!==i)throw new Error("Unexpected magic: "+i);var r=t.readUint32();e.loggingEnabled&&e._log("Binary version: "+r);var n,o=t.readUint32();if(0!==t.buffer.byteLength&&o!==t.buffer.byteLength)throw new Error("Length in header does not match actual data length: "+o+" != "+t.buffer.byteLength);switch(r){case 1:n=e._unpackBinaryV1Async(t,o);break;case 2:n=e._unpackBinaryV2Async(t,o);break;default:throw new Error("Unsupported version: "+r)}return e._endPerformanceCounter("Unpack Binary"),n}))},t.prototype._unpackBinaryV1Async=function(t,e){var i=t.readUint32(),r=t.readUint32();if(0!==r)throw new Error("Unexpected content format: "+r);var n=e-t.byteOffset,o={json:this._parseJson(t.readString(i)),bin:null};if(0!==n){var s=t.byteOffset;o.bin={readAsync:function(e,i){return t.buffer.readAsync(s+e,i)},byteLength:n}}return Promise.resolve(o)},t.prototype._unpackBinaryV2Async=function(t,e){var i=this,r=1313821514,n=5130562,o=t.readUint32();if(t.readUint32()!==r)throw new Error("First chunk format is not JSON");return t.byteOffset+o===e?t.loadAsync(o).then((function(){return{json:i._parseJson(t.readString(o)),bin:null}})):t.loadAsync(o+8).then((function(){var s={json:i._parseJson(t.readString(o)),bin:null},a=function(){var i=t.readUint32();switch(t.readUint32()){case r:throw new Error("Unexpected JSON chunk");case n:var o=t.byteOffset;s.bin={readAsync:function(e,i){return t.buffer.readAsync(o+e,i)},byteLength:i},t.skipBytes(i);break;default:t.skipBytes(i)}return t.byteOffset!==e?t.loadAsync(8).then(a):Promise.resolve(s)};return a()}))},t._parseVersion=function(t){if("1.0"===t||"1.0.1"===t)return{major:1,minor:0};var e=(t+"").match(/^(\d+)\.(\d+)/);return e?{major:parseInt(e[1]),minor:parseInt(e[2])}:null},t._compareVersion=function(t,e){return t.major>e.major?1:t.major<e.major?-1:t.minor>e.minor?1:t.minor<e.minor?-1:0},t.prototype._logOpen=function(t){this._log(t),this._logIndentLevel++},t.prototype._logClose=function(){--this._logIndentLevel},t.prototype._logEnabled=function(e){var i=t._logSpaces.substr(0,2*this._logIndentLevel);s.Logger.Log(""+i+e)},t.prototype._logDisabled=function(t){},t.prototype._startPerformanceCounterEnabled=function(t){s.Tools.StartPerformanceCounter(t)},t.prototype._startPerformanceCounterDisabled=function(t){},t.prototype._endPerformanceCounterEnabled=function(t){s.Tools.EndPerformanceCounter(t)},t.prototype._endPerformanceCounterDisabled=function(t){},t.IncrementalLoading=!0,t.HomogeneousCoordinates=!1,t.magicBase64Encoded="Z2xURg",t._logSpaces="                                ",t}();s.SceneLoader&&s.SceneLoader.RegisterPlugin(new l)},function(t,e,i){"use strict";i.r(e),i.d(e,"GLTFValidation",(function(){return s}));var r=i(0);function n(t,e,i,r){var n={externalResourceFunction:function(t){return r(t).then((function(t){return new Uint8Array(t)}))}};return i&&(n.uri="file:"===e?i:e+i),t instanceof ArrayBuffer?GLTFValidator.validateBytes(new Uint8Array(t),n):GLTFValidator.validateString(t,n)}function o(){var t=[];onmessage=function(e){var i=e.data;switch(i.id){case"init":importScripts(i.url);break;case"validate":n(i.data,i.rootUrl,i.fileName,(function(e){return new Promise((function(i,r){var n=t.length;t.push({resolve:i,reject:r}),postMessage({id:"getExternalResource",index:n,uri:e})}))})).then((function(t){postMessage({id:"validate.resolve",value:t})}),(function(t){postMessage({id:"validate.reject",reason:t})}));break;case"getExternalResource.resolve":t[i.index].resolve(i.value);break;case"getExternalResource.reject":t[i.index].reject(i.reason)}}}var s=function(){function t(){}return t.ValidateAsync=function(t,e,i,s){var a=this;return"function"==typeof Worker?new Promise((function(l,h){var c=n+"("+o+")()",u=URL.createObjectURL(new Blob([c],{type:"application/javascript"})),d=new Worker(u),p=function(t){d.removeEventListener("error",p),d.removeEventListener("message",f),h(t)},f=function(t){var e=t.data;switch(e.id){case"getExternalResource":s(e.uri).then((function(t){d.postMessage({id:"getExternalResource.resolve",index:e.index,value:t},[t])}),(function(t){d.postMessage({id:"getExternalResource.reject",index:e.index,reason:t})}));break;case"validate.resolve":d.removeEventListener("error",p),d.removeEventListener("message",f),l(e.value);break;case"validate.reject":d.removeEventListener("error",p),d.removeEventListener("message",f),h(e.reason)}};d.addEventListener("error",p),d.addEventListener("message",f),d.postMessage({id:"init",url:r.Tools.GetAbsoluteUrl(a.Configuration.url)}),d.postMessage({id:"validate",data:t,rootUrl:e,fileName:i})})):(this._LoadScriptPromise||(this._LoadScriptPromise=r.Tools.LoadScriptAsync(this.Configuration.url)),this._LoadScriptPromise.then((function(){return n(t,e,i,s)})))},t.Configuration={url:"https://preview.babylonjs.com/gltf_validator.js"},t}()},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.create,Object.create},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";i.r(e)},function(t,e,i){"use strict";i.r(e),i.d(e,"EXT_lights_image_based",(function(){return s})),i.d(e,"EXT_mesh_gpu_instancing",(function(){return a})),i.d(e,"EXT_texture_webp",(function(){return l})),i.d(e,"KHR_draco_mesh_compression",(function(){return h})),i.d(e,"KHR_lights",(function(){return c})),i.d(e,"KHR_materials_pbrSpecularGlossiness",(function(){return u})),i.d(e,"KHR_materials_unlit",(function(){return d})),i.d(e,"KHR_materials_clearcoat",(function(){return p})),i.d(e,"KHR_materials_sheen",(function(){return f})),i.d(e,"KHR_materials_specular",(function(){return _})),i.d(e,"KHR_materials_ior",(function(){return g})),i.d(e,"KHR_materials_variants",(function(){return m})),i.d(e,"KHR_materials_transmission",(function(){return y})),i.d(e,"KHR_materials_translucency",(function(){return T})),i.d(e,"KHR_mesh_quantization",(function(){return O})),i.d(e,"KHR_texture_basisu",(function(){return E})),i.d(e,"KHR_texture_transform",(function(){return A})),i.d(e,"MSFT_audio_emitter",(function(){return C})),i.d(e,"MSFT_lod",(function(){return x})),i.d(e,"MSFT_minecraftMesh",(function(){return w})),i.d(e,"MSFT_sRGBFactors",(function(){return M})),i.d(e,"ExtrasAsMetadata",(function(){return S}));var r=i(0),n=i(1),o="EXT_lights_image_based",s=function(){function t(t){this.name=o,this._loader=t,this.enabled=this._loader.isExtensionUsed(o)}return t.prototype.dispose=function(){this._loader=null,delete this._lights},t.prototype.onLoading=function(){var t=this._loader.gltf.extensions;if(t&&t[this.name]){var e=t[this.name];this._lights=e.lights}},t.prototype.loadSceneAsync=function(t,e){var i=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(r,o){var s=new Array;s.push(i._loader.loadSceneAsync(t,e)),i._loader.logOpen(""+r);var a=n.a.Get(r+"/light",i._lights,o.light);return s.push(i._loadLightAsync("/extensions/"+i.name+"/lights/"+o.light,a).then((function(t){i._loader.babylonScene.environmentTexture=t}))),i._loader.logClose(),Promise.all(s).then((function(){}))}))},t.prototype._loadLightAsync=function(t,e){var i=this;if(!e._loaded){var o=new Array;this._loader.logOpen(""+t);for(var s=new Array(e.specularImages.length),a=function(i){var r=e.specularImages[i];s[i]=new Array(r.length);for(var a=function(e){var a=t+"/specularImages/"+i+"/"+e;l._loader.logOpen(""+a);var h=r[e],c=n.a.Get(a,l._loader.gltf.images,h);o.push(l._loader.loadImageAsync("/images/"+h,c).then((function(t){s[i][e]=t}))),l._loader.logClose()},h=0;h<r.length;h++)a(h)},l=this,h=0;h<e.specularImages.length;h++)a(h);this._loader.logClose(),e._loaded=Promise.all(o).then((function(){var t=new r.RawCubeTexture(i._loader.babylonScene,null,e.specularImageSize);if(t.name=e.name||"environment",e._babylonTexture=t,null!=e.intensity&&(t.level=e.intensity),e.rotation){var n=r.Quaternion.FromArray(e.rotation);i._loader.babylonScene.useRightHandedSystem||(n=r.Quaternion.Inverse(n)),r.Matrix.FromQuaternionToRef(n,t.getReflectionTextureMatrix())}var o=r.SphericalHarmonics.FromArray(e.irradianceCoefficients);o.scaleInPlace(e.intensity),o.convertIrradianceToLambertianRadiance();var a=r.SphericalPolynomial.FromHarmonics(o),l=(s.length-1)/r.Scalar.Log2(e.specularImageSize);return t.updateRGBDAsync(s,a,l)}))}return e._loaded.then((function(){return e._babylonTexture}))},t}();n.b.RegisterExtension(o,(function(t){return new s(t)}));var a=function(){function t(t){this.name="EXT_mesh_gpu_instancing",this._loader=t,this.enabled=this._loader.isExtensionUsed("EXT_mesh_gpu_instancing")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadNodeAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(t,s){o._loader._disableInstancedMesh++;var a=o._loader.loadNodeAsync("/nodes/"+e.index,e,i);if(o._loader._disableInstancedMesh--,!e._primitiveBabylonMeshes)return a;var l=new Array,h=0,c=function(e){if(null!=s.attributes[e]){var i=n.a.Get(t+"/attributes/"+e,o._loader.gltf.accessors,s.attributes[e]);if(l.push(o._loader._loadFloatAccessorAsync("/accessors/"+i.bufferView,i)),0===h)h=i.count;else if(h!==i.count)throw new Error(t+"/attributes: Instance buffer accessors do not have the same count.")}else l.push(Promise.resolve(null))};return c("TRANSLATION"),c("ROTATION"),c("SCALE"),a.then((function(t){return Promise.all(l).then((function(i){var n=i[0],o=i[1],s=i[2],a=new Float32Array(16*h);r.TmpVectors.Vector3[0].copyFromFloats(0,0,0),r.TmpVectors.Quaternion[0].copyFromFloats(0,0,0,1),r.TmpVectors.Vector3[1].copyFromFloats(1,1,1);for(var l=0;l<h;++l)n&&r.Vector3.FromArrayToRef(n,3*l,r.TmpVectors.Vector3[0]),o&&r.Quaternion.FromArrayToRef(o,4*l,r.TmpVectors.Quaternion[0]),s&&r.Vector3.FromArrayToRef(s,3*l,r.TmpVectors.Vector3[1]),r.Matrix.ComposeToRef(r.TmpVectors.Vector3[1],r.TmpVectors.Quaternion[0],r.TmpVectors.Vector3[0],r.TmpVectors.Matrix[0]),r.TmpVectors.Matrix[0].copyToArray(a,16*l);for(var c=0,u=e._primitiveBabylonMeshes;c<u.length;c++)u[c].thinInstanceSetBuffer("matrix",a,16,!0);return t}))}))}))},t}();n.b.RegisterExtension("EXT_mesh_gpu_instancing",(function(t){return new a(t)}));var l=function(){function t(t){this.name="EXT_texture_webp",this._loader=t,this.enabled=t.isExtensionUsed("EXT_texture_webp")}return t.prototype.dispose=function(){this._loader=null},t.prototype._loadTextureAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(o,s){var a=null==e.sampler?n.b.DefaultSampler:n.a.Get(t+"/sampler",r._loader.gltf.samplers,e.sampler),l=n.a.Get(o+"/source",r._loader.gltf.images,s.source);return r._loader._createTextureAsync(t,a,l,(function(t){i(t)}))}))},t}();n.b.RegisterExtension("EXT_texture_webp",(function(t){return new l(t)}));var h=function(){function t(t){this.name="KHR_draco_mesh_compression",this._loader=t,this.enabled=r.DracoCompression.DecoderAvailable&&this._loader.isExtensionUsed("KHR_draco_mesh_compression")}return t.prototype.dispose=function(){delete this.dracoCompression,this._loader=null},t.prototype._loadVertexDataAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(s,a){if(null!=e.mode){if(5!==e.mode&&4!==e.mode)throw new Error(t+": Unsupported mode "+e.mode);if(5===e.mode)throw new Error(t+": Mode "+e.mode+" is not currently supported")}var l={},h=function(t,e){var r=a.attributes[t];null!=r&&(i._delayInfo=i._delayInfo||[],-1===i._delayInfo.indexOf(e)&&i._delayInfo.push(e),l[e]=r)};h("POSITION",r.VertexBuffer.PositionKind),h("NORMAL",r.VertexBuffer.NormalKind),h("TANGENT",r.VertexBuffer.TangentKind),h("TEXCOORD_0",r.VertexBuffer.UVKind),h("TEXCOORD_1",r.VertexBuffer.UV2Kind),h("JOINTS_0",r.VertexBuffer.MatricesIndicesKind),h("WEIGHTS_0",r.VertexBuffer.MatricesWeightsKind),h("COLOR_0",r.VertexBuffer.ColorKind);var c=n.a.Get(s,o._loader.gltf.bufferViews,a.bufferView);return c._dracoBabylonGeometry||(c._dracoBabylonGeometry=o._loader.loadBufferViewAsync("/bufferViews/"+c.index,c).then((function(e){return(o.dracoCompression||r.DracoCompression.Default).decodeMeshAsync(e,l).then((function(t){var e=new r.Geometry(i.name,o._loader.babylonScene);return t.applyToGeometry(e),e})).catch((function(e){throw new Error(t+": "+e.message)}))}))),c._dracoBabylonGeometry}))},t}();n.b.RegisterExtension("KHR_draco_mesh_compression",(function(t){return new h(t)}));var c=function(){function t(t){this.name="KHR_lights_punctual",this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_lights_punctual")}return t.prototype.dispose=function(){this._loader=null,delete this._lights},t.prototype.onLoading=function(){var t=this._loader.gltf.extensions;if(t&&t[this.name]){var e=t[this.name];this._lights=e.lights}},t.prototype.loadNodeAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(s,a){return o._loader.loadNodeAsync(t,e,(function(t){var e,l=n.a.Get(s,o._lights,a.light),h=l.name||t.name;switch(o._loader.babylonScene._blockEntityCollection=o._loader._forAssetContainer,l.type){case"directional":e=new r.DirectionalLight(h,r.Vector3.Backward(),o._loader.babylonScene);break;case"point":e=new r.PointLight(h,r.Vector3.Zero(),o._loader.babylonScene);break;case"spot":var c=new r.SpotLight(h,r.Vector3.Zero(),r.Vector3.Backward(),0,1,o._loader.babylonScene);c.angle=2*(l.spot&&l.spot.outerConeAngle||Math.PI/4),c.innerAngle=2*(l.spot&&l.spot.innerConeAngle||0),e=c;break;default:throw o._loader.babylonScene._blockEntityCollection=!1,new Error(s+": Invalid light type ("+l.type+")")}o._loader.babylonScene._blockEntityCollection=!1,e.falloffType=r.Light.FALLOFF_GLTF,e.diffuse=l.color?r.Color3.FromArray(l.color):r.Color3.White(),e.intensity=null==l.intensity?1:l.intensity,e.range=null==l.range?Number.MAX_VALUE:l.range,e.parent=t,o._loader._babylonLights.push(e),n.b.AddPointerMetadata(e,s),i(t)}))}))},t}();n.b.RegisterExtension("KHR_lights_punctual",(function(t){return new c(t)}));var u=function(){function t(t){this.name="KHR_materials_pbrSpecularGlossiness",this.order=200,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_pbrSpecularGlossiness")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialBasePropertiesAsync(t,e,i)),s.push(r._loadSpecularGlossinessPropertiesAsync(n,e,o,i)),r._loader.loadMaterialAlphaProperties(t,e,i),Promise.all(s).then((function(){}))}))},t.prototype._loadSpecularGlossinessPropertiesAsync=function(t,e,i,n){if(!(n instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var o=new Array;return n.metallic=null,n.roughness=null,i.diffuseFactor?(n.albedoColor=r.Color3.FromArray(i.diffuseFactor),n.alpha=i.diffuseFactor[3]):n.albedoColor=r.Color3.White(),n.reflectivityColor=i.specularFactor?r.Color3.FromArray(i.specularFactor):r.Color3.White(),n.microSurface=null==i.glossinessFactor?1:i.glossinessFactor,i.diffuseTexture&&o.push(this._loader.loadTextureInfoAsync(t+"/diffuseTexture",i.diffuseTexture,(function(t){t.name=n.name+" (Diffuse)",n.albedoTexture=t}))),i.specularGlossinessTexture&&(i.specularGlossinessTexture.nonColorData=!0,o.push(this._loader.loadTextureInfoAsync(t+"/specularGlossinessTexture",i.specularGlossinessTexture,(function(t){t.name=n.name+" (Specular Glossiness)",n.reflectivityTexture=t}))),n.reflectivityTexture.hasAlpha=!0,n.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(o).then((function(){}))},t}();n.b.RegisterExtension("KHR_materials_pbrSpecularGlossiness",(function(t){return new u(t)}));var d=function(){function t(t){this.name="KHR_materials_unlit",this.order=210,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_unlit")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(){return r._loadUnlitPropertiesAsync(t,e,i)}))},t.prototype._loadUnlitPropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;i.unlit=!0;var o=e.pbrMetallicRoughness;return o&&(o.baseColorFactor?(i.albedoColor=r.Color3.FromArray(o.baseColorFactor),i.alpha=o.baseColorFactor[3]):i.albedoColor=r.Color3.White(),o.baseColorTexture&&n.push(this._loader.loadTextureInfoAsync(t+"/baseColorTexture",o.baseColorTexture,(function(t){t.name=i.name+" (Base Color)",i.albedoTexture=t})))),e.doubleSided&&(i.backFaceCulling=!1,i.twoSidedLighting=!0),this._loader.loadMaterialAlphaProperties(t,e,i),Promise.all(n).then((function(){}))},t}();n.b.RegisterExtension("KHR_materials_unlit",(function(t){return new d(t)}));var p=function(){function t(t){this.name="KHR_materials_clearcoat",this.order=190,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_clearcoat")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadClearCoatPropertiesAsync(n,o,i)),Promise.all(s).then((function(){}))}))},t.prototype._loadClearCoatPropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;return i.clearCoat.isEnabled=!0,i.clearCoat.useRoughnessFromMainTexture=!1,i.clearCoat.remapF0OnInterfaceChange=!1,null!=e.clearcoatFactor?i.clearCoat.intensity=e.clearcoatFactor:i.clearCoat.intensity=0,e.clearcoatTexture&&n.push(this._loader.loadTextureInfoAsync(t+"/clearcoatTexture",e.clearcoatTexture,(function(t){t.name=i.name+" (ClearCoat Intensity)",i.clearCoat.texture=t}))),null!=e.clearcoatRoughnessFactor?i.clearCoat.roughness=e.clearcoatRoughnessFactor:i.clearCoat.roughness=0,e.clearcoatRoughnessTexture&&(e.clearcoatRoughnessTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(t+"/clearcoatRoughnessTexture",e.clearcoatRoughnessTexture,(function(t){t.name=i.name+" (ClearCoat Roughness)",i.clearCoat.textureRoughness=t})))),e.clearcoatNormalTexture&&(e.clearcoatNormalTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(t+"/clearcoatNormalTexture",e.clearcoatNormalTexture,(function(t){t.name=i.name+" (ClearCoat Normal)",i.clearCoat.bumpTexture=t}))),i.invertNormalMapX=!i.getScene().useRightHandedSystem,i.invertNormalMapY=i.getScene().useRightHandedSystem,null!=e.clearcoatNormalTexture.scale&&(i.clearCoat.bumpTexture.level=e.clearcoatNormalTexture.scale)),Promise.all(n).then((function(){}))},t}();n.b.RegisterExtension("KHR_materials_clearcoat",(function(t){return new p(t)}));var f=function(){function t(t){this.name="KHR_materials_sheen",this.order=190,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_sheen")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadSheenPropertiesAsync(n,o,i)),Promise.all(s).then((function(){}))}))},t.prototype._loadSheenPropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;return i.sheen.isEnabled=!0,i.sheen.intensity=1,null!=e.sheenColorFactor?i.sheen.color=r.Color3.FromArray(e.sheenColorFactor):i.sheen.color=r.Color3.Black(),e.sheenColorTexture&&n.push(this._loader.loadTextureInfoAsync(t+"/sheenColorTexture",e.sheenColorTexture,(function(t){t.name=i.name+" (Sheen Color)",i.sheen.texture=t}))),void 0!==e.sheenRoughnessFactor?i.sheen.roughness=e.sheenRoughnessFactor:i.sheen.roughness=0,e.sheenRoughnessTexture&&(e.sheenRoughnessTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(t+"/sheenRoughnessTexture",e.sheenRoughnessTexture,(function(t){t.name=i.name+" (Sheen Roughness)",i.sheen.textureRoughness=t})))),i.sheen.albedoScaling=!0,i.sheen.useRoughnessFromMainTexture=!1,Promise.all(n).then((function(){}))},t}();n.b.RegisterExtension("KHR_materials_sheen",(function(t){return new f(t)}));var _=function(){function t(t){this.name="KHR_materials_specular",this.order=190,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_specular")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadSpecularPropertiesAsync(n,o,i)),Promise.all(s).then((function(){}))}))},t.prototype._loadSpecularPropertiesAsync=function(t,e,i){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var n=new Array;return void 0!==e.specularFactor&&(i.metallicF0Factor=e.specularFactor),void 0!==e.specularColorFactor&&(i.metallicReflectanceColor=r.Color3.FromArray(e.specularColorFactor)),e.specularTexture&&(e.specularTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(t+"/specularTexture",e.specularTexture,(function(t){t.name=i.name+" (Specular F0 Color)",i.metallicReflectanceTexture=t})))),Promise.all(n).then((function(){}))},t}();n.b.RegisterExtension("KHR_materials_specular",(function(t){return new _(t)}));var g=function(){function t(t){this.name="KHR_materials_ior",this.order=180,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_ior")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadIorPropertiesAsync(n,o,i)),Promise.all(s).then((function(){}))}))},t.prototype._loadIorPropertiesAsync=function(e,i,n){if(!(n instanceof r.PBRMaterial))throw new Error(e+": Material type not supported");return void 0!==i.ior?n.indexOfRefraction=i.ior:n.indexOfRefraction=t._DEFAULT_IOR,Promise.resolve()},t._DEFAULT_IOR=1.5,t}();n.b.RegisterExtension("KHR_materials_ior",(function(t){return new g(t)}));var m=function(){function t(t){this.name="KHR_materials_variants",this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_variants")}return t.prototype.dispose=function(){this._loader=null},t.GetAvailableVariants=function(t){var e=this._GetExtensionMetadata(t);return e?Object.keys(e.variants):[]},t.prototype.getAvailableVariants=function(e){return t.GetAvailableVariants(e)},t.SelectVariant=function(t,e){var i=this._GetExtensionMetadata(t);if(!i)throw new Error("Cannot select variant on a glTF mesh that does not have the KHR_materials_variants extension");var r=function(t){var e=i.variants[t];if(e)for(var r=0,n=e;r<n.length;r++){var o=n[r];o.mesh.material=o.material}};if(e instanceof Array)for(var n=0,o=e;n<o.length;n++)r(o[n]);else r(e);i.lastSelected=e},t.prototype.selectVariant=function(e,i){return t.SelectVariant(e,i)},t.Reset=function(t){var e=this._GetExtensionMetadata(t);if(!e)throw new Error("Cannot reset on a glTF mesh that does not have the KHR_materials_variants extension");for(var i=0,r=e.original;i<r.length;i++){var n=r[i];n.mesh.material=n.material}e.lastSelected=null},t.prototype.reset=function(e){return t.Reset(e)},t.GetLastSelectedVariant=function(t){var e=this._GetExtensionMetadata(t);if(!e)throw new Error("Cannot get the last selected variant on a glTF mesh that does not have the KHR_materials_variants extension");return e.lastSelected},t.prototype.getLastSelectedVariant=function(e){return t.GetLastSelectedVariant(e)},t._GetExtensionMetadata=function(t){var e,i;return(null===(i=null===(e=null==t?void 0:t.metadata)||void 0===e?void 0:e.gltf)||void 0===i?void 0:i.KHR_materials_variants)||null},t.prototype.onLoading=function(){var t=this._loader.gltf.extensions;if(t&&t[this.name]){var e=t[this.name];this._variants=e.variants}},t.prototype._loadMeshPrimitiveAsync=function(t,e,i,o,s,a){var l=this;return n.b.LoadExtensionAsync(t,s,this.name,(function(h,c){var u=new Array;return u.push(l._loader._loadMeshPrimitiveAsync(t,e,i,o,s,(function(e){if(a(e),e instanceof r.Mesh){var i=n.b._GetDrawMode(t,s.mode),o=l._loader.rootBabylonMesh,d=o.metadata=o.metadata||{},p=d.gltf=d.gltf||{},f=p.KHR_materials_variants=p.KHR_materials_variants||{lastSelected:null,original:[],variants:{}};f.original.push({mesh:e,material:e.material});for(var _=f.variants,g=0,m=c.mappings;g<m.length;g++)for(var b=m[g],v=function(t){var r=n.a.Get(h+"/mapping/"+t,l._variants,t),o=n.a.Get("#/materials/",l._loader.gltf.materials,b.material);u.push(l._loader._loadMaterialAsync("#/materials/"+b.material,o,e,i,(function(t){_[r.name]=_[r.name]||[],_[r.name].push({mesh:e,material:t})})))},y=0,T=b.variants;y<T.length;y++)v(T[y])}}))),Promise.all(u).then((function(t){return t[0]}))}))},t}();n.b.RegisterExtension("KHR_materials_variants",(function(t){return new m(t)}));var b=i(4),v=function(){function t(e,i){var n=this;this._opaqueRenderTarget=null,this._opaqueMeshesCache=[],this._transparentMeshesCache=[],this._options=Object(b.a)(Object(b.a)({},t._getDefaultOptions()),e),this._scene=i,this._scene._transmissionHelper=this,this.onErrorObservable=new r.Observable,this._scene.onDisposeObservable.addOnce((function(t){n.dispose()})),this._parseScene(),this._setupRenderTargets()}return t._getDefaultOptions=function(){return{renderSize:512}},t.prototype.updateOptions=function(t){var e=this;if(Object.keys(t).filter((function(i){return e._options[i]!==t[i]})).length){var i=Object(b.a)(Object(b.a)({},this._options),t),r=this._options;this._options=i,i.renderSize!==r.renderSize&&this._setupRenderTargets()}},t.prototype.getOpaqueTarget=function(){return this._opaqueRenderTarget},t.prototype.shouldRenderAsTransmission=function(t){return!!t&&!!(t instanceof r.PBRMaterial&&t.subSurface.isRefractionEnabled)},t.prototype._addMesh=function(t){t instanceof r.Mesh&&(t.onMaterialChangedObservable.add(this.onMeshMaterialChanged.bind(this)),this.shouldRenderAsTransmission(t.material)?this._transparentMeshesCache.push(t):this._opaqueMeshesCache.push(t))},t.prototype._removeMesh=function(t){if(t instanceof r.Mesh){t.onMaterialChangedObservable.remove(this.onMeshMaterialChanged.bind(this));var e=this._transparentMeshesCache.indexOf(t);-1!==e&&this._transparentMeshesCache.splice(e,1),-1!==(e=this._opaqueMeshesCache.indexOf(t))&&this._opaqueMeshesCache.splice(e,1)}},t.prototype._parseScene=function(){this._scene.meshes.forEach(this._addMesh.bind(this)),this._scene.onNewMeshAddedObservable.add(this._addMesh.bind(this)),this._scene.onMeshRemovedObservable.add(this._removeMesh.bind(this))},t.prototype.onMeshMaterialChanged=function(t){if(t instanceof r.Mesh){var e=this._transparentMeshesCache.indexOf(t),i=this._opaqueMeshesCache.indexOf(t);this.shouldRenderAsTransmission(t.material)?(t.material instanceof r.PBRMaterial&&(t.material.subSurface.refractionTexture=this._opaqueRenderTarget),-1!==i?(this._opaqueMeshesCache.splice(i,1),this._transparentMeshesCache.push(t)):-1===e&&this._transparentMeshesCache.push(t)):-1!==e?(this._transparentMeshesCache.splice(e,1),this._opaqueMeshesCache.push(t)):-1===i&&this._opaqueMeshesCache.push(t)}},t.prototype._setupRenderTargets=function(){var t=this,e=-1;if(this._scene.layers&&this._opaqueRenderTarget)for(var i=0,n=this._scene.layers;i<n.length;i++){var o=(l=n[i]).renderTargetTextures.indexOf(this._opaqueRenderTarget);o>=0&&l.renderTargetTextures.splice(o,1)}if(this._opaqueRenderTarget&&(e=this._scene.customRenderTargets.indexOf(this._opaqueRenderTarget),this._opaqueRenderTarget.dispose()),this._opaqueRenderTarget=new r.RenderTargetTexture("opaqueSceneTexture",this._options.renderSize,this._scene,!0),this._opaqueRenderTarget.renderList=this._opaqueMeshesCache,this._opaqueRenderTarget.gammaSpace=!0,this._opaqueRenderTarget.lodGenerationScale=1,this._opaqueRenderTarget.lodGenerationOffset=-4,e>=0?this._scene.customRenderTargets.splice(e,0,this._opaqueRenderTarget):(e=this._scene.customRenderTargets.length,this._scene.customRenderTargets.push(this._opaqueRenderTarget)),this._scene.layers&&this._opaqueRenderTarget)for(var s=0,a=this._scene.layers;s<a.length;s++){var l;(l=a[s]).renderTargetTextures.push(this._opaqueRenderTarget)}this._transparentMeshesCache.forEach((function(e){t.shouldRenderAsTransmission(e.material)&&e.material instanceof r.PBRMaterial&&(e.material.refractionTexture=t._opaqueRenderTarget)}))},t.prototype.dispose=function(){this._scene._transmissionHelper=void 0,this._opaqueRenderTarget&&(this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=null),this._transparentMeshesCache=[],this._opaqueMeshesCache=[]},t}(),y=function(){function t(t){this.name="KHR_materials_transmission",this.order=175,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_transmission"),this.enabled&&(t.parent.transparencyAsCoverage=!0)}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialBasePropertiesAsync(t,e,i)),s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadTransparentPropertiesAsync(n,e,i,o)),Promise.all(s).then((function(){}))}))},t.prototype._loadTransparentPropertiesAsync=function(t,e,i,n){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var o=i;if(o.subSurface.isRefractionEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.useAlbedoToTintRefraction=!0,void 0===n.transmissionFactor)return o.subSurface.refractionIntensity=0,o.subSurface.isRefractionEnabled=!1,Promise.resolve();o.subSurface.refractionIntensity=n.transmissionFactor;var s=o.getScene();return o.subSurface.refractionIntensity&&!s._transmissionHelper&&new v({},o.getScene()),n.transmissionTexture?(n.transmissionTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(t+"/transmissionTexture",n.transmissionTexture,void 0).then((function(t){o.subSurface.thicknessTexture=t,o.subSurface.useMaskFromThicknessTextureGltf=!0}))):Promise.resolve()},t}();n.b.RegisterExtension("KHR_materials_transmission",(function(t){return new y(t)}));var T=function(){function t(t){this.name="KHR_materials_translucency",this.order=175,this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_materials_translucency"),this.enabled&&(t.parent.transparencyAsCoverage=!0)}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,o){var s=new Array;return s.push(r._loader.loadMaterialBasePropertiesAsync(t,e,i)),s.push(r._loader.loadMaterialPropertiesAsync(t,e,i)),s.push(r._loadTranslucentPropertiesAsync(n,e,i,o)),Promise.all(s).then((function(){}))}))},t.prototype._loadTranslucentPropertiesAsync=function(t,e,i,n){if(!(i instanceof r.PBRMaterial))throw new Error(t+": Material type not supported");var o=i;return o.subSurface.isTranslucencyEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.minimumThickness=0,o.subSurface.maximumThickness=0,o.subSurface.useAlbedoToTintRefraction=!0,void 0===n.translucencyFactor?(o.subSurface.translucencyIntensity=0,o.subSurface.isTranslucencyEnabled=!1,Promise.resolve()):(o.subSurface.translucencyIntensity=n.translucencyFactor,n.translucencyTexture?this._loader.loadTextureInfoAsync(t+"/translucencyTexture",n.translucencyTexture).then((function(t){o.subSurface.thicknessTexture=t,o.subSurface.useMaskFromThicknessTextureGltf=!0})):Promise.resolve())},t}();n.b.RegisterExtension("KHR_materials_translucency",(function(t){return new T(t)}));var O=function(){function t(t){this.name="KHR_mesh_quantization",this.enabled=t.isExtensionUsed("KHR_mesh_quantization")}return t.prototype.dispose=function(){},t}();n.b.RegisterExtension("KHR_mesh_quantization",(function(t){return new O(t)}));var E=function(){function t(t){this.name="KHR_texture_basisu",this._loader=t,this.enabled=t.isExtensionUsed("KHR_texture_basisu")}return t.prototype.dispose=function(){this._loader=null},t.prototype._loadTextureAsync=function(t,e,i){var r=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(o,s){var a=null==e.sampler?n.b.DefaultSampler:n.a.Get(t+"/sampler",r._loader.gltf.samplers,e.sampler),l=n.a.Get(o+"/source",r._loader.gltf.images,s.source);return r._loader._createTextureAsync(t,a,l,(function(t){i(t)}),e._textureInfo.nonColorData?{useRGBAIfASTCBC7NotAvailableWhenUASTC:!0}:void 0)}))},t}();n.b.RegisterExtension("KHR_texture_basisu",(function(t){return new E(t)}));var A=function(){function t(t){this.name="KHR_texture_transform",this._loader=t,this.enabled=this._loader.isExtensionUsed("KHR_texture_transform")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadTextureInfoAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(n,s){return o._loader.loadTextureInfoAsync(t,e,(function(t){if(!(t instanceof r.Texture))throw new Error(n+": Texture type not supported");s.offset&&(t.uOffset=s.offset[0],t.vOffset=s.offset[1]),t.uRotationCenter=0,t.vRotationCenter=0,s.rotation&&(t.wAng=-s.rotation),s.scale&&(t.uScale=s.scale[0],t.vScale=s.scale[1]),null!=s.texCoord&&(t.coordinatesIndex=s.texCoord),i(t)}))}))},t}();n.b.RegisterExtension("KHR_texture_transform",(function(t){return new A(t)}));var C=function(){function t(t){this.name="MSFT_audio_emitter",this._loader=t,this.enabled=this._loader.isExtensionUsed("MSFT_audio_emitter")}return t.prototype.dispose=function(){this._loader=null,this._clips=null,this._emitters=null},t.prototype.onLoading=function(){var t=this._loader.gltf.extensions;if(t&&t[this.name]){var e=t[this.name];this._clips=e.clips,this._emitters=e.emitters,n.a.Assign(this._clips),n.a.Assign(this._emitters)}},t.prototype.loadSceneAsync=function(t,e){var i=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(r,o){var s=new Array;s.push(i._loader.loadSceneAsync(t,e));for(var a=0,l=o.emitters;a<l.length;a++){var h=l[a],c=n.a.Get(r+"/emitters",i._emitters,h);if(null!=c.refDistance||null!=c.maxDistance||null!=c.rolloffFactor||null!=c.distanceModel||null!=c.innerAngle||null!=c.outerAngle)throw new Error(r+": Direction or Distance properties are not allowed on emitters attached to a scene");s.push(i._loadEmitterAsync(r+"/emitters/"+c.index,c))}return Promise.all(s).then((function(){}))}))},t.prototype.loadNodeAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(t,s){var a=new Array;return o._loader.loadNodeAsync(t,e,(function(e){for(var l=function(i){var s=n.a.Get(t+"/emitters",o._emitters,i);a.push(o._loadEmitterAsync(t+"/emitters/"+s.index,s).then((function(){for(var t=0,i=s._babylonSounds;t<i.length;t++){var n=i[t];n.attachToMesh(e),null==s.innerAngle&&null==s.outerAngle||(n.setLocalDirectionToMesh(r.Vector3.Forward()),n.setDirectionalCone(2*r.Tools.ToDegrees(null==s.innerAngle?Math.PI:s.innerAngle),2*r.Tools.ToDegrees(null==s.outerAngle?Math.PI:s.outerAngle),0))}})))},h=0,c=s.emitters;h<c.length;h++)l(c[h]);i(e)})).then((function(t){return Promise.all(a).then((function(){return t}))}))}))},t.prototype.loadAnimationAsync=function(t,e){var i=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(r,o){return i._loader.loadAnimationAsync(t,e).then((function(s){var a=new Array;n.a.Assign(o.events);for(var l=0,h=o.events;l<h.length;l++){var c=h[l];a.push(i._loadAnimationEventAsync(r+"/events/"+c.index,t,e,c,s))}return Promise.all(a).then((function(){return s}))}))}))},t.prototype._loadClipAsync=function(t,e){if(e._objectURL)return e._objectURL;var i;if(e.uri)i=this._loader.loadUriAsync(t,e,e.uri);else{var r=n.a.Get(t+"/bufferView",this._loader.gltf.bufferViews,e.bufferView);i=this._loader.loadBufferViewAsync("/bufferViews/"+r.index,r)}return e._objectURL=i.then((function(t){return URL.createObjectURL(new Blob([t],{type:e.mimeType}))})),e._objectURL},t.prototype._loadEmitterAsync=function(t,e){var i=this;if(e._babylonSounds=e._babylonSounds||[],!e._babylonData){for(var o=new Array,s=e.name||"emitter"+e.index,a={loop:!1,autoplay:!1,volume:null==e.volume?1:e.volume},l=function(t){var l="/extensions/"+h.name+"/clips",c=n.a.Get(l,h._clips,e.clips[t].clip);o.push(h._loadClipAsync(l+"/"+e.clips[t].clip,c).then((function(n){var o=e._babylonSounds[t]=new r.Sound(s,n,i._loader.babylonScene,null,a);o.refDistance=e.refDistance||1,o.maxDistance=e.maxDistance||256,o.rolloffFactor=e.rolloffFactor||1,o.distanceModel=e.distanceModel||"exponential",o._positionInEmitterSpace=!0})))},h=this,c=0;c<e.clips.length;c++)l(c);var u=Promise.all(o).then((function(){var t=e.clips.map((function(t){return t.weight||1})),i=new r.WeightedSound(e.loop||!1,e._babylonSounds,t);e.innerAngle&&(i.directionalConeInnerAngle=2*r.Tools.ToDegrees(e.innerAngle)),e.outerAngle&&(i.directionalConeOuterAngle=2*r.Tools.ToDegrees(e.outerAngle)),e.volume&&(i.volume=e.volume),e._babylonData.sound=i}));e._babylonData={loaded:u}}return e._babylonData.loaded},t.prototype._getEventAction=function(t,e,i,r,n){switch(i){case"play":return function(t){var i=(n||0)+(t-r);e.play(i)};case"stop":return function(t){e.stop()};case"pause":return function(t){e.pause()};default:throw new Error(t+": Unsupported action "+i)}},t.prototype._loadAnimationEventAsync=function(t,e,i,o,s){var a=this;if(0==s.targetedAnimations.length)return Promise.resolve();var l=s.targetedAnimations[0],h=o.emitter,c=n.a.Get("/extensions/"+this.name+"/emitters",this._emitters,h);return this._loadEmitterAsync(t,c).then((function(){var e=c._babylonData.sound;if(e){var i=new r.AnimationEvent(o.time,a._getEventAction(t,e,o.action,o.time,o.startOffset));l.animation.addEvent(i),s.onAnimationGroupEndObservable.add((function(){e.stop()})),s.onAnimationGroupPauseObservable.add((function(){e.pause()}))}}))},t}();n.b.RegisterExtension("MSFT_audio_emitter",(function(t){return new C(t)}));var x=function(){function t(t){this.name="MSFT_lod",this.order=100,this.maxLODsToLoad=10,this.onNodeLODsLoadedObservable=new r.Observable,this.onMaterialLODsLoadedObservable=new r.Observable,this._bufferLODs=new Array,this._nodeIndexLOD=null,this._nodeSignalLODs=new Array,this._nodePromiseLODs=new Array,this._nodeBufferLODs=new Array,this._materialIndexLOD=null,this._materialSignalLODs=new Array,this._materialPromiseLODs=new Array,this._materialBufferLODs=new Array,this._loader=t,this.enabled=this._loader.isExtensionUsed("MSFT_lod")}return t.prototype.dispose=function(){this._loader=null,this._nodeIndexLOD=null,this._nodeSignalLODs.length=0,this._nodePromiseLODs.length=0,this._nodeBufferLODs.length=0,this._materialIndexLOD=null,this._materialSignalLODs.length=0,this._materialPromiseLODs.length=0,this._materialBufferLODs.length=0,this.onMaterialLODsLoadedObservable.clear(),this.onNodeLODsLoadedObservable.clear()},t.prototype.onReady=function(){for(var t=this,e=function(e){var r=Promise.all(i._nodePromiseLODs[e]).then((function(){0!==e&&(t._loader.endPerformanceCounter("Node LOD "+e),t._loader.log("Loaded node LOD "+e)),t.onNodeLODsLoadedObservable.notifyObservers(e),e!==t._nodePromiseLODs.length-1&&(t._loader.startPerformanceCounter("Node LOD "+(e+1)),t._loadBufferLOD(t._nodeBufferLODs,e+1),t._nodeSignalLODs[e]&&t._nodeSignalLODs[e].resolve())}));i._loader._completePromises.push(r)},i=this,r=0;r<this._nodePromiseLODs.length;r++)e(r);var n=function(e){var i=Promise.all(o._materialPromiseLODs[e]).then((function(){0!==e&&(t._loader.endPerformanceCounter("Material LOD "+e),t._loader.log("Loaded material LOD "+e)),t.onMaterialLODsLoadedObservable.notifyObservers(e),e!==t._materialPromiseLODs.length-1&&(t._loader.startPerformanceCounter("Material LOD "+(e+1)),t._loadBufferLOD(t._materialBufferLODs,e+1),t._materialSignalLODs[e]&&t._materialSignalLODs[e].resolve())}));o._loader._completePromises.push(i)},o=this;for(r=0;r<this._materialPromiseLODs.length;r++)n(r)},t.prototype.loadSceneAsync=function(t,e){var i=this._loader.loadSceneAsync(t,e);return this._loadBufferLOD(this._bufferLODs,0),i},t.prototype.loadNodeAsync=function(t,e,i){var o=this;return n.b.LoadExtensionAsync(t,e,this.name,(function(t,i){var n,s=o._getLODs(t,e,o._loader.gltf.nodes,i.ids);o._loader.logOpen(""+t);for(var a=function(t){var e=s[t];0!==t&&(o._nodeIndexLOD=t,o._nodeSignalLODs[t]=o._nodeSignalLODs[t]||new r.Deferred);var i=o._loader.loadNodeAsync("/nodes/"+e.index,e,(function(t){t.setEnabled(!1)})).then((function(e){if(0!==t){var i=s[t-1];i._babylonTransformNode&&(o._disposeTransformNode(i._babylonTransformNode),delete i._babylonTransformNode)}return e.setEnabled(!0),e}));o._nodePromiseLODs[t]=o._nodePromiseLODs[t]||[],0===t?n=i:(o._nodeIndexLOD=null,o._nodePromiseLODs[t].push(i))},l=0;l<s.length;l++)a(l);return o._loader.logClose(),n}))},t.prototype._loadMaterialAsync=function(t,e,i,r,o){var s=this;return this._nodeIndexLOD?null:n.b.LoadExtensionAsync(t,e,this.name,(function(t,n){var a,l=s._getLODs(t,e,s._loader.gltf.materials,n.ids);s._loader.logOpen(""+t);for(var h=function(t){var e=l[t];0!==t&&(s._materialIndexLOD=t);var n=s._loader._loadMaterialAsync("/materials/"+e.index,e,i,r,(function(e){0===t&&o(e)})).then((function(e){if(0!==t){o(e);var i=l[t-1]._data;i[r]&&(s._disposeMaterials([i[r].babylonMaterial]),delete i[r])}return e}));s._materialPromiseLODs[t]=s._materialPromiseLODs[t]||[],0===t?a=n:(s._materialIndexLOD=null,s._materialPromiseLODs[t].push(n))},c=0;c<l.length;c++)h(c);return s._loader.logClose(),a}))},t.prototype._loadUriAsync=function(t,e,i){var n=this;if(null!==this._nodeIndexLOD){this._loader.log("deferred");var o=this._nodeIndexLOD-1;return this._nodeSignalLODs[o]=this._nodeSignalLODs[o]||new r.Deferred,this._nodeSignalLODs[this._nodeIndexLOD-1].promise.then((function(){return n._loader.loadUriAsync(t,e,i)}))}return null!==this._materialIndexLOD?(this._loader.log("deferred"),o=this._materialIndexLOD-1,this._materialSignalLODs[o]=this._materialSignalLODs[o]||new r.Deferred,this._materialSignalLODs[o].promise.then((function(){return n._loader.loadUriAsync(t,e,i)}))):null},t.prototype.loadBufferAsync=function(t,e,i,n){if(this._loader.parent.useRangeRequests&&!e.uri){if(!this._loader.bin)throw new Error(t+": Uri is missing or the binary glTF is missing its binary chunk");var o=function(t,e){var o=i,s=o+n-1,a=t[e];return a?(a.start=Math.min(a.start,o),a.end=Math.max(a.end,s)):(a={start:o,end:s,loaded:new r.Deferred},t[e]=a),a.loaded.promise.then((function(t){return new Uint8Array(t.buffer,t.byteOffset+i-a.start,n)}))};return this._loader.log("deferred"),null!==this._nodeIndexLOD?o(this._nodeBufferLODs,this._nodeIndexLOD):null!==this._materialIndexLOD?o(this._materialBufferLODs,this._materialIndexLOD):o(this._bufferLODs,0)}return null},t.prototype._loadBufferLOD=function(t,e){var i=t[e];i&&(this._loader.log("Loading buffer range ["+i.start+"-"+i.end+"]"),this._loader.bin.readAsync(i.start,i.end-i.start+1).then((function(t){i.loaded.resolve(t)}),(function(t){i.loaded.reject(t)})))},t.prototype._getLODs=function(t,e,i,r){if(this.maxLODsToLoad<=0)throw new Error("maxLODsToLoad must be greater than zero");for(var o=new Array,s=r.length-1;s>=0;s--)if(o.push(n.a.Get(t+"/ids/"+r[s],i,r[s])),o.length===this.maxLODsToLoad)return o;return o.push(e),o},t.prototype._disposeTransformNode=function(t){var e=this,i=new Array,r=t.material;r&&i.push(r);for(var n=0,o=t.getChildMeshes();n<o.length;n++){var s=o[n];s.material&&i.push(s.material)}t.dispose();var a=i.filter((function(t){return e._loader.babylonScene.meshes.every((function(e){return e.material!=t}))}));this._disposeMaterials(a)},t.prototype._disposeMaterials=function(t){for(var e={},i=0,r=t;i<r.length;i++){for(var n=0,o=(c=r[i]).getActiveTextures();n<o.length;n++){var s=o[n];e[s.uniqueId]=s}c.dispose()}for(var a in e)for(var l=0,h=this._loader.babylonScene.materials;l<h.length;l++){var c;(c=h[l]).hasTexture(e[a])&&delete e[a]}for(var a in e)e[a].dispose()},t}();n.b.RegisterExtension("MSFT_lod",(function(t){return new x(t)}));var w=function(){function t(t){this.name="MSFT_minecraftMesh",this._loader=t,this.enabled=this._loader.isExtensionUsed("MSFT_minecraftMesh")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var o=this;return n.b.LoadExtraAsync(t,e,this.name,(function(n,s){if(s){if(!(i instanceof r.PBRMaterial))throw new Error(n+": Material type not supported");var a=o._loader.loadMaterialPropertiesAsync(t,e,i);return i.needAlphaBlending()&&(i.forceDepthWrite=!0,i.separateCullingPass=!0),i.backFaceCulling=i.forceDepthWrite,i.twoSidedLighting=!0,a}return null}))},t}();n.b.RegisterExtension("MSFT_minecraftMesh",(function(t){return new w(t)}));var M=function(){function t(t){this.name="MSFT_sRGBFactors",this._loader=t,this.enabled=this._loader.isExtensionUsed("MSFT_sRGBFactors")}return t.prototype.dispose=function(){this._loader=null},t.prototype.loadMaterialPropertiesAsync=function(t,e,i){var o=this;return n.b.LoadExtraAsync(t,e,this.name,(function(n,s){if(s){if(!(i instanceof r.PBRMaterial))throw new Error(n+": Material type not supported");var a=o._loader.loadMaterialPropertiesAsync(t,e,i);return i.albedoTexture||i.albedoColor.toLinearSpaceToRef(i.albedoColor),i.reflectivityTexture||i.reflectivityColor.toLinearSpaceToRef(i.reflectivityColor),a}return null}))},t}();n.b.RegisterExtension("MSFT_sRGBFactors",(function(t){return new M(t)}));var S=function(){function t(t){this.name="ExtrasAsMetadata",this.enabled=!0,this._loader=t}return t.prototype._assignExtras=function(t,e){if(e.extras&&Object.keys(e.extras).length>0){var i=t.metadata=t.metadata||{};(i.gltf=i.gltf||{}).extras=e.extras}},t.prototype.dispose=function(){this._loader=null},t.prototype.loadNodeAsync=function(t,e,i){var r=this;return this._loader.loadNodeAsync(t,e,(function(t){r._assignExtras(t,e),i(t)}))},t.prototype.loadCameraAsync=function(t,e,i){var r=this;return this._loader.loadCameraAsync(t,e,(function(t){r._assignExtras(t,e),i(t)}))},t.prototype.createMaterial=function(t,e,i){var r=this._loader.createMaterial(t,e,i);return this._assignExtras(r,e),r},t}();n.b.RegisterExtension("ExtrasAsMetadata",(function(t){return new S(t)}))},function(t,e,i){"use strict";i.r(e),i.d(e,"GLTFBinaryExtension",(function(){return H})),i.d(e,"GLTFLoaderBase",(function(){return F})),i.d(e,"GLTFLoader",(function(){return V})),i.d(e,"GLTFLoaderExtension",(function(){return j})),i.d(e,"EComponentType",(function(){return r})),i.d(e,"EShaderType",(function(){return n})),i.d(e,"EParameterType",(function(){return o})),i.d(e,"ETextureWrapMode",(function(){return s})),i.d(e,"ETextureFilterType",(function(){return a})),i.d(e,"ETextureFormat",(function(){return l})),i.d(e,"ECullingType",(function(){return h})),i.d(e,"EBlendingFunction",(function(){return c})),i.d(e,"GLTFUtils",(function(){return f})),i.d(e,"GLTFMaterialsCommonExtension",(function(){return U}));var r,n,o,s,a,l,h,c,u=i(4);!function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.FLOAT=5126]="FLOAT"}(r||(r={})),function(t){t[t.FRAGMENT=35632]="FRAGMENT",t[t.VERTEX=35633]="VERTEX"}(n||(n={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D"}(o||(o={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.REPEAT=10497]="REPEAT"}(s||(s={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9728]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(a||(a={})),function(t){t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA"}(l||(l={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(h||(h={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"}(c||(c={}));var d,p=i(0),f=function(){function t(){}return t.SetMatrix=function(t,e,i,r,n){var s=null;if("MODEL"===i.semantic?s=e.getWorldMatrix():"PROJECTION"===i.semantic?s=t.getProjectionMatrix():"VIEW"===i.semantic?s=t.getViewMatrix():"MODELVIEWINVERSETRANSPOSE"===i.semantic?s=p.Matrix.Transpose(e.getWorldMatrix().multiply(t.getViewMatrix()).invert()):"MODELVIEW"===i.semantic?s=e.getWorldMatrix().multiply(t.getViewMatrix()):"MODELVIEWPROJECTION"===i.semantic?s=e.getWorldMatrix().multiply(t.getTransformMatrix()):"MODELINVERSE"===i.semantic?s=e.getWorldMatrix().invert():"VIEWINVERSE"===i.semantic?s=t.getViewMatrix().invert():"PROJECTIONINVERSE"===i.semantic?s=t.getProjectionMatrix().invert():"MODELVIEWINVERSE"===i.semantic?s=e.getWorldMatrix().multiply(t.getViewMatrix()).invert():"MODELVIEWPROJECTIONINVERSE"===i.semantic?s=e.getWorldMatrix().multiply(t.getTransformMatrix()).invert():"MODELINVERSETRANSPOSE"===i.semantic&&(s=p.Matrix.Transpose(e.getWorldMatrix().invert())),s)switch(i.type){case o.FLOAT_MAT2:n.setMatrix2x2(r,p.Matrix.GetAsMatrix2x2(s));break;case o.FLOAT_MAT3:n.setMatrix3x3(r,p.Matrix.GetAsMatrix3x3(s));break;case o.FLOAT_MAT4:n.setMatrix(r,s)}},t.SetUniform=function(t,e,i,r){switch(r){case o.FLOAT:return t.setFloat(e,i),!0;case o.FLOAT_VEC2:return t.setVector2(e,p.Vector2.FromArray(i)),!0;case o.FLOAT_VEC3:return t.setVector3(e,p.Vector3.FromArray(i)),!0;case o.FLOAT_VEC4:return t.setVector4(e,p.Vector4.FromArray(i)),!0;default:return!1}},t.GetWrapMode=function(t){switch(t){case s.CLAMP_TO_EDGE:return p.Texture.CLAMP_ADDRESSMODE;case s.MIRRORED_REPEAT:return p.Texture.MIRROR_ADDRESSMODE;case s.REPEAT:default:return p.Texture.WRAP_ADDRESSMODE}},t.GetByteStrideFromType=function(t){switch(t.type){case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 1}},t.GetTextureFilterMode=function(t){switch(t){case a.LINEAR:case a.LINEAR_MIPMAP_NEAREST:case a.LINEAR_MIPMAP_LINEAR:return p.Texture.TRILINEAR_SAMPLINGMODE;case a.NEAREST:case a.NEAREST_MIPMAP_NEAREST:return p.Texture.NEAREST_SAMPLINGMODE;default:return p.Texture.BILINEAR_SAMPLINGMODE}},t.GetBufferFromBufferView=function(t,e,i,n,o){i=e.byteOffset+i;var s=t.loadedBufferViews[e.buffer];if(i+n>s.byteLength)throw new Error("Buffer access is out of range");var a=s.buffer;switch(i+=s.byteOffset,o){case r.BYTE:return new Int8Array(a,i,n);case r.UNSIGNED_BYTE:return new Uint8Array(a,i,n);case r.SHORT:return new Int16Array(a,i,n);case r.UNSIGNED_SHORT:return new Uint16Array(a,i,n);default:return new Float32Array(a,i,n)}},t.GetBufferFromAccessor=function(e,i){var r=e.bufferViews[i.bufferView],n=i.count*t.GetByteStrideFromType(i);return t.GetBufferFromBufferView(e,r,i.byteOffset,n,i.componentType)},t.DecodeBufferToText=function(t){for(var e="",i=t.byteLength,r=0;r<i;++r)e+=String.fromCharCode(t[r]);return e},t.GetDefaultMaterial=function(e){if(!t._DefaultMaterial){p.Effect.ShadersStore.GLTFDefaultMaterialVertexShader=["precision highp float;","","uniform mat4 worldView;","uniform mat4 projection;","","attribute vec3 position;","","void main(void)","{","    gl_Position = projection * worldView * vec4(position, 1.0);","}"].join("\n"),p.Effect.ShadersStore.GLTFDefaultMaterialPixelShader=["precision highp float;","","uniform vec4 u_emission;","","void main(void)","{","    gl_FragColor = u_emission;","}"].join("\n");var i={attributes:["position"],uniforms:["worldView","projection","u_emission"],samplers:new Array,needAlphaBlending:!1};t._DefaultMaterial=new p.ShaderMaterial("GLTFDefaultMaterial",e,{vertex:"GLTFDefaultMaterial",fragment:"GLTFDefaultMaterial"},i),t._DefaultMaterial.setColor4("u_emission",new p.Color4(.5,.5,.5,1))}return t._DefaultMaterial},t._DefaultMaterial=null,t}(),_=i(2);!function(t){t[t.IDENTIFIER=1]="IDENTIFIER",t[t.UNKNOWN=2]="UNKNOWN",t[t.END_OF_INPUT=3]="END_OF_INPUT"}(d||(d={}));var g=function(){function t(t){this._pos=0,this.currentToken=d.UNKNOWN,this.currentIdentifier="",this.currentString="",this.isLetterOrDigitPattern=/^[a-zA-Z0-9]+$/,this._toParse=t,this._maxPos=t.length}return t.prototype.getNextToken=function(){if(this.isEnd())return d.END_OF_INPUT;if(this.currentString=this.read(),this.currentToken=d.UNKNOWN,"_"===this.currentString||this.isLetterOrDigitPattern.test(this.currentString))for(this.currentToken=d.IDENTIFIER,this.currentIdentifier=this.currentString;!this.isEnd()&&(this.isLetterOrDigitPattern.test(this.currentString=this.peek())||"_"===this.currentString);)this.currentIdentifier+=this.currentString,this.forward();return this.currentToken},t.prototype.peek=function(){return this._toParse[this._pos]},t.prototype.read=function(){return this._toParse[this._pos++]},t.prototype.forward=function(){this._pos++},t.prototype.isEnd=function(){return this._pos>=this._maxPos},t}(),m=["MODEL","VIEW","PROJECTION","MODELVIEW","MODELVIEWPROJECTION","JOINTMATRIX"],b=["world","view","projection","worldView","worldViewProjection","mBones"],v=["translation","rotation","scale"],y=["position","rotationQuaternion","scaling"],T=function(t,e,i){for(var r in t){var n=t[r];i[e][r]=n}},O=function(t){if(t)for(var e=0;e<t.length/2;e++)t[2*e+1]=1-t[2*e+1]},E=function(t){if("NORMAL"===t.semantic)return"normal";if("POSITION"===t.semantic)return"position";if("JOINT"===t.semantic)return"matricesIndices";if("WEIGHT"===t.semantic)return"matricesWeights";if("COLOR"===t.semantic)return"color";if(t.semantic&&-1!==t.semantic.indexOf("TEXCOORD_")){var e=Number(t.semantic.split("_")[1]);return"uv"+(0===e?"":e+1)}return null},A=function(t){var e=null;if(t.translation||t.rotation||t.scale){var i=p.Vector3.FromArray(t.scale||[1,1,1]),r=p.Quaternion.FromArray(t.rotation||[0,0,0,1]),n=p.Vector3.FromArray(t.translation||[0,0,0]);e=p.Matrix.Compose(i,r,n)}else e=p.Matrix.FromArray(t.matrix);return e},C=function(t,e,i,r){for(var n=0;n<r.bones.length;n++)if(r.bones[n].name===i)return r.bones[n];var o=t.nodes;for(var s in o){var a=o[s];if(a.jointName){var l=a.children;for(n=0;n<l.length;n++){var h=t.nodes[l[n]];if(h.jointName&&h.jointName===i){var c=A(a),u=new p.Bone(a.name||"",r,C(t,e,a.jointName,r),c);return u.id=s,u}}}}return null},x=function(t,e){for(var i=0;i<t.length;i++)for(var r=t[i],n=0;n<r.node.children.length;n++)if(r.node.children[n]===e)return r.bone;return null},w=function(t,e){var i=t.nodes,r=i[e];if(r)return{node:r,id:e};for(var n in i)if((r=i[n]).jointName===e)return{node:r,id:n};return null},M=function(t,e){for(var i=0;i<t.jointNames.length;i++)if(t.jointNames[i]===e)return!0;return!1},S=function(t,e,i,r,n){if(r||(r=new p.Skeleton(e.name||"","",t.scene)),!e.babylonSkeleton)return r;var o=[],s=[];!function(t,e,i,r){for(var n in t.nodes){var o=t.nodes[n],s=n;if(o.jointName&&!M(i,o.jointName)){var a=A(o),l=new p.Bone(o.name||"",e,null,a);l.id=s,r.push({bone:l,node:o,id:s})}}for(var h=0;h<r.length;h++)for(var c=r[h],u=c.node.children,d=0;d<u.length;d++){for(var f=null,_=0;_<r.length;_++)if(r[_].id===u[d]){f=r[_];break}f&&(f.bone._parent=c.bone,c.bone.children.push(f.bone))}}(t,r,e,o),r.bones=[];for(var a=0;a<e.jointNames.length;a++)if(y=w(t,e.jointNames[a])){var l=y.node;if(l){n=y.id;var h=t.scene.getBoneByID(n);if(h)r.bones.push(h);else{for(var c=!1,u=null,d=0;d<a;d++){var f=w(t,e.jointNames[d]);if(f){var _=f.node;if(_){var g=_.children;if(g){c=!1;for(var m=0;m<g.length;m++)if(g[m]===n){u=C(t,e,e.jointNames[d],r),c=!0;break}if(c)break}}else p.Tools.Warn("Joint named "+e.jointNames[d]+" does not exist when looking for parent")}}var b=A(l);!u&&o.length>0&&(u=x(o,n))&&-1===s.indexOf(u)&&s.push(u),new p.Bone(l.jointName||"",r,u,b).id=n}}else p.Tools.Warn("Joint named "+e.jointNames[a]+" does not exist")}var v=r.bones;for(r.bones=[],a=0;a<e.jointNames.length;a++){var y;if(y=w(t,e.jointNames[a]))for(d=0;d<v.length;d++)if(v[d].id===y.id){r.bones.push(v[d]);break}}for(r.prepare(),a=0;a<s.length;a++)r.bones.push(s[a]);return r},I=function(t,e,i,r,n){if(n||(t.scene._blockEntityCollection=t.forAssetContainer,n=new p.Mesh(e.name||"",t.scene),t.scene._blockEntityCollection=!1,n.id=r),!e.babylonNode)return n;for(var o,s=[],a=null,l=new Array,h=new Array,c=new Array,u=new Array,d=0;d<i.length;d++){var g=i[d];if(R=t.meshes[g])for(var m=0;m<R.primitives.length;m++){var b=new p.VertexData,v=R.primitives[m];v.mode;var y=v.attributes,T=null,E=null;for(var A in y)if(T=t.accessors[y[A]],E=f.GetBufferFromAccessor(t,T),"NORMAL"===A)b.normals=new Float32Array(E.length),b.normals.set(E);else if("POSITION"===A){if(_.GLTFFileLoader.HomogeneousCoordinates){b.positions=new Float32Array(E.length-E.length/4);for(var C=0;C<E.length;C+=4)b.positions[C]=E[C],b.positions[C+1]=E[C+1],b.positions[C+2]=E[C+2]}else b.positions=new Float32Array(E.length),b.positions.set(E);h.push(b.positions.length)}else if(-1!==A.indexOf("TEXCOORD_")){var x=Number(A.split("_")[1]),w=p.VertexBuffer.UVKind+(0===x?"":x+1),M=new Float32Array(E.length);M.set(E),O(M),b.set(M,w)}else"JOINT"===A?(b.matricesIndices=new Float32Array(E.length),b.matricesIndices.set(E)):"WEIGHT"===A?(b.matricesWeights=new Float32Array(E.length),b.matricesWeights.set(E)):"COLOR"===A&&(b.colors=new Float32Array(E.length),b.colors.set(E));if(T=t.accessors[v.indices])E=f.GetBufferFromAccessor(t,T),b.indices=new Int32Array(E.length),b.indices.set(E),u.push(b.indices.length);else{var S=[];for(C=0;C<b.positions.length/3;C++)S.push(C);b.indices=new Int32Array(S),u.push(b.indices.length)}a?a.merge(b):a=b;var I=t.scene.getMaterialByID(v.material);s.push(null===I?f.GetDefaultMaterial(t.scene):I),l.push(0===l.length?0:l[l.length-1]+h[h.length-2]),c.push(0===c.length?0:c[c.length-1]+u[u.length-2])}}t.scene._blockEntityCollection=t.forAssetContainer,s.length>1?(o=new p.MultiMaterial("multimat"+r,t.scene)).subMaterials=s:o=new p.StandardMaterial("multimat"+r,t.scene),1===s.length&&(o=s[0]),n.material||(n.material=o),new p.Geometry(r,t.scene,a,!1,n),n.computeWorldMatrix(!0),t.scene._blockEntityCollection=!1,n.subMeshes=[];var P=0;for(d=0;d<i.length;d++){var R;if(g=i[d],R=t.meshes[g])for(m=0;m<R.primitives.length;m++)R.primitives[m].mode,p.SubMesh.AddToMesh(P,l[P],h[P],c[P],u[P],n,n,!0),P++}return n},P=function(t,e,i,r){t.position&&(t.position=e),(t.rotationQuaternion||t.rotation)&&(t.rotationQuaternion=i),t.scaling&&(t.scaling=r)},R=function(t,e,i,r){var n=null;if(t.importOnlyMeshes&&(e.skin||e.meshes)&&t.importMeshesNames&&t.importMeshesNames.length>0&&-1===t.importMeshesNames.indexOf(e.name||""))return null;if(e.skin){if(e.meshes){var o=t.skins[e.skin];(s=I(t,e,e.meshes,i,e.babylonNode)).skeleton=t.scene.getLastSkeletonByID(e.skin),null===s.skeleton&&(s.skeleton=S(t,o,0,o.babylonSkeleton,e.skin),o.babylonSkeleton||(o.babylonSkeleton=s.skeleton)),n=s}}else if(e.meshes){var s;n=s=I(t,e,e.mesh?[e.mesh]:e.meshes,i,e.babylonNode)}else if(!e.light||e.babylonNode||t.importOnlyMeshes){if(e.camera&&!e.babylonNode&&!t.importOnlyMeshes){var a=t.cameras[e.camera];if(a){if(t.scene._blockEntityCollection=t.forAssetContainer,"orthographic"===a.type){var l=new p.FreeCamera(e.camera,p.Vector3.Zero(),t.scene,!1);l.name=e.name||"",l.mode=p.Camera.ORTHOGRAPHIC_CAMERA,l.attachControl(),n=l}else if("perspective"===a.type){var h=a[a.type],c=new p.FreeCamera(e.camera,p.Vector3.Zero(),t.scene,!1);c.name=e.name||"",c.attachControl(),h.aspectRatio||(h.aspectRatio=t.scene.getEngine().getRenderWidth()/t.scene.getEngine().getRenderHeight()),h.znear&&h.zfar&&(c.maxZ=h.zfar,c.minZ=h.znear),n=c}t.scene._blockEntityCollection=!1}}}else{var u=t.lights[e.light];if(u)if("ambient"===u.type){var d=u[u.type],f=new p.HemisphericLight(e.light,p.Vector3.Zero(),t.scene);f.name=e.name||"",d.color&&(f.diffuse=p.Color3.FromArray(d.color)),n=f}else if("directional"===u.type){var _=u[u.type],g=new p.DirectionalLight(e.light,p.Vector3.Zero(),t.scene);g.name=e.name||"",_.color&&(g.diffuse=p.Color3.FromArray(_.color)),n=g}else if("point"===u.type){var m=u[u.type],b=new p.PointLight(e.light,p.Vector3.Zero(),t.scene);b.name=e.name||"",m.color&&(b.diffuse=p.Color3.FromArray(m.color)),n=b}else if("spot"===u.type){var v=u[u.type],y=new p.SpotLight(e.light,p.Vector3.Zero(),p.Vector3.Zero(),0,0,t.scene);y.name=e.name||"",v.color&&(y.diffuse=p.Color3.FromArray(v.color)),v.fallOfAngle&&(y.angle=v.fallOfAngle),v.fallOffExponent&&(y.exponent=v.fallOffExponent),n=y}}if(!e.jointName){if(e.babylonNode)return e.babylonNode;if(null===n){t.scene._blockEntityCollection=t.forAssetContainer;var T=new p.Mesh(e.name||"",t.scene);t.scene._blockEntityCollection=!1,e.babylonNode=T,n=T}}if(null!==n){if(e.matrix&&n instanceof p.Mesh)!function(t,e,i){if(e.matrix){var r=new p.Vector3(0,0,0),n=new p.Quaternion,o=new p.Vector3(0,0,0);p.Matrix.FromArray(e.matrix).decompose(o,n,r),P(t,r,n,o)}else e.translation&&e.rotation&&e.scale&&P(t,p.Vector3.FromArray(e.translation),p.Quaternion.FromArray(e.rotation),p.Vector3.FromArray(e.scale));t.computeWorldMatrix(!0)}(n,e);else{var O=e.translation||[0,0,0],E=e.rotation||[0,0,0,1],A=e.scale||[1,1,1];P(n,p.Vector3.FromArray(O),p.Quaternion.FromArray(E),p.Vector3.FromArray(A))}n.updateCache(!0),e.babylonNode=n}return n},L=function(t,e,i,r){void 0===r&&(r=!1);var n=t.nodes[e],o=null;if(r=!(t.importOnlyMeshes&&!r&&t.importMeshesNames)||-1!==t.importMeshesNames.indexOf(n.name||"")||0===t.importMeshesNames.length,!n.jointName&&r&&null!==(o=R(t,n,e))&&(o.id=e,o.parent=i),n.children)for(var s=0;s<n.children.length;s++)L(t,n.children[s],o,r)},N=function(t){var e=t.currentScene;if(e)for(var i=0;i<e.nodes.length;i++)L(t,e.nodes[i],null);else for(var r in t.scenes)for(e=t.scenes[r],i=0;i<e.nodes.length;i++)L(t,e.nodes[i],null);for(function(t){for(var e in t.animations){var i=t.animations[e];if(i.channels&&i.samplers)for(var r=null,n=0;n<i.channels.length;n++){var o=i.channels[n],s=i.samplers[o.sampler];if(s){var a=null,l=null;i.parameters?(a=i.parameters[s.input],l=i.parameters[s.output]):(a=s.input,l=s.output);var h=f.GetBufferFromAccessor(t,t.accessors[a]),c=f.GetBufferFromAccessor(t,t.accessors[l]),u=o.target.id,d=t.scene.getNodeByID(u);if(null===d&&(d=t.scene.getNodeByName(u)),null!==d){var _=d instanceof p.Bone,g=o.target.path,m=v.indexOf(g);-1!==m&&(g=y[m]);var b=p.Animation.ANIMATIONTYPE_MATRIX;_||("rotationQuaternion"===g?(b=p.Animation.ANIMATIONTYPE_QUATERNION,d.rotationQuaternion=new p.Quaternion):b=p.Animation.ANIMATIONTYPE_VECTOR3);var T=null,O=[],E=0,A=!1;_&&r&&r.getKeys().length===h.length&&(T=r,A=!0),A||(t.scene._blockEntityCollection=t.forAssetContainer,T=new p.Animation(e,_?"_matrix":g,1,b,p.Animation.ANIMATIONLOOPMODE_CYCLE),t.scene._blockEntityCollection=!1);for(var C=0;C<h.length;C++){var x=null;if("rotationQuaternion"===g?(x=p.Quaternion.FromArray([c[E],c[E+1],c[E+2],c[E+3]]),E+=4):(x=p.Vector3.FromArray([c[E],c[E+1],c[E+2]]),E+=3),_){var w=d,M=p.Vector3.Zero(),S=new p.Quaternion,I=p.Vector3.Zero(),P=w.getBaseMatrix();A&&r&&(P=r.getKeys()[C].value),P.decompose(I,S,M),"position"===g?M=x:"rotationQuaternion"===g?S=x:I=x,x=p.Matrix.Compose(I,S,M)}A?r&&(r.getKeys()[C].value=x):O.push({frame:h[C],value:x})}!A&&T&&(T.setKeys(O),d.animations.push(T)),r=T,t.scene.stopAnimation(d),t.scene.beginAnimation(d,0,h[h.length-1],!0,1)}else p.Tools.Warn("Creating animation named "+e+". But cannot find node named "+u+" to attach to")}}}}(t),i=0;i<t.scene.skeletons.length;i++){var n=t.scene.skeletons[i];t.scene.beginAnimation(n,0,Number.MAX_VALUE,!0,1)}},k=function(t,e,i,r,n,s){return function(a){!function(t,e,i,r,n){var s=r.values||i.parameters,a=i.uniforms;for(var l in n){var h=n[l],c=h.type,u=s[a[l]];if(void 0===u&&(u=h.value),u){var d=function(t){return function(i){h.value&&t&&(e.setTexture(t,i),delete n[t])}};c===o.SAMPLER_2D?j.LoadTextureAsync(t,r.values?u:h.value,d(l),(function(){return d(null)})):h.value&&f.SetUniform(e,l,r.values?u:h.value,c)&&delete n[l]}}}(t,e,i,r,n),e.onBind=function(a){!function(t,e,i,r,n,s,a){var l=s.values||n.parameters;for(var h in i){var c=i[h],u=c.type;if(u===o.FLOAT_MAT2||u===o.FLOAT_MAT3||u===o.FLOAT_MAT4)if(!c.semantic||c.source||c.node){if(c.semantic&&(c.source||c.node)){var d=e.scene.getNodeByName(c.source||c.node||"");if(null===d&&(d=e.scene.getNodeByID(c.source||c.node||"")),null===d)continue;f.SetMatrix(e.scene,d,c,h,r.getEffect())}}else f.SetMatrix(e.scene,t,c,h,r.getEffect());else{var p=l[n.uniforms[h]];if(!p)continue;if(u===o.SAMPLER_2D){var _=e.textures[s.values?p:c.value].babylonTexture;if(null==_)continue;r.getEffect().setTexture(h,_)}else f.SetUniform(r.getEffect(),h,p,u)}}a(r)}(a,t,n,e,i,r,s)}}},D=function(t,e,i){for(var r in e.uniforms){var n=e.uniforms[r],o=e.parameters[n];if(t.currentIdentifier===r&&o.semantic&&!o.source&&!o.node){var s=m.indexOf(o.semantic);if(-1!==s)return delete i[r],b[s]}}return t.currentIdentifier},B=function(t){for(var e in t.materials)j.LoadMaterialAsync(t,e,(function(t){}),(function(){}))},F=function(){function t(){}return t.CreateRuntime=function(t,e,i){var r={extensions:{},accessors:{},buffers:{},bufferViews:{},meshes:{},lights:{},cameras:{},nodes:{},images:{},textures:{},shaders:{},programs:{},samplers:{},techniques:{},materials:{},animations:{},skins:{},extensionsUsed:[],scenes:{},buffersCount:0,shaderscount:0,scene:e,rootUrl:i,loadedBufferCount:0,loadedBufferViews:{},loadedShaderCount:0,importOnlyMeshes:!1,dummyNodes:[],forAssetContainer:!1};return t.extensions&&T(t.extensions,"extensions",r),t.extensionsUsed&&T(t.extensionsUsed,"extensionsUsed",r),t.buffers&&function(t,e){for(var i in t){var r=t[i];e.buffers[i]=r,e.buffersCount++}}(t.buffers,r),t.bufferViews&&T(t.bufferViews,"bufferViews",r),t.accessors&&T(t.accessors,"accessors",r),t.meshes&&T(t.meshes,"meshes",r),t.lights&&T(t.lights,"lights",r),t.cameras&&T(t.cameras,"cameras",r),t.nodes&&T(t.nodes,"nodes",r),t.images&&T(t.images,"images",r),t.textures&&T(t.textures,"textures",r),t.shaders&&function(t,e){for(var i in t){var r=t[i];e.shaders[i]=r,e.shaderscount++}}(t.shaders,r),t.programs&&T(t.programs,"programs",r),t.samplers&&T(t.samplers,"samplers",r),t.techniques&&T(t.techniques,"techniques",r),t.materials&&T(t.materials,"materials",r),t.animations&&T(t.animations,"animations",r),t.skins&&T(t.skins,"skins",r),t.scenes&&(r.scenes=t.scenes),t.scene&&t.scenes&&(r.currentScene=t.scenes[t.scene]),r},t.LoadBufferAsync=function(t,e,i,r,n){var o=t.buffers[e];p.Tools.IsBase64(o.uri)?setTimeout((function(){return i(new Uint8Array(p.Tools.DecodeBase64(o.uri)))})):p.Tools.LoadFile(t.rootUrl+o.uri,(function(t){return i(new Uint8Array(t))}),n,void 0,!0,(function(t){t&&r(t.status+" "+t.statusText)}))},t.LoadTextureBufferAsync=function(t,e,i,r){var n=t.textures[e];if(n&&n.source)if(n.babylonTexture)i(null);else{var o=t.images[n.source];p.Tools.IsBase64(o.uri)?setTimeout((function(){return i(new Uint8Array(p.Tools.DecodeBase64(o.uri)))})):p.Tools.LoadFile(t.rootUrl+o.uri,(function(t){return i(new Uint8Array(t))}),void 0,void 0,!0,(function(t){t&&r(t.status+" "+t.statusText)}))}else r("")},t.CreateTextureAsync=function(t,e,i,r,n){var o=t.textures[e];if(o.babylonTexture)r(o.babylonTexture);else{var s=t.samplers[o.sampler],l=s.minFilter===a.NEAREST_MIPMAP_NEAREST||s.minFilter===a.NEAREST_MIPMAP_LINEAR||s.minFilter===a.LINEAR_MIPMAP_NEAREST||s.minFilter===a.LINEAR_MIPMAP_LINEAR,h=p.Texture.BILINEAR_SAMPLINGMODE,c=null==i?new Blob:new Blob([i]),u=URL.createObjectURL(c),d=function(){return URL.revokeObjectURL(u)},_=new p.Texture(u,t.scene,!l,!0,h,d,d);void 0!==s.wrapS&&(_.wrapU=f.GetWrapMode(s.wrapS)),void 0!==s.wrapT&&(_.wrapV=f.GetWrapMode(s.wrapT)),_.name=e,o.babylonTexture=_,r(_)}},t.LoadShaderStringAsync=function(t,e,i,r){var n=t.shaders[e];if(p.Tools.IsBase64(n.uri)){var o=atob(n.uri.split(",")[1]);i&&i(o)}else p.Tools.LoadFile(t.rootUrl+n.uri,i,void 0,void 0,!1,(function(t){t&&r&&r(t.status+" "+t.statusText)}))},t.LoadMaterialAsync=function(t,e,i,r){var n=t.materials[e];if(n.technique){var s=t.techniques[n.technique];if(!s){t.scene._blockEntityCollection=t.forAssetContainer;var a=new p.StandardMaterial(e,t.scene);return t.scene._blockEntityCollection=!1,a.diffuseColor=new p.Color3(.5,.5,.5),a.sideOrientation=p.Material.CounterClockWiseSideOrientation,void i(a)}var l=t.programs[s.program],u=s.states,f=p.Effect.ShadersStore[l.vertexShader+"VertexShader"],_=p.Effect.ShadersStore[l.fragmentShader+"PixelShader"],v="",y="",T=new g(f),O=new g(_),A={},C=[],x=[],w=[];for(var M in s.uniforms){var S=s.uniforms[M],I=s.parameters[S];if(A[M]=I,!I.semantic||I.node||I.source)I.type===o.SAMPLER_2D?w.push(M):C.push(M);else{var P=m.indexOf(I.semantic);-1!==P?(C.push(b[P]),delete A[M]):C.push(M)}}for(var R in s.attributes){var L=s.attributes[R];if((F=s.parameters[L]).semantic){var N=E(F);N&&x.push(N)}}for(;!T.isEnd()&&T.getNextToken();)if(T.currentToken===d.IDENTIFIER){var B=!1;for(var R in s.attributes){L=s.attributes[R];var F=s.parameters[L];if(T.currentIdentifier===R&&F.semantic){v+=E(F),B=!0;break}}B||(v+=D(T,s,A))}else v+=T.currentString;for(;!O.isEnd()&&O.getNextToken();)O.currentToken===d.IDENTIFIER?y+=D(O,s,A):y+=O.currentString;var V={vertex:l.vertexShader+e,fragment:l.fragmentShader+e},j={attributes:x,uniforms:C,samplers:w,needAlphaBlending:u&&u.enable&&-1!==u.enable.indexOf(3042)};p.Effect.ShadersStore[l.vertexShader+e+"VertexShader"]=v,p.Effect.ShadersStore[l.fragmentShader+e+"PixelShader"]=y;var H=new p.ShaderMaterial(e,t.scene,V,j);if(H.onError=function(t,e,i){return function(r,n){e.dispose(!0),i("Cannot compile program named "+t.name+". Error: "+n+". Default material will be applied")}}(l,H,r),H.onCompiled=k(t,H,s,n,A,i),H.sideOrientation=p.Material.CounterClockWiseSideOrientation,u&&u.functions){var U=u.functions;U.cullFace&&U.cullFace[0]!==h.BACK&&(H.backFaceCulling=!1);var G=U.blendFuncSeparate;G&&(G[0]===c.SRC_ALPHA&&G[1]===c.ONE_MINUS_SRC_ALPHA&&G[2]===c.ONE&&G[3]===c.ONE?H.alphaMode=p.Constants.ALPHA_COMBINE:G[0]===c.ONE&&G[1]===c.ONE&&G[2]===c.ZERO&&G[3]===c.ONE?H.alphaMode=p.Constants.ALPHA_ONEONE:G[0]===c.SRC_ALPHA&&G[1]===c.ONE&&G[2]===c.ZERO&&G[3]===c.ONE?H.alphaMode=p.Constants.ALPHA_ADD:G[0]===c.ZERO&&G[1]===c.ONE_MINUS_SRC_COLOR&&G[2]===c.ONE&&G[3]===c.ONE?H.alphaMode=p.Constants.ALPHA_SUBTRACT:G[0]===c.DST_COLOR&&G[1]===c.ZERO&&G[2]===c.ONE&&G[3]===c.ONE?H.alphaMode=p.Constants.ALPHA_MULTIPLY:G[0]===c.SRC_ALPHA&&G[1]===c.ONE_MINUS_SRC_COLOR&&G[2]===c.ONE&&G[3]===c.ONE&&(H.alphaMode=p.Constants.ALPHA_MAXIMIZED))}}else r&&r("No technique found.")},t}(),V=function(){function t(){this.state=null}return t.RegisterExtension=function(e){t.Extensions[e.name]?p.Tools.Error('Tool with the same name "'+e.name+'" already exists'):t.Extensions[e.name]=e},t.prototype.dispose=function(){},t.prototype._importMeshAsync=function(t,e,i,r,n,o,s,a){var l=this;return e.useRightHandedSystem=!0,j.LoadRuntimeAsync(e,i,r,(function(e){e.forAssetContainer=n,e.importOnlyMeshes=!0,""===t?e.importMeshesNames=[]:"string"==typeof t?e.importMeshesNames=[t]:!t||t instanceof Array?(e.importMeshesNames=[],p.Tools.Warn("Argument meshesNames must be of type string or string[]")):e.importMeshesNames=[t],l._createNodes(e);var i=new Array,r=new Array;for(var a in e.nodes){var h=e.nodes[a];h.babylonNode instanceof p.AbstractMesh&&i.push(h.babylonNode)}for(var c in e.skins){var u=e.skins[c];u.babylonSkeleton instanceof p.Skeleton&&r.push(u.babylonSkeleton)}l._loadBuffersAsync(e,(function(){l._loadShadersAsync(e,(function(){B(e),N(e),!_.GLTFFileLoader.IncrementalLoading&&o&&o(i,r)}))}),s),_.GLTFFileLoader.IncrementalLoading&&o&&o(i,r)}),a),!0},t.prototype.importMeshAsync=function(t,e,i,r,n,o){var s=this;return new Promise((function(a,l){s._importMeshAsync(t,e,r,n,i,(function(t,e){a({meshes:t,particleSystems:[],skeletons:e,animationGroups:[],lights:[],transformNodes:[],geometries:[]})}),o,(function(t){l(new Error(t))}))}))},t.prototype._loadAsync=function(t,e,i,r,n,o,s){var a=this;t.useRightHandedSystem=!0,j.LoadRuntimeAsync(t,e,i,(function(t){j.LoadRuntimeExtensionsAsync(t,(function(){a._createNodes(t),a._loadBuffersAsync(t,(function(){a._loadShadersAsync(t,(function(){B(t),N(t),_.GLTFFileLoader.IncrementalLoading||n()}))})),_.GLTFFileLoader.IncrementalLoading&&n()}),s)}),s)},t.prototype.loadAsync=function(t,e,i,r){var n=this;return new Promise((function(o,s){n._loadAsync(t,e,i,!1,(function(){o()}),r,(function(t){s(new Error(t))}))}))},t.prototype._loadShadersAsync=function(t,e){var i=!1,r=function(i,r){j.LoadShaderStringAsync(t,i,(function(o){o instanceof ArrayBuffer||(t.loadedShaderCount++,o&&(p.Effect.ShadersStore[i+(r.type===n.VERTEX?"VertexShader":"PixelShader")]=o),t.loadedShaderCount===t.shaderscount&&e())}),(function(){p.Tools.Error("Error when loading shader program named "+i+" located at "+r.uri)}))};for(var o in t.shaders){i=!0;var s=t.shaders[o];s?r.bind(this,o,s)():p.Tools.Error("No shader named: "+o)}i||e()},t.prototype._loadBuffersAsync=function(t,e,i){var r=!1,n=function(i,r){j.LoadBufferAsync(t,i,(function(n){t.loadedBufferCount++,n&&(n.byteLength!=t.buffers[i].byteLength&&p.Tools.Error("Buffer named "+i+" is length "+n.byteLength+". Expected: "+r.byteLength),t.loadedBufferViews[i]=n),t.loadedBufferCount===t.buffersCount&&e()}),(function(){p.Tools.Error("Error when loading buffer named "+i+" located at "+r.uri)}))};for(var o in t.buffers){r=!0;var s=t.buffers[o];s?n.bind(this,o,s)():p.Tools.Error("No buffer named: "+o)}r||e()},t.prototype._createNodes=function(t){var e=t.currentScene;if(e)for(var i=0;i<e.nodes.length;i++)L(t,e.nodes[i],null);else for(var r in t.scenes)for(e=t.scenes[r],i=0;i<e.nodes.length;i++)L(t,e.nodes[i],null)},t.Extensions={},t}(),j=function(){function t(t){this._name=t}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t.prototype.loadRuntimeAsync=function(t,e,i,r,n){return!1},t.prototype.loadRuntimeExtensionsAsync=function(t,e,i){return!1},t.prototype.loadBufferAsync=function(t,e,i,r,n){return!1},t.prototype.loadTextureBufferAsync=function(t,e,i,r){return!1},t.prototype.createTextureAsync=function(t,e,i,r,n){return!1},t.prototype.loadShaderStringAsync=function(t,e,i,r){return!1},t.prototype.loadMaterialAsync=function(t,e,i,r){return!1},t.LoadRuntimeAsync=function(e,i,r,n,o){t.ApplyExtensions((function(t){return t.loadRuntimeAsync(e,i,r,n,o)}),(function(){setTimeout((function(){n&&n(F.CreateRuntime(i.json,e,r))}))}))},t.LoadRuntimeExtensionsAsync=function(e,i,r){t.ApplyExtensions((function(t){return t.loadRuntimeExtensionsAsync(e,i,r)}),(function(){setTimeout((function(){i()}))}))},t.LoadBufferAsync=function(e,i,r,n,o){t.ApplyExtensions((function(t){return t.loadBufferAsync(e,i,r,n,o)}),(function(){F.LoadBufferAsync(e,i,r,n,o)}))},t.LoadTextureAsync=function(e,i,r,n){t.LoadTextureBufferAsync(e,i,(function(o){o&&t.CreateTextureAsync(e,i,o,r,n)}),n)},t.LoadShaderStringAsync=function(e,i,r,n){t.ApplyExtensions((function(t){return t.loadShaderStringAsync(e,i,r,n)}),(function(){F.LoadShaderStringAsync(e,i,r,n)}))},t.LoadMaterialAsync=function(e,i,r,n){t.ApplyExtensions((function(t){return t.loadMaterialAsync(e,i,r,n)}),(function(){F.LoadMaterialAsync(e,i,r,n)}))},t.LoadTextureBufferAsync=function(e,i,r,n){t.ApplyExtensions((function(t){return t.loadTextureBufferAsync(e,i,r,n)}),(function(){F.LoadTextureBufferAsync(e,i,r,n)}))},t.CreateTextureAsync=function(e,i,r,n,o){t.ApplyExtensions((function(t){return t.createTextureAsync(e,i,r,n,o)}),(function(){F.CreateTextureAsync(e,i,r,n,o)}))},t.ApplyExtensions=function(t,e){for(var i in V.Extensions)if(t(V.Extensions[i]))return;e()},t}();_.GLTFFileLoader._CreateGLTF1Loader=function(){return new V};var H=function(t){function e(){return t.call(this,"KHR_binary_glTF")||this}return Object(u.b)(e,t),e.prototype.loadRuntimeAsync=function(t,e,i,r,n){var o=e.json.extensionsUsed;return!(!o||-1===o.indexOf(this.name)||!e.bin)&&(this._bin=e.bin,r(F.CreateRuntime(e.json,t,i)),!0)},e.prototype.loadBufferAsync=function(t,e,i,r){return-1!==t.extensionsUsed.indexOf(this.name)&&"binary_glTF"===e&&(this._bin.readAsync(0,this._bin.byteLength).then(i,(function(t){return r(t.message)})),!0)},e.prototype.loadTextureBufferAsync=function(t,e,i,n){var o=t.textures[e],s=t.images[o.source];if(!s.extensions||!(this.name in s.extensions))return!1;var a=s.extensions[this.name],l=t.bufferViews[a.bufferView];return i(f.GetBufferFromBufferView(t,l,0,l.byteLength,r.UNSIGNED_BYTE)),!0},e.prototype.loadShaderStringAsync=function(t,e,i,n){var o=t.shaders[e];if(!o.extensions||!(this.name in o.extensions))return!1;var s=o.extensions[this.name],a=t.bufferViews[s.bufferView],l=f.GetBufferFromBufferView(t,a,0,a.byteLength,r.UNSIGNED_BYTE);return setTimeout((function(){var t=f.DecodeBufferToText(l);i(t)})),!0},e}(j);V.RegisterExtension(new H);var U=function(t){function e(){return t.call(this,"KHR_materials_common")||this}return Object(u.b)(e,t),e.prototype.loadRuntimeExtensionsAsync=function(t,e,i){if(!t.extensions)return!1;var r=t.extensions[this.name];if(!r)return!1;var n=r.lights;if(n)for(var o in n){var s=n[o];switch(s.type){case"ambient":var a=new p.HemisphericLight(s.name,new p.Vector3(0,1,0),t.scene),l=s.ambient;l&&(a.diffuse=p.Color3.FromArray(l.color||[1,1,1]));break;case"point":var h=new p.PointLight(s.name,new p.Vector3(10,10,10),t.scene),c=s.point;c&&(h.diffuse=p.Color3.FromArray(c.color||[1,1,1]));break;case"directional":var u=new p.DirectionalLight(s.name,new p.Vector3(0,-1,0),t.scene),d=s.directional;d&&(u.diffuse=p.Color3.FromArray(d.color||[1,1,1]));break;case"spot":var f=s.spot;f&&(new p.SpotLight(s.name,new p.Vector3(0,10,0),new p.Vector3(0,-1,0),f.fallOffAngle||Math.PI,f.fallOffExponent||0,t.scene).diffuse=p.Color3.FromArray(f.color||[1,1,1]));break;default:p.Tools.Warn('GLTF Material Common extension: light type "'+s.type+"” not supported")}}return!1},e.prototype.loadMaterialAsync=function(t,e,i,r){var n=t.materials[e];if(!n||!n.extensions)return!1;var o=n.extensions[this.name];if(!o)return!1;var s=new p.StandardMaterial(e,t.scene);return s.sideOrientation=p.Material.CounterClockWiseSideOrientation,"CONSTANT"===o.technique&&(s.disableLighting=!0),s.backFaceCulling=void 0!==o.doubleSided&&!o.doubleSided,s.alpha=void 0===o.values.transparency?1:o.values.transparency,s.specularPower=void 0===o.values.shininess?0:o.values.shininess,"string"==typeof o.values.ambient?this._loadTexture(t,o.values.ambient,s,"ambientTexture",r):s.ambientColor=p.Color3.FromArray(o.values.ambient||[0,0,0]),"string"==typeof o.values.diffuse?this._loadTexture(t,o.values.diffuse,s,"diffuseTexture",r):s.diffuseColor=p.Color3.FromArray(o.values.diffuse||[0,0,0]),"string"==typeof o.values.emission?this._loadTexture(t,o.values.emission,s,"emissiveTexture",r):s.emissiveColor=p.Color3.FromArray(o.values.emission||[0,0,0]),"string"==typeof o.values.specular?this._loadTexture(t,o.values.specular,s,"specularTexture",r):s.specularColor=p.Color3.FromArray(o.values.specular||[0,0,0]),!0},e.prototype._loadTexture=function(t,e,i,r,n){F.LoadTextureBufferAsync(t,e,(function(o){F.CreateTextureAsync(t,e,o,(function(t){return i[r]=t}),n)}),n)},e}(j);V.RegisterExtension(new U)},function(t,e,i){"use strict";i.r(e),i.d(e,"ArrayItem",(function(){return r.a})),i.d(e,"GLTFLoader",(function(){return r.b})),i.d(e,"EXT_lights_image_based",(function(){return n.EXT_lights_image_based})),i.d(e,"EXT_mesh_gpu_instancing",(function(){return n.EXT_mesh_gpu_instancing})),i.d(e,"EXT_texture_webp",(function(){return n.EXT_texture_webp})),i.d(e,"KHR_draco_mesh_compression",(function(){return n.KHR_draco_mesh_compression})),i.d(e,"KHR_lights",(function(){return n.KHR_lights})),i.d(e,"KHR_materials_pbrSpecularGlossiness",(function(){return n.KHR_materials_pbrSpecularGlossiness})),i.d(e,"KHR_materials_unlit",(function(){return n.KHR_materials_unlit})),i.d(e,"KHR_materials_clearcoat",(function(){return n.KHR_materials_clearcoat})),i.d(e,"KHR_materials_sheen",(function(){return n.KHR_materials_sheen})),i.d(e,"KHR_materials_specular",(function(){return n.KHR_materials_specular})),i.d(e,"KHR_materials_ior",(function(){return n.KHR_materials_ior})),i.d(e,"KHR_materials_variants",(function(){return n.KHR_materials_variants})),i.d(e,"KHR_materials_transmission",(function(){return n.KHR_materials_transmission})),i.d(e,"KHR_materials_translucency",(function(){return n.KHR_materials_translucency})),i.d(e,"KHR_mesh_quantization",(function(){return n.KHR_mesh_quantization})),i.d(e,"KHR_texture_basisu",(function(){return n.KHR_texture_basisu})),i.d(e,"KHR_texture_transform",(function(){return n.KHR_texture_transform})),i.d(e,"MSFT_audio_emitter",(function(){return n.MSFT_audio_emitter})),i.d(e,"MSFT_lod",(function(){return n.MSFT_lod})),i.d(e,"MSFT_minecraftMesh",(function(){return n.MSFT_minecraftMesh})),i.d(e,"MSFT_sRGBFactors",(function(){return n.MSFT_sRGBFactors})),i.d(e,"ExtrasAsMetadata",(function(){return n.ExtrasAsMetadata}));var r=i(1),n=(i(6),i(7))},function(t,e,i){"use strict";i.r(e),i.d(e,"MTLFileLoader",(function(){return n})),i.d(e,"OBJFileLoader",(function(){return o}));var r=i(0),n=function(){function t(){this.materials=[]}return t.prototype.parseMTL=function(e,i,n,o){if(!(i instanceof ArrayBuffer)){for(var s,a=i.split("\n"),l=/\s+/,h=null,c=0;c<a.length;c++){var u=a[c].trim();if(0!==u.length&&"#"!==u.charAt(0)){var d=u.indexOf(" "),p=d>=0?u.substring(0,d):u;p=p.toLowerCase();var f=d>=0?u.substring(d+1).trim():"";"newmtl"===p?(h&&this.materials.push(h),e._blockEntityCollection=o,h=new r.StandardMaterial(f,e),e._blockEntityCollection=!1):"kd"===p&&h?(s=f.split(l,3).map(parseFloat),h.diffuseColor=r.Color3.FromArray(s)):"ka"===p&&h?(s=f.split(l,3).map(parseFloat),h.ambientColor=r.Color3.FromArray(s)):"ks"===p&&h?(s=f.split(l,3).map(parseFloat),h.specularColor=r.Color3.FromArray(s)):"ke"===p&&h?(s=f.split(l,3).map(parseFloat),h.emissiveColor=r.Color3.FromArray(s)):"ns"===p&&h?h.specularPower=parseFloat(f):"d"===p&&h?h.alpha=parseFloat(f):"map_ka"===p&&h?h.ambientTexture=t._getTexture(n,f,e):"map_kd"===p&&h?h.diffuseTexture=t._getTexture(n,f,e):"map_ks"===p&&h?h.specularTexture=t._getTexture(n,f,e):"map_ns"===p||("map_bump"===p&&h?h.bumpTexture=t._getTexture(n,f,e):"map_d"===p&&h&&(h.opacityTexture=t._getTexture(n,f,e)))}}h&&this.materials.push(h)}},t._getTexture=function(e,i,n){if(!i)return null;var o=e;if("file:"===e){var s=i.lastIndexOf("\\");-1===s&&(s=i.lastIndexOf("/")),o+=s>-1?i.substr(s+1):i}else o+=i;return new r.Texture(o,n,!1,t.INVERT_TEXTURE_Y)},t.INVERT_TEXTURE_Y=!0,t}(),o=function(){function t(e){this.name="obj",this.extensions=".obj",this.obj=/^o/,this.group=/^g/,this.mtllib=/^mtllib /,this.usemtl=/^usemtl /,this.smooth=/^s /,this.vertexPattern=/v(\s+[\d|\.|\+|\-|e|E]+){3,7}/,this.normalPattern=/vn(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,this.uvPattern=/vt(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,this.facePattern1=/f\s+(([\d]{1,}[\s]?){3,})+/,this.facePattern2=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,this.facePattern3=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,this.facePattern4=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,this.facePattern5=/f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/,this._forAssetContainer=!1,this._meshLoadOptions=e||t.currentMeshLoadOptions}return Object.defineProperty(t,"INVERT_TEXTURE_Y",{get:function(){return n.INVERT_TEXTURE_Y},set:function(t){n.INVERT_TEXTURE_Y=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"currentMeshLoadOptions",{get:function(){return{ComputeNormals:t.COMPUTE_NORMALS,ImportVertexColors:t.IMPORT_VERTEX_COLORS,InvertY:t.INVERT_Y,InvertTextureY:t.INVERT_TEXTURE_Y,UVScaling:t.UV_SCALING,MaterialLoadingFailsSilently:t.MATERIAL_LOADING_FAILS_SILENTLY,OptimizeWithUV:t.OPTIMIZE_WITH_UV,SkipMaterials:t.SKIP_MATERIALS}},enumerable:!1,configurable:!0}),t.prototype._loadMTL=function(t,e,i,n){var o=r.Tools.BaseUrl+e+t;r.Tools.LoadFile(o,i,void 0,void 0,!1,(function(t,e){n(o,e)}))},t.prototype.createPlugin=function(){return new t(t.currentMeshLoadOptions)},t.prototype.canDirectLoad=function(t){return!1},t.prototype.importMeshAsync=function(t,e,i,r,n,o){return this._parseSolid(t,e,i,r).then((function(t){return{meshes:t,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}}))},t.prototype.loadAsync=function(t,e,i,r,n){return this.importMeshAsync(null,t,e,i,r).then((function(){}))},t.prototype.loadAssetContainerAsync=function(t,e,i,n,o){var s=this;return this._forAssetContainer=!0,this.importMeshAsync(null,t,e,i).then((function(e){var i=new r.AssetContainer(t);return e.meshes.forEach((function(t){return i.meshes.push(t)})),e.meshes.forEach((function(t){var e=t.material;e&&-1==i.materials.indexOf(e)&&(i.materials.push(e),e.getActiveTextures().forEach((function(t){-1==i.textures.indexOf(t)&&i.textures.push(t)})))})),s._forAssetContainer=!1,i})).catch((function(t){throw s._forAssetContainer=!1,t}))},t.prototype._parseSolid=function(e,i,o,s){for(var a,l=this,h=[],c=[],u=[],d=[],p=[],f=[],_=[],g=[],m=[],b=[],v=[],y=0,T=!1,O=[],E=[],A=[],C=[],x=[],w="",M="",S=new n,I=1,P=!0,R=new r.Color4(.5,.5,.5,1),L=function(t,e,i,r,n,o,s){var a;-1===(a=l._meshLoadOptions.OptimizeWithUV?function(t,e){t[e[0]]||(t[e[0]]={normals:[],idx:[],uv:[]});var i=t[e[0]].normals.indexOf(e[1]);return 1!=i&&e[2]===t[e[0]].uv[i]?t[e[0]].idx[i]:-1}(v,[t,i,e]):function(t,e){t[e[0]]||(t[e[0]]={normals:[],idx:[]});var i=t[e[0]].normals.indexOf(e[1]);return-1===i?-1:t[e[0]].idx[i]}(v,[t,i]))?(f.push(_.length),_.push(r),g.push(n),b.push(o),void 0!==s&&m.push(s),v[t].normals.push(i),v[t].idx.push(y++),l._meshLoadOptions.OptimizeWithUV&&v[t].uv.push(e)):f.push(a)},N=function(){for(var t=0;t<_.length;t++)O.push(_[t].x,_[t].y,_[t].z),A.push(b[t].x,b[t].y,b[t].z),C.push(g[t].x,g[t].y),!0===l._meshLoadOptions.ImportVertexColors&&E.push(m[t].r,m[t].g,m[t].b,m[t].a);_=[],b=[],g=[],m=[],v=[],y=0},k=function(t,e){for(var i=e;i<t.length-1;i++)x.push(t[0],t[i],t[i+1])},D=function(t,e){k(t,e);for(var i=0;i<x.length;i++){var n=parseInt(x[i])-1;L(n,0,0,h[n],r.Vector2.Zero(),r.Vector3.Up(),!0===l._meshLoadOptions.ImportVertexColors?d[n]:void 0)}x=[]},B=function(t,e){k(t,e);for(var i=0;i<x.length;i++){var n=x[i].split("/"),o=parseInt(n[0])-1,s=parseInt(n[1])-1;L(o,s,0,h[o],u[s],r.Vector3.Up(),!0===l._meshLoadOptions.ImportVertexColors?d[o]:void 0)}x=[]},F=function(t,e){k(t,e);for(var i=0;i<x.length;i++){var r=x[i].split("/"),n=parseInt(r[0])-1,o=parseInt(r[1])-1,s=parseInt(r[2])-1;L(n,o,s,h[n],u[o],c[s])}x=[]},V=function(t,e){k(t,e);for(var i=0;i<x.length;i++){var n=x[i].split("//"),o=parseInt(n[0])-1,s=parseInt(n[1])-1;L(o,1,s,h[o],r.Vector2.Zero(),c[s],!0===l._meshLoadOptions.ImportVertexColors?d[o]:void 0)}x=[]},j=function(t,e){k(t,e);for(var i=0;i<x.length;i++){var r=x[i].split("/"),n=h.length+parseInt(r[0]),o=u.length+parseInt(r[1]),s=c.length+parseInt(r[2]);L(n,o,s,h[n],u[o],c[s],!0===l._meshLoadOptions.ImportVertexColors?d[n]:void 0)}x=[]},H=function(){p.length>0&&(a=p[p.length-1],N(),f.reverse(),a.indices=f.slice(),a.positions=O.slice(),a.normals=A.slice(),a.uvs=C.slice(),!0===l._meshLoadOptions.ImportVertexColors&&(a.colors=E.slice()),f=[],O=[],E=[],A=[],C=[])},U=o.split("\n"),G=0;G<U.length;G++){var W,z=U[G].trim().replace(/\s\s/g," ");if(0!==z.length&&"#"!==z.charAt(0))if(this.vertexPattern.test(z))W=z.match(/[^ ]+/g),h.push(new r.Vector3(parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3]))),!0===this._meshLoadOptions.ImportVertexColors&&(W.length>=7?d.push(new r.Color4(parseFloat(W[4]),parseFloat(W[5]),parseFloat(W[6]),7===W.length||void 0===W[7]?1:parseFloat(W[7]))):d.push(R));else if(null!==(W=this.normalPattern.exec(z)))c.push(new r.Vector3(parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3])));else if(null!==(W=this.uvPattern.exec(z)))u.push(new r.Vector2(parseFloat(W[1])*t.UV_SCALING.x,parseFloat(W[2])*t.UV_SCALING.y));else if(null!==(W=this.facePattern3.exec(z)))F(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern4.exec(z)))V(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern5.exec(z)))j(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern2.exec(z)))B(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern1.exec(z)))D(W[1].trim().split(" "),1);else if(this.group.test(z)||this.obj.test(z)){var X={name:z.substring(2).trim(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:""};H(),p.push(X),T=!0,P=!0,I=1}else this.usemtl.test(z)?(w=z.substring(7).trim(),P&&T||(H(),X={name:"mesh_mm"+I.toString(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:w},I++,p.push(X),T=!0),T&&P&&(p[p.length-1].materialName=w,P=!1)):this.mtllib.test(z)?M=z.substring(7).trim():this.smooth.test(z)||console.log("Unhandled expression at line : "+z)}T&&(a=p[p.length-1],f.reverse(),N(),a.indices=f,a.positions=O,a.normals=A,a.uvs=C,!0===this._meshLoadOptions.ImportVertexColors&&(a.colors=E)),T||(f.reverse(),N(),p.push({name:r.Geometry.RandomId(),indices:f,positions:O,colors:E,normals:A,uvs:C,materialName:w}));for(var $=[],Y=new Array,K=0;K<p.length;K++){if(e&&p[K].name)if(e instanceof Array){if(-1===e.indexOf(p[K].name))continue}else if(p[K].name!==e)continue;a=p[K],i._blockEntityCollection=this._forAssetContainer;var q=new r.Mesh(p[K].name,i);i._blockEntityCollection=!1,Y.push(p[K].materialName);var Z=new r.VertexData;if(Z.uvs=a.uvs,Z.indices=a.indices,Z.positions=a.positions,!0===this._meshLoadOptions.ComputeNormals){var J=new Array;r.VertexData.ComputeNormals(a.positions,a.indices,J),Z.normals=J}else Z.normals=a.normals;!0===this._meshLoadOptions.ImportVertexColors&&(Z.colors=a.colors),Z.applyToMesh(q),this._meshLoadOptions.InvertY&&(q.scaling.y*=-1),$.push(q)}var Q=[];return""!==M&&!1===this._meshLoadOptions.SkipMaterials&&Q.push(new Promise((function(t,e){l._loadMTL(M,s,(function(n){try{S.parseMTL(i,n,s,l._forAssetContainer);for(var o=0;o<S.materials.length;o++){for(var a,h=0,c=[];(a=Y.indexOf(S.materials[o].name,h))>-1;)c.push(a),h=a+1;if(-1===a&&0===c.length)S.materials[o].dispose();else for(var u=0;u<c.length;u++)$[c[u]].material=S.materials[o]}t()}catch(i){r.Tools.Warn("Error processing MTL file: '"+M+"'"),l._meshLoadOptions.MaterialLoadingFailsSilently?t():e(i)}}),(function(i,n){r.Tools.Warn("Error downloading MTL file: '"+M+"'"),l._meshLoadOptions.MaterialLoadingFailsSilently?t():e(n)}))}))),Promise.all(Q).then((function(){return $}))},t.OPTIMIZE_WITH_UV=!0,t.INVERT_Y=!1,t.IMPORT_VERTEX_COLORS=!1,t.COMPUTE_NORMALS=!1,t.UV_SCALING=new r.Vector2(1,1),t.SKIP_MATERIALS=!1,t.MATERIAL_LOADING_FAILS_SILENTLY=!0,t}();r.SceneLoader&&r.SceneLoader.RegisterPlugin(new o)},function(t,e,i){"use strict";i.r(e),i.d(e,"STLFileLoader",(function(){return n}));var r=i(0),n=function(){function t(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}return t.prototype.importMesh=function(t,e,i,n,o,s,a){var l;if("string"!=typeof i){if(this._isBinary(i)){var h=new r.Mesh("stlmesh",e);return this._parseBinary(h,i),o&&o.push(h),!0}for(var c=new Uint8Array(i),u="",d=0;d<i.byteLength;d++)u+=String.fromCharCode(c[d]);i=u}for(;l=this.solidPattern.exec(i);){var p=l[1];if(p!=l[3])return r.Tools.Error("Error in STL, solid name != endsolid name"),!1;if(t&&p)if(t instanceof Array){if(!t.indexOf(p))continue}else if(p!==t)continue;p=p||"stlmesh",h=new r.Mesh(p,e),this._parseASCII(h,l[2]),o&&o.push(h)}return!0},t.prototype.load=function(t,e,i){return this.importMesh(null,t,e,i,null,null,null)},t.prototype.loadAssetContainer=function(t,e,i,n){var o=new r.AssetContainer(t);return t._blockEntityCollection=!0,this.importMesh(null,t,e,i,o.meshes,null,null),t._blockEntityCollection=!1,o},t.prototype._isBinary=function(t){var e;if(84+50*(e=new DataView(t)).getUint32(80,!0)===e.byteLength)return!0;for(var i=e.byteLength,r=0;r<i;r++)if(e.getUint8(r)>127)return!0;return!1},t.prototype._parseBinary=function(t,e){for(var i=new DataView(e),n=i.getUint32(80,!0),o=0,s=new Float32Array(3*n*3),a=new Float32Array(3*n*3),l=new Uint32Array(3*n),h=0,c=0;c<n;c++){for(var u=84+50*c,d=i.getFloat32(u,!0),p=i.getFloat32(u+4,!0),f=i.getFloat32(u+8,!0),_=1;_<=3;_++){var g=u+12*_;s[o]=i.getFloat32(g,!0),s[o+2]=i.getFloat32(g+4,!0),s[o+1]=i.getFloat32(g+8,!0),a[o]=d,a[o+2]=p,a[o+1]=f,o+=3}l[h]=h++,l[h]=h++,l[h]=h++}t.setVerticesData(r.VertexBuffer.PositionKind,s),t.setVerticesData(r.VertexBuffer.NormalKind,a),t.setIndices(l),t.computeWorldMatrix(!0)},t.prototype._parseASCII=function(t,e){for(var i,n=[],o=[],s=[],a=0;i=this.facetsPattern.exec(e);){var l=i[1],h=this.normalPattern.exec(l);if(this.normalPattern.lastIndex=0,h){for(var c,u=[Number(h[1]),Number(h[5]),Number(h[3])];c=this.vertexPattern.exec(l);)n.push(Number(c[1]),Number(c[5]),Number(c[3])),o.push(u[0],u[1],u[2]);s.push(a++,a++,a++),this.vertexPattern.lastIndex=0}}this.facetsPattern.lastIndex=0,t.setVerticesData(r.VertexBuffer.PositionKind,n),t.setVerticesData(r.VertexBuffer.NormalKind,o),t.setIndices(s),t.computeWorldMatrix(!0)},t}();r.SceneLoader&&r.SceneLoader.RegisterPlugin(new n)},function(t,e,i){"use strict";(function(t){var r=i(2),n=i(3);i.d(e,"a",(function(){return r.GLTFFileLoader})),i.d(e,"b",(function(){return r.GLTFLoaderAnimationStartMode})),i.d(e,"c",(function(){return r.GLTFLoaderCoordinateSystemMode})),i.d(e,"d",(function(){return r.GLTFLoaderState})),i.d(e,"e",(function(){return n.GLTFValidation}));var o=void 0!==t?t:"undefined"!=typeof window?window:void 0;if(void 0!==o){for(var s in o.BABYLON=o.BABYLON||{},r)o.BABYLON[s]=r[s];for(var s in n)o.BABYLON[s]=n[s]}}).call(this,i(5))},function(t,e,i){"use strict";(function(t){var r=i(8);i.d(e,"a",(function(){return r}));var n=void 0!==t?t:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in n.BABYLON=n.BABYLON||{},n.BABYLON.GLTF1=n.BABYLON.GLTF1||{},r)n.BABYLON.GLTF1[o]=r[o]}).call(this,i(5))},function(t,e,i){"use strict";(function(t){var r=i(7),n=i(6),o=i(9);i.d(e,"a",(function(){return o}));var s=void 0!==t?t:"undefined"!=typeof window?window:void 0;if(void 0!==s){s.BABYLON=s.BABYLON||{};var a=s.BABYLON;a.GLTF2=a.GLTF2||{},a.GLTF2.Loader=a.GLTF2.Loader||{},a.GLTF2.Loader.Extensions=a.GLTF2.Loader.Extensions||{};var l=[];for(var h in r)a.GLTF2.Loader.Extensions[h]=r[h],l.push(h);for(var h in n)a.GLTF2.Loader[h]=n[h],l.push(h);for(var h in o)l.indexOf(h)>-1||(a.GLTF2[h]=o[h])}}).call(this,i(5))},function(t,e,i){"use strict";i.r(e),function(t){var r=i(10);i.d(e,"MTLFileLoader",(function(){return r.MTLFileLoader})),i.d(e,"OBJFileLoader",(function(){return r.OBJFileLoader}));var n=void 0!==t?t:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in r)n.BABYLON[o]=r[o]}.call(this,i(5))},function(t,e,i){"use strict";i.r(e),function(t){var r=i(11);i.d(e,"STLFileLoader",(function(){return r.STLFileLoader}));var n=void 0!==t?t:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in r)n.BABYLON[o]=r[o]}.call(this,i(5))},,,,function(t,e,i){"use strict";i.r(e),i.d(e,"GLTFLoaderCoordinateSystemMode",(function(){return r.c})),i.d(e,"GLTFLoaderAnimationStartMode",(function(){return r.b})),i.d(e,"GLTFLoaderState",(function(){return r.d})),i.d(e,"GLTFFileLoader",(function(){return r.a})),i.d(e,"GLTFValidation",(function(){return r.e})),i.d(e,"GLTF1",(function(){return n.a})),i.d(e,"GLTF2",(function(){return o.a})),i.d(e,"MTLFileLoader",(function(){return s.MTLFileLoader})),i.d(e,"OBJFileLoader",(function(){return s.OBJFileLoader})),i.d(e,"STLFileLoader",(function(){return a.STLFileLoader})),i(2),i(3),i(8),i(9),i(10),i(11);var r=i(12),n=i(13),o=i(14),s=i(15),a=i(16)}])}))}).call(this,i("c8ba"))},b848:function(t,e,i){"use strict";var r=i("58df");function n(t){const e=[];for(let i=0;i<t.length;i++){const r=t[i];r.isActive&&r.isDependent?e.push(r):e.push(...n(r.$children))}return e}e["a"]=Object(r["a"])().extend({name:"dependent",data(){return{closeDependents:!0,isActive:!1,isDependent:!0}},watch:{isActive(t){if(t)return;const e=this.getOpenDependents();for(let i=0;i<e.length;i++)e[i].isActive=!1}},methods:{getOpenDependents(){return this.closeDependents?n(this.$children):[]},getOpenDependentElements(){const t=[],e=this.getOpenDependents();for(let i=0;i<e.length;i++)t.push(...e[i].getClickableDependentElements());return t},getClickableDependentElements(){const t=[this.$el];return this.$refs.content&&t.push(this.$refs.content),this.overlay&&t.push(this.overlay.$el),t.push(...this.getOpenDependentElements()),t}}})},b974:function(t,e,i){"use strict";i("4ff9"),i("68dd");var r=i("34ef"),n=i("326d"),o=i("9e88"),s=(i("8ce9"),i("7560")),a=s["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render(t){let e;return this.$attrs.role&&"separator"!==this.$attrs.role||(e=this.vertical?"vertical":"horizontal"),t("hr",{class:{"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical,...this.themeClasses},attrs:{role:"separator","aria-orientation":e,...this.$attrs},on:this.$listeners})}}),l=a,h=(i("0bc6"),i("58df")),c=Object(h["a"])(s["a"]).extend({name:"v-subheader",props:{inset:Boolean},render(t){return t("div",{staticClass:"v-subheader",class:{"v-subheader--inset":this.inset,...this.themeClasses},attrs:this.$attrs,on:this.$listeners},this.$slots.default)}}),u=c,d=i("da13"),p=i("1800"),f=i("5d23"),_=i("8860"),g=i("5607"),m=i("a9ad"),b=i("80d2"),v=Object(h["a"])(m["a"],s["a"]).extend({name:"v-select-list",directives:{ripple:g["a"]},props:{action:Boolean,dense:Boolean,hideSelected:Boolean,items:{type:Array,default:()=>[]},itemDisabled:{type:[String,Array,Function],default:"disabled"},itemText:{type:[String,Array,Function],default:"text"},itemValue:{type:[String,Array,Function],default:"value"},noDataText:String,noFilter:Boolean,searchInput:null,selectedItems:{type:Array,default:()=>[]}},computed:{parsedItems(){return this.selectedItems.map(t=>this.getValue(t))},tileActiveClass(){return Object.keys(this.setTextColor(this.color).class||{}).join(" ")},staticNoDataTile(){const t={attrs:{role:void 0},on:{mousedown:t=>t.preventDefault()}};return this.$createElement(d["a"],t,[this.genTileContent(this.noDataText)])}},methods:{genAction(t,e){return this.$createElement(p["a"],[this.$createElement(o["a"],{props:{color:this.color,value:e,ripple:!1},on:{input:()=>this.$emit("select",t)}})])},genDivider(t){return this.$createElement(l,{props:t})},genFilteredText(t){if(t=t||"",!this.searchInput||this.noFilter)return t;const{start:e,middle:i,end:r}=this.getMaskedCharacters(t);return[e,this.genHighlight(i),r]},genHeader(t){return this.$createElement(u,{props:t},t.header)},genHighlight(t){return this.$createElement("span",{staticClass:"v-list-item__mask"},t)},getMaskedCharacters(t){const e=(this.searchInput||"").toString().toLocaleLowerCase(),i=t.toLocaleLowerCase().indexOf(e);if(i<0)return{start:t,middle:"",end:""};const r=t.slice(0,i),n=t.slice(i,i+e.length),o=t.slice(i+e.length);return{start:r,middle:n,end:o}},genTile({item:t,index:e,disabled:i=null,value:r=!1}){r||(r=this.hasItem(t)),t===Object(t)&&(i=null!==i?i:this.getDisabled(t));const n={attrs:{"aria-selected":String(r),id:`list-item-${this._uid}-${e}`,role:"option"},on:{mousedown:t=>{t.preventDefault()},click:()=>i||this.$emit("select",t)},props:{activeClass:this.tileActiveClass,disabled:i,ripple:!0,inputValue:r}};if(!this.$scopedSlots.item)return this.$createElement(d["a"],n,[this.action&&!this.hideSelected&&this.items.length>0?this.genAction(t,r):null,this.genTileContent(t,e)]);const o=this,s=this.$scopedSlots.item({parent:o,item:t,attrs:{...n.attrs,...n.props},on:n.on});return this.needsTile(s)?this.$createElement(d["a"],n,s):s},genTileContent(t,e=0){return this.$createElement(f["a"],[this.$createElement(f["b"],[this.genFilteredText(this.getText(t))])])},hasItem(t){return this.parsedItems.indexOf(this.getValue(t))>-1},needsTile(t){return 1!==t.length||null==t[0].componentOptions||"v-list-item"!==t[0].componentOptions.Ctor.options.name},getDisabled(t){return Boolean(Object(b["q"])(t,this.itemDisabled,!1))},getText(t){return String(Object(b["q"])(t,this.itemText,t))},getValue(t){return Object(b["q"])(t,this.itemValue,this.getText(t))}},render(){const t=[],e=this.items.length;for(let i=0;i<e;i++){const e=this.items[i];this.hideSelected&&this.hasItem(e)||(null==e?t.push(this.genTile({item:e,index:i})):e.header?t.push(this.genHeader(e)):e.divider?t.push(this.genDivider(e)):t.push(this.genTile({item:e,index:i})))}return t.length||t.push(this.$slots["no-data"]||this.staticNoDataTile),this.$slots["prepend-item"]&&t.unshift(this.$slots["prepend-item"]),this.$slots["append-item"]&&t.push(this.$slots["append-item"]),this.$createElement(_["a"],{staticClass:"v-select-list",class:this.themeClasses,attrs:{role:"listbox",tabindex:-1},props:{dense:this.dense}},t)}}),y=i("c37a"),T=i("8654"),O=i("8547"),E=i("b848"),A=i("2b0e"),C=A["a"].extend({name:"filterable",props:{noDataText:{type:String,default:"$vuetify.noDataText"}}}),x=i("a293"),w=i("d9f7"),M=i("d9bd");const S={closeOnClick:!1,closeOnContentClick:!1,disableKeys:!0,openOnClick:!1,maxHeight:304},I=Object(h["a"])(T["a"],O["a"],E["a"],C);e["a"]=I.extend().extend({name:"v-select",directives:{ClickOutside:x["a"]},props:{appendIcon:{type:String,default:"$dropdown"},attach:{type:null,default:!1},cacheItems:Boolean,chips:Boolean,clearable:Boolean,deletableChips:Boolean,disableLookup:Boolean,eager:Boolean,hideSelected:Boolean,items:{type:Array,default:()=>[]},itemColor:{type:String,default:"primary"},itemDisabled:{type:[String,Array,Function],default:"disabled"},itemText:{type:[String,Array,Function],default:"text"},itemValue:{type:[String,Array,Function],default:"value"},menuProps:{type:[String,Array,Object],default:()=>S},multiple:Boolean,openOnClear:Boolean,returnObject:Boolean,smallChips:Boolean},data(){return{cachedItems:this.cacheItems?this.items:[],menuIsBooted:!1,isMenuActive:!1,lastItem:20,lazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,selectedIndex:-1,selectedItems:[],keyboardLookupPrefix:"",keyboardLookupLastTime:0}},computed:{allItems(){return this.filterDuplicates(this.cachedItems.concat(this.items))},classes(){return{...T["a"].options.computed.classes.call(this),"v-select":!0,"v-select--chips":this.hasChips,"v-select--chips--small":this.smallChips,"v-select--is-menu-active":this.isMenuActive,"v-select--is-multi":this.multiple}},computedItems(){return this.allItems},computedOwns(){return"list-"+this._uid},computedCounterValue(){var t;const e=this.multiple?this.selectedItems:(null!==(t=this.getText(this.selectedItems[0]))&&void 0!==t?t:"").toString();return"function"===typeof this.counterValue?this.counterValue(e):e.length},directives(){return this.isFocused?[{name:"click-outside",value:{handler:this.blur,closeConditional:this.closeConditional,include:()=>this.getOpenDependentElements()}}]:void 0},dynamicHeight(){return"auto"},hasChips(){return this.chips||this.smallChips},hasSlot(){return Boolean(this.hasChips||this.$scopedSlots.selection)},isDirty(){return this.selectedItems.length>0},listData(){const t=this.$vnode&&this.$vnode.context.$options._scopeId,e=t?{[t]:!0}:{};return{attrs:{...e,id:this.computedOwns},props:{action:this.multiple,color:this.itemColor,dense:this.dense,hideSelected:this.hideSelected,items:this.virtualizedItems,itemDisabled:this.itemDisabled,itemText:this.itemText,itemValue:this.itemValue,noDataText:this.$vuetify.lang.t(this.noDataText),selectedItems:this.selectedItems},on:{select:this.selectItem},scopedSlots:{item:this.$scopedSlots.item}}},staticList(){return(this.$slots["no-data"]||this.$slots["prepend-item"]||this.$slots["append-item"])&&Object(M["b"])("assert: staticList should not be called if slots are used"),this.$createElement(v,this.listData)},virtualizedItems(){return this.$_menuProps.auto?this.computedItems:this.computedItems.slice(0,this.lastItem)},menuCanShow:()=>!0,$_menuProps(){let t="string"===typeof this.menuProps?this.menuProps.split(","):this.menuProps;return Array.isArray(t)&&(t=t.reduce((t,e)=>(t[e.trim()]=!0,t),{})),{...S,eager:this.eager,value:this.menuCanShow&&this.isMenuActive,nudgeBottom:t.offsetY?1:0,...t}}},watch:{internalValue(t){this.initialValue=t,this.setSelectedItems(),this.multiple&&this.$nextTick(()=>{var t;null===(t=this.$refs.menu)||void 0===t||t.updateDimensions()})},isMenuActive(t){window.setTimeout(()=>this.onMenuActiveChange(t))},items:{immediate:!0,handler(t){this.cacheItems&&this.$nextTick(()=>{this.cachedItems=this.filterDuplicates(this.cachedItems.concat(t))}),this.setSelectedItems()}}},methods:{blur(t){T["a"].options.methods.blur.call(this,t),this.isMenuActive=!1,this.isFocused=!1,this.selectedIndex=-1,this.setMenuIndex(-1)},activateMenu(){this.isInteractive&&!this.isMenuActive&&(this.isMenuActive=!0)},clearableCallback(){this.setValue(this.multiple?[]:null),this.setMenuIndex(-1),this.$nextTick(()=>this.$refs.input&&this.$refs.input.focus()),this.openOnClear&&(this.isMenuActive=!0)},closeConditional(t){return!this.isMenuActive||!this._isDestroyed&&(!this.getContent()||!this.getContent().contains(t.target))&&this.$el&&!this.$el.contains(t.target)&&t.target!==this.$el},filterDuplicates(t){const e=new Map;for(let i=0;i<t.length;++i){const r=t[i];if(null==r)continue;if(r.header||r.divider){e.set(r,r);continue}const n=this.getValue(r);!e.has(n)&&e.set(n,r)}return Array.from(e.values())},findExistingIndex(t){const e=this.getValue(t);return(this.internalValue||[]).findIndex(t=>this.valueComparator(this.getValue(t),e))},getContent(){return this.$refs.menu&&this.$refs.menu.$refs.content},genChipSelection(t,e){const i=this.isDisabled||this.getDisabled(t),n=!i&&this.isInteractive;return this.$createElement(r["a"],{staticClass:"v-chip--select",attrs:{tabindex:-1},props:{close:this.deletableChips&&n,disabled:i,inputValue:e===this.selectedIndex,small:this.smallChips},on:{click:t=>{n&&(t.stopPropagation(),this.selectedIndex=e)},"click:close":()=>this.onChipInput(t)},key:JSON.stringify(this.getValue(t))},this.getText(t))},genCommaSelection(t,e,i){const r=e===this.selectedIndex&&this.computedColor,n=this.isDisabled||this.getDisabled(t);return this.$createElement("div",this.setTextColor(r,{staticClass:"v-select__selection v-select__selection--comma",class:{"v-select__selection--disabled":n},key:JSON.stringify(this.getValue(t))}),`${this.getText(t)}${i?"":", "}`)},genDefaultSlot(){const t=this.genSelections(),e=this.genInput();return Array.isArray(t)?t.push(e):(t.children=t.children||[],t.children.push(e)),[this.genFieldset(),this.$createElement("div",{staticClass:"v-select__slot",directives:this.directives},[this.genLabel(),this.prefix?this.genAffix("prefix"):null,t,this.suffix?this.genAffix("suffix"):null,this.genClearIcon(),this.genIconSlot(),this.genHiddenInput()]),this.genMenu(),this.genProgress()]},genIcon(t,e,i){const r=y["a"].options.methods.genIcon.call(this,t,e,i);return"append"===t&&(r.children[0].data=Object(w["a"])(r.children[0].data,{attrs:{tabindex:r.children[0].componentOptions.listeners&&"-1","aria-hidden":"true","aria-label":void 0}})),r},genInput(){const t=T["a"].options.methods.genInput.call(this);return delete t.data.attrs.name,t.data=Object(w["a"])(t.data,{domProps:{value:null},attrs:{readonly:!0,type:"text","aria-readonly":String(this.isReadonly),"aria-activedescendant":Object(b["o"])(this.$refs.menu,"activeTile.id"),autocomplete:Object(b["o"])(t.data,"attrs.autocomplete","off"),placeholder:this.isDirty||!this.persistentPlaceholder&&!this.isFocused&&this.hasLabel?void 0:this.placeholder},on:{keypress:this.onKeyPress}}),t},genHiddenInput(){return this.$createElement("input",{domProps:{value:this.lazyValue},attrs:{type:"hidden",name:this.attrs$.name}})},genInputSlot(){const t=T["a"].options.methods.genInputSlot.call(this);return t.data.attrs={...t.data.attrs,role:"button","aria-haspopup":"listbox","aria-expanded":String(this.isMenuActive),"aria-owns":this.computedOwns},t},genList(){return this.$slots["no-data"]||this.$slots["prepend-item"]||this.$slots["append-item"]?this.genListWithSlot():this.staticList},genListWithSlot(){const t=["prepend-item","no-data","append-item"].filter(t=>this.$slots[t]).map(t=>this.$createElement("template",{slot:t},this.$slots[t]));return this.$createElement(v,{...this.listData},t)},genMenu(){const t=this.$_menuProps;return t.activator=this.$refs["input-slot"],""===this.attach||!0===this.attach||"attach"===this.attach?t.attach=this.$el:t.attach=this.attach,this.$createElement(n["a"],{attrs:{role:void 0},props:t,on:{input:t=>{this.isMenuActive=t,this.isFocused=t},scroll:this.onScroll},ref:"menu"},[this.genList()])},genSelections(){let t=this.selectedItems.length;const e=new Array(t);let i;i=this.$scopedSlots.selection?this.genSlotSelection:this.hasChips?this.genChipSelection:this.genCommaSelection;while(t--)e[t]=i(this.selectedItems[t],t,t===e.length-1);return this.$createElement("div",{staticClass:"v-select__selections"},e)},genSlotSelection(t,e){return this.$scopedSlots.selection({attrs:{class:"v-chip--select"},parent:this,item:t,index:e,select:t=>{t.stopPropagation(),this.selectedIndex=e},selected:e===this.selectedIndex,disabled:!this.isInteractive})},getMenuIndex(){return this.$refs.menu?this.$refs.menu.listIndex:-1},getDisabled(t){return Object(b["q"])(t,this.itemDisabled,!1)},getText(t){return Object(b["q"])(t,this.itemText,t)},getValue(t){return Object(b["q"])(t,this.itemValue,this.getText(t))},onBlur(t){t&&this.$emit("blur",t)},onChipInput(t){this.multiple?this.selectItem(t):this.setValue(null),0===this.selectedItems.length?this.isMenuActive=!0:this.isMenuActive=!1,this.selectedIndex=-1},onClick(t){this.isInteractive&&(this.isAppendInner(t.target)||(this.isMenuActive=!0),this.isFocused||(this.isFocused=!0,this.$emit("focus")),this.$emit("click",t))},onEscDown(t){t.preventDefault(),this.isMenuActive&&(t.stopPropagation(),this.isMenuActive=!1)},onKeyPress(t){if(this.multiple||!this.isInteractive||this.disableLookup)return;const e=1e3,i=performance.now();i-this.keyboardLookupLastTime>e&&(this.keyboardLookupPrefix=""),this.keyboardLookupPrefix+=t.key.toLowerCase(),this.keyboardLookupLastTime=i;const r=this.allItems.findIndex(t=>{var e;const i=(null!==(e=this.getText(t))&&void 0!==e?e:"").toString();return i.toLowerCase().startsWith(this.keyboardLookupPrefix)}),n=this.allItems[r];-1!==r&&(this.lastItem=Math.max(this.lastItem,r+5),this.setValue(this.returnObject?n:this.getValue(n)),this.$nextTick(()=>this.$refs.menu.getTiles()),setTimeout(()=>this.setMenuIndex(r)))},onKeyDown(t){if(this.isReadonly&&t.keyCode!==b["w"].tab)return;const e=t.keyCode,i=this.$refs.menu;return this.$emit("keydown",t),i?(this.isMenuActive&&[b["w"].up,b["w"].down,b["w"].home,b["w"].end,b["w"].enter].includes(e)&&this.$nextTick(()=>{i.changeListIndex(t),this.$emit("update:list-index",i.listIndex)}),[b["w"].enter,b["w"].space].includes(e)&&this.activateMenu(),!this.isMenuActive&&[b["w"].up,b["w"].down,b["w"].home,b["w"].end].includes(e)?this.onUpDown(t):e===b["w"].esc?this.onEscDown(t):e===b["w"].tab?this.onTabDown(t):e===b["w"].space?this.onSpaceDown(t):void 0):void 0},onMenuActiveChange(t){if(this.multiple&&!t||this.getMenuIndex()>-1)return;const e=this.$refs.menu;if(e&&this.isDirty){this.$refs.menu.getTiles();for(let t=0;t<e.tiles.length;t++)if("true"===e.tiles[t].getAttribute("aria-selected")){this.setMenuIndex(t);break}}},onMouseUp(t){this.hasMouseDown&&3!==t.which&&this.isInteractive&&this.isAppendInner(t.target)&&this.$nextTick(()=>this.isMenuActive=!this.isMenuActive),T["a"].options.methods.onMouseUp.call(this,t)},onScroll(){if(this.isMenuActive){if(this.lastItem>this.computedItems.length)return;const t=this.getContent().scrollHeight-(this.getContent().scrollTop+this.getContent().clientHeight)<200;t&&(this.lastItem+=20)}else requestAnimationFrame(()=>this.getContent().scrollTop=0)},onSpaceDown(t){t.preventDefault()},onTabDown(t){const e=this.$refs.menu;if(!e)return;const i=e.activeTile;!this.multiple&&i&&this.isMenuActive?(t.preventDefault(),t.stopPropagation(),i.click()):this.blur(t)},onUpDown(t){const e=this.$refs.menu;if(!e)return;if(t.preventDefault(),this.multiple)return this.activateMenu();const i=t.keyCode;e.isBooted=!0,window.requestAnimationFrame(()=>{if(e.getTiles(),!e.hasClickableTiles)return this.activateMenu();switch(i){case b["w"].up:e.prevTile();break;case b["w"].down:e.nextTile();break;case b["w"].home:e.firstTile();break;case b["w"].end:e.lastTile();break}this.selectItem(this.allItems[this.getMenuIndex()])})},selectItem(t){if(this.multiple){const e=(this.internalValue||[]).slice(),i=this.findExistingIndex(t);if(-1!==i?e.splice(i,1):e.push(t),this.setValue(e.map(t=>this.returnObject?t:this.getValue(t))),this.hideSelected)this.setMenuIndex(-1);else{const e=this.allItems.indexOf(t);~e&&(this.$nextTick(()=>this.$refs.menu.getTiles()),setTimeout(()=>this.setMenuIndex(e)))}}else this.setValue(this.returnObject?t:this.getValue(t)),this.isMenuActive=!1},setMenuIndex(t){this.$refs.menu&&(this.$refs.menu.listIndex=t)},setSelectedItems(){const t=[],e=this.multiple&&Array.isArray(this.internalValue)?this.internalValue:[this.internalValue];for(const i of e){const e=this.allItems.findIndex(t=>this.valueComparator(this.getValue(t),this.getValue(i)));e>-1&&t.push(this.allItems[e])}this.selectedItems=t},setValue(t){this.valueComparator(t,this.internalValue)||(this.internalValue=t,this.$emit("change",t))},isAppendInner(t){const e=this.$refs["append-inner"];return e&&(e===t||e.contains(t))}}})},ba87:function(t,e,i){"use strict";i("1b2c");var r=i("a9ad"),n=i("7560"),o=i("58df"),s=i("80d2"),a=Object(o["a"])(n["a"]).extend({name:"v-label",functional:!0,props:{absolute:Boolean,color:{type:String,default:"primary"},disabled:Boolean,focused:Boolean,for:String,left:{type:[Number,String],default:0},right:{type:[Number,String],default:"auto"},value:Boolean},render(t,e){const{children:i,listeners:o,props:a}=e,l={staticClass:"v-label",class:{"v-label--active":a.value,"v-label--is-disabled":a.disabled,...Object(n["b"])(e)},attrs:{for:a.for,"aria-hidden":!a.for},on:o,style:{left:Object(s["h"])(a.left),right:Object(s["h"])(a.right),position:a.absolute?"absolute":"relative"},ref:"label"};return t("label",r["a"].options.methods.setTextColor(a.focused&&a.color,l),i)}});e["a"]=a},c37a:function(t,e,i){"use strict";i("d191");var r=i("9d26"),n=i("ba87"),o=(i("8ff2"),i("a9ad")),s=i("7560"),a=i("58df"),l=i("80d2"),h=Object(a["a"])(o["a"],s["a"]).extend({name:"v-messages",props:{value:{type:Array,default:()=>[]}},methods:{genChildren(){return this.$createElement("transition-group",{staticClass:"v-messages__wrapper",attrs:{name:"message-transition",tag:"div"}},this.value.map(this.genMessage))},genMessage(t,e){return this.$createElement("div",{staticClass:"v-messages__message",key:e},Object(l["r"])(this,"default",{message:t,key:e})||[t])}},render(t){return t("div",this.setTextColor(this.color,{staticClass:"v-messages",class:this.themeClasses}),[this.genChildren()])}}),c=h,u=i("7e2b"),d=i("38cb"),p=i("d9f7");const f=Object(a["a"])(u["a"],d["a"]);var _=f.extend().extend({name:"v-input",inheritAttrs:!1,props:{appendIcon:String,backgroundColor:{type:String,default:""},dense:Boolean,height:[Number,String],hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,id:String,label:String,loading:Boolean,persistentHint:Boolean,prependIcon:String,value:null},data(){return{lazyValue:this.value,hasMouseDown:!1}},computed:{classes(){return{"v-input--has-state":this.hasState,"v-input--hide-details":!this.showDetails,"v-input--is-label-active":this.isLabelActive,"v-input--is-dirty":this.isDirty,"v-input--is-disabled":this.isDisabled,"v-input--is-focused":this.isFocused,"v-input--is-loading":!1!==this.loading&&null!=this.loading,"v-input--is-readonly":this.isReadonly,"v-input--dense":this.dense,"v-input--hide-spin-buttons":this.hideSpinButtons,...this.themeClasses}},computedId(){return this.id||"input-"+this._uid},hasDetails(){return this.messagesToDisplay.length>0},hasHint(){return!this.hasMessages&&!!this.hint&&(this.persistentHint||this.isFocused)},hasLabel(){return!(!this.$slots.label&&!this.label)},internalValue:{get(){return this.lazyValue},set(t){this.lazyValue=t,this.$emit(this.$_modelEvent,t)}},isDirty(){return!!this.lazyValue},isLabelActive(){return this.isDirty},messagesToDisplay(){return this.hasHint?[this.hint]:this.hasMessages?this.validations.map(t=>{if("string"===typeof t)return t;const e=t(this.internalValue);return"string"===typeof e?e:""}).filter(t=>""!==t):[]},showDetails(){return!1===this.hideDetails||"auto"===this.hideDetails&&this.hasDetails}},watch:{value(t){this.lazyValue=t}},beforeCreate(){this.$_modelEvent=this.$options.model&&this.$options.model.event||"input"},methods:{genContent(){return[this.genPrependSlot(),this.genControl(),this.genAppendSlot()]},genControl(){return this.$createElement("div",{staticClass:"v-input__control",attrs:{title:this.attrs$.title}},[this.genInputSlot(),this.genMessages()])},genDefaultSlot(){return[this.genLabel(),this.$slots.default]},genIcon(t,e,i={}){const n=this[t+"Icon"],o="click:"+Object(l["v"])(t),s=!(!this.listeners$[o]&&!e),a=Object(p["a"])({attrs:{"aria-label":s?Object(l["v"])(t).split("-")[0]+" icon":void 0,color:this.validationState,dark:this.dark,disabled:this.isDisabled,light:this.light,tabindex:"clear"===t?-1:void 0},on:s?{click:t=>{t.preventDefault(),t.stopPropagation(),this.$emit(o,t),e&&e(t)},mouseup:t=>{t.preventDefault(),t.stopPropagation()}}:void 0},i);return this.$createElement("div",{staticClass:"v-input__icon",class:t?"v-input__icon--"+Object(l["v"])(t):void 0},[this.$createElement(r["a"],a,n)])},genInputSlot(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor,{staticClass:"v-input__slot",style:{height:Object(l["h"])(this.height)},on:{click:this.onClick,mousedown:this.onMouseDown,mouseup:this.onMouseUp},ref:"input-slot"}),[this.genDefaultSlot()])},genLabel(){return this.hasLabel?this.$createElement(n["a"],{props:{color:this.validationState,dark:this.dark,disabled:this.isDisabled,focused:this.hasState,for:this.computedId,light:this.light}},this.$slots.label||this.label):null},genMessages(){return this.showDetails?this.$createElement(c,{props:{color:this.hasHint?"":this.validationState,dark:this.dark,light:this.light,value:this.messagesToDisplay},attrs:{role:this.hasMessages?"alert":null},scopedSlots:{default:t=>Object(l["r"])(this,"message",t)}}):null},genSlot(t,e,i){if(!i.length)return null;const r=`${t}-${e}`;return this.$createElement("div",{staticClass:"v-input__"+r,ref:r},i)},genPrependSlot(){const t=[];return this.$slots.prepend?t.push(this.$slots.prepend):this.prependIcon&&t.push(this.genIcon("prepend")),this.genSlot("prepend","outer",t)},genAppendSlot(){const t=[];return this.$slots.append?t.push(this.$slots.append):this.appendIcon&&t.push(this.genIcon("append")),this.genSlot("append","outer",t)},onClick(t){this.$emit("click",t)},onMouseDown(t){this.hasMouseDown=!0,this.$emit("mousedown",t)},onMouseUp(t){this.hasMouseDown=!1,this.$emit("mouseup",t)}},render(t){return t("div",this.setTextColor(this.validationState,{staticClass:"v-input",class:this.classes}),this.genContent())}});e["a"]=_},c3f0:function(t,e,i){"use strict";var r=i("80d2");const n=t=>{const{touchstartX:e,touchendX:i,touchstartY:r,touchendY:n}=t,o=.5,s=16;t.offsetX=i-e,t.offsetY=n-r,Math.abs(t.offsetY)<o*Math.abs(t.offsetX)&&(t.left&&i<e-s&&t.left(t),t.right&&i>e+s&&t.right(t)),Math.abs(t.offsetX)<o*Math.abs(t.offsetY)&&(t.up&&n<r-s&&t.up(t),t.down&&n>r+s&&t.down(t))};function o(t,e){const i=t.changedTouches[0];e.touchstartX=i.clientX,e.touchstartY=i.clientY,e.start&&e.start(Object.assign(t,e))}function s(t,e){const i=t.changedTouches[0];e.touchendX=i.clientX,e.touchendY=i.clientY,e.end&&e.end(Object.assign(t,e)),n(e)}function a(t,e){const i=t.changedTouches[0];e.touchmoveX=i.clientX,e.touchmoveY=i.clientY,e.move&&e.move(Object.assign(t,e))}function l(t){const e={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:t=>o(t,e),touchend:t=>s(t,e),touchmove:t=>a(t,e)}}function h(t,e,i){const n=e.value,o=n.parent?t.parentElement:t,s=n.options||{passive:!0};if(!o)return;const a=l(e.value);o._touchHandlers=Object(o._touchHandlers),o._touchHandlers[i.context._uid]=a,Object(r["x"])(a).forEach(t=>{o.addEventListener(t,a[t],s)})}function c(t,e,i){const n=e.value.parent?t.parentElement:t;if(!n||!n._touchHandlers)return;const o=n._touchHandlers[i.context._uid];Object(r["x"])(o).forEach(t=>{n.removeEventListener(t,o[t])}),delete n._touchHandlers[i.context._uid]}const u={inserted:h,unbind:c};e["a"]=u},c70c:function(t,e,i){"use strict";i("ee9d")},cf36:function(t,e,i){},d191:function(t,e,i){},d9f7:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return l}));var r=i("80d2");const n={styleList:/;(?![^(]*\))/g,styleProp:/:(.*)/};function o(t){const e={};for(const i of t.split(n.styleList)){let[t,o]=i.split(n.styleProp);t=t.trim(),t&&("string"===typeof o&&(o=o.trim()),e[Object(r["c"])(t)]=o)}return e}function s(){const t={};let e,i=arguments.length;while(i--)for(e of Object.keys(arguments[i]))switch(e){case"class":case"directives":arguments[i][e]&&(t[e]=l(t[e],arguments[i][e]));break;case"style":arguments[i][e]&&(t[e]=a(t[e],arguments[i][e]));break;case"staticClass":if(!arguments[i][e])break;void 0===t[e]&&(t[e]=""),t[e]&&(t[e]+=" "),t[e]+=arguments[i][e].trim();break;case"on":case"nativeOn":arguments[i][e]&&(t[e]=h(t[e],arguments[i][e]));break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":if(!arguments[i][e])break;t[e]||(t[e]={}),t[e]={...arguments[i][e],...t[e]};break;default:t[e]||(t[e]=arguments[i][e])}return t}function a(t,e){return t?e?(t=Object(r["E"])("string"===typeof t?o(t):t),t.concat("string"===typeof e?o(e):e)):t:e}function l(t,e){return e?t&&t?Object(r["E"])(t).concat(e):e:t}function h(...t){if(!t[0])return t[1];if(!t[1])return t[0];const e={};for(let i=2;i--;){const r=t[i];for(const t in r)r[t]&&(e[t]?e[t]=[].concat(r[t],e[t]):e[t]=r[t])}return e}},da13:function(t,e,i){"use strict";i("61d2");var r=i("a9ad"),n=i("1c87"),o=i("4e82"),s=i("7560"),a=i("f2e7"),l=i("5607"),h=i("80d2"),c=i("d9bd"),u=i("58df");const d=Object(u["a"])(r["a"],n["a"],s["a"],Object(o["a"])("listItemGroup"),Object(a["b"])("inputValue"));e["a"]=d.extend().extend({name:"v-list-item",directives:{Ripple:l["a"]},inject:{isInGroup:{default:!1},isInList:{default:!1},isInMenu:{default:!1},isInNav:{default:!1}},inheritAttrs:!1,props:{activeClass:{type:String,default(){return this.listItemGroup?this.listItemGroup.activeClass:""}},dense:Boolean,inactive:Boolean,link:Boolean,selectable:{type:Boolean},tag:{type:String,default:"div"},threeLine:Boolean,twoLine:Boolean,value:null},data:()=>({proxyClass:"v-list-item--active"}),computed:{classes(){return{"v-list-item":!0,...n["a"].options.computed.classes.call(this),"v-list-item--dense":this.dense,"v-list-item--disabled":this.disabled,"v-list-item--link":this.isClickable&&!this.inactive,"v-list-item--selectable":this.selectable,"v-list-item--three-line":this.threeLine,"v-list-item--two-line":this.twoLine,...this.themeClasses}},isClickable(){return Boolean(n["a"].options.computed.isClickable.call(this)||this.listItemGroup)}},created(){this.$attrs.hasOwnProperty("avatar")&&Object(c["e"])("avatar",this)},methods:{click(t){t.detail&&this.$el.blur(),this.$emit("click",t),this.to||this.toggle()},genAttrs(){const t={"aria-disabled":!!this.disabled||void 0,tabindex:this.isClickable&&!this.disabled?0:-1,...this.$attrs};return this.$attrs.hasOwnProperty("role")||this.isInNav||(this.isInGroup?(t.role="option",t["aria-selected"]=String(this.isActive)):this.isInMenu?(t.role=this.isClickable?"menuitem":void 0,t.id=t.id||"list-item-"+this._uid):this.isInList&&(t.role="listitem")),t},toggle(){this.to&&void 0===this.inputValue&&(this.isActive=!this.isActive),this.$emit("change")}},render(t){let{tag:e,data:i}=this.generateRouteLink();i.attrs={...i.attrs,...this.genAttrs()},i[this.to?"nativeOn":"on"]={...i[this.to?"nativeOn":"on"],keydown:t=>{this.disabled||(t.keyCode===h["w"].enter&&this.click(t),this.$emit("keydown",t))}},this.inactive&&(e="div"),this.inactive&&this.to&&(i.on=i.nativeOn,delete i.nativeOn);const r=this.$scopedSlots.default?this.$scopedSlots.default({active:this.isActive,toggle:this.toggle}):this.$slots.default;return t(e,this.isActive?this.setTextColor(this.color,i):i,r)}})},db42:function(t,e,i){},dc22:function(t,e,i){"use strict";function r(t,e,i){const r=e.value,n=e.options||{passive:!0};window.addEventListener("resize",r,n),t._onResize=Object(t._onResize),t._onResize[i.context._uid]={callback:r,options:n},e.modifiers&&e.modifiers.quiet||r()}function n(t,e,i){var r;if(!(null===(r=t._onResize)||void 0===r?void 0:r[i.context._uid]))return;const{callback:n,options:o}=t._onResize[i.context._uid];window.removeEventListener("resize",n,o),delete t._onResize[i.context._uid]}const o={inserted:r,unbind:n};e["a"]=o},dd89:function(t,e,i){"use strict";function r(t){if("function"!==typeof t.getRootNode){while(t.parentNode)t=t.parentNode;return t!==document?null:document}const e=t.getRootNode();return e!==document&&e.getRootNode({composed:!0})!==document?null:e}i.d(e,"a",(function(){return r}))},e07a:function(t,e,i){"use strict";var r=i("6821"),n=i.n(r),o=!1,s={radToDeg(t){var e=Math.PI;return t*(180/e)},degToRad(t){var e=Math.PI;return t*(e/180)},getMeshSize(t){const e=t.getHierarchyBoundingVectors(),i={x:e.max.x-e.min.x,y:e.max.y-e.min.y,z:e.max.z-e.min.z};return i},getMeshFromMeshs(t,e){var i=null;return t.forEach((t,r)=>{t.name==e&&(i=t)}),i},getChildMeshFromMeshs(t,e){var i=null;return t._children.forEach((t,r)=>{t.name==e&&(console.log("find child mesh"),i=t)}),i},debugLog(...t){o&&console.log(...t)},createProjectId(){return n()(new Date)},getProjectById(t){var e=this.getLocalProjects();for(const i of e)if(i.id==t)return i;return null},deleteProjectById(t){var e=this.getLocalProjects(),i=0,r=!1;for(const n of e){if(n.id==t){e.splice(i,1),r=!0;break}i++}return!!r&&(window.localStorage.setItem("MyProjects",JSON.stringify(e)),e)},copyProjectById(t){var e=this.getLocalProjects(),i=!1,r=this.createProjectId();for(const o of e)if(o.id==t){var n=JSON.parse(JSON.stringify(o));n.name=n.name+"(复制)",n.id=r,e.push(n),i=!0;break}return!!i&&(window.localStorage.setItem(r,window.localStorage.getItem(t)),window.localStorage.setItem("MyProjects",JSON.stringify(e)),e)},renameProjectById(t,e){var i=this.getLocalProjects(),r=!1;for(const n of i)if(n.id==t){n.name=e,r=!0;break}return!!r&&(window.localStorage.setItem("MyProjects",JSON.stringify(i)),i)},getLocalProjects(){var t=window.localStorage.getItem("MyProjects");return t=null==t?[]:JSON.parse(t),t}};e["a"]=s,Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t}},e28d:function(t,e,i){"use strict";i("4edb")},e449:function(t,e,i){"use strict";i("ee6f");var r=i("480e"),n=i("4ad4"),o=i("16b7"),s=i("b848"),a=i("21be"),l=i("fe6c"),h=i("75eb"),c=i("58df"),u=i("80d2");const d=Object(c["a"])(a["a"],Object(l["b"])(["top","right","bottom","left","absolute"]),n["a"],h["a"]);var p=d.extend().extend({name:"menuable",props:{allowOverflow:Boolean,light:Boolean,dark:Boolean,maxWidth:{type:[Number,String],default:"auto"},minWidth:[Number,String],nudgeBottom:{type:[Number,String],default:0},nudgeLeft:{type:[Number,String],default:0},nudgeRight:{type:[Number,String],default:0},nudgeTop:{type:[Number,String],default:0},nudgeWidth:{type:[Number,String],default:0},offsetOverflow:Boolean,positionX:{type:Number,default:null},positionY:{type:Number,default:null},zIndex:{type:[Number,String],default:null}},data:()=>({activatorNode:[],absoluteX:0,absoluteY:0,activatedBy:null,activatorFixed:!1,dimensions:{activator:{top:0,left:0,bottom:0,right:0,width:0,height:0,offsetTop:0,scrollHeight:0,offsetLeft:0},content:{top:0,left:0,bottom:0,right:0,width:0,height:0,offsetTop:0,scrollHeight:0}},relativeYOffset:0,hasJustFocused:!1,hasWindow:!1,inputActivator:!1,isContentActive:!1,pageWidth:0,pageYOffset:0,stackClass:"v-menu__content--active",stackMinZIndex:6}),computed:{computedLeft(){const t=this.dimensions.activator,e=this.dimensions.content,i=(!1!==this.attach?t.offsetLeft:t.left)||0,r=Math.max(t.width,e.width);let n=0;if(n+=i,(this.left||this.$vuetify.rtl&&!this.right)&&(n-=r-t.width),this.offsetX){const e=isNaN(Number(this.maxWidth))?t.width:Math.min(t.width,Number(this.maxWidth));n+=this.left?-e:t.width}return this.nudgeLeft&&(n-=parseInt(this.nudgeLeft)),this.nudgeRight&&(n+=parseInt(this.nudgeRight)),n},computedTop(){const t=this.dimensions.activator,e=this.dimensions.content;let i=0;return this.top&&(i+=t.height-e.height),!1!==this.attach?i+=t.offsetTop:i+=t.top+this.pageYOffset,this.offsetY&&(i+=this.top?-t.height:t.height),this.nudgeTop&&(i-=parseInt(this.nudgeTop)),this.nudgeBottom&&(i+=parseInt(this.nudgeBottom)),i},hasActivator(){return!!this.$slots.activator||!!this.$scopedSlots.activator||!!this.activator||!!this.inputActivator},absoluteYOffset(){return this.pageYOffset-this.relativeYOffset}},watch:{disabled(t){t&&this.callDeactivate()},isActive(t){this.disabled||(t?this.callActivate():this.callDeactivate())},positionX:"updateDimensions",positionY:"updateDimensions"},beforeMount(){this.hasWindow="undefined"!==typeof window,this.hasWindow&&window.addEventListener("resize",this.updateDimensions,!1)},beforeDestroy(){this.hasWindow&&window.removeEventListener("resize",this.updateDimensions,!1)},methods:{absolutePosition(){return{offsetTop:this.positionY||this.absoluteY,offsetLeft:this.positionX||this.absoluteX,scrollHeight:0,top:this.positionY||this.absoluteY,bottom:this.positionY||this.absoluteY,left:this.positionX||this.absoluteX,right:this.positionX||this.absoluteX,height:0,width:0}},activate(){},calcLeft(t){return Object(u["h"])(!1!==this.attach?this.computedLeft:this.calcXOverflow(this.computedLeft,t))},calcTop(){return Object(u["h"])(!1!==this.attach?this.computedTop:this.calcYOverflow(this.computedTop))},calcXOverflow(t,e){const i=t+e-this.pageWidth+12;return t=(!this.left||this.right)&&i>0?Math.max(t-i,0):Math.max(t,12),t+this.getOffsetLeft()},calcYOverflow(t){const e=this.getInnerHeight(),i=this.absoluteYOffset+e,r=this.dimensions.activator,n=this.dimensions.content.height,o=t+n,s=i<o;return s&&this.offsetOverflow&&r.top>n?t=this.pageYOffset+(r.top-n):s&&!this.allowOverflow?t=i-n-12:t<this.absoluteYOffset&&!this.allowOverflow&&(t=this.absoluteYOffset+12),t<12?12:t},callActivate(){this.hasWindow&&this.activate()},callDeactivate(){this.isContentActive=!1,this.deactivate()},checkForPageYOffset(){this.hasWindow&&(this.pageYOffset=this.activatorFixed?0:this.getOffsetTop())},checkActivatorFixed(){if(!1!==this.attach)return void(this.activatorFixed=!1);let t=this.getActivator();while(t){if("fixed"===window.getComputedStyle(t).position)return void(this.activatorFixed=!0);t=t.offsetParent}this.activatorFixed=!1},deactivate(){},genActivatorListeners(){const t=n["a"].options.methods.genActivatorListeners.call(this),e=t.click;return e&&(t.click=t=>{this.openOnClick&&e&&e(t),this.absoluteX=t.clientX,this.absoluteY=t.clientY}),t},getInnerHeight(){return this.hasWindow?window.innerHeight||document.documentElement.clientHeight:0},getOffsetLeft(){return this.hasWindow?window.pageXOffset||document.documentElement.scrollLeft:0},getOffsetTop(){return this.hasWindow?window.pageYOffset||document.documentElement.scrollTop:0},getRoundedBoundedClientRect(t){const e=t.getBoundingClientRect();return{top:Math.round(e.top),left:Math.round(e.left),bottom:Math.round(e.bottom),right:Math.round(e.right),width:Math.round(e.width),height:Math.round(e.height)}},measure(t){if(!t||!this.hasWindow)return null;const e=this.getRoundedBoundedClientRect(t);if(!1!==this.attach){const i=window.getComputedStyle(t);e.left=parseInt(i.marginLeft),e.top=parseInt(i.marginTop)}return e},sneakPeek(t){requestAnimationFrame(()=>{const e=this.$refs.content;e&&"none"===e.style.display?(e.style.display="inline-block",t(),e.style.display="none"):t()})},startTransition(){return new Promise(t=>requestAnimationFrame(()=>{this.isContentActive=this.hasJustFocused=this.isActive,t()}))},updateDimensions(){this.hasWindow="undefined"!==typeof window,this.checkActivatorFixed(),this.checkForPageYOffset(),this.pageWidth=document.documentElement.clientWidth;const t={activator:{...this.dimensions.activator},content:{...this.dimensions.content}};if(!this.hasActivator||this.absolute)t.activator=this.absolutePosition();else{const e=this.getActivator();if(!e)return;t.activator=this.measure(e),t.activator.offsetLeft=e.offsetLeft,!1!==this.attach?t.activator.offsetTop=e.offsetTop:t.activator.offsetTop=0}this.sneakPeek(()=>{if(this.$refs.content){if(this.$refs.content.offsetParent){const e=this.getRoundedBoundedClientRect(this.$refs.content.offsetParent);this.relativeYOffset=window.pageYOffset+e.top,t.activator.top-=this.relativeYOffset,t.activator.left-=window.pageXOffset+e.left}t.content=this.measure(this.$refs.content)}this.dimensions=t})}}}),f=i("e4d3"),_=i("a236"),g=i("7560"),m=i("a293"),b=i("dc22"),v=i("d9bd"),y=i("7d8f");const T=Object(c["a"])(s["a"],o["a"],f["a"],_["a"],g["a"],p);e["a"]=T.extend({name:"v-menu",directives:{ClickOutside:m["a"],Resize:b["a"]},provide(){return{isInMenu:!0,theme:this.theme}},props:{auto:Boolean,closeOnClick:{type:Boolean,default:!0},closeOnContentClick:{type:Boolean,default:!0},disabled:Boolean,disableKeys:Boolean,maxHeight:{type:[Number,String],default:"auto"},offsetX:Boolean,offsetY:Boolean,openOnHover:Boolean,origin:{type:String,default:"top left"},transition:{type:[Boolean,String],default:"v-menu-transition"}},data(){return{calculatedTopAuto:0,defaultOffset:8,hasJustFocused:!1,listIndex:-1,resizeTimeout:0,selectedIndex:null,tiles:[]}},computed:{activeTile(){return this.tiles[this.listIndex]},calculatedLeft(){const t=Math.max(this.dimensions.content.width,parseFloat(this.calculatedMinWidth));return this.auto?Object(u["h"])(this.calcXOverflow(this.calcLeftAuto(),t))||"0":this.calcLeft(t)||"0"},calculatedMaxHeight(){const t=this.auto?"200px":Object(u["h"])(this.maxHeight);return t||"0"},calculatedMaxWidth(){return Object(u["h"])(this.maxWidth)||"0"},calculatedMinWidth(){if(this.minWidth)return Object(u["h"])(this.minWidth)||"0";const t=Math.min(this.dimensions.activator.width+Number(this.nudgeWidth)+(this.auto?16:0),Math.max(this.pageWidth-24,0)),e=isNaN(parseInt(this.calculatedMaxWidth))?t:parseInt(this.calculatedMaxWidth);return Object(u["h"])(Math.min(e,t))||"0"},calculatedTop(){const t=this.auto?Object(u["h"])(this.calcYOverflow(this.calculatedTopAuto)):this.calcTop();return t||"0"},hasClickableTiles(){return Boolean(this.tiles.find(t=>t.tabIndex>-1))},styles(){return{maxHeight:this.calculatedMaxHeight,minWidth:this.calculatedMinWidth,maxWidth:this.calculatedMaxWidth,top:this.calculatedTop,left:this.calculatedLeft,transformOrigin:this.origin,zIndex:this.zIndex||this.activeZIndex}}},watch:{isActive(t){t||(this.listIndex=-1)},isContentActive(t){this.hasJustFocused=t},listIndex(t,e){if(t in this.tiles){const e=this.tiles[t];e.classList.add("v-list-item--highlighted");const i=this.$refs.content.scrollTop,r=this.$refs.content.clientHeight;i>e.offsetTop-8?Object(y["b"])(e.offsetTop-e.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content}):i+r<e.offsetTop+e.clientHeight+8&&Object(y["b"])(e.offsetTop-r+2*e.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content})}e in this.tiles&&this.tiles[e].classList.remove("v-list-item--highlighted")}},created(){this.$attrs.hasOwnProperty("full-width")&&Object(v["e"])("full-width",this)},mounted(){this.isActive&&this.callActivate()},methods:{activate(){this.updateDimensions(),requestAnimationFrame(()=>{this.startTransition().then(()=>{this.$refs.content&&(this.calculatedTopAuto=this.calcTopAuto(),this.auto&&(this.$refs.content.scrollTop=this.calcScrollPosition()))})})},calcScrollPosition(){const t=this.$refs.content,e=t.querySelector(".v-list-item--active"),i=t.scrollHeight-t.offsetHeight;return e?Math.min(i,Math.max(0,e.offsetTop-t.offsetHeight/2+e.offsetHeight/2)):t.scrollTop},calcLeftAuto(){return parseInt(this.dimensions.activator.left-2*this.defaultOffset)},calcTopAuto(){const t=this.$refs.content,e=t.querySelector(".v-list-item--active");if(e||(this.selectedIndex=null),this.offsetY||!e)return this.computedTop;this.selectedIndex=Array.from(this.tiles).indexOf(e);const i=e.offsetTop-this.calcScrollPosition(),r=t.querySelector(".v-list-item").offsetTop;return this.computedTop-i-r-1},changeListIndex(t){if(this.getTiles(),this.isActive&&this.hasClickableTiles)if(t.keyCode!==u["w"].tab){if(t.keyCode===u["w"].down)this.nextTile();else if(t.keyCode===u["w"].up)this.prevTile();else if(t.keyCode===u["w"].end)this.lastTile();else if(t.keyCode===u["w"].home)this.firstTile();else{if(t.keyCode!==u["w"].enter||-1===this.listIndex)return;this.tiles[this.listIndex].click()}t.preventDefault()}else this.isActive=!1},closeConditional(t){const e=t.target;return this.isActive&&!this._isDestroyed&&this.closeOnClick&&!this.$refs.content.contains(e)},genActivatorAttributes(){const t=n["a"].options.methods.genActivatorAttributes.call(this);return this.activeTile&&this.activeTile.id?{...t,"aria-activedescendant":this.activeTile.id}:t},genActivatorListeners(){const t=p.options.methods.genActivatorListeners.call(this);return this.disableKeys||(t.keydown=this.onKeyDown),t},genTransition(){const t=this.genContent();return this.transition?this.$createElement("transition",{props:{name:this.transition}},[t]):t},genDirectives(){const t=[{name:"show",value:this.isContentActive}];return!this.openOnHover&&this.closeOnClick&&t.push({name:"click-outside",value:{handler:()=>{this.isActive=!1},closeConditional:this.closeConditional,include:()=>[this.$el,...this.getOpenDependentElements()]}}),t},genContent(){const t={attrs:{...this.getScopeIdAttrs(),role:"role"in this.$attrs?this.$attrs.role:"menu"},staticClass:"v-menu__content",class:{...this.rootThemeClasses,...this.roundedClasses,"v-menu__content--auto":this.auto,"v-menu__content--fixed":this.activatorFixed,menuable__content__active:this.isActive,[this.contentClass.trim()]:!0},style:this.styles,directives:this.genDirectives(),ref:"content",on:{click:t=>{const e=t.target;e.getAttribute("disabled")||this.closeOnContentClick&&(this.isActive=!1)},keydown:this.onKeyDown}};return this.$listeners.scroll&&(t.on=t.on||{},t.on.scroll=this.$listeners.scroll),!this.disabled&&this.openOnHover&&(t.on=t.on||{},t.on.mouseenter=this.mouseEnterHandler),this.openOnHover&&(t.on=t.on||{},t.on.mouseleave=this.mouseLeaveHandler),this.$createElement("div",t,this.getContentSlot())},getTiles(){this.$refs.content&&(this.tiles=Array.from(this.$refs.content.querySelectorAll(".v-list-item, .v-divider, .v-subheader")))},mouseEnterHandler(){this.runDelay("open",()=>{this.hasJustFocused||(this.hasJustFocused=!0)})},mouseLeaveHandler(t){this.runDelay("close",()=>{var e;(null===(e=this.$refs.content)||void 0===e?void 0:e.contains(t.relatedTarget))||requestAnimationFrame(()=>{this.isActive=!1,this.callDeactivate()})})},nextTile(){const t=this.tiles[this.listIndex+1];if(!t){if(!this.tiles.length)return;return this.listIndex=-1,void this.nextTile()}this.listIndex++,-1===t.tabIndex&&this.nextTile()},prevTile(){const t=this.tiles[this.listIndex-1];if(!t){if(!this.tiles.length)return;return this.listIndex=this.tiles.length,void this.prevTile()}this.listIndex--,-1===t.tabIndex&&this.prevTile()},lastTile(){const t=this.tiles[this.tiles.length-1];t&&(this.listIndex=this.tiles.length-1,-1===t.tabIndex&&this.prevTile())},firstTile(){const t=this.tiles[0];t&&(this.listIndex=0,-1===t.tabIndex&&this.nextTile())},onKeyDown(t){if(t.keyCode===u["w"].esc){setTimeout(()=>{this.isActive=!1});const t=this.getActivator();this.$nextTick(()=>t&&t.focus())}else!this.isActive&&[u["w"].up,u["w"].down].includes(t.keyCode)&&(this.isActive=!0);this.$nextTick(()=>this.changeListIndex(t))},onResize(){this.isActive&&(this.$refs.content.offsetWidth,this.updateDimensions(),clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(this.updateDimensions,100))}},render(t){const e={staticClass:"v-menu",class:{"v-menu--attached":""===this.attach||!0===this.attach||"attach"===this.attach},directives:[{arg:"500",name:"resize",value:this.onResize}]};return t("div",e,[!this.activator&&this.genActivator(),this.showLazyContent(()=>[this.$createElement(r["a"],{props:{root:!0,light:this.light,dark:this.dark}},[this.genTransition()])])])}})},e4cd:function(t,e,i){"use strict";var r=i("d9bd"),n=i("2b0e");e["a"]=n["a"].extend({name:"mobile",props:{mobileBreakpoint:{type:[Number,String],default(){return this.$vuetify?this.$vuetify.breakpoint.mobileBreakpoint:void 0},validator:t=>!isNaN(Number(t))||["xs","sm","md","lg","xl"].includes(String(t))}},computed:{isMobile(){const{mobile:t,width:e,name:i,mobileBreakpoint:r}=this.$vuetify.breakpoint;if(r===this.mobileBreakpoint)return t;const n=parseInt(this.mobileBreakpoint,10),o=!isNaN(n);return o?e<n:i===this.mobileBreakpoint}},created(){this.$attrs.hasOwnProperty("mobile-break-point")&&Object(r["d"])("mobile-break-point","mobile-breakpoint",this)}})},e4d3:function(t,e,i){"use strict";var r=i("2b0e");e["a"]=r["a"].extend({name:"returnable",props:{returnValue:null},data:()=>({isActive:!1,originalValue:null}),watch:{isActive(t){t?this.originalValue=this.returnValue:this.$emit("update:return-value",this.originalValue)}},methods:{save(t){this.originalValue=t,setTimeout(()=>{this.isActive=!1})}}})},e707:function(t,e,i){"use strict";i("3c93");var r=i("a9ad"),n=i("7560"),o=i("f2e7"),s=i("58df"),a=Object(s["a"])(r["a"],n["a"],o["a"]).extend({name:"v-overlay",props:{absolute:Boolean,color:{type:String,default:"#212121"},dark:{type:Boolean,default:!0},opacity:{type:[Number,String],default:.46},value:{default:!0},zIndex:{type:[Number,String],default:5}},computed:{__scrim(){const t=this.setBackgroundColor(this.color,{staticClass:"v-overlay__scrim",style:{opacity:this.computedOpacity}});return this.$createElement("div",t)},classes(){return{"v-overlay--absolute":this.absolute,"v-overlay--active":this.isActive,...this.themeClasses}},computedOpacity(){return Number(this.isActive?this.opacity:0)},styles(){return{zIndex:this.zIndex}}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-overlay__content"},this.$slots.default)}},render(t){const e=[this.__scrim];return this.isActive&&e.push(this.genContent()),t("div",{staticClass:"v-overlay",on:this.$listeners,class:this.classes,style:this.styles},e)}}),l=a,h=i("80d2"),c=i("2b0e");e["a"]=c["a"].extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(t){this.isActive&&(t?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const t=new l({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});t.$mount();const e=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");e&&e.insertBefore(t.$el,e.firstChild),this.overlay=t},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame(()=>{this.overlay&&(void 0!==this.activeZIndex?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=Object(h["t"])(this.$el)),this.overlay.value=!0)}),!0},removeOverlay(t=!0){this.overlay&&(Object(h["a"])(this.overlay.$el,"transitionend",()=>{this.overlay&&this.overlay.$el&&this.overlay.$el.parentNode&&!this.overlay.value&&!this.isActive&&(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)}),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),t&&this.showScroll()},scrollListener(t){if("key"in t){if(["INPUT","TEXTAREA","SELECT"].includes(t.target.tagName)||t.target.isContentEditable)return;const e=[h["w"].up,h["w"].pageup],i=[h["w"].down,h["w"].pagedown];if(e.includes(t.keyCode))t.deltaY=-1;else{if(!i.includes(t.keyCode))return;t.deltaY=1}}(t.target===this.overlay||"keydown"!==t.type&&t.target===document.body||this.checkPath(t))&&t.preventDefault()},hasScrollbar(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return(["auto","scroll"].includes(e.overflowY)||"SELECT"===t.tagName)&&t.scrollHeight>t.clientHeight||["auto","scroll"].includes(e.overflowX)&&t.scrollWidth>t.clientWidth},shouldScroll(t,e){if(t.hasAttribute("data-app"))return!1;const i=e.shiftKey||e.deltaX?"x":"y",r="y"===i?e.deltaY:e.deltaX||e.deltaY;let n,o;"y"===i?(n=0===t.scrollTop,o=t.scrollTop+t.clientHeight===t.scrollHeight):(n=0===t.scrollLeft,o=t.scrollLeft+t.clientWidth===t.scrollWidth);const s=r<0,a=r>0;return!(n||!s)||(!(o||!a)||!(!n&&!o)&&this.shouldScroll(t.parentNode,e))},isInside(t,e){return t===e||null!==t&&t!==document.body&&this.isInside(t.parentNode,e)},checkPath(t){const e=Object(h["g"])(t);if("keydown"===t.type&&e[0]===document.body){const e=this.$refs.dialog,i=window.getSelection().anchorNode;return!(e&&this.hasScrollbar(e)&&this.isInside(i,e))||!this.shouldScroll(e,t)}for(let i=0;i<e.length;i++){const r=e[i];if(r===document)return!0;if(r===document.documentElement)return!0;if(r===this.$refs.content)return!0;if(this.hasScrollbar(r))return!this.shouldScroll(r,t)}return!0},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):(Object(h["b"])(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}})},e9b1:function(t,e,i){},ee6f:function(t,e,i){},ee9d:function(t,e,i){},f289:function(t,e,i){"use strict";var r=function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"blocklyDiv",staticClass:"blocklyDiv"}),e("xml",{ref:"blocklyToolbox",staticStyle:{display:"none"}},[t._t("default")],2)],1)},n=[],o=i("54ca"),s=i.n(o),a=i("7724"),l=i.n(a),h=i("b7fd"),c=i.n(h);const u={};class d extends c.a.MetricsManager{constructor(t){super(t)}static setFixedEdges(t){u.top=!!t.top,u.bottom=!!t.bottom,u.left=!!t.left,u.right=!!t.right}hasFixedEdges(){return!0}getComputedFixedEdges_(t){const e=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically(),r=t||this.getViewMetrics(!1),n={top:u.top?0:void 0,bottom:u.bottom?0:void 0,left:u.left?0:void 0,right:u.right?0:void 0};return u.top&&u.bottom&&(n.bottom=r.height),u.left&&u.right&&(n.right=r.width),i||(void 0!==n.top?n.bottom=n.top+r.height:void 0!==n.bottom?n.top=n.bottom-r.height:(n.top=r.top,n.bottom=r.top+r.height)),e||(void 0!==n.left?n.right=n.left+r.width:void 0!==n.right?n.left=n.right-r.width:(n.left=r.left,n.right=r.left+r.width)),n}}var p=i("e07a"),f=i("560a");s.a.setLocale(f);var _={name:"BlocklyComponent",props:["robotController","projectId"],data(){return{robotCtr:null,workspace:null,isStop:!0,runNext:0,options:{media:"media/",zoom:{controls:!0,wheel:!1,startScale:1,maxScale:3,minScale:.8,scaleSpeed:1.2},trashcan:!1,scrollbars:!0,theme:"deuteranopia",renderer:"zelos",move:{scrollbars:{horizontal:!0,vertical:!0},drag:!0,wheel:!0},oneBasedIndex:!0,horizontalLayout:!0,toolboxPosition:"end",grid:{spacing:100,length:3,colour:"#ccc",snap:!0},toolbox:{kind:"flyoutToolbox",contents:[{kind:"block",type:"while_program_start"},{kind:"block",type:"move"},{kind:"block",type:"turn"},{kind:"block",type:"arc"},{kind:"block",type:"draw"},{kind:"block",type:"pencilcolor"},{kind:"block",type:"controls_repeat_ext"},{kind:"block",type:"controls_whileUntil"},{kind:"block",type:"controls_for"},{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_negate"},{kind:"block",type:"logic_boolean"},{kind:"sep",gap:"32"},{kind:"block",blockxml:"<block type='math_number'><field name='NUM'>10</field></block>"},{kind:"block",type:"math_arithmetic"},{kind:"block",type:"math_single"},{kind:"block",type:"text"},{kind:"block",type:"text_length"},{kind:"block",type:"text_print"},{kind:"block",type:"variables_get"},{kind:"block",type:"variables_set"}]}}}},methods:{runCodeClick(){console.log("runCodeClick"),this.isStop?window.step_btn():console.log("程序还没运行完，别急")},stopCodeClick(){console.log("stopCodeClick"),window.stop_btn()}},watch:{robotController(){this.robotCtr=this.$props.robotController},runNext(){this.runNext&&!this.isStop&&window.step_btn()}},mounted(){var t=this.options;t.toolbox||(t.toolbox=this.$refs["blocklyToolbox"]),this.robotCtr=this.$props.robotController,d.setFixedEdges({top:!0,left:!0}),t["plugins"]={metricsManager:d},this.workspace=s.a.inject(this.$refs["blocklyDiv"],t);var e=this;function i(t){t instanceof s.a.Events.Ui||u()}this.workspace.addChangeListener(i);var r=null;function n(t,i){var r=function(t){return e.isStop=!1,t=String(t||""),h(t)};t.setProperty(i,"highlightBlock",t.createNativeFunction(r));var n=t.nativeToPseudo({});t.setProperty(i,"robot",n);var s=function(){return e.isStop=!1,e.runNext+=1,o=!0,e.robotCtr.init()};t.setProperty(n,"init",t.createNativeFunction(s));var a=function(){return e.isStop=!0,o=!1,e.robotCtr.stop()};t.setProperty(n,"stop",t.createNativeFunction(a));var l=function(t){o=!0,e.robotCtr.moveBlockly(t,(function(t){p["a"].debugLog("result",t),o=!1,e.runNext+=1}))};t.setProperty(n,"move",t.createNativeFunction(l));var c=function(t,i){o=!0,e.robotCtr.turnBlockly(t,i,(function(t){p["a"].debugLog("result",t),o=!1,e.runNext+=1}))};t.setProperty(n,"turn",t.createNativeFunction(c));var u=function(t,i,r){o=!0,e.robotCtr.arcBlockly(t,i,r,(function(t){p["a"].debugLog("result",t),o=!1,e.runNext+=1}))};t.setProperty(n,"arc",t.createNativeFunction(u));var d=function(t){o=!0,e.robotCtr.drawableBlockly(t,(function(t){p["a"].debugLog("result",t),o=!1,e.runNext+=1}))};t.setProperty(n,"drawable",t.createNativeFunction(d))}var o=!1,a="";function h(t){e.workspace.highlightBlock(t),o=!1}function c(t){e.workspace.highlightBlock(null),o=!1,t&&p["a"].debugLog("clearOutput")}function u(){p["a"].debugLog("generateCodeAndLoadIntoInterpreter"),s.a.JavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n",s.a.JavaScript.addReservedWords("highlightBlock"),a=s.a.JavaScript.workspaceToCode(e.workspace),c(!0)}function f(){if(!r)return c(!0),p["a"].debugLog("latestCode",a),r=new l.a(a,n),void setTimeout((function(){o=!0,f()}),1);o=!1;do{try{var t=r.step()}finally{t||(p["a"].debugLog("代码执行完了"),r=null,c(!1))}}while(t&&!o)}function _(){e.isStop=!0,e.robotCtr.stop(),c(!0),o=!0,r=null}window.step_btn=f,window.stop_btn=_}},g=_,m=(i("c70c"),i("2877")),b=Object(m["a"])(g,r,n,!1,null,"1978aa07",null);e["a"]=b.exports},f32a:function(t,e,i){"use strict";var r=i("633b"),n=(i("b234"),i("dd4a")),o=i("6fcd"),s=i("8681"),a=i.n(s),l=i("e07a"),h=i("d722"),c=!1,u=null,d=null,p=null,f=null,_=null,g=null,m=null,b=null,v=null,y=null,T=null,O=null,E=null,A=1;const C=A/10;var x=50;const w=x/10;var M=.5,S=.5,I=.9;const P=9,R=.16,L=P*R,N=.8,k=.5;var D=512;const B=h["a"].simulatorUrl;var F=[];let V=null;var j=!1,H={async init(t,e){return p=t,V=e,this.initEngine(),this.initCamera(),this.initLights(),await this.initAmmo(),this.initGreenGround(),this.initGridPlane(),this.initPencilGround(),this.initSkyBox(),this.initCubes(),this.initButtons(),await this.initRobot(),this.dragListening(),c&&d.debugLayer.show(),d},async initAmmo(){const t=await a()();l["a"].debugLog("Ammo",t),d.enablePhysics(new r["Vector3"](0,-100,0),new r["AmmoJSPlugin"](!0,t)),d.onReadyObservable.add((function(){l["a"].debugLog("getPhysicsEngine",d.getPhysicsEngine()._physicsPlugin.bjsAMMO.btDefaultCollisionConfiguration()),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._collisionConfiguration),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._dispatcher),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._solver),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin.world)}))},bindRobotController(t){E=t},cleanDrawLines(){_=null,g=null,m=null,y=null,T=null,O=new r["Vector3"](0,0,0)},async retsetScene(){this.cleanDrawLines(),d.dispose(),this.initEngine(),c&&d.debugLayer.show(),this.initCamera(),this.initLights(),await this.initAmmo(),this.initGreenGround(),this.initGridPlane(),this.initPencilGround(),this.initSkyBox(),this.initCubes(),this.initButtons(),await this.initRobot(T),E.resetScene(d,T,O),E.initRobotPenclDynamicTexture(v),console.log("robotCotroller",E)},createDefaultEngine(){return new r["Engine"](p,!0,{preserveDrawingBuffer:!0,stencil:!0})},async resizeEngine(){await this.retsetScene(),f.resize()},initEngine(){if(f=this.createDefaultEngine(),!f)throw"engine should not be null.";d=new r["Scene"](f),this.customLoadingUI(),f.displayLoadingUI(),f.runRenderLoop((function(){d&&(d.render(),V.innerHTML="("+f.getFps().toFixed()+" fps)")})),window.addEventListener("resize",(function(){f.resize()}))},initCamera(){return _=new r["ArcRotateCamera"]("Camera",0,0,0,new r["Vector3"](0,0,0),d),_.setPosition(new r["Vector3"](-210*C,250*C,200*C)),_.upperBetaLimit=1.5,_.lowerRadiusLimit=20,_.upperRadiusLimit=500,_.wheelPrecision=5,_.pinchPrecision=20,d.activeCamera.panningSensibility=100,_.attachControl(p,!0),_},initLights(){var t=new r["HemisphericLight"]("light1",new r["Vector3"](0,10,0),d);t.specular=new r["Color3"](0,0,0),t.intensity=1},initGreenGround(){const t=100*A*L,e=50*t/2;var i=new r["StandardMaterial"]("texturePlane",d);i.diffuseColor=new r["Color3"](152/255,209/255,115/255),i.backFaceCulling=!1,i.freeze();var n=r["MeshBuilder"].CreateDisc("ground",{radius:e},d);return n.rotation.x=Math.PI/2,n.material=i,n.freezeWorldMatrix(),n.position.y=-.01,n.physicsImpostor=new r["PhysicsImpostor"](n,r["PhysicsImpostor"].BoxImpostor,{mass:0,restitution:k,friction:N},d),g=n,n},initGridPlane(){const t=100*A*L;var e=r["Mesh"].CreateGround("ground",t,t,1,d,!0),i=new n["GridMaterial"]("grid",d);i.freeze(),i.mainColor=r["Color3"].White(),i.alpha=1;const o=.95;i.lineColor=new r["Color3"](o,o,o),i.backFaceCulling=!0,i.majorUnitFrequency=t/P,i.minorUnitVisibility=0;const s=.5*t/P;return i.gridOffset=new r["Vector3"](s,0,s),e.material=i,m=e,e},getRobotPenclDynamicTexture(){return v},initPencilGround(){const t=100*A*L;var e=r["MeshBuilder"].CreateGround("pencilGround",{width:t,height:t,subdivisions:1},d);v=new r["DynamicTexture"]("dynamic texture",D,d);var i=new r["StandardMaterial"]("Mat",d);i.diffuseTexture=v,i.opacityTexture=v,i.specularColor=new r["Color3"](0,0,0),i.backFaceCulling=!1,i.useAlphaFromDiffuseTexture=!0,i.freeze(),e.material=i,e.rotation.y-=Math.PI,e.position.y+=.01,e.freezeWorldMatrix(),e.alphaIndex=0,e.physicsImpostor=new r["PhysicsImpostor"](e,r["PhysicsImpostor"].BoxImpostor,{mass:0,restitution:k,friction:N},d),b=e},initSkyBox(){const t=100*A*L,e=50*t;var i=new n["SkyMaterial"]("skyMaterial",d);i.backFaceCulling=!1,i.inclination=0,i.cameraOffset.y=e/10;var o=r["Mesh"].CreateBox("skyBox",e,d);return o.material=i,y=o,o},createBasicRoundedBox:function(t,e,i){let n=.25,o=.5,s=.5;const a=i,l=3.1*a/2,h=r["MeshBuilder"].CreateSphere("sphere",{diameter:l,segments:16},t),c=r["Mesh"].CreateBox("box",a,t),u=r["CSG"].FromMesh(c).intersect(r["CSG"].FromMesh(h));h.dispose(),c.dispose();const d=u.toMesh(e,new r["StandardMaterial"]("roundedBoxMaterial",t),t);return d.draggable=!0,d.physicsImpostor=new r["PhysicsImpostor"](d,r["PhysicsImpostor"].BoxImpostor,{mass:n,restitution:o,friction:s}),d.material.freeze(),d.material.specularColor=new r["Color3"](0,0,0),d.freezeWorldMatrix(),d},initCubes(){F=new r["TransformNode"]("cubes");const t=80*C;var e=this.createBasicRoundedBox(d,"cube",t);e.position._y+=t/2,e.position._x-=100,e.material=new r["StandardMaterial"]("amaterial",d),e.material.diffuseColor=new r["Color3"](16/255,156/255,73/255),F[0]=e;var i=this.createBasicRoundedBox(d,"cube2",t);i.position._y+=t/2,i.position._x-=100,i.position._z+=2*t,i.material=new r["StandardMaterial"]("amaterial",d),i.material.diffuseColor=new r["Color3"](48/255,.4,150/255),F[1]=i;var n=this.createBasicRoundedBox(d,"cube3",t);n.position._y+=t/2,n.position._x-=100,n.position._z-=2*t,n.material=new r["StandardMaterial"]("amaterial",d),n.material.diffuseColor=new r["Color3"](199/255,88/255,93/255),F[2]=n;let o=new r["ActionManager"](d);e.actionManager=o,i.actionManager=o,n.actionManager=o;var s=new r["HighlightLayer"]("hl1",d);o.registerAction(new r["ExecuteCodeAction"](r["ActionManager"].OnPointerOverTrigger,(function(t){var o=t.meshUnderPointer.id;o==e.name?s.addMesh(e,r["Color3"].White()):o==i.name?s.addMesh(i,r["Color3"].White()):o==n.name&&s.addMesh(n,r["Color3"].White())}))),o.registerAction(new r["ExecuteCodeAction"](r["ActionManager"].OnPointerOutTrigger,(function(t){var r=t.meshUnderPointer.id;r==e.name?s.removeMesh(e):r==i.name?s.removeMesh(i):r==n.name&&s.removeMesh(n)}))),d.freezeMaterials()},initButtons(){console.log("gui",o);var t=o["AdvancedDynamicTexture"].CreateFullscreenUI("UI",!0,d),e=o["Button"].CreateImageOnlyButton("but",B+"restart.png");e.height="60px",e.width="60px",e.thickness=0,e.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_RIGHT,e.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,e.top="-20px",e.left="-20px",e.onPointerClickObservable.add((function(){console.log("重启引擎"),H.resizeEngine()})),u=new o["Rectangle"]("speedSelect"),u.height="110px",u.width="60px",u.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_LEFT,u.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,u.top="-90px",u.left="20px",u.thickness=3,u.color="#505781",u.background="white",u.cornerRadius=15,u.isVisible=!1;var i=o["Button"].CreateImageOnlyButton("slowlyBtn",B+"turtle.png");i.width="30px",i.height="30px",i.thickness=0,i.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_TOP,i.top=15,i.onPointerClickObservable.add((function(){console.log("slowImg click"),a.source=B+"turtle.png",E.setSpeed(1),u.isVisible=!1}));var r=o["Button"].CreateImageOnlyButton("fastBtn",B+"rabbit.png");r.width="30px",r.height="30px",r.thickness=0,r.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,r.top=-15,r.onPointerClickObservable.add((function(){console.log("fastImg click"),a.source=B+"rabbit.png",E.setSpeed(6),u.isVisible=!1})),u.addControl(i),u.addControl(r);var n=new o["Button"]("speedBtn");n.height="60px",n.width="60px",n.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_LEFT,n.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,n.top="-20px",n.left="20px",n.thickness=0,n.onPointerClickObservable.add((function(){u.isVisible=!u.isVisible,u.isVisible&&(j=!0)})),n.isPointerBlocker=!0;var s=new o["Ellipse"];s.width="60px",s.height="60px",s.color="#505781",s.thickness=3,s.background="white";var a=new o["Image"]("currentSpeedBtn",B+"turtle.png");a.width="30px",a.height="30px",a.thickness=0,n.addControl(s),n.addControl(a),t._shouldBlockPointer=!1,t.addControl(e),t.addControl(n),t.addControl(u)},makePhysicsObjects(t,e,i,n){var o=new r["Mesh"]("robot",e);t.forEach(t=>{null==t.parent&&o.addChild(t)}),o.getChildMeshes().forEach(t=>{t.scaling.x=Math.abs(t.scaling.x),t.scaling.y=Math.abs(t.scaling.y),t.scaling.z=Math.abs(t.scaling.z),t.physicsImpostor=new r["PhysicsImpostor"](t,r["PhysicsImpostor"].BoxImpostor,{mass:.1},e)}),o.scaling.scaleInPlace(i),o.physicsImpostor=new r["PhysicsImpostor"](o,r["PhysicsImpostor"].NoImpostor,{mass:M,friction:S,restitution:I},e);const s=-n.y/1.1;return o.physicsImpostor.setDeltaPosition(new r["Vector3"](0,s,0)),o.position.subtractInPlace(new r["Vector3"](0,-s,0)),o},async initRobot(){const t="sportcar.babylon";console.log("api.modelUrl",h["a"].modelUrl);var e=await r["SceneLoader"].ImportMeshAsync(null,h["a"].modelUrl,t,d),i=e.meshes,n=l["a"].getMeshFromMeshs(i,"Glass_Plane.006");console.log("robotBody",n);var o=l["a"].getMeshSize(n);console.log("robotSize",o);var s=new r["Mesh"]("robot",d),a=new r["Mesh"]("pencil"),c=[];c[0]=new r["Vector4"](0,0,0,0),c[1]=new r["Vector4"](1,.2,0,1),c[2]=new r["Vector4"](0,0,.25,1);var u=[];u[0]=new r["Color4"](.5,.5,.5,1),u[2]=new r["Color3"](16/255,156/255,73/255);var p=4*o.y,_=o.y/2,g=.3*o.x,m=r["MeshBuilder"].CreateCylinder("cylinder",{height:p,diameter:g,faceUV:c,faceColors:u,updatable:!0},d);m.position._y=p/2+_,m.rotation._y=m.rotation._y+Math.PI/2;var b=new r["StandardMaterial"]("material",d);b.diffuseTexture=new r["Texture"](B+"marker.png",d),m.material=b,b.freeze(),m.parent=a;var v=.8*g,y=g,O=p/20,E=50,C=r["Mesh"].CreateCylinder("inner",O,v,v,E,1,d,!0),x=r["Mesh"].CreateCylinder("outer",O,y,y,E,1,d,!0),M=r["CSG"].FromMesh(C),S=r["CSG"].FromMesh(x),I=S.subtract(M),P=new r["StandardMaterial"]("mat0",d),R=I.toMesh("csg2",P,d);R.material.mainColor=new r["Color3"](0,1,0);var L=new r["StandardMaterial"]("outinMaterial",d);L.diffuseColor=new r["Color3"](16/255,156/255,73/255),L.freeze(),R.material=L,R.position._y=p+_+O/2,R.parent=a,C.scaling._z=.7,C.scaling._x=.7,C.material=L,C.position=R.position,C.parent=a,x.dispose(),i.push(a);var N=this.makePhysicsObjects(i,d,w,o);console.log("physicsRoot",N);var k=N;s=k,f.hideLoadingUI();var D=document.getElementById("customLoadingScreenDiv");return D&&(D.outerHTML=""),setTimeout((function(){H.ArcAnimation(0,0,470*A/5)}),1500),s.freezeWorldMatrix(),s.position.y+=.1,T=s,s},getRobot(){return T},getStartPoint(){return O},customLoadingUI(){r["DefaultLoadingScreen"].prototype.displayLoadingUI=function(){if(document.getElementById("customLoadingScreenDiv"))document.getElementById("customLoadingScreenDiv").style.display="initial";else{this._loadingDiv=document.createElement("div"),this._loadingDiv.id="customLoadingScreenDiv",this._loadingDiv.style.background="#505781",this._loadingDiv.style.height="100%",this._loadingDiv.style.width="700px",this._loadingDiv.style.alignContent="center",this._loadingDiv.style.zIndex="10006";var t=new Image;t.src=B+"loading.gif",t.style.padding="15%",t.style.paddingTop="30%",this._loadingDiv.appendChild(t),this._resizeLoadingUI(),window.addEventListener("resize",this._resizeLoadingUI),document.body.appendChild(this._loadingDiv)}}},ArcAnimation(t,e,i){var n=new r["Animation"]("animCam","alpha",30,r["Animation"].ANIMATIONTYPE_FLOAT,r["Animation"].ANIMATIONLOOPMODE_CYCLE),o=[];o.push({frame:0,value:_.alpha}),o.push({frame:100,value:t});var s=new r["Animation"]("animCam","beta",30,r["Animation"].ANIMATIONTYPE_FLOAT,r["Animation"].ANIMATIONLOOPMODE_CYCLE),a=[];a.push({frame:0,value:_.beta}),a.push({frame:100,value:e});var l=new r["Animation"]("animCam","radius",30,r["Animation"].ANIMATIONTYPE_FLOAT,r["Animation"].ANIMATIONLOOPMODE_CYCLE),h=[];h.push({frame:0,value:_.radius}),h.push({frame:100,value:i}),n.setKeys(o),s.setKeys(a),l.setKeys(h),_.animations.push(n),_.animations.push(s),_.animations.push(l),d.beginAnimation(_,0,100,!1,6,(function(){}))},dragListening(t){var e,i=f.getRenderingCanvas(),r=function(){var t=d.pick(d.pointerX,d.pointerY,(function(t){return t==m||t==b||t==g}));return t.hit?t.pickedPoint:null},n=function(n){if(0===n.button){var o=d.pick(d.pointerX,d.pointerY,(function(t){return t!==m&&t!==b&&t!==y&&t!==g}));console.log("pickInfo",o),o.hit&&(d.stopAnimation(parent),e=o.pickedMesh,null==e.parent?console.log("no parent"):"robot"==e.parent.name?e=e.parent:"pencil"==e.parent.name&&(e=e.parent.parent),console.log("currentMesh",e),t=r(n),t&&setTimeout((function(){_.detachControl(i)}),0))}},o=function(){if(j&&(j=!1,u.isVisible=!1),t)return _.attachControl(i,!0),void(t=null)},s=function(i){if(t){var n=r(i);if(n){var o=n.subtract(t);e.position.addInPlace(o),console.log("currentMesh.name",e.name),t=n}}};i.addEventListener("pointerdown",n,!1),i.addEventListener("pointerup",o,!1),i.addEventListener("pointermove",s,!1),O=t}};e["a"]=H},f774:function(t,e,i){"use strict";i("7958");var r=i("adda"),n=i("3a66"),o=i("a9ad"),s=i("b848"),a=i("e4cd"),l=i("e707"),h=i("d10f"),c=i("7560"),u=i("a293"),d=i("dc22"),p=i("c3f0"),f=i("80d2"),_=i("58df");const g=Object(_["a"])(Object(n["a"])("left",["isActive","isMobile","miniVariant","expandOnHover","permanent","right","temporary","width"]),o["a"],s["a"],a["a"],l["a"],h["a"],c["a"]);e["a"]=g.extend({name:"v-navigation-drawer",directives:{ClickOutside:u["a"],Resize:d["a"],Touch:p["a"]},provide(){return{isInNav:"nav"===this.tag}},props:{bottom:Boolean,clipped:Boolean,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,height:{type:[Number,String],default(){return this.app?"100vh":"100%"}},miniVariant:Boolean,miniVariantWidth:{type:[Number,String],default:56},permanent:Boolean,right:Boolean,src:{type:[String,Object],default:""},stateless:Boolean,tag:{type:String,default(){return this.app?"nav":"aside"}},temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},value:null},data:()=>({isMouseover:!1,touchArea:{left:0,right:0},stackMinZIndex:6}),computed:{applicationProperty(){return this.right?"right":"left"},classes(){return{"v-navigation-drawer":!0,"v-navigation-drawer--absolute":this.absolute,"v-navigation-drawer--bottom":this.bottom,"v-navigation-drawer--clipped":this.clipped,"v-navigation-drawer--close":!this.isActive,"v-navigation-drawer--fixed":!this.absolute&&(this.app||this.fixed),"v-navigation-drawer--floating":this.floating,"v-navigation-drawer--is-mobile":this.isMobile,"v-navigation-drawer--is-mouseover":this.isMouseover,"v-navigation-drawer--mini-variant":this.isMiniVariant,"v-navigation-drawer--custom-mini-variant":56!==Number(this.miniVariantWidth),"v-navigation-drawer--open":this.isActive,"v-navigation-drawer--open-on-hover":this.expandOnHover,"v-navigation-drawer--right":this.right,"v-navigation-drawer--temporary":this.temporary,...this.themeClasses}},computedMaxHeight(){if(!this.hasApp)return null;const t=this.$vuetify.application.bottom+this.$vuetify.application.footer+this.$vuetify.application.bar;return this.clipped?t+this.$vuetify.application.top:t},computedTop(){if(!this.hasApp)return 0;let t=this.$vuetify.application.bar;return t+=this.clipped?this.$vuetify.application.top:0,t},computedTransform(){return this.isActive?0:this.isBottom||this.right?100:-100},computedWidth(){return this.isMiniVariant?this.miniVariantWidth:this.width},hasApp(){return this.app&&!this.isMobile&&!this.temporary},isBottom(){return this.bottom&&this.isMobile},isMiniVariant(){return!this.expandOnHover&&this.miniVariant||this.expandOnHover&&!this.isMouseover},isMobile(){return!this.stateless&&!this.permanent&&a["a"].options.computed.isMobile.call(this)},reactsToClick(){return!this.stateless&&!this.permanent&&(this.isMobile||this.temporary)},reactsToMobile(){return this.app&&!this.disableResizeWatcher&&!this.permanent&&!this.stateless&&!this.temporary},reactsToResize(){return!this.disableResizeWatcher&&!this.stateless},reactsToRoute(){return!this.disableRouteWatcher&&!this.stateless&&(this.temporary||this.isMobile)},showOverlay(){return!this.hideOverlay&&this.isActive&&(this.isMobile||this.temporary)},styles(){const t=this.isBottom?"translateY":"translateX";return{height:Object(f["h"])(this.height),top:this.isBottom?"auto":Object(f["h"])(this.computedTop),maxHeight:null!=this.computedMaxHeight?`calc(100% - ${Object(f["h"])(this.computedMaxHeight)})`:void 0,transform:`${t}(${Object(f["h"])(this.computedTransform,"%")})`,width:Object(f["h"])(this.computedWidth)}}},watch:{$route:"onRouteChange",isActive(t){this.$emit("input",t)},isMobile(t,e){!t&&this.isActive&&!this.temporary&&this.removeOverlay(),null!=e&&this.reactsToResize&&this.reactsToMobile&&(this.isActive=!t)},permanent(t){t&&(this.isActive=!0)},showOverlay(t){t?this.genOverlay():this.removeOverlay()},value(t){this.permanent||(null!=t?t!==this.isActive&&(this.isActive=t):this.init())},expandOnHover:"updateMiniVariant",isMouseover(t){this.updateMiniVariant(!t)}},beforeMount(){this.init()},methods:{calculateTouchArea(){const t=this.$el.parentNode;if(!t)return;const e=t.getBoundingClientRect();this.touchArea={left:e.left+50,right:e.right-50}},closeConditional(){return this.isActive&&!this._isDestroyed&&this.reactsToClick},genAppend(){return this.genPosition("append")},genBackground(){const t={height:"100%",width:"100%",src:this.src},e=this.$scopedSlots.img?this.$scopedSlots.img(t):this.$createElement(r["a"],{props:t});return this.$createElement("div",{staticClass:"v-navigation-drawer__image"},[e])},genDirectives(){const t=[{name:"click-outside",value:{handler:()=>{this.isActive=!1},closeConditional:this.closeConditional,include:this.getOpenDependentElements}}];return this.touchless||this.stateless||t.push({name:"touch",value:{parent:!0,left:this.swipeLeft,right:this.swipeRight}}),t},genListeners(){const t={mouseenter:()=>this.isMouseover=!0,mouseleave:()=>this.isMouseover=!1,transitionend:t=>{if(t.target!==t.currentTarget)return;this.$emit("transitionend",t);const e=document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}};return this.miniVariant&&(t.click=()=>this.$emit("update:mini-variant",!1)),t},genPosition(t){const e=Object(f["r"])(this,t);return e?this.$createElement("div",{staticClass:"v-navigation-drawer__"+t},e):e},genPrepend(){return this.genPosition("prepend")},genContent(){return this.$createElement("div",{staticClass:"v-navigation-drawer__content"},this.$slots.default)},genBorder(){return this.$createElement("div",{staticClass:"v-navigation-drawer__border"})},init(){this.permanent?this.isActive=!0:this.stateless||null!=this.value?this.isActive=this.value:this.temporary||(this.isActive=!this.isMobile)},onRouteChange(){this.reactsToRoute&&this.closeConditional()&&(this.isActive=!1)},swipeLeft(t){this.isActive&&this.right||(this.calculateTouchArea(),Math.abs(t.touchendX-t.touchstartX)<100||(this.right&&t.touchstartX>=this.touchArea.right?this.isActive=!0:!this.right&&this.isActive&&(this.isActive=!1)))},swipeRight(t){this.isActive&&!this.right||(this.calculateTouchArea(),Math.abs(t.touchendX-t.touchstartX)<100||(!this.right&&t.touchstartX<=this.touchArea.left?this.isActive=!0:this.right&&this.isActive&&(this.isActive=!1)))},updateApplication(){if(!this.isActive||this.isMobile||this.temporary||!this.$el)return 0;const t=Number(this.miniVariant?this.miniVariantWidth:this.width);return isNaN(t)?this.$el.clientWidth:t},updateMiniVariant(t){this.expandOnHover&&this.miniVariant!==t&&this.$emit("update:mini-variant",t)}},render(t){const e=[this.genPrepend(),this.genContent(),this.genAppend(),this.genBorder()];return(this.src||Object(f["r"])(this,"img"))&&e.unshift(this.genBackground()),t(this.tag,this.setBackgroundColor(this.color,{class:this.classes,style:this.styles,directives:this.genDirectives(),on:this.genListeners()}),e)}})}}]);
//# sourceMappingURL=chunk-469ec564.d0f218e7.js.map