(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47e17d80","chunk-2d0db847","chunk-2d0c8988"],{"00d8":function(e,t){(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,i=0;r<e.length;r++,i+=8)t[i>>>5]|=e[r]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var n=e[i]<<16|e[i+1]<<8|e[i+2],o=0;o<4;o++)8*i+6*o<=8*e.length?r.push(t.charAt(n>>>6*(3-o)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],i=0,n=0;i<e.length;n=++i%4)0!=n&&r.push((t.indexOf(e.charAt(i-1))&Math.pow(2,-2*n+8)-1)<<2*n|t.indexOf(e.charAt(i))>>>6-2*n);return r}};e.exports=r})()},"044b":function(e,t){function r(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&r(e.slice(0,0))}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},"0789":function(e,t,r){"use strict";r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return d}));var i=r("d9f7");function n(e=[],...t){return Array().concat(e,...t)}function o(e,t="top center 0",r){return{name:e,functional:!0,props:{group:{type:Boolean,default:!1},hideOnLeave:{type:Boolean,default:!1},leaveAbsolute:{type:Boolean,default:!1},mode:{type:String,default:r},origin:{type:String,default:t}},render(t,r){const o="transition"+(r.props.group?"-group":""),s={props:{name:e,mode:r.props.mode},on:{beforeEnter(e){e.style.transformOrigin=r.props.origin,e.style.webkitTransformOrigin=r.props.origin}}};return r.props.leaveAbsolute&&(s.on.leave=n(s.on.leave,e=>{const{offsetTop:t,offsetLeft:r,offsetWidth:i,offsetHeight:n}=e;e._transitionInitialStyles={position:e.style.position,top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height},e.style.position="absolute",e.style.top=t+"px",e.style.left=r+"px",e.style.width=i+"px",e.style.height=n+"px"}),s.on.afterLeave=n(s.on.afterLeave,e=>{if(e&&e._transitionInitialStyles){const{position:t,top:r,left:i,width:n,height:o}=e._transitionInitialStyles;delete e._transitionInitialStyles,e.style.position=t||"",e.style.top=r||"",e.style.left=i||"",e.style.width=n||"",e.style.height=o||""}})),r.props.hideOnLeave&&(s.on.leave=n(s.on.leave,e=>{e.style.setProperty("display","none","important")})),t(o,Object(i["a"])(r.data,s),r.children)}}}function s(e,t,r="in-out"){return{name:e,functional:!0,props:{mode:{type:String,default:r}},render(r,n){return r("transition",Object(i["a"])(n.data,{props:{name:e},on:t}),n.children)}}}var a=r("80d2"),l=function(e="",t=!1){const r=t?"width":"height",i="offset"+Object(a["D"])(r);return{beforeEnter(e){e._parent=e.parentNode,e._initialStyle={transition:e.style.transition,overflow:e.style.overflow,[r]:e.style[r]}},enter(t){const n=t._initialStyle;t.style.setProperty("transition","none","important"),t.style.overflow="hidden";const o=t[i]+"px";t.style[r]="0",t.offsetHeight,t.style.transition=n.transition,e&&t._parent&&t._parent.classList.add(e),requestAnimationFrame(()=>{t.style[r]=o})},afterEnter:o,enterCancelled:o,leave(e){e._initialStyle={transition:"",overflow:e.style.overflow,[r]:e.style[r]},e.style.overflow="hidden",e.style[r]=e[i]+"px",e.offsetHeight,requestAnimationFrame(()=>e.style[r]="0")},afterLeave:n,leaveCancelled:n};function n(t){e&&t._parent&&t._parent.classList.remove(e),o(t)}function o(e){const t=e._initialStyle[r];e.style.overflow=e._initialStyle.overflow,null!=t&&(e.style[r]=t),delete e._initialStyle}};o("carousel-transition"),o("carousel-reverse-transition"),o("tab-transition"),o("tab-reverse-transition"),o("menu-transition"),o("fab-transition","center center","out-in"),o("dialog-transition"),o("dialog-bottom-transition"),o("dialog-top-transition");const h=o("fade-transition"),u=(o("scale-transition"),o("scroll-x-transition"),o("scroll-x-reverse-transition"),o("scroll-y-transition"),o("scroll-y-reverse-transition"),o("slide-x-transition")),c=(o("slide-x-reverse-transition"),o("slide-y-transition"),o("slide-y-reverse-transition"),s("expand-transition",l())),d=s("expand-x-transition",l("",!0))},"169a":function(e,t,r){"use strict";r("368e");var i=r("480e"),n=r("4ad4"),o=r("b848"),s=r("75eb"),a=r("e707"),l=r("e4d3"),h=r("21be"),u=r("a293"),c=r("58df"),d=r("d9bd"),p=r("80d2");const f=Object(c["a"])(o["a"],s["a"],a["a"],l["a"],h["a"],n["a"]);t["a"]=f.extend({name:"v-dialog",directives:{ClickOutside:u["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:[String,Number],noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:[String,Number]},data(){return{activatedBy:null,animate:!1,animateTimeout:-1,stackMinZIndex:200,previousActiveElement:null}},computed:{classes(){return{[("v-dialog "+this.contentClass).trim()]:!0,"v-dialog--active":this.isActive,"v-dialog--persistent":this.persistent,"v-dialog--fullscreen":this.fullscreen,"v-dialog--scrollable":this.scrollable,"v-dialog--animated":this.animate}},contentClasses(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive(e){var t;e?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null===(t=this.previousActiveElement)||void 0===t||t.focus())},fullscreen(e){this.isActive&&(e?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created(){this.$attrs.hasOwnProperty("full-width")&&Object(d["e"])("full-width",this)},beforeMount(){this.$nextTick(()=>{this.isBooted=this.isActive,this.isActive&&this.show()})},beforeDestroy(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick(){this.animate=!1,this.$nextTick(()=>{this.animate=!0,window.clearTimeout(this.animateTimeout),this.animateTimeout=window.setTimeout(()=>this.animate=!1,150)})},closeConditional(e){const t=e.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(t)||this.overlay&&t&&!this.overlay.$el.contains(t))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):a["a"].options.methods.hideScroll.call(this)},show(){!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick(()=>{this.$nextTick(()=>{var e,t;(null===(e=this.$refs.dialog)||void 0===e?void 0:e.contains(document.activeElement))||(this.previousActiveElement=document.activeElement,null===(t=this.$refs.dialog)||void 0===t||t.focus()),this.bind()})})},bind(){window.addEventListener("focusin",this.onFocusin)},unbind(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside(e){this.$emit("click:outside",e),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown(e){if(e.keyCode===p["w"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;const e=this.getActivator();this.$nextTick(()=>e&&e.focus())}this.$emit("keydown",e)},onFocusin(e){if(!e||!this.retainFocus)return;const t=e.target;if(t&&this.$refs.dialog&&![document,this.$refs.dialog].includes(t)&&!this.$refs.dialog.contains(t)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some(e=>e.contains(t))){const e=this.$refs.dialog.querySelectorAll('button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])'),t=[...e].find(e=>!e.hasAttribute("disabled")&&!e.matches('[tabindex="-1"]'));t&&t.focus()}},genContent(){return this.showLazyContent(()=>[this.$createElement(i["a"],{props:{root:!0,light:this.light,dark:this.dark}},[this.$createElement("div",{class:this.contentClasses,attrs:{role:"dialog","aria-modal":this.hideOverlay?void 0:"true",...this.getScopeIdAttrs()},on:{keydown:this.onKeydown},style:{zIndex:this.activeZIndex},ref:"content"},[this.genTransition()])])])},genTransition(){const e=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[e]):e},genInnerContent(){const e={class:this.classes,attrs:{tabindex:this.isActive?0:void 0},ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(e.style={...e.style,maxWidth:Object(p["h"])(this.maxWidth),width:Object(p["h"])(this.width)}),this.$createElement("div",e,this.getContentSlot())}},render(e){return e("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},[this.genActivator(),this.genContent()])}})},"16b7":function(e,t,r){"use strict";var i=r("2b0e");t["a"]=i["a"].extend().extend({name:"delayable",props:{openDelay:{type:[Number,String],default:0},closeDelay:{type:[Number,String],default:0}},data:()=>({openTimeout:void 0,closeTimeout:void 0}),methods:{clearDelay(){clearTimeout(this.openTimeout),clearTimeout(this.closeTimeout)},runDelay(e,t){this.clearDelay();const r=parseInt(this[e+"Delay"],10);this[e+"Timeout"]=setTimeout(t||(()=>{this.isActive={open:!0,close:!1}[e]}),r)}}})},"1b2c":function(e,t,r){},"20f6":function(e,t,r){},"21be":function(e,t,r){"use strict";var i=r("2b0e"),n=r("80d2");t["a"]=i["a"].extend().extend({name:"stackable",data(){return{stackElement:null,stackExclude:null,stackMinZIndex:0,isActive:!1}},computed:{activeZIndex(){if("undefined"===typeof window)return 0;const e=this.stackElement||this.$refs.content,t=this.isActive?this.getMaxZIndex(this.stackExclude||[e])+2:Object(n["t"])(e);return null==t?t:parseInt(t)}},methods:{getMaxZIndex(e=[]){const t=this.$el,r=[this.stackMinZIndex,Object(n["t"])(t)],i=[...document.getElementsByClassName("v-menu__content--active"),...document.getElementsByClassName("v-dialog__content--active")];for(let o=0;o<i.length;o++)e.includes(i[o])||r.push(Object(n["t"])(i[o]));return Math.max(...r)}}})},"297c":function(e,t,r){"use strict";var i=r("2b0e"),n=r("37c6");t["a"]=i["a"].extend().extend({name:"loadable",props:{loading:{type:[Boolean,String],default:!1},loaderHeight:{type:[Number,String],default:2}},methods:{genProgress(){return!1===this.loading?null:this.$slots.progress||this.$createElement(n["a"],{props:{absolute:!0,color:!0===this.loading||""===this.loading?this.color||"primary":this.loading,height:this.loaderHeight,indeterminate:!0}})}}})},"2bf3":function(e,t,r){},"2fa4":function(e,t,r){"use strict";r("20f6");var i=r("80d2");t["a"]=Object(i["i"])("spacer","div","v-spacer")},"368e":function(e,t,r){},"37c6":function(e,t,r){"use strict";r("6ece");var i=r("0789"),n=r("90a2"),o=r("a9ad"),s=r("fe6c"),a=r("a452"),l=r("7560"),h=r("80d2"),u=r("58df");const c=Object(u["a"])(o["a"],Object(s["b"])(["absolute","fixed","top","bottom"]),a["a"],l["a"]);var d=c.extend({name:"v-progress-linear",directives:{intersect:n["a"]},props:{active:{type:Boolean,default:!0},backgroundColor:{type:String,default:null},backgroundOpacity:{type:[Number,String],default:null},bufferValue:{type:[Number,String],default:100},color:{type:String,default:"primary"},height:{type:[Number,String],default:4},indeterminate:Boolean,query:Boolean,reverse:Boolean,rounded:Boolean,stream:Boolean,striped:Boolean,value:{type:[Number,String],default:0}},data(){return{internalLazyValue:this.value||0,isVisible:!0}},computed:{__cachedBackground(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor||this.color,{staticClass:"v-progress-linear__background",style:this.backgroundStyle}))},__cachedBar(){return this.$createElement(this.computedTransition,[this.__cachedBarType])},__cachedBarType(){return this.indeterminate?this.__cachedIndeterminate:this.__cachedDeterminate},__cachedBuffer(){return this.$createElement("div",{staticClass:"v-progress-linear__buffer",style:this.styles})},__cachedDeterminate(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__determinate",style:{width:Object(h["h"])(this.normalizedValue,"%")}}))},__cachedIndeterminate(){return this.$createElement("div",{staticClass:"v-progress-linear__indeterminate",class:{"v-progress-linear__indeterminate--active":this.active}},[this.genProgressBar("long"),this.genProgressBar("short")])},__cachedStream(){return this.stream?this.$createElement("div",this.setTextColor(this.color,{staticClass:"v-progress-linear__stream",style:{width:Object(h["h"])(100-this.normalizedBuffer,"%")}})):null},backgroundStyle(){const e=null==this.backgroundOpacity?this.backgroundColor?1:.3:parseFloat(this.backgroundOpacity);return{opacity:e,[this.isReversed?"right":"left"]:Object(h["h"])(this.normalizedValue,"%"),width:Object(h["h"])(Math.max(0,this.normalizedBuffer-this.normalizedValue),"%")}},classes(){return{"v-progress-linear--absolute":this.absolute,"v-progress-linear--fixed":this.fixed,"v-progress-linear--query":this.query,"v-progress-linear--reactive":this.reactive,"v-progress-linear--reverse":this.isReversed,"v-progress-linear--rounded":this.rounded,"v-progress-linear--striped":this.striped,"v-progress-linear--visible":this.isVisible,...this.themeClasses}},computedTransition(){return this.indeterminate?i["c"]:i["d"]},isReversed(){return this.$vuetify.rtl!==this.reverse},normalizedBuffer(){return this.normalize(this.bufferValue)},normalizedValue(){return this.normalize(this.internalLazyValue)},reactive(){return Boolean(this.$listeners.change)},styles(){const e={};return this.active||(e.height=0),this.indeterminate||100===parseFloat(this.normalizedBuffer)||(e.width=Object(h["h"])(this.normalizedBuffer,"%")),e}},methods:{genContent(){const e=Object(h["r"])(this,"default",{value:this.internalLazyValue});return e?this.$createElement("div",{staticClass:"v-progress-linear__content"},e):null},genListeners(){const e=this.$listeners;return this.reactive&&(e.click=this.onClick),e},genProgressBar(e){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-progress-linear__indeterminate",class:{[e]:!0}}))},onClick(e){if(!this.reactive)return;const{width:t}=this.$el.getBoundingClientRect();this.internalValue=e.offsetX/t*100},onObserve(e,t,r){this.isVisible=r},normalize(e){return e<0?0:e>100?100:parseFloat(e)}},render(e){const t={staticClass:"v-progress-linear",attrs:{role:"progressbar","aria-valuemin":0,"aria-valuemax":this.normalizedBuffer,"aria-valuenow":this.indeterminate?void 0:this.normalizedValue},class:this.classes,directives:[{name:"intersect",value:this.onObserve}],style:{bottom:this.bottom?0:void 0,height:this.active?Object(h["h"])(this.height):0,top:this.top?0:void 0},on:this.genListeners()};return e("div",t,[this.__cachedStream,this.__cachedBackground,this.__cachedBuffer,this.__cachedBar,this.genContent()])}});t["a"]=d},"38cb":function(e,t,r){"use strict";var i=r("a9ad"),n=r("7560"),o=r("3206"),s=r("80d2"),a=r("d9bd"),l=r("58df");const h=Object(l["a"])(i["a"],Object(o["a"])("form"),n["a"]);t["a"]=h.extend({name:"validatable",props:{disabled:Boolean,error:Boolean,errorCount:{type:[Number,String],default:1},errorMessages:{type:[String,Array],default:()=>[]},messages:{type:[String,Array],default:()=>[]},readonly:Boolean,rules:{type:Array,default:()=>[]},success:Boolean,successMessages:{type:[String,Array],default:()=>[]},validateOnBlur:Boolean,value:{required:!1}},data(){return{errorBucket:[],hasColor:!1,hasFocused:!1,hasInput:!1,isFocused:!1,isResetting:!1,lazyValue:this.value,valid:!1}},computed:{computedColor(){if(!this.isDisabled)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},hasError(){return this.internalErrorMessages.length>0||this.errorBucket.length>0||this.error},hasSuccess(){return this.internalSuccessMessages.length>0||this.success},externalError(){return this.internalErrorMessages.length>0||this.error},hasMessages(){return this.validationTarget.length>0},hasState(){return!this.isDisabled&&(this.hasSuccess||this.shouldValidate&&this.hasError)},internalErrorMessages(){return this.genInternalMessages(this.errorMessages)},internalMessages(){return this.genInternalMessages(this.messages)},internalSuccessMessages(){return this.genInternalMessages(this.successMessages)},internalValue:{get(){return this.lazyValue},set(e){this.lazyValue=e,this.$emit("input",e)}},isDisabled(){return this.disabled||!!this.form&&this.form.disabled},isInteractive(){return!this.isDisabled&&!this.isReadonly},isReadonly(){return this.readonly||!!this.form&&this.form.readonly},shouldValidate(){return!!this.externalError||!this.isResetting&&(this.validateOnBlur?this.hasFocused&&!this.isFocused:this.hasInput||this.hasFocused)},validations(){return this.validationTarget.slice(0,Number(this.errorCount))},validationState(){if(!this.isDisabled)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":this.hasColor?this.computedColor:void 0},validationTarget(){return this.internalErrorMessages.length>0?this.internalErrorMessages:this.successMessages&&this.successMessages.length>0?this.internalSuccessMessages:this.messages&&this.messages.length>0?this.internalMessages:this.shouldValidate?this.errorBucket:[]}},watch:{rules:{handler(e,t){Object(s["j"])(e,t)||this.validate()},deep:!0},internalValue(){this.hasInput=!0,this.validateOnBlur||this.$nextTick(this.validate)},isFocused(e){e||this.isDisabled||(this.hasFocused=!0,this.validateOnBlur&&this.$nextTick(this.validate))},isResetting(){setTimeout(()=>{this.hasInput=!1,this.hasFocused=!1,this.isResetting=!1,this.validate()},0)},hasError(e){this.shouldValidate&&this.$emit("update:error",e)},value(e){this.lazyValue=e}},beforeMount(){this.validate()},created(){this.form&&this.form.register(this)},beforeDestroy(){this.form&&this.form.unregister(this)},methods:{genInternalMessages(e){return e?Array.isArray(e)?e:[e]:[]},reset(){this.isResetting=!0,this.internalValue=Array.isArray(this.internalValue)?[]:null},resetValidation(){this.isResetting=!0},validate(e=!1,t){const r=[];t=t||this.internalValue,e&&(this.hasInput=this.hasFocused=!0);for(let i=0;i<this.rules.length;i++){const e=this.rules[i],n="function"===typeof e?e(t):e;!1===n||"string"===typeof n?r.push(n||""):"boolean"!==typeof n&&Object(a["b"])(`Rules should return a string or boolean, received '${typeof n}' instead`,this)}return this.errorBucket=r,this.valid=0===r.length,this.valid}}})},"3c93":function(e,t,r){},"480e":function(e,t,r){"use strict";var i=r("7560");t["a"]=i["a"].extend({name:"v-theme-provider",props:{root:Boolean},computed:{isDark(){return this.root?this.rootIsDark:i["a"].options.computed.isDark.call(this)}},render(){return this.$slots.default&&this.$slots.default.find(e=>!e.isComment&&" "!==e.text)}})},"4ad4":function(e,t,r){"use strict";var i=r("16b7"),n=r("f2e7"),o=r("58df"),s=r("80d2"),a=r("d9bd");const l=Object(o["a"])(i["a"],n["a"]);t["a"]=l.extend({name:"activatable",props:{activator:{default:null,validator:e=>["string","object"].includes(typeof e)},disabled:Boolean,internalActivator:Boolean,openOnClick:{type:Boolean,default:!0},openOnHover:Boolean,openOnFocus:Boolean},data:()=>({activatorElement:null,activatorNode:[],events:["click","mouseenter","mouseleave","focus"],listeners:{}}),watch:{activator:"resetActivator",openOnFocus:"resetActivator",openOnHover:"resetActivator"},mounted(){const e=Object(s["s"])(this,"activator",!0);e&&["v-slot","normal"].includes(e)&&Object(a["b"])('The activator slot must be bound, try \'<template v-slot:activator="{ on }"><v-btn v-on="on">\'',this),this.addActivatorEvents()},beforeDestroy(){this.removeActivatorEvents()},methods:{addActivatorEvents(){if(!this.activator||this.disabled||!this.getActivator())return;this.listeners=this.genActivatorListeners();const e=Object.keys(this.listeners);for(const t of e)this.getActivator().addEventListener(t,this.listeners[t])},genActivator(){const e=Object(s["r"])(this,"activator",Object.assign(this.getValueProxy(),{on:this.genActivatorListeners(),attrs:this.genActivatorAttributes()}))||[];return this.activatorNode=e,e},genActivatorAttributes(){return{role:this.openOnClick&&!this.openOnHover?"button":void 0,"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genActivatorListeners(){if(this.disabled)return{};const e={};return this.openOnHover?(e.mouseenter=e=>{this.getActivator(e),this.runDelay("open")},e.mouseleave=e=>{this.getActivator(e),this.runDelay("close")}):this.openOnClick&&(e.click=e=>{const t=this.getActivator(e);t&&t.focus(),e.stopPropagation(),this.isActive=!this.isActive}),this.openOnFocus&&(e.focus=e=>{this.getActivator(e),e.stopPropagation(),this.isActive=!this.isActive}),e},getActivator(e){if(this.activatorElement)return this.activatorElement;let t=null;if(this.activator){const e=this.internalActivator?this.$el:document;t="string"===typeof this.activator?e.querySelector(this.activator):this.activator.$el?this.activator.$el:this.activator}else if(1===this.activatorNode.length||this.activatorNode.length&&!e){const e=this.activatorNode[0].componentInstance;t=e&&e.$options.mixins&&e.$options.mixins.some(e=>e.options&&["activatable","menuable"].includes(e.options.name))?e.getActivator():this.activatorNode[0].elm}else e&&(t=e.currentTarget||e.target);return this.activatorElement=(null===t||void 0===t?void 0:t.nodeType)===Node.ELEMENT_NODE?t:null,this.activatorElement},getContentSlot(){return Object(s["r"])(this,"default",this.getValueProxy(),!0)},getValueProxy(){const e=this;return{get value(){return e.isActive},set value(t){e.isActive=t}}},removeActivatorEvents(){if(!this.activator||!this.activatorElement)return;const e=Object.keys(this.listeners);for(const t of e)this.activatorElement.removeEventListener(t,this.listeners[t]);this.listeners={}},resetActivator(){this.removeActivatorEvents(),this.activatorElement=null,this.getActivator(),this.addActivatorEvents()}}})},"4ff9":function(e,t,r){},"560a":function(e,t,r){var i,n,o;(function(s,a){n=[r("b7fd")],i=a,o="function"===typeof i?i.apply(t,n):i,void 0===o||(e.exports=o)})(0,(function(e){e={Msg:{}};return e.Msg["ADD_COMMENT"]="添加注释",e.Msg["CANNOT_DELETE_VARIABLE_PROCEDURE"]="不能删除变量“%1”，因为它是函数“%2”定义的一部分",e.Msg["CHANGE_VALUE_TITLE"]="更改值：",e.Msg["CLEAN_UP"]="整理块",e.Msg["COLLAPSED_WARNINGS_WARNING"]="已收起的信息块内包含警告。",e.Msg["COLLAPSE_ALL"]="折叠块",e.Msg["COLLAPSE_BLOCK"]="折叠块",e.Msg["COLOUR_BLEND_COLOUR1"]="颜色1",e.Msg["COLOUR_BLEND_COLOUR2"]="颜色2",e.Msg["COLOUR_BLEND_HELPURL"]="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg["COLOUR_BLEND_RATIO"]="比例",e.Msg["COLOUR_BLEND_TITLE"]="混合",e.Msg["COLOUR_BLEND_TOOLTIP"]="把两种颜色以一个给定的比例(0.0-1.0)进行混合。",e.Msg["COLOUR_PICKER_HELPURL"]="https://zh.wikipedia.org/wiki/颜色",e.Msg["COLOUR_PICKER_TOOLTIP"]="从调色板中选择一种颜色。",e.Msg["COLOUR_RANDOM_HELPURL"]="http://randomcolour.com",e.Msg["COLOUR_RANDOM_TITLE"]="随机颜色",e.Msg["COLOUR_RANDOM_TOOLTIP"]="随机选择一种颜色。",e.Msg["COLOUR_RGB_BLUE"]="蓝色",e.Msg["COLOUR_RGB_GREEN"]="绿色",e.Msg["COLOUR_RGB_HELPURL"]="https://www.december.com/html/spec/colorpercompact.html",e.Msg["COLOUR_RGB_RED"]="红色",e.Msg["COLOUR_RGB_TITLE"]="颜色",e.Msg["COLOUR_RGB_TOOLTIP"]="通过指定红色、绿色和蓝色的量创建一种颜色。所有的值必须在0和100之间。",e.Msg["CONTROLS_FLOW_STATEMENTS_HELPURL"]="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK"]="跳出循环",e.Msg["CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE"]="继续下一轮循环",e.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK"]="跳出包含它的循环。",e.Msg["CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE"]="跳过本轮循环的剩余部分，并继进行续下一轮循环。",e.Msg["CONTROLS_FLOW_STATEMENTS_WARNING"]="警告：这个块只能在循环内使用。",e.Msg["CONTROLS_FOREACH_HELPURL"]="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg["CONTROLS_FOREACH_TITLE"]="遍历列表 %2 里的每一项 %1",e.Msg["CONTROLS_FOREACH_TOOLTIP"]="遍历列表中的每一项，将变量“%1”设为所选项，并执行一些语句。",e.Msg["CONTROLS_FOR_HELPURL"]="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg["CONTROLS_FOR_TITLE"]="变量 %1 从 %2 数到 %3 每次增加 %4",e.Msg["CONTROLS_FOR_TOOLTIP"]="用变量%1记录从开始数值到终止数值之间的数值，数值按指定间隔增加，并执行指定的块。",e.Msg["CONTROLS_IF_ELSEIF_TOOLTIP"]="在这个if语句块中增加一个条件。",e.Msg["CONTROLS_IF_ELSE_TOOLTIP"]="在这个if语句块中添加一个最终的，包括所有其余情况的条件。",e.Msg["CONTROLS_IF_HELPURL"]="https://github.com/google/blockly/wiki/IfElse",e.Msg["CONTROLS_IF_IF_TOOLTIP"]="增加、删除或重新排列各节来重新配置这个if语句块。",e.Msg["CONTROLS_IF_MSG_ELSE"]="否则",e.Msg["CONTROLS_IF_MSG_ELSEIF"]="否则如果",e.Msg["CONTROLS_IF_MSG_IF"]="如果",e.Msg["CONTROLS_IF_TOOLTIP_1"]="如果值为真，执行一些语句。",e.Msg["CONTROLS_IF_TOOLTIP_2"]="如果值为真，则执行第一块语句。否则，则执行第二块语句。",e.Msg["CONTROLS_IF_TOOLTIP_3"]="如果第一个值为真，则执行第一块的语句。否则，如果第二个值为真，则执行第二块的语句。",e.Msg["CONTROLS_IF_TOOLTIP_4"]="如果第一个值为真，则执行第一块对语句。否则，如果第二个值为真，则执行语句的第二块。如果没有值为真，则执行最后一块的语句。",e.Msg["CONTROLS_REPEAT_HELPURL"]="https://zh.wikipedia.org/wiki/For循环",e.Msg["CONTROLS_REPEAT_INPUT_DO"]="执行",e.Msg["CONTROLS_REPEAT_TITLE"]="重复 %1 次",e.Msg["CONTROLS_REPEAT_TOOLTIP"]="多次执行一些语句。",e.Msg["CONTROLS_WHILEUNTIL_HELPURL"]="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg["CONTROLS_WHILEUNTIL_OPERATOR_UNTIL"]="重复直到条件满足",e.Msg["CONTROLS_WHILEUNTIL_OPERATOR_WHILE"]="当条件满足时重复",e.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL"]="只要值为假，就一直循环执行一些语句。",e.Msg["CONTROLS_WHILEUNTIL_TOOLTIP_WHILE"]="只要值为真，就一直循环执行一些语句。",e.Msg["DELETE_ALL_BLOCKS"]="删除所有 %1 个块吗？",e.Msg["DELETE_BLOCK"]="删除块",e.Msg["DELETE_VARIABLE"]="删除变量“%1”",e.Msg["DELETE_VARIABLE_CONFIRMATION"]="要删除对变量“%2”的%1个引用吗？",e.Msg["DELETE_X_BLOCKS"]="删除 %1 个块",e.Msg["DISABLE_BLOCK"]="禁用块",e.Msg["DUPLICATE_BLOCK"]="复制",e.Msg["DUPLICATE_COMMENT"]="复制注释",e.Msg["ENABLE_BLOCK"]="启用块",e.Msg["EXPAND_ALL"]="展开块",e.Msg["EXPAND_BLOCK"]="展开块",e.Msg["EXTERNAL_INPUTS"]="外部输入",e.Msg["HELP"]="帮助",e.Msg["INLINE_INPUTS"]="单行输入",e.Msg["IOS_CANCEL"]="取消",e.Msg["IOS_ERROR"]="错误",e.Msg["IOS_OK"]="确定",e.Msg["IOS_PROCEDURES_ADD_INPUT"]="+ 添加输入",e.Msg["IOS_PROCEDURES_ALLOW_STATEMENTS"]="允许的语句",e.Msg["IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR"]="这个函数有多个输入。",e.Msg["IOS_PROCEDURES_INPUTS"]="输入",e.Msg["IOS_VARIABLES_ADD_BUTTON"]="添加",e.Msg["IOS_VARIABLES_ADD_VARIABLE"]="+ 添加变量",e.Msg["IOS_VARIABLES_DELETE_BUTTON"]="删除",e.Msg["IOS_VARIABLES_EMPTY_NAME_ERROR"]="你不能使用空白的变量名。",e.Msg["IOS_VARIABLES_RENAME_BUTTON"]="重命名",e.Msg["IOS_VARIABLES_VARIABLE_NAME"]="变量名",e.Msg["LISTS_CREATE_EMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg["LISTS_CREATE_EMPTY_TITLE"]="创建空列表",e.Msg["LISTS_CREATE_EMPTY_TOOLTIP"]="返回一个列表，长度为 0，不包含任何数据记录",e.Msg["LISTS_CREATE_WITH_CONTAINER_TITLE_ADD"]="列表",e.Msg["LISTS_CREATE_WITH_CONTAINER_TOOLTIP"]="增加、删除或重新排列各部分以此重新配置这个列表块。",e.Msg["LISTS_CREATE_WITH_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg["LISTS_CREATE_WITH_INPUT_WITH"]="创建列表，内容：",e.Msg["LISTS_CREATE_WITH_ITEM_TOOLTIP"]="将一个项添加到列表中。",e.Msg["LISTS_CREATE_WITH_TOOLTIP"]="建立一个具有任意数量项目的列表。",e.Msg["LISTS_GET_INDEX_FIRST"]="第一项",e.Msg["LISTS_GET_INDEX_FROM_END"]="倒数第#项",e.Msg["LISTS_GET_INDEX_FROM_START"]="#",e.Msg["LISTS_GET_INDEX_GET"]="取得",e.Msg["LISTS_GET_INDEX_GET_REMOVE"]="取得并移除",e.Msg["LISTS_GET_INDEX_LAST"]="最后一项",e.Msg["LISTS_GET_INDEX_RANDOM"]="随机的一项",e.Msg["LISTS_GET_INDEX_REMOVE"]="移除",e.Msg["LISTS_GET_INDEX_TAIL"]="-",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FIRST"]="返回列表中的第一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_FROM"]="返回在列表中的指定位置的项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_LAST"]="返回列表中的最后一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_RANDOM"]="返回列表中的随机一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST"]="移除并返回列表中的第一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM"]="移除并返回列表中的指定位置的项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST"]="移除并返回列表中的最后一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM"]="移除并返回列表中的随机一项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST"]="移除列表中的第一项",e.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM"]="移除在列表中的指定位置的项。",e.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST"]="移除列表中的最后一项",e.Msg["LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM"]="删除列表中的随机一项。",e.Msg["LISTS_GET_SUBLIST_END_FROM_END"]="到倒数第#项",e.Msg["LISTS_GET_SUBLIST_END_FROM_START"]="到第#项",e.Msg["LISTS_GET_SUBLIST_END_LAST"]="到最后一项",e.Msg["LISTS_GET_SUBLIST_HELPURL"]="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg["LISTS_GET_SUBLIST_START_FIRST"]="获取子列表，从第一项",e.Msg["LISTS_GET_SUBLIST_START_FROM_END"]="获取子列表，从倒数第#项",e.Msg["LISTS_GET_SUBLIST_START_FROM_START"]="获取子列表，从第#项",e.Msg["LISTS_GET_SUBLIST_TAIL"]="-",e.Msg["LISTS_GET_SUBLIST_TOOLTIP"]="复制列表中指定的部分。",e.Msg["LISTS_INDEX_FROM_END_TOOLTIP"]="%1是最后一项。",e.Msg["LISTS_INDEX_FROM_START_TOOLTIP"]="%1是第一项。",e.Msg["LISTS_INDEX_OF_FIRST"]="寻找第一次出现的项",e.Msg["LISTS_INDEX_OF_HELPURL"]="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg["LISTS_INDEX_OF_LAST"]="寻找最后一次出现的项",e.Msg["LISTS_INDEX_OF_TOOLTIP"]="返回在列表中的第一/最后一个匹配项的索引值。如果找不到项目则返回%1。",e.Msg["LISTS_INLIST"]="在列表中",e.Msg["LISTS_ISEMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg["LISTS_ISEMPTY_TITLE"]="%1是空的",e.Msg["LISTS_ISEMPTY_TOOLTIP"]="如果改列表为空，则返回真。",e.Msg["LISTS_LENGTH_HELPURL"]="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg["LISTS_LENGTH_TITLE"]="%1的长度",e.Msg["LISTS_LENGTH_TOOLTIP"]="返回列表的长度。",e.Msg["LISTS_REPEAT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg["LISTS_REPEAT_TITLE"]="建立列表使用项 %1 重复 %2 次",e.Msg["LISTS_REPEAT_TOOLTIP"]="建立包含指定重复次数的值的列表。",e.Msg["LISTS_REVERSE_HELPURL"]="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg["LISTS_REVERSE_MESSAGE0"]="倒转%1",e.Msg["LISTS_REVERSE_TOOLTIP"]="倒转一个列表，返回副本。",e.Msg["LISTS_SET_INDEX_HELPURL"]="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg["LISTS_SET_INDEX_INPUT_TO"]="值为",e.Msg["LISTS_SET_INDEX_INSERT"]="插入在",e.Msg["LISTS_SET_INDEX_SET"]="设置",e.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST"]="在列表的起始处添加该项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_FROM"]="在列表中指定位置插入项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_LAST"]="在列表的末尾处添加该项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM"]="在列表的随机位置插入该项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FIRST"]="设置列表中的第一项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_SET_FROM"]="设置在列表中指定位置的项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_SET_LAST"]="设置列表中的最后一项。",e.Msg["LISTS_SET_INDEX_TOOLTIP_SET_RANDOM"]="设置列表中的随机一项。",e.Msg["LISTS_SORT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg["LISTS_SORT_ORDER_ASCENDING"]="升序",e.Msg["LISTS_SORT_ORDER_DESCENDING"]="降序",e.Msg["LISTS_SORT_TITLE"]="排序%1 %2 %3",e.Msg["LISTS_SORT_TOOLTIP"]="排序一个列表，返回副本。",e.Msg["LISTS_SORT_TYPE_IGNORECASE"]="按字母（忽略大小写）",e.Msg["LISTS_SORT_TYPE_NUMERIC"]="按数字",e.Msg["LISTS_SORT_TYPE_TEXT"]="按字母",e.Msg["LISTS_SPLIT_HELPURL"]="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg["LISTS_SPLIT_LIST_FROM_TEXT"]="从文本制作列表",e.Msg["LISTS_SPLIT_TEXT_FROM_LIST"]="将列表合并为文本",e.Msg["LISTS_SPLIT_TOOLTIP_JOIN"]="加入文本列表至一个文本，由分隔符分隔。",e.Msg["LISTS_SPLIT_TOOLTIP_SPLIT"]="将文本按指定的分隔符拆分为文本组成的列表。",e.Msg["LISTS_SPLIT_WITH_DELIMITER"]="分隔符：",e.Msg["LOGIC_BOOLEAN_FALSE"]="假",e.Msg["LOGIC_BOOLEAN_HELPURL"]="https://github.com/google/blockly/wiki/Logic#values",e.Msg["LOGIC_BOOLEAN_TOOLTIP"]="返回真或假。",e.Msg["LOGIC_BOOLEAN_TRUE"]="真",e.Msg["LOGIC_COMPARE_HELPURL"]="https://zh.wikipedia.org/wiki/不等",e.Msg["LOGIC_COMPARE_TOOLTIP_EQ"]="如果两个输入结果相等，则返回真。",e.Msg["LOGIC_COMPARE_TOOLTIP_GT"]="如果第一个输入结果比第二个大，则返回真。",e.Msg["LOGIC_COMPARE_TOOLTIP_GTE"]="如果第一个输入结果大于或等于第二个输入结果，则返回真。",e.Msg["LOGIC_COMPARE_TOOLTIP_LT"]="如果第一个输入结果比第二个小，则返回真。",e.Msg["LOGIC_COMPARE_TOOLTIP_LTE"]="如果第一个输入结果小于或等于第二个输入结果，则返回真。",e.Msg["LOGIC_COMPARE_TOOLTIP_NEQ"]="如果两个输入结果不相等，则返回真。",e.Msg["LOGIC_NEGATE_HELPURL"]="https://github.com/google/blockly/wiki/Logic#not",e.Msg["LOGIC_NEGATE_TITLE"]="%1不成立",e.Msg["LOGIC_NEGATE_TOOLTIP"]="如果输入结果为假，则返回真；如果输入结果为真，则返回假。",e.Msg["LOGIC_NULL"]="空",e.Msg["LOGIC_NULL_HELPURL"]="https://en.wikipedia.org/wiki/Nullable_type",e.Msg["LOGIC_NULL_TOOLTIP"]="返回空值。",e.Msg["LOGIC_OPERATION_AND"]="并且",e.Msg["LOGIC_OPERATION_HELPURL"]="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg["LOGIC_OPERATION_OR"]="或",e.Msg["LOGIC_OPERATION_TOOLTIP_AND"]="如果两个输入结果都为真，则返回真。",e.Msg["LOGIC_OPERATION_TOOLTIP_OR"]="如果至少有一个输入结果为真，则返回真。",e.Msg["LOGIC_TERNARY_CONDITION"]="断言",e.Msg["LOGIC_TERNARY_HELPURL"]="https://zh.wikipedia.org/wiki/条件运算符",e.Msg["LOGIC_TERNARY_IF_FALSE"]="如果为假",e.Msg["LOGIC_TERNARY_IF_TRUE"]="如果为真",e.Msg["LOGIC_TERNARY_TOOLTIP"]="检查“断言”里的条件语句。如果条件为真，则返回“如果为真”的值，否则，则返回“如果为假”的值。",e.Msg["MATH_ADDITION_SYMBOL"]="+",e.Msg["MATH_ARITHMETIC_HELPURL"]="https://zh.wikipedia.org/wiki/算术",e.Msg["MATH_ARITHMETIC_TOOLTIP_ADD"]="返回两个数值的和。",e.Msg["MATH_ARITHMETIC_TOOLTIP_DIVIDE"]="返回两个数值的商。",e.Msg["MATH_ARITHMETIC_TOOLTIP_MINUS"]="返回两个数值的差。",e.Msg["MATH_ARITHMETIC_TOOLTIP_MULTIPLY"]="返回两个数值的乘积。",e.Msg["MATH_ARITHMETIC_TOOLTIP_POWER"]="返回以第一个数值为底数，以第二个数值为幂的结果。",e.Msg["MATH_ATAN2_HELPURL"]="https://zh.wikipedia.org/wiki/反正切2",e.Msg["MATH_ATAN2_TITLE"]="点(x:%1,y:%2)的方位角",e.Msg["MATH_ATAN2_TOOLTIP"]="返回点（X，Y）的反正切值，范围为-180到180度。",e.Msg["MATH_CHANGE_HELPURL"]="https://zh.wikipedia.org/wiki/加法",e.Msg["MATH_CHANGE_TITLE"]="将 %1 增加 %2",e.Msg["MATH_CHANGE_TOOLTIP"]="为变量“%1”增加一个数值。",e.Msg["MATH_CONSTANT_HELPURL"]="https://zh.wikipedia.org/wiki/数学常数",e.Msg["MATH_CONSTANT_TOOLTIP"]="返回一个常见常量：π (3.141…)、e (2.718…)、φ (1.618…)、根号2 (1.414…)、根号二分之一 (0.707…)或∞ (无穷大)。",e.Msg["MATH_CONSTRAIN_HELPURL"]="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg["MATH_CONSTRAIN_TITLE"]="将 %1 限制在 最低 %2 到最高 %3 之间",e.Msg["MATH_CONSTRAIN_TOOLTIP"]="将一个数值限制在两个指定的数值范围（含边界）之间。",e.Msg["MATH_DIVISION_SYMBOL"]="÷",e.Msg["MATH_IS_DIVISIBLE_BY"]="可被整除",e.Msg["MATH_IS_EVEN"]="是偶数",e.Msg["MATH_IS_NEGATIVE"]="是负数",e.Msg["MATH_IS_ODD"]="是奇数",e.Msg["MATH_IS_POSITIVE"]="是正数",e.Msg["MATH_IS_PRIME"]="是质数",e.Msg["MATH_IS_TOOLTIP"]="检查一个数值是否是偶数、奇数、质数、自然数、正数、负数或者是否能被某数整除。返回真或假。",e.Msg["MATH_IS_WHOLE"]="是整数",e.Msg["MATH_MODULO_HELPURL"]="https://zh.wikipedia.org/wiki/模除",e.Msg["MATH_MODULO_TITLE"]="取 %1 ÷ %2 的余数",e.Msg["MATH_MODULO_TOOLTIP"]="返回这两个数字相除后的余数。",e.Msg["MATH_MULTIPLICATION_SYMBOL"]="×",e.Msg["MATH_NUMBER_HELPURL"]="https://zh.wikipedia.org/wiki/数",e.Msg["MATH_NUMBER_TOOLTIP"]="一个数值。",e.Msg["MATH_ONLIST_HELPURL"]="",e.Msg["MATH_ONLIST_OPERATOR_AVERAGE"]="列表平均值",e.Msg["MATH_ONLIST_OPERATOR_MAX"]="列表最大值",e.Msg["MATH_ONLIST_OPERATOR_MEDIAN"]="列表中位数",e.Msg["MATH_ONLIST_OPERATOR_MIN"]="列表最小值",e.Msg["MATH_ONLIST_OPERATOR_MODE"]="列表中的众数",e.Msg["MATH_ONLIST_OPERATOR_RANDOM"]="列表中的随机一项",e.Msg["MATH_ONLIST_OPERATOR_STD_DEV"]="列表的标准差",e.Msg["MATH_ONLIST_OPERATOR_SUM"]="列表中数值的和",e.Msg["MATH_ONLIST_TOOLTIP_AVERAGE"]="返回列表中的数值的平均值。",e.Msg["MATH_ONLIST_TOOLTIP_MAX"]="返回列表中最大值。",e.Msg["MATH_ONLIST_TOOLTIP_MEDIAN"]="返回列表中数值的中位数。",e.Msg["MATH_ONLIST_TOOLTIP_MIN"]="返回列表中最小值。",e.Msg["MATH_ONLIST_TOOLTIP_MODE"]="返回列表中的出现次数最多的项的列表。",e.Msg["MATH_ONLIST_TOOLTIP_RANDOM"]="从列表中返回一个随机的元素。",e.Msg["MATH_ONLIST_TOOLTIP_STD_DEV"]="返回列表的标准差。",e.Msg["MATH_ONLIST_TOOLTIP_SUM"]="返回列表中的所有数值的和。",e.Msg["MATH_POWER_SYMBOL"]="^",e.Msg["MATH_RANDOM_FLOAT_HELPURL"]="https://zh.wikipedia.org/wiki/随机数生成器",e.Msg["MATH_RANDOM_FLOAT_TITLE_RANDOM"]="随机小数",e.Msg["MATH_RANDOM_FLOAT_TOOLTIP"]="返回一个从0.0（含）到1.0（不含）之间的随机数。",e.Msg["MATH_RANDOM_INT_HELPURL"]="https://zh.wikipedia.org/wiki/随机数生成器",e.Msg["MATH_RANDOM_INT_TITLE"]="从 %1 到 %2 范围内的随机整数",e.Msg["MATH_RANDOM_INT_TOOLTIP"]="返回一个限制在两个指定数值的范围（含边界）之间的随机整数。",e.Msg["MATH_ROUND_HELPURL"]="https://zh.wikipedia.org/wiki/数值修约",e.Msg["MATH_ROUND_OPERATOR_ROUND"]="四舍五入",e.Msg["MATH_ROUND_OPERATOR_ROUNDDOWN"]="向下舍入",e.Msg["MATH_ROUND_OPERATOR_ROUNDUP"]="向上舍入",e.Msg["MATH_ROUND_TOOLTIP"]="数字向上或向下舍入。",e.Msg["MATH_SINGLE_HELPURL"]="https://zh.wikipedia.org/wiki/平方根",e.Msg["MATH_SINGLE_OP_ABSOLUTE"]="绝对值",e.Msg["MATH_SINGLE_OP_ROOT"]="平方根",e.Msg["MATH_SINGLE_TOOLTIP_ABS"]="返回一个数值的绝对值。",e.Msg["MATH_SINGLE_TOOLTIP_EXP"]="返回一个数值的e次幂。",e.Msg["MATH_SINGLE_TOOLTIP_LN"]="返回一个数值的自然对数。",e.Msg["MATH_SINGLE_TOOLTIP_LOG10"]="返回一个数值的以10为底的对数。",e.Msg["MATH_SINGLE_TOOLTIP_NEG"]="返回一个数值的相反数。",e.Msg["MATH_SINGLE_TOOLTIP_POW10"]="返回一个数值的10次幂。",e.Msg["MATH_SINGLE_TOOLTIP_ROOT"]="返回一个数的平方根。",e.Msg["MATH_SUBTRACTION_SYMBOL"]="-",e.Msg["MATH_TRIG_ACOS"]="acos",e.Msg["MATH_TRIG_ASIN"]="asin",e.Msg["MATH_TRIG_ATAN"]="atan",e.Msg["MATH_TRIG_COS"]="cos",e.Msg["MATH_TRIG_HELPURL"]="https://zh.wikipedia.org/wiki/三角函数",e.Msg["MATH_TRIG_SIN"]="sin",e.Msg["MATH_TRIG_TAN"]="tan",e.Msg["MATH_TRIG_TOOLTIP_ACOS"]="返回一个数值的反余弦值。",e.Msg["MATH_TRIG_TOOLTIP_ASIN"]="返回一个数值的反正弦值。",e.Msg["MATH_TRIG_TOOLTIP_ATAN"]="返回一个数值的反正切值。",e.Msg["MATH_TRIG_TOOLTIP_COS"]="返回指定角度的余弦值（非弧度）。",e.Msg["MATH_TRIG_TOOLTIP_SIN"]="返回指定角度的正弦值（非弧度）。",e.Msg["MATH_TRIG_TOOLTIP_TAN"]="返回指定角度的正切值（非弧度）。",e.Msg["NEW_COLOUR_VARIABLE"]="创建颜色变量...",e.Msg["NEW_NUMBER_VARIABLE"]="创建数字变量...",e.Msg["NEW_STRING_VARIABLE"]="创建字符串变量...",e.Msg["NEW_VARIABLE"]="创建变量...",e.Msg["NEW_VARIABLE_TITLE"]="新变量的名称：",e.Msg["NEW_VARIABLE_TYPE_TITLE"]="新变量的类型：",e.Msg["ORDINAL_NUMBER_SUFFIX"]="-",e.Msg["PROCEDURES_ALLOW_STATEMENTS"]="允许声明",e.Msg["PROCEDURES_BEFORE_PARAMS"]="与：",e.Msg["PROCEDURES_CALLNORETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",e.Msg["PROCEDURES_CALLNORETURN_TOOLTIP"]="运行用户定义的函数“%1”。",e.Msg["PROCEDURES_CALLRETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",e.Msg["PROCEDURES_CALLRETURN_TOOLTIP"]="运行用户定义的函数“%1”，并使用它的输出值。",e.Msg["PROCEDURES_CALL_BEFORE_PARAMS"]="与：",e.Msg["PROCEDURES_CREATE_DO"]="创建“%1”",e.Msg["PROCEDURES_DEFNORETURN_COMMENT"]="描述该功能...",e.Msg["PROCEDURES_DEFNORETURN_DO"]="-",e.Msg["PROCEDURES_DEFNORETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",e.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"]="做点什么",e.Msg["PROCEDURES_DEFNORETURN_TITLE"]="至",e.Msg["PROCEDURES_DEFNORETURN_TOOLTIP"]="创建一个不带输出值的函数。",e.Msg["PROCEDURES_DEFRETURN_HELPURL"]="https://zh.wikipedia.org/wiki/子程序",e.Msg["PROCEDURES_DEFRETURN_RETURN"]="返回",e.Msg["PROCEDURES_DEFRETURN_TOOLTIP"]="创建一个有输出值的函数。",e.Msg["PROCEDURES_DEF_DUPLICATE_WARNING"]="警告：此函数具有重复参数。",e.Msg["PROCEDURES_HIGHLIGHT_DEF"]="突出显示函数定义",e.Msg["PROCEDURES_IFRETURN_HELPURL"]="http://c2.com/cgi/wiki?GuardClause",e.Msg["PROCEDURES_IFRETURN_TOOLTIP"]="如果值为真，则返回第二个值。",e.Msg["PROCEDURES_IFRETURN_WARNING"]="警告：这个块只能在函数内部使用。",e.Msg["PROCEDURES_MUTATORARG_TITLE"]="输入名称：",e.Msg["PROCEDURES_MUTATORARG_TOOLTIP"]="添加函数输入。",e.Msg["PROCEDURES_MUTATORCONTAINER_TITLE"]="输入",e.Msg["PROCEDURES_MUTATORCONTAINER_TOOLTIP"]="添加、移除或重新排此函数的输入。",e.Msg["REDO"]="重做",e.Msg["REMOVE_COMMENT"]="删除注释",e.Msg["RENAME_VARIABLE"]="重命名变量...",e.Msg["RENAME_VARIABLE_TITLE"]="将所有“%1”变量重命名为:",e.Msg["TEXT_APPEND_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg["TEXT_APPEND_TITLE"]="在%1之后加上文本%2",e.Msg["TEXT_APPEND_TOOLTIP"]="将一些文本追加到变量“%1”里。",e.Msg["TEXT_CHANGECASE_HELPURL"]="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg["TEXT_CHANGECASE_OPERATOR_LOWERCASE"]="转为小写",e.Msg["TEXT_CHANGECASE_OPERATOR_TITLECASE"]="转为首字母大写",e.Msg["TEXT_CHANGECASE_OPERATOR_UPPERCASE"]="转为大写",e.Msg["TEXT_CHANGECASE_TOOLTIP"]="用不同的大小写模式复制并返回这段文字。",e.Msg["TEXT_CHARAT_FIRST"]="获取第一个字符",e.Msg["TEXT_CHARAT_FROM_END"]="获取倒数第#个字符",e.Msg["TEXT_CHARAT_FROM_START"]="获取第#个字符",e.Msg["TEXT_CHARAT_HELPURL"]="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg["TEXT_CHARAT_LAST"]="获取最后一个字符",e.Msg["TEXT_CHARAT_RANDOM"]="获取随机一个字符",e.Msg["TEXT_CHARAT_TAIL"]="-",e.Msg["TEXT_CHARAT_TITLE"]="在文本%1 里 %2",e.Msg["TEXT_CHARAT_TOOLTIP"]="返回位于指定位置的字符。",e.Msg["TEXT_COUNT_HELPURL"]="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg["TEXT_COUNT_MESSAGE0"]="计算%1在%2里出现的次数",e.Msg["TEXT_COUNT_TOOLTIP"]="计算在一段文本中，某个部分文本重复出现了多少次。",e.Msg["TEXT_CREATE_JOIN_ITEM_TOOLTIP"]="将一个项添加到文本中。",e.Msg["TEXT_CREATE_JOIN_TITLE_JOIN"]="拼接",e.Msg["TEXT_CREATE_JOIN_TOOLTIP"]="添加、移除或重新排列各节来重新配置这个文本块。",e.Msg["TEXT_GET_SUBSTRING_END_FROM_END"]="到倒数第#个字符",e.Msg["TEXT_GET_SUBSTRING_END_FROM_START"]="到第#个字符",e.Msg["TEXT_GET_SUBSTRING_END_LAST"]="到最后一个字符",e.Msg["TEXT_GET_SUBSTRING_HELPURL"]="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg["TEXT_GET_SUBSTRING_INPUT_IN_TEXT"]="从文本",e.Msg["TEXT_GET_SUBSTRING_START_FIRST"]="获取子串，从第一个字符",e.Msg["TEXT_GET_SUBSTRING_START_FROM_END"]="获取子串，从倒数第#个字符",e.Msg["TEXT_GET_SUBSTRING_START_FROM_START"]="获取子串，从第#个字符",e.Msg["TEXT_GET_SUBSTRING_TAIL"]="-",e.Msg["TEXT_GET_SUBSTRING_TOOLTIP"]="返回文本中指定的一部分。",e.Msg["TEXT_INDEXOF_HELPURL"]="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg["TEXT_INDEXOF_OPERATOR_FIRST"]="寻找第一次出现的文本",e.Msg["TEXT_INDEXOF_OPERATOR_LAST"]="寻找最后一次出现的文本",e.Msg["TEXT_INDEXOF_TITLE"]="在文本 %1 里 %2  %3",e.Msg["TEXT_INDEXOF_TOOLTIP"]="返回第一个文本段在第二个文本段中的第一/最后一个匹配项的起始位置。如果未找到，则返回%1。",e.Msg["TEXT_ISEMPTY_HELPURL"]="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg["TEXT_ISEMPTY_TITLE"]="%1是空的",e.Msg["TEXT_ISEMPTY_TOOLTIP"]="如果给定的文本为空，则返回真。",e.Msg["TEXT_JOIN_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg["TEXT_JOIN_TITLE_CREATEWITH"]="创建文本，内容：",e.Msg["TEXT_JOIN_TOOLTIP"]="通过串起任意数量的项以建立一段文本。",e.Msg["TEXT_LENGTH_HELPURL"]="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg["TEXT_LENGTH_TITLE"]="%1的长度",e.Msg["TEXT_LENGTH_TOOLTIP"]="返回给定文本的字母数（包括空格）。",e.Msg["TEXT_PRINT_HELPURL"]="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg["TEXT_PRINT_TITLE"]="输出%1",e.Msg["TEXT_PRINT_TOOLTIP"]="输出指定的文字、数字或其他值。",e.Msg["TEXT_PROMPT_HELPURL"]="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg["TEXT_PROMPT_TOOLTIP_NUMBER"]="要求用户输入数字。",e.Msg["TEXT_PROMPT_TOOLTIP_TEXT"]="要求用户输入一些文本。",e.Msg["TEXT_PROMPT_TYPE_NUMBER"]="要求输入数字，并显示提示消息",e.Msg["TEXT_PROMPT_TYPE_TEXT"]="要求输入文本，并显示提示消息",e.Msg["TEXT_REPLACE_HELPURL"]="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg["TEXT_REPLACE_MESSAGE0"]="把%3中的%1替换为%2",e.Msg["TEXT_REPLACE_TOOLTIP"]="在一段文本中，将出现过的某部分文本都替换掉。",e.Msg["TEXT_REVERSE_HELPURL"]="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg["TEXT_REVERSE_MESSAGE0"]="倒转文本%1",e.Msg["TEXT_REVERSE_TOOLTIP"]="将文本中各个字符的顺序倒转。",e.Msg["TEXT_TEXT_HELPURL"]="https://zh.wikipedia.org/wiki/字符串",e.Msg["TEXT_TEXT_TOOLTIP"]="一个字、词语或一行文本。",e.Msg["TEXT_TRIM_HELPURL"]="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg["TEXT_TRIM_OPERATOR_BOTH"]="消除其两侧的空白",e.Msg["TEXT_TRIM_OPERATOR_LEFT"]="消除其左侧的空白",e.Msg["TEXT_TRIM_OPERATOR_RIGHT"]="消除其右侧的空白",e.Msg["TEXT_TRIM_TOOLTIP"]="从某一端或同时从两端删除多余的空白，并返回这段文字的一个副本。",e.Msg["TODAY"]="今天",e.Msg["UNDO"]="撤销",e.Msg["UNNAMED_KEY"]="匿名",e.Msg["VARIABLES_DEFAULT_NAME"]="项目",e.Msg["VARIABLES_GET_CREATE_SET"]="创建“设定%1”",e.Msg["VARIABLES_GET_HELPURL"]="https://github.com/google/blockly/wiki/Variables#get",e.Msg["VARIABLES_GET_TOOLTIP"]="返回此变量的值。",e.Msg["VARIABLES_SET"]="赋值 %1 为 %2",e.Msg["VARIABLES_SET_CREATE_GET"]="创建“获得%1”",e.Msg["VARIABLES_SET_HELPURL"]="https://github.com/google/blockly/wiki/Variables#set",e.Msg["VARIABLES_SET_TOOLTIP"]="设置此变量，以使它和输入值相等。",e.Msg["VARIABLE_ALREADY_EXISTS"]="名字叫“%1”的变量已经存在了。",e.Msg["VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE"]="名字叫“%1”的变量已经有了另一个类型：“%2”。",e.Msg["WORKSPACE_ARIA_LABEL"]="Blockly工作区",e.Msg["WORKSPACE_COMMENT_DEFAULT_TEXT"]="说点什么...",e.Msg["CONTROLS_FOREACH_INPUT_DO"]=e.Msg["CONTROLS_REPEAT_INPUT_DO"],e.Msg["CONTROLS_FOR_INPUT_DO"]=e.Msg["CONTROLS_REPEAT_INPUT_DO"],e.Msg["CONTROLS_IF_ELSEIF_TITLE_ELSEIF"]=e.Msg["CONTROLS_IF_MSG_ELSEIF"],e.Msg["CONTROLS_IF_ELSE_TITLE_ELSE"]=e.Msg["CONTROLS_IF_MSG_ELSE"],e.Msg["CONTROLS_IF_IF_TITLE_IF"]=e.Msg["CONTROLS_IF_MSG_IF"],e.Msg["CONTROLS_IF_MSG_THEN"]=e.Msg["CONTROLS_REPEAT_INPUT_DO"],e.Msg["CONTROLS_WHILEUNTIL_INPUT_DO"]=e.Msg["CONTROLS_REPEAT_INPUT_DO"],e.Msg["LISTS_CREATE_WITH_ITEM_TITLE"]=e.Msg["VARIABLES_DEFAULT_NAME"],e.Msg["LISTS_GET_INDEX_HELPURL"]=e.Msg["LISTS_INDEX_OF_HELPURL"],e.Msg["LISTS_GET_INDEX_INPUT_IN_LIST"]=e.Msg["LISTS_INLIST"],e.Msg["LISTS_GET_SUBLIST_INPUT_IN_LIST"]=e.Msg["LISTS_INLIST"],e.Msg["LISTS_INDEX_OF_INPUT_IN_LIST"]=e.Msg["LISTS_INLIST"],e.Msg["LISTS_SET_INDEX_INPUT_IN_LIST"]=e.Msg["LISTS_INLIST"],e.Msg["MATH_CHANGE_TITLE_ITEM"]=e.Msg["VARIABLES_DEFAULT_NAME"],e.Msg["PROCEDURES_DEFRETURN_COMMENT"]=e.Msg["PROCEDURES_DEFNORETURN_COMMENT"],e.Msg["PROCEDURES_DEFRETURN_DO"]=e.Msg["PROCEDURES_DEFNORETURN_DO"],e.Msg["PROCEDURES_DEFRETURN_PROCEDURE"]=e.Msg["PROCEDURES_DEFNORETURN_PROCEDURE"],e.Msg["PROCEDURES_DEFRETURN_TITLE"]=e.Msg["PROCEDURES_DEFNORETURN_TITLE"],e.Msg["TEXT_APPEND_VARIABLE"]=e.Msg["VARIABLES_DEFAULT_NAME"],e.Msg["TEXT_CREATE_JOIN_ITEM_TITLE_ITEM"]=e.Msg["VARIABLES_DEFAULT_NAME"],e.Msg["MATH_HUE"]="230",e.Msg["LOOPS_HUE"]="120",e.Msg["LISTS_HUE"]="260",e.Msg["LOGIC_HUE"]="210",e.Msg["VARIABLES_HUE"]="330",e.Msg["TEXTS_HUE"]="160",e.Msg["PROCEDURES_HUE"]="290",e.Msg["COLOUR_HUE"]="20",e.Msg["VARIABLES_DYNAMIC_HUE"]="310",e.Msg}))},"5b28":function(e,t,r){"use strict";var i=r("633b"),n=r("e07a");if("undefined"==typeof o)var o={Left:0,Right:1,Forward:2,Back:3};if("undefined"==typeof s)var s={UP:0,DOWN:1};var a=!1,l=null,h=null,u=null,c=null,d=!0,p={turn:!0,move:!0,arc:!0},f=null,_=null,g=0,m=0,b=null,y=null,v=[],T=[],O=20,E=1,A=0,C=new i["Color4"](0,1,0,1),M=null,x=null,w=null,S=null,R=512;const P=9,I=.16,L=P*I;var N={getRobotInstance(){return this},initScene:function(e,t,r){l=e,h=t,u=n["a"].getMeshSize(h),this.resetBodyPose(),this.setSpeed(1),c=r,a=!1,f=null,b=null,y=null,v=[],T=[]},initRobotPenclDynamicTexture(e){_=e},resetScene:function(e,t,r){l=e,h=t,u=n["a"].getMeshSize(h),this.resetBodyPose(),this.setSpeed(1),c=r,g=0,m=0,a=!1,f=null,b=null,y=null,v=[],T=[]},init:function(){console.log("robot模块化程序初始化"),a=!0},upadteCurrentPosition(e,t){g=e,m=t},setSpeed:function(e){console.log("setSpeed"),E=e},checkStatus:function(){if(!a&&!d)throw"程序需要初始化模块"},stop:function(){console.log("robot模块运行结束"),this.resetPencil(),a=!1},pencilTo(e,t){if(!b)return g=e,void(m=t);var r=_.getContext();r.beginPath(),r.lineWidth=2,r.fillStyle="green",r.strokeStyle="green";var i=this.sceneToPadX(g),n=this.sceneToPadY(m),o=this.sceneToPadX(e),s=this.sceneToPadY(t);r.moveTo(i,n),r.lineTo(o,s),r.quadraticCurveTo(i,n,o,s),r.stroke(),_.update(),g=e,m=t},sceneToPadX(e){var t=100*L,r=R/t;return-e*r+R/2},sceneToPadY(e){var t=100*L,r=R/t;return e*r+R/2},robotPosition(){return{z:Math.round(h.position.z,2),x:Math.round(h.position.x,2)}},drawable:async function(e){var t=b,r=s.DOWN==e;t==s.DOWN&&0==r&&(A+=1,console.log("drawable.line_grounp",A),v=[],T=[]),b=r;for(let n=0;n<h._children.length;n++){var i=h._children[n];if("pencil"==i.id){await this.pencilDown(e,i);break}}},resetPencil(){if(b)for(let t=0;t<h._children.length;t++){var e=h._children[t];if("pencil"==e.id){e.position.y+=u.y/1e3,b=!1;break}}},drawableBlockly(e,t){var r=b,i=s.DOWN==e;r==s.DOWN&&0==i&&(A+=1,v=[],T=[]),b=i;for(let o=0;o<h._children.length;o++){var n=h._children[o];if("pencil"==n.id){this.pencilDown(e,n).then(e=>{t(e)});break}}},pencilDown:async function(e,t){var r=new i["Vector3"](t.position._x,t.position._y,t.position._z),n=u.y/1e3;if(r.y==-n&&e==s.DOWN)return console.log("[pencil already down]"),"pencil already down";if(0==r.y&&e==s.UP)return console.log("[pencil already up]"),"pencil already up";var o=0,a=25e-5*E;return console.log("pencilDownOffset,pencilSpeed",n,a),await new Promise(i=>{var l=setInterval((function(){var h=!1;n-o<a?setTimeout((function(){t.position.y=r.y-n*(e==s.DOWN?1:-1),console.log(e==s.DOWN?"[pencil down done]":"[pencil up done]",t.position.y),i("pencil down/up done"),clearInterval(l)})):h=!0,h&&(t.position.y-=a*(e==s.DOWN?1:-1),o+=a)}),O)})},pencilcolor:async function(e,t,r){return A+=1,console.log("pencilcolor.line_grounp",A),v=[],T=[],C.r=e,C.g=t,C.b=r,new Promise(e=>{setTimeout((function(){console.log("[pencil color set]"),e("[pencil color set]")}),1e3/O)})},draw:function(e){b&&(e.y=.01,v.push(e),T.push(new i["Vector3"](0,1,0)),null==f?(console.log("new line"),f=i["MeshBuilder"].CreateLines("line",{points:v,colors:T,updatable:!0,useVertexAlpha:!0},l)):(null!=f&&f.dispose(),f=i["MeshBuilder"].CreateLines("line",{points:v,colors:T,updatable:!0,useVertexAlpha:!0},l)),f.material.freeze(),f.freezeWorldMatrix(),f.enableEdgesRendering(),f.edgesWidth=50,f.edgesColor=new i["Color4"](C.r,C.g,C.b,C.a))},move:async function(e){this.checkStatus(),await this.slowRunMoveTask(e)},moveBlockly:function(e,t){this.checkStatus(),this.slowRunMoveTask(e).then(e=>{t(e)})},slowRunMoveTask:async function(e){var t=h.getAbsolutePosition(),r=Math.round(S,0),o=-Math.round(Math.cos(n["a"].degToRad(r))*e,2),s=-Math.round(Math.sin(n["a"].degToRad(r))*e,2),l=new i["Vector3"](t._x,t._y,t._z);y=t,g=y._x,m=y._z,this.pencilTo(y._x,y._z);var u=0,c=0,d=this,f=E/4;return await new Promise(t=>{var r=setInterval((function(){a||setTimeout((function(){clearInterval(r),t("move force stop")}));var i=Math.sqrt(Math.pow(u,2)+Math.pow(c,2)),n=!1;if(e-i<=f?setTimeout((function(){y._x=l._x+o,y._z=l._z+s,h.position=y,d.pencilTo(y._x,y._z),p.move&&console.log("[move done]z,x",d.robotPosition().z,d.robotPosition().x),t("move done"),clearInterval(r)})):n=!0,n){var _=o/e*f,g=s/e*f;u+=_,c+=g,y._x+=_,y._z+=g,d.pencilTo(y._x,y._z),h.position=y}}),O)})},turn:async function(e,t){await this.turnTask(e,t)},turnBlockly:function(e,t,r){this.turnTask(e,t).then(e=>{r(e)})},async turnTask(e,t){M=e==o.Left?1:-1,x=S,w=this.getBodyHeading();var r=this,i=0;return await new Promise(e=>{var n=setInterval((function(){a||setTimeout((function(){S=x+M*(i-E),S>360?S-=360:S<-360&&(S+=360),clearInterval(n),e("turn force stop")}));var o=!1;t-i<=E?setTimeout((function(){r.setBodyHeading(w+M*t),S=x+M*t,S>360?S-=360:S<-360&&(S+=360),p.turn&&console.log("[turn done]rotation.y",S),e("turn done"),clearInterval(n)})):o=!0,o&&(r.setBodyHeading(w+M*i),i+=E)}),O)})},turnTaskSync(e,t){M=e==o.Left?1:-1,x=S,w=this.getBodyHeading(),this.setBodyHeading(w+M*t),S=x+M*t,S>360?S-=360:S<-360&&(S+=360)},arc:async function(e,t,r){this.checkStatus();var s=h.getAbsolutePosition();g=s._x,m=s._z;var a=Math.round(S,0),l=Math.round(Math.sin(n["a"].degToRad(a))*r,2),u=Math.round(Math.cos(n["a"].degToRad(a))*r,2);e==o.Left?u=-u:l=-l;var d=new i["Vector3"](s._x+l,s._y,s._z+u);return c=new i["Vector3"](s._x,s._y,s._z),e==o.Right?await this.arc_right(t,r,s,d):e==o.Left?await this.arc_left(t,r,s,d):void 0},arcBlockly:function(e,t,r,s){this.checkStatus();var a=h.getAbsolutePosition(),l=Math.round(S,0),u=Math.round(Math.sin(n["a"].degToRad(l))*r,2),d=Math.round(Math.cos(n["a"].degToRad(l))*r,2);e==o.Left?d=-d:u=-u;var p=new i["Vector3"](a._x+u,a._y,a._z+d);c=new i["Vector3"](a._x,a._y,a._z),g=a._x,m=a._z,this.pencilTo(c._x,c._z),e==o.Right?this.arc_right(t,r,a,p).then(e=>{s(e)}):e==o.Left&&this.arc_left(t,r,a,p).then(e=>{s(e)})},arc_left:async function(e,t,r,i){var s=this.get_angle(c._z,c._x,i._z,i._x)+270;s=180-s,s=s<0?s+360:s,s=s>=360?s-360:s,y=r;var l=0,u=this;return await new Promise(r=>{var c=setInterval((function(){a||setTimeout((function(){clearInterval(c),r("arc left force stop")}));var d=!1;if(e-l<=E?setTimeout((function(){clearInterval(c);var a=e-l;s+=a;var d=i._z+t*Math.cos(n["a"].degToRad(s)),f=i._x-t*Math.sin(n["a"].degToRad(s));y._x=f,y._z=d,h.position=y,u.turnTaskSync(o.Left,a),u.pencilTo(y._x,y._z),p.arc&&console.log("[arc left done]z,x,roation.y",u.robotPosition().z,u.robotPosition().x,S),r("arc done")})):d=!0,d){var f=i._z+t*Math.cos(n["a"].degToRad(s)),_=i._x-t*Math.sin(n["a"].degToRad(s));y._x=_,y._z=f,h.position=y;var g=E;u.turnTaskSync(o.Left,g),u.pencilTo(y._x,y._z),s+=E,l+=E}}),O)})},arc_right:async function(e,t,r,i){var s=this.get_angle(c._z,c._x,i._z,i._x)+270;s=s>=360?s-360:s,y=r;var l=0,u=this;return await new Promise(r=>{var c=setInterval((function(){a||setTimeout((function(){clearInterval(c),r("arc right force stop")}));var d=!1;if(e-l<=E?setTimeout((function(){clearInterval(c);var a=e-l;s+=a;var d=i._z-t*Math.cos(n["a"].degToRad(s)),f=i._x-t*Math.sin(n["a"].degToRad(s));y._x=f,y._z=d,h.position=y,u.turnTaskSync(o.Right,a),u.pencilTo(y._x,y._z),p.arc&&console.log("[arc right done]z,x,roation.y",u.robotPosition().z,u.robotPosition().x,S),r("arc done")})):d=!0,d){var f=i._z-t*Math.cos(n["a"].degToRad(s)),_=i._x-t*Math.sin(n["a"].degToRad(s));y._x=_,y._z=f,h.position=y;var g=E;u.turnTaskSync(o.Right,g),u.pencilTo(y._x,y._z),s+=E,l+=E}}),O)})},get_angle:function(e,t,r,i){var n=Math.abs(e-r),o=Math.abs(t-i),s=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),a=o/s,l=Math.acos(a),h=Math.floor(180/(Math.PI/l));return r>e&&i>t&&(h=180-h),r==e&&i>t&&(h=180),r>e&&i==t&&(h=90),r<e&&i>t&&(h=180+h),r<e&&i==t&&(h=270),r<e&&i<t&&(h=360-h),h},resetBodyPose(e=0,t=0){S=0,this.setBodyHeading(this.initialHeading()),this.setBodyPosition(e,t)},setBodyPosition(e,t){h.position.x=e,h.position.z=t},initialHeading(){return 90},getBodyHeading(){return-n["a"].radToDeg(h.rotationQuaternion.toEulerAngles().y)},setBodyHeading(e){const t=h.rotationQuaternion.toEulerAngles();h.rotationQuaternion=i["Quaternion"].RotationYawPitchRoll(n["a"].degToRad(-e),t.x,t.z)}};t["a"]=N},"5e35":function(e,t,r){},"615b":function(e,t,r){},"671e":function(e,t,r){"use strict";r.r(t);var i=r("7496"),n=r("8336"),o=r("b0af"),s=r("99d9"),a=r("169a"),l=r("132d"),h=r("2fa4"),u=r("8654"),c=function(){var e=this,t=e._self._c;return t(i["a"],[t("div",{staticStyle:{height:"100%",width:"100%"}},[t("div",{staticClass:"navgationbar",on:{click:e.saveProject}},[t("div",{staticClass:"title"},[e._v(" "+e._s(e.projectTitle?e.projectTitle:"新项目"))]),e._e()],1),t(n["a"],{staticClass:"btnplay",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#4E737B"},on:{click:e.playAction}},[t(l["a"],[e._v("mdi-play")])],1),t(n["a"],{staticClass:"btnstop",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#4E737B"},on:{click:e.stopAction}},[t(l["a"],[e._v("mdi-stop")])],1),t(n["a"],{directives:[{name:"show",rawName:"v-show",value:!e.show3D,expression:"!show3D"}],staticClass:"btn3d",attrs:{elevation:"2",fab:"",icon:""},on:{click:e.show3DAction}},[t(l["a"],[e._v("mdi-menu-open")])],1),t("blocklycomponent",{ref:"blockRef",attrs:{id:"blockly",robotController:e.robotController,projectId:e.projectId}}),t("div",{directives:[{name:"window",rawName:"v-window",value:e.windowParams,expression:"windowParams"},{name:"show",rawName:"v-show",value:e.show3D,expression:"show3D"}],staticClass:"window1"},[t("div",{staticClass:"window__header"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("div",{staticStyle:{padding:"10px 20px 5px 20px",color:"white",display:"flex"}},[e._v("仿真 "),t("div",{attrs:{id:"fps"}})]),t(n["a"],{staticStyle:{padding:"10px 20px 5px 20px"},attrs:{icon:"",color:"white"},on:{click:e.close3dAction}},[t(l["a"],[e._v("mdi-close")])],1)],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.show3D,expression:"show3D"}],staticStyle:{"z-index":"10001","padding-left":"10px"}},[t("canvas",{attrs:{id:"renderCanvas"}})])]),t("div",{directives:[{name:"window",rawName:"v-window",value:e.windowParams,expression:"windowParams"},{name:"show",rawName:"v-show",value:!e.show3D,expression:"!show3D"}],staticClass:"window1"},[t("div",{staticClass:"window__header"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("div",[e._v("生成代码")])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.show3D,expression:"!show3D"}],staticStyle:{"z-index":"10001"}},[t("button",{on:{click:function(t){return e.showCode()}}},[e._v("Show JavaScript")]),t("pre",{domProps:{innerHTML:e._s(e.code)}})])]),t(a["a"],{staticStyle:{"z-index":"10009"},attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:i}){return[t(n["a"],e._g(e._b({staticClass:"backbtn",attrs:{elevation:"0",rounded:"",icon:"",large:"",color:"#80441E"}},"v-btn",i,!1),r),[t(l["a"],[e._v("mdi-reply")])],1)]}}]),model:{value:e.showExitDialog,callback:function(t){e.showExitDialog=t},expression:"showExitDialog"}},[t(o["a"],[t(s["c"],{staticClass:"text-h5"},[e._v(" 确定退出吗？ ")]),t(s["b"],[e._v("退出之前保存项目，可以在下次进入后继续编辑")]),t(s["a"],[t(h["a"]),t(n["a"],{attrs:{color:"grey",text:""},on:{click:e.backAction}},[e._v(" 继续退出 ")]),t(n["a"],{attrs:{color:"green darken-1",text:""},on:{click:e.saveProjectAndExit}},[e._v(" 保存 ")])],1)],1)],1),t("Modal",{attrs:{show:e.showsaveProject,title:"保存项目"},on:{hideModal:e.hideSaveProjectModal,submit:e.saveProjectSubmit}},[t(u["a"],{staticClass:"centered-input text--darken-3 mt-3",attrs:{placeholder:"输入项目名称","solo-inverted":"",flat:""},model:{value:e.projectTitle,callback:function(t){e.projectTitle=t},expression:"projectTitle"}})],1)],1)])},d=[],p=r("f32a"),f=r("5b28"),_=r("f289"),g=(r("8464"),r("fc06")),m=r.n(g),b=r("54ca"),y=r.n(b),v=r("714b"),T=r("e07a");window.robot=f["a"];var O=null;async function E(){var e=async function(){var e=document.getElementById("renderCanvas"),t=document.getElementById("fps");return p["a"].cleanDrawLines(),O=await p["a"].init(e,t),f["a"].initScene(O,p["a"].getRobot(),p["a"].getStartPoint()),f["a"].initRobotPenclDynamicTexture(p["a"].getRobotPenclDynamicTexture()),p["a"].bindRobotController(f["a"].getRobotInstance()),f["a"].getRobotInstance()},t=await e();return t}var A={name:"game",components:{blocklycomponent:_["a"],Modal:v["a"]},data(){return{projectId:null,projectTitle:"",code:"",robotController:null,showExitDialog:!1,show3D:!0,isShowCode:!0,showsaveProject:!1,isExitAfterSave:!1,windowParams:{movable:!0,resizable:!1}}},methods:{show3DAction(){console.log("show3DAction"),this.show3D=!this.show3D,0==this.show3D&&this.showCode()},close3dAction(){this.show3D=!1},saveProject(){this.showsaveProject=!0},backAction(){this.showExitDialog=!1,console.log("backAction"),this.$router.replace("/")},playAction(){this.$refs["blockRef"].runCodeClick()},stopAction(){this.$refs["blockRef"].stopCodeClick()},showCode(){this.code=m.a.workspaceToCode(this.$refs["blockRef"].workspace)},hideSaveProjectModal(){this.showsaveProject=!1},saveProjectSubmit(){this.saveProjectToLocal(),this.showsaveProject=!1},saveProjectAndExit(){this.projectTitle?(this.saveProjectToLocal(),this.backAction()):(this.showExitDialog=!1,this.isExitAfterSave=!0,this.saveProject())},saveProjectToLocal(){this.showsaveProject=!1;const e=y.a.Xml.workspaceToDom(this.$refs["blockRef"].workspace),t=y.a.Xml.domToText(e);window.localStorage.setItem(this.projectId,t);var r=T["a"].getLocalProjects();const i=(new Date).Format("yyyy-MM-dd HH:mm:ss");var n=!1;for(const s of r)if(s.id==this.projectId){s.name=this.projectTitle,s.update_time=i,n=!0;break}if(!n){var o={id:this.projectId,name:this.projectTitle,time:i,update_time:i,img:"art.jpg"};r.push(o)}console.log("xml_text",t),window.localStorage.setItem("MyProjects",JSON.stringify(r)),this.isExitAfterSave&&(this.isExitAfterSave=!1,this.$router.back())}},beforeDestroy(){var e=document.getElementById("customLoadingScreenDiv");e&&(e.outerHTML="")},async mounted(){this.projectId=this.$route.query.project_id;var e=T["a"].getLocalProjects();for(const i of e)if(i.id==this.projectId){this.projectTitle=i.name;break}var t=window.localStorage.getItem(this.projectId);if(console.log("xml_text",t),t){const e=y.a.Xml.textToDom(t);y.a.Xml.domToWorkspace(e,this.$refs["blockRef"].workspace)}var r=await E();this.robotController=r}},C=A,M=(r("9c0d"),r("2877")),x=Object(M["a"])(C,c,d,!1,null,"ef0e525c",null);t["default"]=x.exports},6821:function(e,t,r){(function(){var t=r("00d8"),i=r("9a63").utf8,n=r("044b"),o=r("9a63").bin,s=function(e,r){e.constructor==String?e=r&&"binary"===r.encoding?o.stringToBytes(e):i.stringToBytes(e):n(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var a=t.bytesToWords(e),l=8*e.length,h=1732584193,u=-271733879,c=-1732584194,d=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[14+(l+64>>>9<<4)]=l;var f=s._ff,_=s._gg,g=s._hh,m=s._ii;for(p=0;p<a.length;p+=16){var b=h,y=u,v=c,T=d;h=f(h,u,c,d,a[p+0],7,-680876936),d=f(d,h,u,c,a[p+1],12,-389564586),c=f(c,d,h,u,a[p+2],17,606105819),u=f(u,c,d,h,a[p+3],22,-1044525330),h=f(h,u,c,d,a[p+4],7,-176418897),d=f(d,h,u,c,a[p+5],12,1200080426),c=f(c,d,h,u,a[p+6],17,-1473231341),u=f(u,c,d,h,a[p+7],22,-45705983),h=f(h,u,c,d,a[p+8],7,1770035416),d=f(d,h,u,c,a[p+9],12,-1958414417),c=f(c,d,h,u,a[p+10],17,-42063),u=f(u,c,d,h,a[p+11],22,-1990404162),h=f(h,u,c,d,a[p+12],7,1804603682),d=f(d,h,u,c,a[p+13],12,-40341101),c=f(c,d,h,u,a[p+14],17,-1502002290),u=f(u,c,d,h,a[p+15],22,1236535329),h=_(h,u,c,d,a[p+1],5,-165796510),d=_(d,h,u,c,a[p+6],9,-1069501632),c=_(c,d,h,u,a[p+11],14,643717713),u=_(u,c,d,h,a[p+0],20,-373897302),h=_(h,u,c,d,a[p+5],5,-701558691),d=_(d,h,u,c,a[p+10],9,38016083),c=_(c,d,h,u,a[p+15],14,-660478335),u=_(u,c,d,h,a[p+4],20,-405537848),h=_(h,u,c,d,a[p+9],5,568446438),d=_(d,h,u,c,a[p+14],9,-1019803690),c=_(c,d,h,u,a[p+3],14,-187363961),u=_(u,c,d,h,a[p+8],20,1163531501),h=_(h,u,c,d,a[p+13],5,-1444681467),d=_(d,h,u,c,a[p+2],9,-51403784),c=_(c,d,h,u,a[p+7],14,1735328473),u=_(u,c,d,h,a[p+12],20,-1926607734),h=g(h,u,c,d,a[p+5],4,-378558),d=g(d,h,u,c,a[p+8],11,-2022574463),c=g(c,d,h,u,a[p+11],16,1839030562),u=g(u,c,d,h,a[p+14],23,-35309556),h=g(h,u,c,d,a[p+1],4,-1530992060),d=g(d,h,u,c,a[p+4],11,1272893353),c=g(c,d,h,u,a[p+7],16,-155497632),u=g(u,c,d,h,a[p+10],23,-1094730640),h=g(h,u,c,d,a[p+13],4,681279174),d=g(d,h,u,c,a[p+0],11,-358537222),c=g(c,d,h,u,a[p+3],16,-722521979),u=g(u,c,d,h,a[p+6],23,76029189),h=g(h,u,c,d,a[p+9],4,-640364487),d=g(d,h,u,c,a[p+12],11,-421815835),c=g(c,d,h,u,a[p+15],16,530742520),u=g(u,c,d,h,a[p+2],23,-995338651),h=m(h,u,c,d,a[p+0],6,-198630844),d=m(d,h,u,c,a[p+7],10,1126891415),c=m(c,d,h,u,a[p+14],15,-1416354905),u=m(u,c,d,h,a[p+5],21,-57434055),h=m(h,u,c,d,a[p+12],6,1700485571),d=m(d,h,u,c,a[p+3],10,-1894986606),c=m(c,d,h,u,a[p+10],15,-1051523),u=m(u,c,d,h,a[p+1],21,-2054922799),h=m(h,u,c,d,a[p+8],6,1873313359),d=m(d,h,u,c,a[p+15],10,-30611744),c=m(c,d,h,u,a[p+6],15,-1560198380),u=m(u,c,d,h,a[p+13],21,1309151649),h=m(h,u,c,d,a[p+4],6,-145523070),d=m(d,h,u,c,a[p+11],10,-1120210379),c=m(c,d,h,u,a[p+2],15,718787259),u=m(u,c,d,h,a[p+9],21,-343485551),h=h+b>>>0,u=u+y>>>0,c=c+v>>>0,d=d+T>>>0}return t.endian([h,u,c,d])};s._ff=function(e,t,r,i,n,o,s){var a=e+(t&r|~t&i)+(n>>>0)+s;return(a<<o|a>>>32-o)+t},s._gg=function(e,t,r,i,n,o,s){var a=e+(t&i|r&~i)+(n>>>0)+s;return(a<<o|a>>>32-o)+t},s._hh=function(e,t,r,i,n,o,s){var a=e+(t^r^i)+(n>>>0)+s;return(a<<o|a>>>32-o)+t},s._ii=function(e,t,r,i,n,o,s){var a=e+(r^(t|~i))+(n>>>0)+s;return(a<<o|a>>>32-o)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,r){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var i=t.wordsToBytes(s(e,r));return r&&r.asBytes?i:r&&r.asString?o.bytesToString(i):t.bytesToHex(i)}})()},"6cd8":function(e,t,r){"use strict";r("2bf3")},"6ece":function(e,t,r){},"6fcd":function(e,t,r){(function(t){!function(t,i){e.exports=i(r("633b"))}("undefined"!=typeof self&&self,(function(e){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(t,r){t.exports=e},function(e,t,r){"use strict";r.r(t),r.d(t,"Button",(function(){return T})),r.d(t,"Checkbox",(function(){return E})),r.d(t,"ColorPicker",(function(){return x})),r.d(t,"Container",(function(){return g})),r.d(t,"Control",(function(){return _})),r.d(t,"Ellipse",(function(){return w})),r.d(t,"Grid",(function(){return M})),r.d(t,"Image",(function(){return v})),r.d(t,"InputText",(function(){return C})),r.d(t,"InputPassword",(function(){return S})),r.d(t,"Line",(function(){return R})),r.d(t,"MultiLine",(function(){return I})),r.d(t,"RadioButton",(function(){return L})),r.d(t,"StackPanel",(function(){return O})),r.d(t,"SelectorGroup",(function(){return D})),r.d(t,"CheckboxGroup",(function(){return B})),r.d(t,"RadioGroup",(function(){return F})),r.d(t,"SliderGroup",(function(){return V})),r.d(t,"SelectionPanel",(function(){return H})),r.d(t,"ScrollViewer",(function(){return W})),r.d(t,"TextWrapping",(function(){return m})),r.d(t,"TextBlock",(function(){return y})),r.d(t,"TextWrapper",(function(){return A})),r.d(t,"KeyPropertySet",(function(){return z})),r.d(t,"VirtualKeyboard",(function(){return X})),r.d(t,"Rectangle",(function(){return b})),r.d(t,"DisplayGrid",(function(){return Y})),r.d(t,"BaseSlider",(function(){return N})),r.d(t,"Slider",(function(){return k})),r.d(t,"ImageBasedSlider",(function(){return K})),r.d(t,"ScrollBar",(function(){return U})),r.d(t,"ImageScrollBar",(function(){return G})),r.d(t,"name",(function(){return $})),r.d(t,"AdvancedDynamicTexture",(function(){return Z})),r.d(t,"AdvancedDynamicTextureInstrumentation",(function(){return J})),r.d(t,"Vector2WithInfo",(function(){return p})),r.d(t,"Matrix2D",(function(){return f})),r.d(t,"Measure",(function(){return d})),r.d(t,"MultiLinePoint",(function(){return P})),r.d(t,"Style",(function(){return q})),r.d(t,"ValueAndUnit",(function(){return a})),r.d(t,"XmlLoader",(function(){return Q})),r.d(t,"AbstractButton3D",(function(){return re})),r.d(t,"Button3D",(function(){return ie})),r.d(t,"Container3D",(function(){return ne})),r.d(t,"Control3D",(function(){return te})),r.d(t,"CylinderPanel",(function(){return se})),r.d(t,"HolographicButton",(function(){return ce})),r.d(t,"MeshButton3D",(function(){return de})),r.d(t,"PlanePanel",(function(){return pe})),r.d(t,"ScatterPanel",(function(){return fe})),r.d(t,"SpherePanel",(function(){return _e})),r.d(t,"StackPanel3D",(function(){return ge})),r.d(t,"VolumeBasedPanel",(function(){return oe})),r.d(t,"FluentMaterialDefines",(function(){return he})),r.d(t,"FluentMaterial",(function(){return ue})),r.d(t,"GUI3DManager",(function(){return me})),r.d(t,"Vector3WithInfo",(function(){return ee}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}Object.create,Object.create;var s=r(0),a=function(){function e(t,r,i){void 0===r&&(r=e.UNITMODE_PIXEL),void 0===i&&(i=!0),this.unit=r,this.negativeValueAllowed=i,this._value=1,this.ignoreAdaptiveScaling=!1,this._value=t,this._originalUnit=r}return Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.unit===e.UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPixel",{get:function(){return this.unit===e.UNITMODE_PIXEL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalValue",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.getValueInPixel=function(e,t){return this.isPixel?this.getValue(e):this.getValue(e)*t},e.prototype.updateInPlace=function(t,r){return void 0===r&&(r=e.UNITMODE_PIXEL),this._value=t,this.unit=r,this},e.prototype.getValue=function(t){if(t&&!this.ignoreAdaptiveScaling&&this.unit!==e.UNITMODE_PERCENTAGE){var r=0,i=0;if(t.idealWidth&&(r=this._value*t.getSize().width/t.idealWidth),t.idealHeight&&(i=this._value*t.getSize().height/t.idealHeight),t.useSmallestIdeal&&t.idealWidth&&t.idealHeight)return window.innerWidth<window.innerHeight?r:i;if(t.idealWidth)return r;if(t.idealHeight)return i}return this._value},e.prototype.toString=function(t,r){switch(this.unit){case e.UNITMODE_PERCENTAGE:var i=100*this.getValue(t);return(r?i.toFixed(r):i)+"%";case e.UNITMODE_PIXEL:var n=this.getValue(t);return(r?n.toFixed(r):n)+"px"}return this.unit.toString()},e.prototype.fromString=function(t){var r=e._Regex.exec(t.toString());if(!r||0===r.length)return!1;var i=parseFloat(r[1]),n=this._originalUnit;if(this.negativeValueAllowed||i<0&&(i=0),4===r.length)switch(r[3]){case"px":n=e.UNITMODE_PIXEL;break;case"%":n=e.UNITMODE_PERCENTAGE,i/=100}return(i!==this._value||n!==this.unit)&&(this._value=i,this.unit=n,!0)},Object.defineProperty(e,"UNITMODE_PERCENTAGE",{get:function(){return e._UNITMODE_PERCENTAGE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UNITMODE_PIXEL",{get:function(){return e._UNITMODE_PIXEL},enumerable:!1,configurable:!0}),e._Regex=/(^-?\d*(\.\d+)?)(%|px)?/,e._UNITMODE_PERCENTAGE=0,e._UNITMODE_PIXEL=1,e}(),l=[new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0)],h=[new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0),new s.Vector2(0,0)],u=new s.Vector2(0,0),c=new s.Vector2(0,0),d=function(){function e(e,t,r,i){this.left=e,this.top=t,this.width=r,this.height=i}return e.prototype.copyFrom=function(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t,r,i){this.left=e,this.top=t,this.width=r,this.height=i},e.CombineToRef=function(e,t,r){var i=Math.min(e.left,t.left),n=Math.min(e.top,t.top),o=Math.max(e.left+e.width,t.left+t.width),s=Math.max(e.top+e.height,t.top+t.height);r.left=i,r.top=n,r.width=o-i,r.height=s-n},e.prototype.addAndTransformToRef=function(e,t,r,i,n,o){var s=this.left+t,a=this.top+r,d=this.width+i,p=this.height+n;l[0].copyFromFloats(s,a),l[1].copyFromFloats(s+d,a),l[2].copyFromFloats(s+d,a+p),l[3].copyFromFloats(s,a+p),u.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE),c.copyFromFloats(0,0);for(var f=0;f<4;f++)e.transformCoordinates(l[f].x,l[f].y,h[f]),u.x=Math.floor(Math.min(u.x,h[f].x)),u.y=Math.floor(Math.min(u.y,h[f].y)),c.x=Math.ceil(Math.max(c.x,h[f].x)),c.y=Math.ceil(Math.max(c.y,h[f].y));o.left=u.x,o.top=u.y,o.width=c.x-u.x,o.height=c.y-u.y},e.prototype.transformToRef=function(e,t){this.addAndTransformToRef(e,0,0,0,0,t)},e.prototype.isEqualsTo=function(e){return this.left===e.left&&this.top===e.top&&this.width===e.width&&this.height===e.height},e.Empty=function(){return new e(0,0,0,0)},e}(),p=function(e){function t(t,r){void 0===r&&(r=0);var i=e.call(this,t.x,t.y)||this;return i.buttonIndex=r,i}return n(t,e),t}(s.Vector2),f=function(){function e(e,t,r,i,n,o){this.m=new Float32Array(6),this.fromValues(e,t,r,i,n,o)}return e.prototype.fromValues=function(e,t,r,i,n,o){return this.m[0]=e,this.m[1]=t,this.m[2]=r,this.m[3]=i,this.m[4]=n,this.m[5]=o,this},e.prototype.determinant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]},e.prototype.invertToRef=function(e){var t=this.m[0],r=this.m[1],i=this.m[2],n=this.m[3],o=this.m[4],a=this.m[5],l=this.determinant();if(l<s.Epsilon*s.Epsilon)return e.m[0]=0,e.m[1]=0,e.m[2]=0,e.m[3]=0,e.m[4]=0,e.m[5]=0,this;var h=1/l,u=i*a-n*o,c=r*o-t*a;return e.m[0]=n*h,e.m[1]=-r*h,e.m[2]=-i*h,e.m[3]=t*h,e.m[4]=u*h,e.m[5]=c*h,this},e.prototype.multiplyToRef=function(e,t){var r=this.m[0],i=this.m[1],n=this.m[2],o=this.m[3],s=this.m[4],a=this.m[5],l=e.m[0],h=e.m[1],u=e.m[2],c=e.m[3],d=e.m[4],p=e.m[5];return t.m[0]=r*l+i*u,t.m[1]=r*h+i*c,t.m[2]=n*l+o*u,t.m[3]=n*h+o*c,t.m[4]=s*l+a*u+d,t.m[5]=s*h+a*c+p,this},e.prototype.transformCoordinates=function(e,t,r){return r.x=e*this.m[0]+t*this.m[2]+this.m[4],r.y=e*this.m[1]+t*this.m[3]+this.m[5],this},e.Identity=function(){return new e(1,0,0,1,0,0)},e.TranslationToRef=function(e,t,r){r.fromValues(1,0,0,1,e,t)},e.ScalingToRef=function(e,t,r){r.fromValues(e,0,0,t,0,0)},e.RotationToRef=function(e,t){var r=Math.sin(e),i=Math.cos(e);t.fromValues(i,r,-r,i,0,0)},e.ComposeToRef=function(t,r,i,n,o,s,a){e.TranslationToRef(t,r,e._TempPreTranslationMatrix),e.ScalingToRef(n,o,e._TempScalingMatrix),e.RotationToRef(i,e._TempRotationMatrix),e.TranslationToRef(-t,-r,e._TempPostTranslationMatrix),e._TempPreTranslationMatrix.multiplyToRef(e._TempScalingMatrix,e._TempCompose0),e._TempCompose0.multiplyToRef(e._TempRotationMatrix,e._TempCompose1),s?(e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,e._TempCompose2),e._TempCompose2.multiplyToRef(s,a)):e._TempCompose1.multiplyToRef(e._TempPostTranslationMatrix,a)},e._TempPreTranslationMatrix=e.Identity(),e._TempPostTranslationMatrix=e.Identity(),e._TempRotationMatrix=e.Identity(),e._TempScalingMatrix=e.Identity(),e._TempCompose0=e.Identity(),e._TempCompose1=e.Identity(),e._TempCompose2=e.Identity(),e}(),_=function(){function e(t){this.name=t,this._alpha=1,this._alphaSet=!1,this._zIndex=0,this._currentMeasure=d.Empty(),this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new a(18,a.UNITMODE_PIXEL,!1),this._width=new a(1,a.UNITMODE_PERCENTAGE,!1),this._height=new a(1,a.UNITMODE_PERCENTAGE,!1),this._color="",this._style=null,this._horizontalAlignment=e.HORIZONTAL_ALIGNMENT_CENTER,this._verticalAlignment=e.VERTICAL_ALIGNMENT_CENTER,this._isDirty=!0,this._wasDirty=!1,this._tempParentMeasure=d.Empty(),this._prevCurrentMeasureTransformedIntoGlobalSpace=d.Empty(),this._cachedParentMeasure=d.Empty(),this._paddingLeft=new a(0),this._paddingRight=new a(0),this._paddingTop=new a(0),this._paddingBottom=new a(0),this._left=new a(0),this._top=new a(0),this._scaleX=1,this._scaleY=1,this._rotation=0,this._transformCenterX=.5,this._transformCenterY=.5,this._transformMatrix=f.Identity(),this._invertTransformMatrix=f.Identity(),this._transformedPosition=s.Vector2.Zero(),this._isMatrixDirty=!0,this._isVisible=!0,this._isHighlighted=!1,this._fontSet=!1,this._dummyVector2=s.Vector2.Zero(),this._downCount=0,this._enterCount=-1,this._doNotRender=!1,this._downPointerIds={},this._isEnabled=!0,this._disabledColor="#9a9a9a",this._disabledColorItem="#6a6a6a",this._rebuildLayout=!1,this._customData={},this._isClipped=!1,this._automaticSize=!1,this.metadata=null,this.isHitTestVisible=!0,this.isPointerBlocker=!1,this.isFocusInvisible=!1,this.clipChildren=!0,this.clipContent=!0,this.useBitmapCache=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowBlur=0,this._shadowColor="black",this.hoverCursor="",this._linkOffsetX=new a(0),this._linkOffsetY=new a(0),this.onWheelObservable=new s.Observable,this.onPointerMoveObservable=new s.Observable,this.onPointerOutObservable=new s.Observable,this.onPointerDownObservable=new s.Observable,this.onPointerUpObservable=new s.Observable,this.onPointerClickObservable=new s.Observable,this.onPointerEnterObservable=new s.Observable,this.onDirtyObservable=new s.Observable,this.onBeforeDrawObservable=new s.Observable,this.onAfterDrawObservable=new s.Observable,this.onDisposeObservable=new s.Observable,this.fixedRatio=0,this._fixedRatioMasterIsWidth=!0,this._tmpMeasureA=new d(0,0,0,0)}return Object.defineProperty(e.prototype,"shadowOffsetX",{get:function(){return this._shadowOffsetX},set:function(e){this._shadowOffsetX!==e&&(this._shadowOffsetX=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowOffsetY",{get:function(){return this._shadowOffsetY},set:function(e){this._shadowOffsetY!==e&&(this._shadowOffsetY=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowBlur",{get:function(){return this._shadowBlur},set:function(e){this._shadowBlur!==e&&(this._shadowBlur=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._shadowColor},set:function(e){this._shadowColor!==e&&(this._shadowColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontOffset",{get:function(){return this._fontOffset},set:function(e){this._fontOffset=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alphaSet=!0,this._alpha=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(e){this._isHighlighted!==e&&(this._isHighlighted=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX!==e&&(this._scaleX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY!==e&&(this._scaleY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterY",{get:function(){return this._transformCenterY},set:function(e){this._transformCenterY!==e&&(this._transformCenterY=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformCenterX",{get:function(){return this._transformCenterX},set:function(e){this._transformCenterX!==e&&(this._transformCenterX=e,this._markAsDirty(),this._markMatrixAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlignment",{get:function(){return this._horizontalAlignment},set:function(e){this._horizontalAlignment!==e&&(this._horizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this._verticalAlignment},set:function(e){this._verticalAlignment!==e&&(this._verticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!0,this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"widthInPixels",{get:function(){return this._width.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!0,this.width=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._fixedRatioMasterIsWidth=!1,this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heightInPixels",{get:function(){return this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this._fixedRatioMasterIsWidth=!1,this.height=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontSet?this._fontFamily:""},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(e){var t=this;this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this._style=e,this._style&&(this._styleObserver=this._style.onChangedObservable.add((function(){t._markAsDirty(),t._resetFontCache()}))),this._markAsDirty(),this._resetFontCache()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFontSizeInPercentage",{get:function(){return this._fontSize.isPercentage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeInPixels",{get:function(){var e=this._style?this._style._fontSize:this._fontSize;return e.isPixel?e.getValue(this._host):e.getValueInPixel(this._host,this._tempParentMeasure.height||this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.fontSize=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&(this._markAsDirty(),this._resetFontCache())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(e){this._color!==e&&(this._color=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this.zIndex!==e&&(this._zIndex=e,this.parent&&this.parent._reOrderControl(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notRenderable",{get:function(){return this._doNotRender},set:function(e){this._doNotRender!==e&&(this._doNotRender=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible!==e&&(this._isVisible=e,this._markAsDirty(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkedMesh",{get:function(){return this._linkedMesh},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft.toString(this._host)},set:function(e){this._paddingLeft.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeftInPixels",{get:function(){return this._paddingLeft.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingLeft=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight.toString(this._host)},set:function(e){this._paddingRight.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingRightInPixels",{get:function(){return this._paddingRight.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.paddingRight=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop.toString(this._host)},set:function(e){this._paddingTop.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingTopInPixels",{get:function(){return this._paddingTop.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingTop=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom.toString(this._host)},set:function(e){this._paddingBottom.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottomInPixels",{get:function(){return this._paddingBottom.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.paddingBottom=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._left.toString(this._host)},set:function(e){this._left.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftInPixels",{get:function(){return this._left.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.left=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top.toString(this._host)},set:function(e){this._top.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topInPixels",{get:function(){return this._top.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.top=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetX",{get:function(){return this._linkOffsetX.toString(this._host)},set:function(e){this._linkOffsetX.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetXInPixels",{get:function(){return this._linkOffsetX.getValueInPixel(this._host,this._cachedParentMeasure.width)},set:function(e){isNaN(e)||(this.linkOffsetX=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetY",{get:function(){return this._linkOffsetY.toString(this._host)},set:function(e){this._linkOffsetY.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkOffsetYInPixels",{get:function(){return this._linkOffsetY.getValueInPixel(this._host,this._cachedParentMeasure.height)},set:function(e){isNaN(e)||(this.linkOffsetY=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerX",{get:function(){return this._currentMeasure.left+this._currentMeasure.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerY",{get:function(){return this._currentMeasure.top+this._currentMeasure.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColor",{get:function(){return this._disabledColor},set:function(e){this._disabledColor!==e&&(this._disabledColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabledColorItem",{get:function(){return this._disabledColorItem},set:function(e){this._disabledColorItem!==e&&(this._disabledColorItem=e,this._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype._getTypeName=function(){return"Control"},e.prototype.getAscendantOfClass=function(e){return this.parent?this.parent.getClassName()===e?this.parent:this.parent.getAscendantOfClass(e):null},e.prototype._resetFontCache=function(){this._fontSet=!0,this._markAsDirty()},e.prototype.isAscendant=function(e){return!!this.parent&&(this.parent===e||this.parent.isAscendant(e))},e.prototype.getLocalCoordinates=function(e){var t=s.Vector2.Zero();return this.getLocalCoordinatesToRef(e,t),t},e.prototype.getLocalCoordinatesToRef=function(e,t){return t.x=e.x-this._currentMeasure.left,t.y=e.y-this._currentMeasure.top,this},e.prototype.getParentLocalCoordinates=function(e){var t=s.Vector2.Zero();return t.x=e.x-this._cachedParentMeasure.left,t.y=e.y-this._cachedParentMeasure.top,t},e.prototype.moveToVector3=function(t,r){if(this._host&&this.parent===this._host._rootContainer){this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP;var i=this._host._getGlobalViewport(r),n=s.Vector3.Project(t,s.Matrix.Identity(),r.getTransformMatrix(),i);this._moveToProjectedPosition(n),n.z<0||n.z>1?this.notRenderable=!0:this.notRenderable=!1}else s.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},e.prototype.getDescendantsToRef=function(e,t,r){void 0===t&&(t=!1)},e.prototype.getDescendants=function(e,t){var r=new Array;return this.getDescendantsToRef(r,e,t),r},e.prototype.linkWithMesh=function(t){if(!this._host||this.parent&&this.parent!==this._host._rootContainer)t&&s.Tools.Error("Cannot link a control to a mesh if the control is not at root level");else{var r=this._host._linkedControls.indexOf(this);if(-1!==r)return this._linkedMesh=t,void(t||this._host._linkedControls.splice(r,1));t&&(this.horizontalAlignment=e.HORIZONTAL_ALIGNMENT_LEFT,this.verticalAlignment=e.VERTICAL_ALIGNMENT_TOP,this._linkedMesh=t,this._host._linkedControls.push(this))}},e.prototype._moveToProjectedPosition=function(e){var t=this._left.getValue(this._host),r=this._top.getValue(this._host),i=e.x+this._linkOffsetX.getValue(this._host)-this._currentMeasure.width/2,n=e.y+this._linkOffsetY.getValue(this._host)-this._currentMeasure.height/2;this._left.ignoreAdaptiveScaling&&this._top.ignoreAdaptiveScaling&&(Math.abs(i-t)<.5&&(i=t),Math.abs(n-r)<.5&&(n=r)),this.left=i+"px",this.top=n+"px",this._left.ignoreAdaptiveScaling=!0,this._top.ignoreAdaptiveScaling=!0,this._markAsDirty()},e.prototype._offsetLeft=function(e){this._isDirty=!0,this._currentMeasure.left+=e},e.prototype._offsetTop=function(e){this._isDirty=!0,this._currentMeasure.top+=e},e.prototype._markMatrixAsDirty=function(){this._isMatrixDirty=!0,this._flagDescendantsAsMatrixDirty()},e.prototype._flagDescendantsAsMatrixDirty=function(){},e.prototype._intersectsRect=function(e){return this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),!(this._tmpMeasureA.left>=e.left+e.width)&&!(this._tmpMeasureA.top>=e.top+e.height)&&!(this._tmpMeasureA.left+this._tmpMeasureA.width<=e.left)&&!(this._tmpMeasureA.top+this._tmpMeasureA.height<=e.top)},e.prototype.invalidateRect=function(){if(this._transform(),this.host&&this.host.useInvalidateRectOptimization)if(this._currentMeasure.transformToRef(this._transformMatrix,this._tmpMeasureA),d.CombineToRef(this._tmpMeasureA,this._prevCurrentMeasureTransformedIntoGlobalSpace,this._tmpMeasureA),this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var e=this.shadowOffsetX,t=this.shadowOffsetY,r=this.shadowBlur,i=Math.min(Math.min(e,0)-2*r,0),n=Math.max(Math.max(e,0)+2*r,0),o=Math.min(Math.min(t,0)-2*r,0),s=Math.max(Math.max(t,0)+2*r,0);this.host.invalidateRect(Math.floor(this._tmpMeasureA.left+i),Math.floor(this._tmpMeasureA.top+o),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width+n),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height+s))}else this.host.invalidateRect(Math.floor(this._tmpMeasureA.left),Math.floor(this._tmpMeasureA.top),Math.ceil(this._tmpMeasureA.left+this._tmpMeasureA.width),Math.ceil(this._tmpMeasureA.top+this._tmpMeasureA.height))},e.prototype._markAsDirty=function(e){void 0===e&&(e=!1),(this._isVisible||e)&&(this._isDirty=!0,this._host&&this._host.markAsDirty())},e.prototype._markAllAsDirty=function(){this._markAsDirty(),this._font&&this._prepareFont()},e.prototype._link=function(e){this._host=e,this._host&&(this.uniqueId=this._host.getScene().getUniqueId())},e.prototype._transform=function(e){if(this._isMatrixDirty||1!==this._scaleX||1!==this._scaleY||0!==this._rotation){var t=this._currentMeasure.width*this._transformCenterX+this._currentMeasure.left,r=this._currentMeasure.height*this._transformCenterY+this._currentMeasure.top;e&&(e.translate(t,r),e.rotate(this._rotation),e.scale(this._scaleX,this._scaleY),e.translate(-t,-r)),(this._isMatrixDirty||this._cachedOffsetX!==t||this._cachedOffsetY!==r)&&(this._cachedOffsetX=t,this._cachedOffsetY=r,this._isMatrixDirty=!1,this._flagDescendantsAsMatrixDirty(),f.ComposeToRef(-t,-r,this._rotation,this._scaleX,this._scaleY,this.parent?this.parent._transformMatrix:null,this._transformMatrix),this._transformMatrix.invertToRef(this._invertTransformMatrix))}},e.prototype._renderHighlight=function(e){this.isHighlighted&&(e.save(),e.strokeStyle="#4affff",e.lineWidth=2,this._renderHighlightSpecific(e),e.restore())},e.prototype._renderHighlightSpecific=function(e){e.strokeRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)},e.prototype._applyStates=function(t){this._isFontSizeInPercentage&&(this._fontSet=!0),this._fontSet&&(this._prepareFont(),this._fontSet=!1),this._font&&(t.font=this._font),this._color&&(t.fillStyle=this._color),e.AllowAlphaInheritance?t.globalAlpha*=this._alpha:this._alphaSet&&(t.globalAlpha=this.parent?this.parent.alpha*this._alpha:this._alpha)},e.prototype._layout=function(e,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;if(this._isDirty||!this._cachedParentMeasure.isEqualsTo(e)){this.host._numLayoutCalls++,this._currentMeasure.addAndTransformToRef(this._transformMatrix,0|-this.paddingLeftInPixels,0|-this.paddingTopInPixels,0|this.paddingRightInPixels,0|this.paddingBottomInPixels,this._prevCurrentMeasureTransformedIntoGlobalSpace),t.save(),this._applyStates(t);var r=0;do{this._rebuildLayout=!1,this._processMeasures(e,t),r++}while(this._rebuildLayout&&r<3);r>=3&&s.Logger.Error("Layout cycle detected in GUI (Control name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this.invalidateRect(),this._evaluateClippingState(e)}return this._wasDirty=this._isDirty,this._isDirty=!1,!0},e.prototype._processMeasures=function(e,t){this._currentMeasure.copyFrom(e),this._preMeasure(e,t),this._measure(),this._computeAlignment(e,t),this._currentMeasure.left=0|this._currentMeasure.left,this._currentMeasure.top=0|this._currentMeasure.top,this._currentMeasure.width=0|this._currentMeasure.width,this._currentMeasure.height=0|this._currentMeasure.height,this._additionalProcessing(e,t),this._cachedParentMeasure.copyFrom(e),this.onDirtyObservable.hasObservers()&&this.onDirtyObservable.notifyObservers(this)},e.prototype._evaluateClippingState=function(e){if(this.parent&&this.parent.clipChildren){if(this._currentMeasure.left>e.left+e.width)return void(this._isClipped=!0);if(this._currentMeasure.left+this._currentMeasure.width<e.left)return void(this._isClipped=!0);if(this._currentMeasure.top>e.top+e.height)return void(this._isClipped=!0);if(this._currentMeasure.top+this._currentMeasure.height<e.top)return void(this._isClipped=!0)}this._isClipped=!1},e.prototype._measure=function(){this._width.isPixel?this._currentMeasure.width=this._width.getValue(this._host):this._currentMeasure.width*=this._width.getValue(this._host),this._height.isPixel?this._currentMeasure.height=this._height.getValue(this._host):this._currentMeasure.height*=this._height.getValue(this._host),0!==this.fixedRatio&&(this._fixedRatioMasterIsWidth?this._currentMeasure.height=this._currentMeasure.width*this.fixedRatio:this._currentMeasure.width=this._currentMeasure.height*this.fixedRatio)},e.prototype._computeAlignment=function(t,r){var i=this._currentMeasure.width,n=this._currentMeasure.height,o=t.width,s=t.height,a=0,l=0;switch(this.horizontalAlignment){case e.HORIZONTAL_ALIGNMENT_LEFT:a=0;break;case e.HORIZONTAL_ALIGNMENT_RIGHT:a=o-i;break;case e.HORIZONTAL_ALIGNMENT_CENTER:a=(o-i)/2}switch(this.verticalAlignment){case e.VERTICAL_ALIGNMENT_TOP:l=0;break;case e.VERTICAL_ALIGNMENT_BOTTOM:l=s-n;break;case e.VERTICAL_ALIGNMENT_CENTER:l=(s-n)/2}this._paddingLeft.isPixel?(this._currentMeasure.left+=this._paddingLeft.getValue(this._host),this._currentMeasure.width-=this._paddingLeft.getValue(this._host)):(this._currentMeasure.left+=o*this._paddingLeft.getValue(this._host),this._currentMeasure.width-=o*this._paddingLeft.getValue(this._host)),this._paddingRight.isPixel?this._currentMeasure.width-=this._paddingRight.getValue(this._host):this._currentMeasure.width-=o*this._paddingRight.getValue(this._host),this._paddingTop.isPixel?(this._currentMeasure.top+=this._paddingTop.getValue(this._host),this._currentMeasure.height-=this._paddingTop.getValue(this._host)):(this._currentMeasure.top+=s*this._paddingTop.getValue(this._host),this._currentMeasure.height-=s*this._paddingTop.getValue(this._host)),this._paddingBottom.isPixel?this._currentMeasure.height-=this._paddingBottom.getValue(this._host):this._currentMeasure.height-=s*this._paddingBottom.getValue(this._host),this._left.isPixel?this._currentMeasure.left+=this._left.getValue(this._host):this._currentMeasure.left+=o*this._left.getValue(this._host),this._top.isPixel?this._currentMeasure.top+=this._top.getValue(this._host):this._currentMeasure.top+=s*this._top.getValue(this._host),this._currentMeasure.left+=a,this._currentMeasure.top+=l},e.prototype._preMeasure=function(e,t){},e.prototype._additionalProcessing=function(e,t){},e.prototype._clipForChildren=function(e){},e.prototype._clip=function(t,r){if(t.beginPath(),e._ClipMeasure.copyFrom(this._currentMeasure),r){r.transformToRef(this._invertTransformMatrix,this._tmpMeasureA);var i=new d(0,0,0,0);i.left=Math.max(this._tmpMeasureA.left,this._currentMeasure.left),i.top=Math.max(this._tmpMeasureA.top,this._currentMeasure.top),i.width=Math.min(this._tmpMeasureA.left+this._tmpMeasureA.width,this._currentMeasure.left+this._currentMeasure.width)-i.left,i.height=Math.min(this._tmpMeasureA.top+this._tmpMeasureA.height,this._currentMeasure.top+this._currentMeasure.height)-i.top,e._ClipMeasure.copyFrom(i)}if(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY){var n=this.shadowOffsetX,o=this.shadowOffsetY,s=this.shadowBlur,a=Math.min(Math.min(n,0)-2*s,0),l=Math.max(Math.max(n,0)+2*s,0),h=Math.min(Math.min(o,0)-2*s,0),u=Math.max(Math.max(o,0)+2*s,0);t.rect(e._ClipMeasure.left+a,e._ClipMeasure.top+h,e._ClipMeasure.width+l-a,e._ClipMeasure.height+u-h)}else t.rect(e._ClipMeasure.left,e._ClipMeasure.top,e._ClipMeasure.width,e._ClipMeasure.height);t.clip()},e.prototype._render=function(e,t){return!this.isVisible||this.notRenderable||this._isClipped?(this._isDirty=!1,!1):(this.host._numRenderCalls++,e.save(),this._applyStates(e),this._transform(e),this.clipContent&&this._clip(e,t),this.onBeforeDrawObservable.hasObservers()&&this.onBeforeDrawObservable.notifyObservers(this),this.useBitmapCache&&!this._wasDirty&&this._cacheData?e.putImageData(this._cacheData,this._currentMeasure.left,this._currentMeasure.top):this._draw(e,t),this.useBitmapCache&&this._wasDirty&&(this._cacheData=e.getImageData(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._renderHighlight(e),this.onAfterDrawObservable.hasObservers()&&this.onAfterDrawObservable.notifyObservers(this),e.restore(),!0)},e.prototype._draw=function(e,t){},e.prototype.contains=function(e,t){return this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y,!(e<this._currentMeasure.left)&&!(e>this._currentMeasure.left+this._currentMeasure.width)&&!(t<this._currentMeasure.top)&&!(t>this._currentMeasure.top+this._currentMeasure.height)&&(this.isPointerBlocker&&(this._host._shouldBlockPointer=!0),!0)},e.prototype._processPicking=function(e,t,r,i,n,o,s,a){return!!this._isEnabled&&!(!this.isHitTestVisible||!this.isVisible||this._doNotRender)&&!!this.contains(e,t)&&(this._processObservables(i,e,t,r,n,o,s,a),!0)},e.prototype._onPointerMove=function(e,t,r,i){this.onPointerMoveObservable.notifyObservers(t,-1,e,this,i)&&null!=this.parent&&this.parent._onPointerMove(e,t,r,i)},e.prototype._onPointerEnter=function(e,t){return!!this._isEnabled&&!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,e,this,t)&&null!=this.parent&&this.parent._onPointerEnter(e,t),!0)},e.prototype._onPointerOut=function(e,t,r){if(void 0===r&&(r=!1),r||this._isEnabled&&e!==this){this._enterCount=0;var i=!0;e.isAscendant(this)||(i=this.onPointerOutObservable.notifyObservers(this,-1,e,this,t)),i&&null!=this.parent&&this.parent._onPointerOut(e,t,r)}},e.prototype._onPointerDown=function(e,t,r,i,n){return this._onPointerEnter(this,n),0===this._downCount&&(this._downCount++,this._downPointerIds[r]=!0,this.onPointerDownObservable.notifyObservers(new p(t,i),-1,e,this,n)&&null!=this.parent&&this.parent._onPointerDown(e,t,r,i,n),!0)},e.prototype._onPointerUp=function(e,t,r,i,n,o){if(this._isEnabled){this._downCount=0,delete this._downPointerIds[r];var s=n;n&&(this._enterCount>0||-1===this._enterCount)&&(s=this.onPointerClickObservable.notifyObservers(new p(t,i),-1,e,this,o)),this.onPointerUpObservable.notifyObservers(new p(t,i),-1,e,this,o)&&null!=this.parent&&this.parent._onPointerUp(e,t,r,i,s,o)}},e.prototype._forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,s.Vector2.Zero(),e,0,!0);else for(var t in this._downPointerIds)this._onPointerUp(this,s.Vector2.Zero(),+t,0,!0)},e.prototype._onWheelScroll=function(e,t){this._isEnabled&&this.onWheelObservable.notifyObservers(new s.Vector2(e,t))&&null!=this.parent&&this.parent._onWheelScroll(e,t)},e.prototype._onCanvasBlur=function(){},e.prototype._processObservables=function(e,t,r,i,n,o,a,l){if(!this._isEnabled)return!1;if(this._dummyVector2.copyFromFloats(t,r),e===s.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,this._dummyVector2,n,i);var h=this._host._lastControlOver[n];return h&&h!==this&&h._onPointerOut(this,i),h!==this&&this._onPointerEnter(this,i),this._host._lastControlOver[n]=this,!0}return e===s.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,this._dummyVector2,n,o,i),this._host._registerLastControlDown(this,n),this._host._lastPickedControl=this,!0):e===s.PointerEventTypes.POINTERUP?(this._host._lastControlDown[n]&&this._host._lastControlDown[n]._onPointerUp(this,this._dummyVector2,n,o,!0,i),delete this._host._lastControlDown[n],!0):!(e!==s.PointerEventTypes.POINTERWHEEL||!this._host._lastControlOver[n])&&(this._host._lastControlOver[n]._onWheelScroll(a,l),!0)},e.prototype._prepareFont=function(){(this._font||this._fontSet)&&(this._style?this._font=this._style.fontStyle+" "+this._style.fontWeight+" "+this.fontSizeInPixels+"px "+this._style.fontFamily:this._font=this._fontStyle+" "+this._fontWeight+" "+this.fontSizeInPixels+"px "+this._fontFamily,this._fontOffset=e._GetFontOffset(this._font))},e.prototype.dispose=function(){this.onDirtyObservable.clear(),this.onBeforeDrawObservable.clear(),this.onAfterDrawObservable.clear(),this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this.onWheelObservable.clear(),this._styleObserver&&this._style&&(this._style.onChangedObservable.remove(this._styleObserver),this._styleObserver=null),this.parent&&(this.parent.removeControl(this),this.parent=null),this._host&&this._host._linkedControls.indexOf(this)>-1&&this.linkWithMesh(null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_LEFT",{get:function(){return e._HORIZONTAL_ALIGNMENT_LEFT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_RIGHT",{get:function(){return e._HORIZONTAL_ALIGNMENT_RIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HORIZONTAL_ALIGNMENT_CENTER",{get:function(){return e._HORIZONTAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_TOP",{get:function(){return e._VERTICAL_ALIGNMENT_TOP},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_BOTTOM",{get:function(){return e._VERTICAL_ALIGNMENT_BOTTOM},enumerable:!1,configurable:!0}),Object.defineProperty(e,"VERTICAL_ALIGNMENT_CENTER",{get:function(){return e._VERTICAL_ALIGNMENT_CENTER},enumerable:!1,configurable:!0}),e._GetFontOffset=function(t){if(e._FontHeightSizes[t])return e._FontHeightSizes[t];var r=document.createElement("span");r.innerHTML="Hg",r.style.font=t;var i=document.createElement("div");i.style.display="inline-block",i.style.width="1px",i.style.height="0px",i.style.verticalAlign="bottom";var n=document.createElement("div");n.style.whiteSpace="nowrap",n.appendChild(r),n.appendChild(i),document.body.appendChild(n);var o=0,s=0;try{s=i.getBoundingClientRect().top-r.getBoundingClientRect().top,i.style.verticalAlign="baseline",o=i.getBoundingClientRect().top-r.getBoundingClientRect().top}finally{document.body.removeChild(n)}var a={ascent:o,height:s,descent:s-o};return e._FontHeightSizes[t]=a,a},e.drawEllipse=function(e,t,r,i,n){n.translate(e,t),n.scale(r,i),n.beginPath(),n.arc(0,0,1,0,2*Math.PI),n.closePath(),n.scale(1/r,1/i),n.translate(-e,-t)},e.AllowAlphaInheritance=!1,e._ClipMeasure=new d(0,0,0,0),e._HORIZONTAL_ALIGNMENT_LEFT=0,e._HORIZONTAL_ALIGNMENT_RIGHT=1,e._HORIZONTAL_ALIGNMENT_CENTER=2,e._VERTICAL_ALIGNMENT_TOP=0,e._VERTICAL_ALIGNMENT_BOTTOM=1,e._VERTICAL_ALIGNMENT_CENTER=2,e._FontHeightSizes={},e.AddHeader=function(){},e}();s._TypeStore.RegisteredTypes["BABYLON.GUI.Control"]=_;var g=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._children=new Array,r._measureForChildren=d.Empty(),r._background="",r._adaptWidthToChildren=!1,r._adaptHeightToChildren=!1,r.logLayoutCycleErrors=!1,r.maxLayoutCycle=3,r}return n(t,e),Object.defineProperty(t.prototype,"adaptHeightToChildren",{get:function(){return this._adaptHeightToChildren},set:function(e){this._adaptHeightToChildren!==e&&(this._adaptHeightToChildren=e,e&&(this.height="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adaptWidthToChildren",{get:function(){return this._adaptWidthToChildren},set:function(e){this._adaptWidthToChildren!==e&&(this._adaptWidthToChildren=e,e&&(this.width="100%"),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Container"},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this.children;e<t.length;e++)t[e]._markMatrixAsDirty()},t.prototype.getChildByName=function(e){for(var t=0,r=this.children;t<r.length;t++){var i=r[t];if(i.name===e)return i}return null},t.prototype.getChildByType=function(e,t){for(var r=0,i=this.children;r<i.length;r++){var n=i[r];if(n.typeName===t)return n}return null},t.prototype.containsControl=function(e){return-1!==this.children.indexOf(e)},t.prototype.addControl=function(e){return e?(-1!==this._children.indexOf(e)||(e._link(this._host),e._markAllAsDirty(),this._reOrderControl(e),this._markAsDirty()),this):this},t.prototype.clearControls=function(){for(var e=0,t=this.children.slice();e<t.length;e++){var r=t[e];this.removeControl(r)}return this},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null),e.linkWithMesh(null),this._host&&this._host._cleanControlAfterRemoval(e),this._markAsDirty(),this},t.prototype._reOrderControl=function(e){this.removeControl(e);for(var t=!1,r=0;r<this._children.length;r++)if(this._children[r].zIndex>e.zIndex){this._children.splice(r,0,e),t=!0;break}t||this._children.push(e),e.parent=this,this._markAsDirty()},t.prototype._offsetLeft=function(t){e.prototype._offsetLeft.call(this,t);for(var r=0,i=this._children;r<i.length;r++)i[r]._offsetLeft(t)},t.prototype._offsetTop=function(t){e.prototype._offsetTop.call(this,t);for(var r=0,i=this._children;r<i.length;r++)i[r]._offsetTop(t)},t.prototype._markAllAsDirty=function(){e.prototype._markAllAsDirty.call(this);for(var t=0;t<this._children.length;t++)this._children[t]._markAllAsDirty()},t.prototype._localDraw=function(e){this._background&&(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.restore())},t.prototype._link=function(t){e.prototype._link.call(this,t);for(var r=0,i=this._children;r<i.length;r++)i[r]._link(t)},t.prototype._beforeLayout=function(){},t.prototype._processMeasures=function(t,r){!this._isDirty&&this._cachedParentMeasure.isEqualsTo(t)||(e.prototype._processMeasures.call(this,t,r),this._evaluateClippingState(t))},t.prototype._layout=function(e,t){if(!this.isDirty&&(!this.isVisible||this.notRenderable))return!1;this.host._numLayoutCalls++,this._isDirty&&this._currentMeasure.transformToRef(this._transformMatrix,this._prevCurrentMeasureTransformedIntoGlobalSpace);var r=0;t.save(),this._applyStates(t),this._beforeLayout();do{var i=-1,n=-1;if(this._rebuildLayout=!1,this._processMeasures(e,t),!this._isClipped){for(var o=0,a=this._children;o<a.length;o++){var l=a[o];l._tempParentMeasure.copyFrom(this._measureForChildren),l._layout(this._measureForChildren,t)&&(this.adaptWidthToChildren&&l._width.isPixel&&(i=Math.max(i,l._currentMeasure.width+l.paddingLeftInPixels+l.paddingRightInPixels)),this.adaptHeightToChildren&&l._height.isPixel&&(n=Math.max(n,l._currentMeasure.height+l.paddingTopInPixels+l.paddingBottomInPixels)))}this.adaptWidthToChildren&&i>=0&&(i+=this.paddingLeftInPixels+this.paddingRightInPixels,this.width!==i+"px"&&(this.width=i+"px",this._rebuildLayout=!0)),this.adaptHeightToChildren&&n>=0&&(n+=this.paddingTopInPixels+this.paddingBottomInPixels,this.height!==n+"px"&&(this.height=n+"px",this._rebuildLayout=!0)),this._postMeasure()}r++}while(this._rebuildLayout&&r<this.maxLayoutCycle);return r>=3&&this.logLayoutCycleErrors&&s.Logger.Error("Layout cycle detected in GUI (Container name="+this.name+", uniqueId="+this.uniqueId+")"),t.restore(),this._isDirty&&(this.invalidateRect(),this._isDirty=!1),!0},t.prototype._postMeasure=function(){},t.prototype._draw=function(e,t){this._localDraw(e),this.clipChildren&&this._clipForChildren(e);for(var r=0,i=this._children;r<i.length;r++){var n=i[r];t&&!n._intersectsRect(t)||n._render(e,t)}},t.prototype.getDescendantsToRef=function(e,t,r){if(void 0===t&&(t=!1),this.children)for(var i=0;i<this.children.length;i++){var n=this.children[i];r&&!r(n)||e.push(n),t||n.getDescendantsToRef(e,!1,r)}},t.prototype._processPicking=function(t,r,i,n,o,s,a,l){if(!this._isEnabled||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,r))return!1;for(var h=this._children.length-1;h>=0;h--){var u=this._children[h];if(u._processPicking(t,r,i,n,o,s,a,l))return u.hoverCursor&&this._host._changeCursor(u.hoverCursor),!0}return!!this.isHitTestVisible&&this._processObservables(n,t,r,i,o,s,a,l)},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._measureForChildren.copyFrom(this._currentMeasure)},t.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=this.children.length-1;t>=0;t--)this.children[t].dispose()},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Container"]=g;var m,b=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._thickness=1,r._cornerRadius=0,r}return n(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(e){e<0&&(e=0),this._cornerRadius!==e&&(this._cornerRadius=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Rectangle"},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._background&&(e.fillStyle=this._background,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.fill()):e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),this._thickness&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,this._cornerRadius?(this._drawRoundedRect(e,this._thickness/2),e.stroke()):e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._drawRoundedRect=function(e,t){void 0===t&&(t=0);var r=this._currentMeasure.left+t,i=this._currentMeasure.top+t,n=this._currentMeasure.width-2*t,o=this._currentMeasure.height-2*t,s=Math.min(o/2-2,Math.min(n/2-2,this._cornerRadius));e.beginPath(),e.moveTo(r+s,i),e.lineTo(r+n-s,i),e.quadraticCurveTo(r+n,i,r+n,i+s),e.lineTo(r+n,i+o-s),e.quadraticCurveTo(r+n,i+o,r+n-s,i+o),e.lineTo(r+s,i+o),e.quadraticCurveTo(r,i+o,r,i+o-s),e.lineTo(r,i+s),e.quadraticCurveTo(r,i,r+s,i),e.closePath()},t.prototype._clipForChildren=function(e){this._cornerRadius&&(this._drawRoundedRect(e,this._thickness),e.clip())},t}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Rectangle"]=b,function(e){e[e.Clip=0]="Clip",e[e.WordWrap=1]="WordWrap",e[e.Ellipsis=2]="Ellipsis"}(m||(m={}));var y=function(e){function t(t,r){void 0===r&&(r="");var i=e.call(this,t)||this;return i.name=t,i._text="",i._textWrapping=m.Clip,i._textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,i._textVerticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,i._resizeToFit=!1,i._lineSpacing=new a(0),i._outlineWidth=0,i._outlineColor="white",i._underline=!1,i._lineThrough=!1,i.onTextChangedObservable=new s.Observable,i.onLinesReadyObservable=new s.Observable,i.text=r,i}return n(t,e),Object.defineProperty(t.prototype,"lines",{get:function(){return this._lines},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeToFit",{get:function(){return this._resizeToFit},set:function(e){this._resizeToFit!==e&&(this._resizeToFit=e,this._resizeToFit&&(this._width.ignoreAdaptiveScaling=!0,this._height.ignoreAdaptiveScaling=!0),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWrapping",{get:function(){return this._textWrapping},set:function(e){this._textWrapping!==e&&(this._textWrapping=+e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHorizontalAlignment",{get:function(){return this._textHorizontalAlignment},set:function(e){this._textHorizontalAlignment!==e&&(this._textHorizontalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textVerticalAlignment",{get:function(){return this._textVerticalAlignment},set:function(e){this._textVerticalAlignment!==e&&(this._textVerticalAlignment=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineSpacing",{get:function(){return this._lineSpacing.toString(this._host)},set:function(e){this._lineSpacing.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this._underline},set:function(e){this._underline!==e&&(this._underline=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineThrough",{get:function(){return this._lineThrough},set:function(e){this._lineThrough!==e&&(this._lineThrough=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor!==e&&(this._outlineColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"TextBlock"},t.prototype._processMeasures=function(t,r){this._fontOffset||(this._fontOffset=_._GetFontOffset(r.font)),e.prototype._processMeasures.call(this,t,r),this._lines=this._breakLines(this._currentMeasure.width,r),this.onLinesReadyObservable.notifyObservers(this);for(var i=0,n=0;n<this._lines.length;n++){var o=this._lines[n];o.width>i&&(i=o.width)}if(this._resizeToFit){if(this._textWrapping===m.Clip){var s=this.paddingLeftInPixels+this.paddingRightInPixels+i|0;s!==this._width.internalValue&&(this._width.updateInPlace(s,a.UNITMODE_PIXEL),this._rebuildLayout=!0)}var l=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*this._lines.length|0;if(this._lines.length>0&&0!==this._lineSpacing.internalValue){var h=0;h=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),l+=(this._lines.length-1)*h}l!==this._height.internalValue&&(this._height.updateInPlace(l,a.UNITMODE_PIXEL),this._rebuildLayout=!0)}},t.prototype._drawText=function(e,t,r,i){var n=this._currentMeasure.width,o=0;switch(this._textHorizontalAlignment){case _.HORIZONTAL_ALIGNMENT_LEFT:o=0;break;case _.HORIZONTAL_ALIGNMENT_RIGHT:o=n-t;break;case _.HORIZONTAL_ALIGNMENT_CENTER:o=(n-t)/2}(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(i.shadowColor=this.shadowColor,i.shadowBlur=this.shadowBlur,i.shadowOffsetX=this.shadowOffsetX,i.shadowOffsetY=this.shadowOffsetY),this.outlineWidth&&i.strokeText(e,this._currentMeasure.left+o,r),i.fillText(e,this._currentMeasure.left+o,r),this._underline&&(i.beginPath(),i.lineWidth=Math.round(.05*this.fontSizeInPixels),i.moveTo(this._currentMeasure.left+o,r+3),i.lineTo(this._currentMeasure.left+o+t,r+3),i.stroke(),i.closePath()),this._lineThrough&&(i.beginPath(),i.lineWidth=Math.round(.05*this.fontSizeInPixels),i.moveTo(this._currentMeasure.left+o,r-this.fontSizeInPixels/3),i.lineTo(this._currentMeasure.left+o+t,r-this.fontSizeInPixels/3),i.stroke(),i.closePath())},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._renderLines(e),e.restore()},t.prototype._applyStates=function(t){e.prototype._applyStates.call(this,t),this.outlineWidth&&(t.lineWidth=this.outlineWidth,t.strokeStyle=this.outlineColor,t.lineJoin="miter",t.miterLimit=2)},t.prototype._breakLines=function(e,t){var r=[],i=this.text.split("\n");if(this._textWrapping===m.Ellipsis)for(var n=0,o=i;n<o.length;n++){var s=o[n];r.push(this._parseLineEllipsis(s,e,t))}else if(this._textWrapping===m.WordWrap)for(var a=0,l=i;a<l.length;a++)s=l[a],r.push.apply(r,this._parseLineWordWrap(s,e,t));else for(var h=0,u=i;h<u.length;h++)s=u[h],r.push(this._parseLine(s,t));return r},t.prototype._parseLine=function(e,t){return void 0===e&&(e=""),{text:e,width:t.measureText(e).width}},t.prototype._parseLineEllipsis=function(e,t,r){void 0===e&&(e="");var i=r.measureText(e).width;i>t&&(e+="…");var n=Array.from&&Array.from(e);if(n)for(;n.length&&i>t;)n.pop(),e=n.join("")+"...",i=r.measureText(e).width;else for(;e.length>2&&i>t;)e=e.slice(0,-2)+"…",i=r.measureText(e).width;return{text:e,width:i}},t.prototype._parseLineWordWrap=function(e,t,r){void 0===e&&(e="");for(var i=[],n=this.wordSplittingFunction?this.wordSplittingFunction(e):e.split(" "),o=0,s=0;s<n.length;s++){var a=s>0?e+" "+n[s]:n[0],l=r.measureText(a).width;l>t&&s>0?(i.push({text:e,width:o}),e=n[s],o=r.measureText(e).width):(o=l,e=a)}return i.push({text:e,width:o}),i},t.prototype._renderLines=function(e){var t=this._currentMeasure.height,r=0;switch(this._textVerticalAlignment){case _.VERTICAL_ALIGNMENT_TOP:r=this._fontOffset.ascent;break;case _.VERTICAL_ALIGNMENT_BOTTOM:r=t-this._fontOffset.height*(this._lines.length-1)-this._fontOffset.descent;break;case _.VERTICAL_ALIGNMENT_CENTER:r=this._fontOffset.ascent+(t-this._fontOffset.height*this._lines.length)/2}r+=this._currentMeasure.top;for(var i=0;i<this._lines.length;i++){var n=this._lines[i];0!==i&&0!==this._lineSpacing.internalValue&&(this._lineSpacing.isPixel?r+=this._lineSpacing.getValue(this._host):r+=this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height)),this._drawText(n.text,n.width,r,e),r+=this._fontOffset.height}},t.prototype.computeExpectedHeight=function(){if(this.text&&this.widthInPixels){var e=document.createElement("canvas").getContext("2d");if(e){this._applyStates(e),this._fontOffset||(this._fontOffset=_._GetFontOffset(e.font));var t=this._lines?this._lines:this._breakLines(this.widthInPixels-this.paddingLeftInPixels-this.paddingRightInPixels,e),r=this.paddingTopInPixels+this.paddingBottomInPixels+this._fontOffset.height*t.length;if(t.length>0&&0!==this._lineSpacing.internalValue){var i=0;i=this._lineSpacing.isPixel?this._lineSpacing.getValue(this._host):this._lineSpacing.getValue(this._host)*this._height.getValueInPixel(this._host,this._cachedParentMeasure.height),r+=(t.length-1)*i}return r}}return 0},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onTextChangedObservable.clear()},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.TextBlock"]=y;var v=function(e){function t(r,i){void 0===i&&(i=null);var n=e.call(this,r)||this;return n.name=r,n._workingCanvas=null,n._loaded=!1,n._stretch=t.STRETCH_FILL,n._autoScale=!1,n._sourceLeft=0,n._sourceTop=0,n._sourceWidth=0,n._sourceHeight=0,n._svgAttributesComputationCompleted=!1,n._isSVG=!1,n._cellWidth=0,n._cellHeight=0,n._cellId=-1,n._populateNinePatchSlicesFromImage=!1,n._imageDataCache={data:null,key:""},n.onImageLoadedObservable=new s.Observable,n.onSVGAttributesComputedObservable=new s.Observable,n.source=i,n}return n(t,e),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"populateNinePatchSlicesFromImage",{get:function(){return this._populateNinePatchSlicesFromImage},set:function(e){this._populateNinePatchSlicesFromImage!==e&&(this._populateNinePatchSlicesFromImage=e,this._populateNinePatchSlicesFromImage&&this._loaded&&this._extractNinePatchSliceDataFromImage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"detectPointerOnOpaqueOnly",{get:function(){return this._detectPointerOnOpaqueOnly},set:function(e){this._detectPointerOnOpaqueOnly!==e&&(this._detectPointerOnOpaqueOnly=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceLeft",{get:function(){return this._sliceLeft},set:function(e){this._sliceLeft!==e&&(this._sliceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceRight",{get:function(){return this._sliceRight},set:function(e){this._sliceRight!==e&&(this._sliceRight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceTop",{get:function(){return this._sliceTop},set:function(e){this._sliceTop!==e&&(this._sliceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliceBottom",{get:function(){return this._sliceBottom},set:function(e){this._sliceBottom!==e&&(this._sliceBottom=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceLeft",{get:function(){return this._sourceLeft},set:function(e){this._sourceLeft!==e&&(this._sourceLeft=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceTop",{get:function(){return this._sourceTop},set:function(e){this._sourceTop!==e&&(this._sourceTop=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceWidth",{get:function(){return this._sourceWidth},set:function(e){this._sourceWidth!==e&&(this._sourceWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceHeight",{get:function(){return this._sourceHeight},set:function(e){this._sourceHeight!==e&&(this._sourceHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSVG",{get:function(){return this._isSVG},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svgAttributesComputationCompleted",{get:function(){return this._svgAttributesComputationCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoScale",{get:function(){return this._autoScale},set:function(e){this._autoScale!==e&&(this._autoScale=e,e&&this._loaded&&this.synchronizeSizeWithContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stretch",{get:function(){return this._stretch},set:function(e){this._stretch!==e&&(this._stretch=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._rotate90=function(e,r){void 0===r&&(r=!1);var i=document.createElement("canvas"),n=i.getContext("2d"),o=this._domImage.width,s=this._domImage.height;i.width=s,i.height=o,n.translate(i.width/2,i.height/2),n.rotate(e*Math.PI/2),n.drawImage(this._domImage,0,0,o,s,-o/2,-s/2,o,s);var a=i.toDataURL("image/jpg"),l=new t(this.name+"rotated",a);return r&&(l._stretch=this._stretch,l._autoScale=this._autoScale,l._cellId=this._cellId,l._cellWidth=e%1?this._cellHeight:this._cellWidth,l._cellHeight=e%1?this._cellWidth:this._cellHeight),this._handleRotationForSVGImage(this,l,e),this._imageDataCache.data=null,l},t.prototype._handleRotationForSVGImage=function(e,t,r){var i=this;e._isSVG&&(e._svgAttributesComputationCompleted?(this._rotate90SourceProperties(e,t,r),this._markAsDirty()):e.onSVGAttributesComputedObservable.addOnce((function(){i._rotate90SourceProperties(e,t,r),i._markAsDirty()})))},t.prototype._rotate90SourceProperties=function(e,t,r){var i,n,o=e.sourceLeft,s=e.sourceTop,a=e.domImage.width,l=e.domImage.height,h=o,u=s,c=e.sourceWidth,d=e.sourceHeight;if(0!=r){var p=r<0?-1:1;r%=4;for(var f=0;f<Math.abs(r);++f)h=-(s-l/2)*p+l/2,u=(o-a/2)*p+a/2,c=(i=[d,c])[0],d=i[1],r<0?u-=d:h-=c,o=h,s=u,a=(n=[l,a])[0],l=n[1]}t.sourceLeft=h,t.sourceTop=u,t.sourceWidth=c,t.sourceHeight=d},Object.defineProperty(t.prototype,"domImage",{get:function(){return this._domImage},set:function(e){var t=this;this._domImage=e,this._loaded=!1,this._imageDataCache.data=null,this._domImage.width?this._onImageLoaded():this._domImage.onload=function(){t._onImageLoaded()}},enumerable:!1,configurable:!0}),t.prototype._onImageLoaded=function(){this._imageDataCache.data=null,this._imageWidth=this._domImage.width,this._imageHeight=this._domImage.height,this._loaded=!0,this._populateNinePatchSlicesFromImage&&this._extractNinePatchSliceDataFromImage(),this._autoScale&&this.synchronizeSizeWithContent(),this.onImageLoadedObservable.notifyObservers(this),this._markAsDirty()},t.prototype._extractNinePatchSliceDataFromImage=function(){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"));var e=this._workingCanvas,t=e.getContext("2d"),r=this._domImage.width,i=this._domImage.height;e.width=r,e.height=i,t.drawImage(this._domImage,0,0,r,i);var n=t.getImageData(0,0,r,i);this._sliceLeft=-1,this._sliceRight=-1;for(var o=0;o<r;o++)if((a=n.data[4*o+3])>127&&-1===this._sliceLeft)this._sliceLeft=o;else if(a<127&&this._sliceLeft>-1){this._sliceRight=o;break}this._sliceTop=-1,this._sliceBottom=-1;for(var s=0;s<i;s++){var a;if((a=n.data[s*r*4+3])>127&&-1===this._sliceTop)this._sliceTop=s;else if(a<127&&this._sliceTop>-1){this._sliceBottom=s;break}}},Object.defineProperty(t.prototype,"source",{set:function(e){var t=this;this._source!==e&&(this._loaded=!1,this._source=e,this._imageDataCache.data=null,e&&(e=this._svgCheck(e)),this._domImage=document.createElement("img"),this._domImage.onload=function(){t._onImageLoaded()},e&&(s.Tools.SetCorsBehavior(e,this._domImage),this._domImage.src=e))},enumerable:!1,configurable:!0}),t.prototype._svgCheck=function(e){var t=this;if(window.SVGSVGElement&&-1!==e.search(/.svg#/gi)&&e.indexOf("#")===e.lastIndexOf("#")){this._isSVG=!0;var r=e.split("#")[0],i=e.split("#")[1],n=document.body.querySelector('object[data="'+r+'"]');if(n){var o=n.contentDocument;if(o&&o.documentElement){var s=o.documentElement.getAttribute("viewBox"),a=Number(o.documentElement.getAttribute("width")),l=Number(o.documentElement.getAttribute("height"));if(o.getElementById(i)&&s&&a&&l)return this._getSVGAttribs(n,i),e}n.addEventListener("load",(function(){t._getSVGAttribs(n,i)}))}else{var h=document.createElement("object");h.data=r,h.type="image/svg+xml",h.width="0%",h.height="0%",document.body.appendChild(h),h.onload=function(){var e=document.body.querySelector('object[data="'+r+'"]');e&&t._getSVGAttribs(e,i)}}return r}return e},t.prototype._getSVGAttribs=function(e,t){var r=e.contentDocument;if(r&&r.documentElement){var i=r.documentElement.getAttribute("viewBox"),n=Number(r.documentElement.getAttribute("width")),o=Number(r.documentElement.getAttribute("height")),s=r.getElementById(t);if(i&&n&&o&&s){var a=Number(i.split(" ")[2]),l=Number(i.split(" ")[3]),h=s.getBBox(),u=1,c=1,d=0,p=0;s.transform&&s.transform.baseVal.consolidate()&&(u=s.transform.baseVal.consolidate().matrix.a,c=s.transform.baseVal.consolidate().matrix.d,d=s.transform.baseVal.consolidate().matrix.e,p=s.transform.baseVal.consolidate().matrix.f),this.sourceLeft=(u*h.x+d)*n/a,this.sourceTop=(c*h.y+p)*o/l,this.sourceWidth=h.width*u*(n/a),this.sourceHeight=h.height*c*(o/l),this._svgAttributesComputationCompleted=!0,this.onSVGAttributesComputedObservable.notifyObservers(this)}}},Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth!==e&&(this._cellWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight!==e&&(this._cellHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellId",{get:function(){return this._cellId},set:function(e){this._cellId!==e&&(this._cellId=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.contains=function(t,r){if(!e.prototype.contains.call(this,t,r))return!1;if(!this._detectPointerOnOpaqueOnly||!this._workingCanvas)return!0;var i=0|this._currentMeasure.width,n=0|this._currentMeasure.height,o=i+"_"+n,s=this._imageDataCache.data;if(!s||this._imageDataCache.key!==o){var a=this._workingCanvas.getContext("2d");this._imageDataCache.data=s=a.getImageData(0,0,i,n).data,this._imageDataCache.key=o}return s[4*((t=t-this._currentMeasure.left|0)+(r=r-this._currentMeasure.top|0)*i)+3]>0},t.prototype._getTypeName=function(){return"Image"},t.prototype.synchronizeSizeWithContent=function(){this._loaded&&(this.width=this._domImage.width+"px",this.height=this._domImage.height+"px")},t.prototype._processMeasures=function(r,i){if(this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:case t.STRETCH_UNIFORM:case t.STRETCH_NINE_PATCH:break;case t.STRETCH_EXTEND:this._autoScale&&this.synchronizeSizeWithContent(),this.parent&&this.parent.parent&&(this.parent.adaptWidthToChildren=!0,this.parent.adaptHeightToChildren=!0)}e.prototype._processMeasures.call(this,r,i)},t.prototype._prepareWorkingCanvasForOpaqueDetection=function(){if(this._detectPointerOnOpaqueOnly){this._workingCanvas||(this._workingCanvas=document.createElement("canvas"));var e=this._workingCanvas,t=this._currentMeasure.width,r=this._currentMeasure.height,i=e.getContext("2d");e.width=t,e.height=r,i.clearRect(0,0,t,r)}},t.prototype._drawImage=function(e,t,r,i,n,o,s,a,l){e.drawImage(this._domImage,t,r,i,n,o,s,a,l),this._detectPointerOnOpaqueOnly&&(e=this._workingCanvas.getContext("2d")).drawImage(this._domImage,t,r,i,n,o-this._currentMeasure.left,s-this._currentMeasure.top,a,l)},t.prototype._draw=function(e){var r,i,n,o;if(e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),-1==this.cellId)r=this._sourceLeft,i=this._sourceTop,n=this._sourceWidth?this._sourceWidth:this._imageWidth,o=this._sourceHeight?this._sourceHeight:this._imageHeight;else{var s=this._domImage.naturalWidth/this.cellWidth,a=this.cellId/s>>0,l=this.cellId%s;r=this.cellWidth*l,i=this.cellHeight*a,n=this.cellWidth,o=this.cellHeight}if(this._prepareWorkingCanvasForOpaqueDetection(),this._applyStates(e),this._loaded)switch(this._stretch){case t.STRETCH_NONE:case t.STRETCH_FILL:this._drawImage(e,r,i,n,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_UNIFORM:var h=this._currentMeasure.width/n,u=this._currentMeasure.height/o,c=Math.min(h,u),d=(this._currentMeasure.width-n*c)/2,p=(this._currentMeasure.height-o*c)/2;this._drawImage(e,r,i,n,o,this._currentMeasure.left+d,this._currentMeasure.top+p,n*c,o*c);break;case t.STRETCH_EXTEND:this._drawImage(e,r,i,n,o,this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height);break;case t.STRETCH_NINE_PATCH:this._renderNinePatch(e)}e.restore()},t.prototype._renderCornerPatch=function(e,t,r,i,n,o,s){this._drawImage(e,t,r,i,n,this._currentMeasure.left+o,this._currentMeasure.top+s,i,n)},t.prototype._renderNinePatch=function(e){var t=this._imageHeight,r=this._sliceLeft,i=this._sliceTop,n=this._imageHeight-this._sliceBottom,o=this._imageWidth-this._sliceRight,s=0,a=0;this._populateNinePatchSlicesFromImage&&(s=1,a=1,t-=2,r-=1,i-=1,n-=1,o-=1);var l=this._sliceRight-this._sliceLeft,h=this._currentMeasure.width-o-this.sliceLeft,u=this._currentMeasure.height-t+this._sliceBottom;this._renderCornerPatch(e,s,a,r,i,0,0),this._renderCornerPatch(e,s,this._sliceBottom,r,t-this._sliceBottom,0,u),this._renderCornerPatch(e,this._sliceRight,a,o,i,this._currentMeasure.width-o,0),this._renderCornerPatch(e,this._sliceRight,this._sliceBottom,o,t-this._sliceBottom,this._currentMeasure.width-o,u),this._drawImage(e,this._sliceLeft,this._sliceTop,l,this._sliceBottom-this._sliceTop,this._currentMeasure.left+r,this._currentMeasure.top+i,h,u-i),this._drawImage(e,s,this._sliceTop,r,this._sliceBottom-this._sliceTop,this._currentMeasure.left,this._currentMeasure.top+i,r,u-i),this._drawImage(e,this._sliceRight,this._sliceTop,r,this._sliceBottom-this._sliceTop,this._currentMeasure.left+this._currentMeasure.width-o,this._currentMeasure.top+i,r,u-i),this._drawImage(e,this._sliceLeft,a,l,i,this._currentMeasure.left+r,this._currentMeasure.top,h,i),this._drawImage(e,this._sliceLeft,this._sliceBottom,l,n,this._currentMeasure.left+r,this._currentMeasure.top+u,h,n)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onImageLoadedObservable.clear(),this.onSVGAttributesComputedObservable.clear()},t.STRETCH_NONE=0,t.STRETCH_FILL=1,t.STRETCH_UNIFORM=2,t.STRETCH_EXTEND=3,t.STRETCH_NINE_PATCH=4,t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Image"]=v;var T=function(e){function t(t){var r=e.call(this,t)||this;r.name=t,r.delegatePickingToChildren=!1,r.thickness=1,r.isPointerBlocker=!0;var i=null;return r.pointerEnterAnimation=function(){i=r.alpha,r.alpha-=.1},r.pointerOutAnimation=function(){null!==i&&(r.alpha=i)},r.pointerDownAnimation=function(){r.scaleX-=.05,r.scaleY-=.05},r.pointerUpAnimation=function(){r.scaleX+=.05,r.scaleY+=.05},r}return n(t,e),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBlock",{get:function(){return this._textBlock},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Button"},t.prototype._processPicking=function(t,r,i,n,o,s,a,l){if(!this._isEnabled||!this.isHitTestVisible||!this.isVisible||this.notRenderable)return!1;if(!e.prototype.contains.call(this,t,r))return!1;if(this.delegatePickingToChildren){for(var h=!1,u=this._children.length-1;u>=0;u--){var c=this._children[u];if(c.isEnabled&&c.isHitTestVisible&&c.isVisible&&!c.notRenderable&&c.contains(t,r)){h=!0;break}}if(!h)return!1}return this._processObservables(n,t,r,i,o,s,a,l),!0},t.prototype._onPointerEnter=function(t,r){return!!e.prototype._onPointerEnter.call(this,t,r)&&(this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},t.prototype._onPointerOut=function(t,r,i){void 0===i&&(i=!1),this.pointerOutAnimation&&this.pointerOutAnimation(),e.prototype._onPointerOut.call(this,t,r,i)},t.prototype._onPointerDown=function(t,r,i,n,o){return!!e.prototype._onPointerDown.call(this,t,r,i,n,o)&&(this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},t.prototype._onPointerUp=function(t,r,i,n,o,s){this.pointerUpAnimation&&this.pointerUpAnimation(),e.prototype._onPointerUp.call(this,t,r,i,n,o,s)},t.CreateImageButton=function(e,r,i){var n=new t(e),o=new y(e+"_button",r);o.textWrapping=!0,o.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,o.paddingLeft="20%",n.addControl(o);var s=new v(e+"_icon",i);return s.width="20%",s.stretch=v.STRETCH_UNIFORM,s.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.addControl(s),n._image=s,n._textBlock=o,n},t.CreateImageOnlyButton=function(e,r){var i=new t(e),n=new v(e+"_icon",r);return n.stretch=v.STRETCH_FILL,n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i.addControl(n),i._image=n,i},t.CreateSimpleButton=function(e,r){var i=new t(e),n=new y(e+"_button",r);return n.textWrapping=!0,n.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,i.addControl(n),i._textBlock=n,i},t.CreateImageWithCenterTextButton=function(e,r,i){var n=new t(e),o=new v(e+"_icon",i);o.stretch=v.STRETCH_FILL,n.addControl(o);var s=new y(e+"_button",r);return s.textWrapping=!0,s.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,n.addControl(s),n._image=o,n._textBlock=s,n},t}(b);s._TypeStore.RegisteredTypes["BABYLON.GUI.Button"]=T;var O=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._isVertical=!0,r._manualWidth=!1,r._manualHeight=!1,r._doNotTrackManualChanges=!1,r.ignoreLayoutWarnings=!1,r}return n(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualWidth=!0),this._width.toString(this._host)!==e&&this._width.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._doNotTrackManualChanges||(this._manualHeight=!0),this._height.toString(this._host)!==e&&this._height.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"StackPanel"},t.prototype._preMeasure=function(t,r){for(var i=0,n=this._children;i<n.length;i++){var o=n[i];this._isVertical?o.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP:o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT}e.prototype._preMeasure.call(this,t,r)},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._measureForChildren.copyFrom(t),this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this.isVertical&&!this._manualWidth||(this._measureForChildren.width=this._currentMeasure.width),(this.isVertical||this._manualHeight)&&(this._measureForChildren.height=this._currentMeasure.height)},t.prototype._postMeasure=function(){for(var t=0,r=0,i=0,n=this._children;i<n.length;i++){var o=n[i];o.isVisible&&!o.notRenderable&&(this._isVertical?(o.top!==r+"px"&&(o.top=r+"px",this._rebuildLayout=!0,o._top.ignoreAdaptiveScaling=!0),o._height.isPercentage&&!o._automaticSize?this.ignoreLayoutWarnings||s.Tools.Warn("Control (Name:"+o.name+", UniqueId:"+o.uniqueId+") is using height in percentage mode inside a vertical StackPanel"):r+=o._currentMeasure.height+o.paddingTopInPixels+o.paddingBottomInPixels):(o.left!==t+"px"&&(o.left=t+"px",this._rebuildLayout=!0,o._left.ignoreAdaptiveScaling=!0),o._width.isPercentage&&!o._automaticSize?this.ignoreLayoutWarnings||s.Tools.Warn("Control (Name:"+o.name+", UniqueId:"+o.uniqueId+") is using width in percentage mode inside a horizontal StackPanel"):t+=o._currentMeasure.width+o.paddingLeftInPixels+o.paddingRightInPixels))}t+=this.paddingLeftInPixels+this.paddingRightInPixels,r+=this.paddingTopInPixels+this.paddingBottomInPixels,this._doNotTrackManualChanges=!0;var a=!1,l=!1;if(!this._manualHeight&&this._isVertical){var h=this.height;this.height=r+"px",l=h!==this.height||!this._height.ignoreAdaptiveScaling}if(!this._manualWidth&&!this._isVertical){var u=this.width;this.width=t+"px",a=u!==this.width||!this._width.ignoreAdaptiveScaling}l&&(this._height.ignoreAdaptiveScaling=!0),a&&(this._width.ignoreAdaptiveScaling=!0),this._doNotTrackManualChanges=!1,(a||l)&&(this._rebuildLayout=!0),e.prototype._postMeasure.call(this)},t}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.StackPanel"]=O;var E=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._isChecked=!1,r._background="black",r._checkSizeRatio=.8,r._thickness=1,r.onIsCheckedChangedObservable=new s.Observable,r.isPointerBlocker=!0,r}return n(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Checkbox"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e);var r=this._currentMeasure.width-this._thickness,i=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,r,i),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColorItem;var n=r*this._checkSizeRatio,o=i*this._checkSizeRatio;e.fillRect(this._currentMeasure.left+this._thickness/2+(r-n)/2,this._currentMeasure.top+this._thickness/2+(i-o)/2,n,o)}e.strokeStyle=this.color,e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,r,i),e.restore()},t.prototype._onPointerDown=function(t,r,i,n,o){return!!e.prototype._onPointerDown.call(this,t,r,i,n,o)&&(this.isChecked=!this.isChecked,!0)},t.AddCheckBoxWithHeader=function(e,r){var i=new O;i.isVertical=!1,i.height="30px";var n=new t;n.width="20px",n.height="20px",n.isChecked=!0,n.color="green",n.onIsCheckedChangedObservable.add(r),i.addControl(n);var o=new y;return o.text=e,o.width="180px",o.paddingLeft="5px",o.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.color="white",i.addControl(o),i},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Checkbox"]=E;var A=function(){function e(){}return Object.defineProperty(e.prototype,"text",{get:function(){return this._characters?this._characters.join(""):this._text},set:function(e){this._text=e,this._characters=Array.from&&Array.from(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._characters?this._characters.length:this._text.length},enumerable:!1,configurable:!0}),e.prototype.removePart=function(e,t,r){var i;if(this._text=this._text.slice(0,e)+(r||"")+this._text.slice(t),this._characters){var n=r?Array.from(r):[];(i=this._characters).splice.apply(i,function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i}([e,t-e],n))}},e.prototype.charAt=function(e){return this._characters?this._characters[e]:this._text.charAt(e)},e.prototype.substr=function(e,t){if(this._characters){e=isNaN(e)?0:e>=0?Math.min(e,this._characters.length):this._characters.length+Math.max(e,-this._characters.length),void 0===t?t=this._characters.length-e:(isNaN(t)||t<0)&&(t=0);for(var r=[];--t>=0;)r[t]=this._characters[e+t];return r.join("")}return this._text.substr(e,t)},e.prototype.substring=function(e,t){if(this._characters){isNaN(e)?e=0:e>this._characters.length?e=this._characters.length:e<0&&(e=0),void 0===t?t=this._characters.length:isNaN(t)?t=0:t>this._characters.length?t=this._characters.length:t<0&&(t=0);for(var r=[],i=0;e<t;)r[i++]=this._characters[e++];return r.join("")}return this._text.substring(e,t)},e.prototype.isWord=function(e){var t=/\w/g;return this._characters?-1!==this._characters[e].search(t):-1!==this._text.search(t)},e}(),C=function(e){function t(t,r){void 0===r&&(r="");var i=e.call(this,t)||this;return i.name=t,i._placeholderText="",i._background="#222222",i._focusedBackground="#000000",i._focusedColor="white",i._placeholderColor="gray",i._thickness=1,i._margin=new a(10,a.UNITMODE_PIXEL),i._autoStretchWidth=!0,i._maxWidth=new a(1,a.UNITMODE_PERCENTAGE,!1),i._isFocused=!1,i._blinkIsEven=!1,i._cursorOffset=0,i._deadKey=!1,i._addKey=!0,i._currentKey="",i._isTextHighlightOn=!1,i._textHighlightColor="#d5e0ff",i._highligherOpacity=.4,i._highlightedText="",i._startHighlightIndex=0,i._endHighlightIndex=0,i._cursorIndex=-1,i._onFocusSelectAll=!1,i._isPointerDown=!1,i.promptMessage="Please enter text:",i.disableMobilePrompt=!1,i.onTextChangedObservable=new s.Observable,i.onBeforeKeyAddObservable=new s.Observable,i.onFocusObservable=new s.Observable,i.onBlurObservable=new s.Observable,i.onTextHighlightObservable=new s.Observable,i.onTextCopyObservable=new s.Observable,i.onTextCutObservable=new s.Observable,i.onTextPasteObservable=new s.Observable,i.onKeyboardEventProcessedObservable=new s.Observable,i.text=r,i.isPointerBlocker=!0,i}return n(t,e),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth.toString(this._host)},set:function(e){this._maxWidth.toString(this._host)!==e&&this._maxWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidthInPixels",{get:function(){return this._maxWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highligherOpacity",{get:function(){return this._highligherOpacity},set:function(e){this._highligherOpacity!==e&&(this._highligherOpacity=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusSelectAll",{get:function(){return this._onFocusSelectAll},set:function(e){this._onFocusSelectAll!==e&&(this._onFocusSelectAll=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHighlightColor",{get:function(){return this._textHighlightColor},set:function(e){this._textHighlightColor!==e&&(this._textHighlightColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"margin",{get:function(){return this._margin.toString(this._host)},set:function(e){this._margin.toString(this._host)!==e&&this._margin.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"marginInPixels",{get:function(){return this._margin.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoStretchWidth",{get:function(){return this._autoStretchWidth},set:function(e){this._autoStretchWidth!==e&&(this._autoStretchWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedBackground",{get:function(){return this._focusedBackground},set:function(e){this._focusedBackground!==e&&(this._focusedBackground=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedColor",{get:function(){return this._focusedColor},set:function(e){this._focusedColor!==e&&(this._focusedColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderColor",{get:function(){return this._placeholderColor},set:function(e){this._placeholderColor!==e&&(this._placeholderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(e){this._placeholderText!==e&&(this._placeholderText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deadKey",{get:function(){return this._deadKey},set:function(e){this._deadKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedText",{get:function(){return this._highlightedText},set:function(e){this._highlightedText!==e&&(this._highlightedText=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addKey",{get:function(){return this._addKey},set:function(e){this._addKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentKey",{get:function(){return this._currentKey},set:function(e){this._currentKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._textWrapper.text},set:function(e){var t=e.toString();this._textWrapper||(this._textWrapper=new A),this._textWrapper.text!==t&&(this._textWrapper.text=t,this._textHasChanged())},enumerable:!1,configurable:!0}),t.prototype._textHasChanged=function(){this._markAsDirty(),this.onTextChangedObservable.notifyObservers(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&(this._width.fromString(e)&&this._markAsDirty(),this.autoStretchWidth=!1)},enumerable:!1,configurable:!0}),t.prototype.onBlur=function(){this._isFocused=!1,this._scrollLeft=null,this._cursorOffset=0,clearTimeout(this._blinkTimeout),this._markAsDirty(),this.onBlurObservable.notifyObservers(this),this._host.unRegisterClipboardEvents(),this._onClipboardObserver&&this._host.onClipboardObservable.remove(this._onClipboardObserver);var e=this._host.getScene();this._onPointerDblTapObserver&&e&&e.onPointerObservable.remove(this._onPointerDblTapObserver)},t.prototype.onFocus=function(){var e=this;if(this._isEnabled){if(this._scrollLeft=null,this._isFocused=!0,this._blinkIsEven=!1,this._cursorOffset=0,this._markAsDirty(),this.onFocusObservable.notifyObservers(this),-1!==navigator.userAgent.indexOf("Mobile")&&!this.disableMobilePrompt){var t=prompt(this.promptMessage);return null!==t&&(this.text=t),void(this._host.focusedControl=null)}this._host.registerClipboardEvents(),this._onClipboardObserver=this._host.onClipboardObservable.add((function(t){switch(t.type){case s.ClipboardEventTypes.COPY:e._onCopyText(t.event),e.onTextCopyObservable.notifyObservers(e);break;case s.ClipboardEventTypes.CUT:e._onCutText(t.event),e.onTextCutObservable.notifyObservers(e);break;case s.ClipboardEventTypes.PASTE:e._onPasteText(t.event),e.onTextPasteObservable.notifyObservers(e);break;default:return}}));var r=this._host.getScene();r&&(this._onPointerDblTapObserver=r.onPointerObservable.add((function(t){e._isFocused&&t.type===s.PointerEventTypes.POINTERDOUBLETAP&&e._processDblClick(t)}))),this._onFocusSelectAll&&this._selectAllText()}},t.prototype._getTypeName=function(){return"InputText"},t.prototype.keepsFocusWith=function(){return this._connectedVirtualKeyboard?[this._connectedVirtualKeyboard]:null},t.prototype.processKey=function(e,t,r){if(!r||!r.ctrlKey&&!r.metaKey||67!==e&&86!==e&&88!==e){if(r&&(r.ctrlKey||r.metaKey)&&65===e)return this._selectAllText(),void r.preventDefault();switch(e){case 32:t=" ";break;case 191:r&&r.preventDefault();break;case 8:if(this._textWrapper.text&&this._textWrapper.length>0){if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._blinkIsEven=!1,void(r&&r.preventDefault());0===this._cursorOffset?this.text=this._textWrapper.substr(0,this._textWrapper.length-1):(i=this._textWrapper.length-this._cursorOffset)>0&&(this._textWrapper.removePart(i-1,i),this._textHasChanged())}return void(r&&r.preventDefault());case 46:if(this._isTextHighlightOn)return this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,void(r&&r.preventDefault());if(this._textWrapper.text&&this._textWrapper.length>0&&this._cursorOffset>0){var i=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(i,i+1),this._textHasChanged(),this._cursorOffset--}return void(r&&r.preventDefault());case 13:return this._host.focusedControl=null,void(this._isTextHighlightOn=!1);case 35:return this._cursorOffset=0,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 36:return this._cursorOffset=this._textWrapper.length,this._blinkIsEven=!1,this._isTextHighlightOn=!1,void this._markAsDirty();case 37:if(this._cursorOffset++,this._cursorOffset>this._textWrapper.length&&(this._cursorOffset=this._textWrapper.length),r&&r.shiftKey){if(this._blinkIsEven=!1,r.ctrlKey||r.metaKey){if(!this._isTextHighlightOn){if(this._textWrapper.length===this._cursorOffset)return;this._endHighlightIndex=this._textWrapper.length-this._cursorOffset+1}return this._startHighlightIndex=0,this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=this._textWrapper.length,this._isTextHighlightOn=!0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._endHighlightIndex,this._cursorOffset=0===this._startHighlightIndex?this._textWrapper.length:this._textWrapper.length-this._startHighlightIndex+1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset>=this._textWrapper.length?this._textWrapper.length:this._cursorOffset-1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this._isTextHighlightOn=!1),r&&(r.ctrlKey||r.metaKey)&&(this._cursorOffset=this._textWrapper.length,r.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 39:if(this._cursorOffset--,this._cursorOffset<0&&(this._cursorOffset=0),r&&r.shiftKey){if(this._blinkIsEven=!1,r.ctrlKey||r.metaKey){if(!this._isTextHighlightOn){if(0===this._cursorOffset)return;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset-1}return this._endHighlightIndex=this._textWrapper.length,this._isTextHighlightOn=!0,this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=0,void this._markAsDirty()}return this._isTextHighlightOn?-1===this._cursorIndex&&(this._cursorIndex=this._textWrapper.length-this._startHighlightIndex,this._cursorOffset=this._textWrapper.length===this._endHighlightIndex?0:this._textWrapper.length-this._endHighlightIndex-1):(this._isTextHighlightOn=!0,this._cursorIndex=this._cursorOffset<=0?0:this._cursorOffset+1),this._cursorIndex<this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset):this._cursorIndex>this._cursorOffset?(this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex):this._isTextHighlightOn=!1,void this._markAsDirty()}return this._isTextHighlightOn&&(this._cursorOffset=this._textWrapper.length-this._endHighlightIndex,this._isTextHighlightOn=!1),r&&(r.ctrlKey||r.metaKey)&&(this._cursorOffset=0,r.preventDefault()),this._blinkIsEven=!1,this._isTextHighlightOn=!1,this._cursorIndex=-1,void this._markAsDirty();case 222:r&&r.preventDefault(),this._cursorIndex=-1,this.deadKey=!0}if(t&&(-1===e||32===e||e>47&&e<64||e>64&&e<91||e>159&&e<193||e>218&&e<223||e>95&&e<112)&&(this._currentKey=t,this.onBeforeKeyAddObservable.notifyObservers(this),t=this._currentKey,this._addKey))if(this._isTextHighlightOn)this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex,t),this._textHasChanged(),this._cursorOffset=this._textWrapper.length-(this._startHighlightIndex+1),this._isTextHighlightOn=!1,this._blinkIsEven=!1,this._markAsDirty();else if(0===this._cursorOffset)this.text+=t;else{var n=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(n,n,t),this._textHasChanged()}}},t.prototype._updateValueFromCursorIndex=function(e){if(this._blinkIsEven=!1,-1===this._cursorIndex)this._cursorIndex=e;else if(this._cursorIndex<this._cursorOffset)this._endHighlightIndex=this._textWrapper.length-this._cursorIndex,this._startHighlightIndex=this._textWrapper.length-this._cursorOffset;else{if(!(this._cursorIndex>this._cursorOffset))return this._isTextHighlightOn=!1,void this._markAsDirty();this._endHighlightIndex=this._textWrapper.length-this._cursorOffset,this._startHighlightIndex=this._textWrapper.length-this._cursorIndex}this._isTextHighlightOn=!0,this._markAsDirty()},t.prototype._processDblClick=function(e){var t,r;this._startHighlightIndex=this._textWrapper.length-this._cursorOffset,this._endHighlightIndex=this._startHighlightIndex;do{r=this._endHighlightIndex<this._textWrapper.length&&this._textWrapper.isWord(this._endHighlightIndex)?++this._endHighlightIndex:0,t=this._startHighlightIndex>0&&this._textWrapper.isWord(this._startHighlightIndex-1)?--this._startHighlightIndex:0}while(t||r);this._cursorOffset=this._textWrapper.length-this._startHighlightIndex,this.onTextHighlightObservable.notifyObservers(this),this._isTextHighlightOn=!0,this._clickedCoordinate=null,this._blinkIsEven=!0,this._cursorIndex=-1,this._markAsDirty()},t.prototype._selectAllText=function(){this._blinkIsEven=!0,this._isTextHighlightOn=!0,this._startHighlightIndex=0,this._endHighlightIndex=this._textWrapper.length,this._cursorOffset=this._textWrapper.length,this._cursorIndex=-1,this._markAsDirty()},t.prototype.processKeyboard=function(e){this.processKey(e.keyCode,e.key,e),this.onKeyboardEventProcessedObservable.notifyObservers(e)},t.prototype._onCopyText=function(e){this._isTextHighlightOn=!1;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText},t.prototype._onCutText=function(e){if(this._highlightedText){this._textWrapper.removePart(this._startHighlightIndex,this._endHighlightIndex),this._textHasChanged(),this._isTextHighlightOn=!1,this._cursorOffset=this._textWrapper.length-this._startHighlightIndex;try{e.clipboardData&&e.clipboardData.setData("text/plain",this._highlightedText)}catch(e){}this._host.clipboardData=this._highlightedText,this._highlightedText=""}},t.prototype._onPasteText=function(e){var t="";t=e.clipboardData&&-1!==e.clipboardData.types.indexOf("text/plain")?e.clipboardData.getData("text/plain"):this._host.clipboardData;var r=this._textWrapper.length-this._cursorOffset;this._textWrapper.removePart(r,r,t),this._textHasChanged()},t.prototype._draw=function(e,t){var r=this;e.save(),this._applyStates(e),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isFocused?this._focusedBackground&&(e.fillStyle=this._isEnabled?this._focusedBackground:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)):this._background&&(e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height)),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._fontOffset||(this._fontOffset=_._GetFontOffset(e.font));var i=this._currentMeasure.left+this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this.color&&(e.fillStyle=this.color);var n=this._beforeRenderText(this._textWrapper);this._isFocused||this._textWrapper.text||!this._placeholderText||((n=new A).text=this._placeholderText,this._placeholderColor&&(e.fillStyle=this._placeholderColor)),this._textWidth=e.measureText(n.text).width;var o=2*this._margin.getValueInPixel(this._host,this._tempParentMeasure.width);this._autoStretchWidth&&(this.width=Math.min(this._maxWidth.getValueInPixel(this._host,this._tempParentMeasure.width),this._textWidth+o)+"px");var s=this._fontOffset.ascent+(this._currentMeasure.height-this._fontOffset.height)/2,a=this._width.getValueInPixel(this._host,this._tempParentMeasure.width)-o;if(e.save(),e.beginPath(),e.rect(i,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,a+2,this._currentMeasure.height),e.clip(),this._isFocused&&this._textWidth>a){var l=i-this._textWidth+a;this._scrollLeft||(this._scrollLeft=l)}else this._scrollLeft=i;if(e.fillText(n.text,this._scrollLeft,this._currentMeasure.top+s),this._isFocused){if(this._clickedCoordinate){var h=this._scrollLeft+this._textWidth-this._clickedCoordinate,u=0;this._cursorOffset=0;var c=0;do{this._cursorOffset&&(c=Math.abs(h-u)),this._cursorOffset++,u=e.measureText(n.substr(n.length-this._cursorOffset,this._cursorOffset)).width}while(u<h&&n.length>=this._cursorOffset);Math.abs(h-u)>c&&this._cursorOffset--,this._blinkIsEven=!1,this._clickedCoordinate=null}if(!this._blinkIsEven){var d=n.substr(n.length-this._cursorOffset),p=e.measureText(d).width,f=this._scrollLeft+this._textWidth-p;f<i?(this._scrollLeft+=i-f,f=i,this._markAsDirty()):f>i+a&&(this._scrollLeft+=i+a-f,f=i+a,this._markAsDirty()),this._isTextHighlightOn||e.fillRect(f,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,2,this._fontOffset.height)}if(clearTimeout(this._blinkTimeout),this._blinkTimeout=setTimeout((function(){r._blinkIsEven=!r._blinkIsEven,r._markAsDirty()}),500),this._isTextHighlightOn){clearTimeout(this._blinkTimeout);var g=e.measureText(n.substring(this._startHighlightIndex)).width,m=this._scrollLeft+this._textWidth-g;this._highlightedText=n.substring(this._startHighlightIndex,this._endHighlightIndex);var b=e.measureText(n.substring(this._startHighlightIndex,this._endHighlightIndex)).width;m<i&&((b-=i-m)||(b=e.measureText(n.charAt(n.length-this._cursorOffset)).width),m=i),e.globalAlpha=this._highligherOpacity,e.fillStyle=this._textHighlightColor,e.fillRect(m,this._currentMeasure.top+(this._currentMeasure.height-this._fontOffset.height)/2,b,this._fontOffset.height),e.globalAlpha=1}}e.restore(),this._thickness&&(this._isFocused?this.focusedColor&&(e.strokeStyle=this.focusedColor):this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.strokeRect(this._currentMeasure.left+this._thickness/2,this._currentMeasure.top+this._thickness/2,this._currentMeasure.width-this._thickness,this._currentMeasure.height-this._thickness)),e.restore()},t.prototype._onPointerDown=function(t,r,i,n,o){return!!e.prototype._onPointerDown.call(this,t,r,i,n,o)&&(this._clickedCoordinate=r.x,this._isTextHighlightOn=!1,this._highlightedText="",this._cursorIndex=-1,this._isPointerDown=!0,this._host._capturingControl[i]=this,this._host.focusedControl===this?(clearTimeout(this._blinkTimeout),this._markAsDirty(),!0):!!this._isEnabled&&(this._host.focusedControl=this,!0))},t.prototype._onPointerMove=function(t,r,i,n){this._host.focusedControl===this&&this._isPointerDown&&(this._clickedCoordinate=r.x,this._markAsDirty(),this._updateValueFromCursorIndex(this._cursorOffset)),e.prototype._onPointerMove.call(this,t,r,i,n)},t.prototype._onPointerUp=function(t,r,i,n,o){this._isPointerDown=!1,delete this._host._capturingControl[i],e.prototype._onPointerUp.call(this,t,r,i,n,o)},t.prototype._beforeRenderText=function(e){return e},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onBlurObservable.clear(),this.onFocusObservable.clear(),this.onTextChangedObservable.clear(),this.onTextCopyObservable.clear(),this.onTextCutObservable.clear(),this.onTextPasteObservable.clear(),this.onTextHighlightObservable.clear(),this.onKeyboardEventProcessedObservable.clear()},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.InputText"]=C;var M=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._rowDefinitions=new Array,r._columnDefinitions=new Array,r._cells={},r._childControls=new Array,r}return n(t,e),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this._columnDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowDefinitions.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this._childControls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._cells},enumerable:!1,configurable:!0}),t.prototype.getRowDefinition=function(e){return e<0||e>=this._rowDefinitions.length?null:this._rowDefinitions[e]},t.prototype.getColumnDefinition=function(e){return e<0||e>=this._columnDefinitions.length?null:this._columnDefinitions[e]},t.prototype.addRowDefinition=function(e,t){return void 0===t&&(t=!1),this._rowDefinitions.push(new a(e,t?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.addColumnDefinition=function(e,t){return void 0===t&&(t=!1),this._columnDefinitions.push(new a(e,t?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE)),this._markAsDirty(),this},t.prototype.setRowDefinition=function(e,t,r){if(void 0===r&&(r=!1),e<0||e>=this._rowDefinitions.length)return this;var i=this._rowDefinitions[e];return i&&i.isPixel===r&&i.internalValue===t||(this._rowDefinitions[e]=new a(t,r?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE),this._markAsDirty()),this},t.prototype.setColumnDefinition=function(e,t,r){if(void 0===r&&(r=!1),e<0||e>=this._columnDefinitions.length)return this;var i=this._columnDefinitions[e];return i&&i.isPixel===r&&i.internalValue===t||(this._columnDefinitions[e]=new a(t,r?a.UNITMODE_PIXEL:a.UNITMODE_PERCENTAGE),this._markAsDirty()),this},t.prototype.getChildrenAt=function(e,t){var r=this._cells[e+":"+t];return r?r.children:null},t.prototype.getChildCellInfo=function(e){return e._tag},t.prototype._removeCell=function(t,r){if(t){e.prototype.removeControl.call(this,t);for(var i=0,n=t.children;i<n.length;i++){var o=n[i],s=this._childControls.indexOf(o);-1!==s&&this._childControls.splice(s,1)}delete this._cells[r]}},t.prototype._offsetCell=function(e,t){if(this._cells[t]){this._cells[e]=this._cells[t];for(var r=0,i=this._cells[e].children;r<i.length;r++)i[r]._tag=e;delete this._cells[t]}},t.prototype.removeColumnDefinition=function(e){if(e<0||e>=this._columnDefinitions.length)return this;for(var t=0;t<this._rowDefinitions.length;t++){var r=t+":"+e,i=this._cells[r];this._removeCell(i,r)}for(t=0;t<this._rowDefinitions.length;t++)for(var n=e+1;n<this._columnDefinitions.length;n++){var o=t+":"+(n-1);r=t+":"+n,this._offsetCell(o,r)}return this._columnDefinitions.splice(e,1),this._markAsDirty(),this},t.prototype.removeRowDefinition=function(e){if(e<0||e>=this._rowDefinitions.length)return this;for(var t=0;t<this._columnDefinitions.length;t++){var r=e+":"+t,i=this._cells[r];this._removeCell(i,r)}for(t=0;t<this._columnDefinitions.length;t++)for(var n=e+1;n<this._rowDefinitions.length;n++){var o=n-1+":"+t;r=n+":"+t,this._offsetCell(o,r)}return this._rowDefinitions.splice(e,1),this._markAsDirty(),this},t.prototype.addControl=function(t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=0),0===this._rowDefinitions.length&&this.addRowDefinition(1,!1),0===this._columnDefinitions.length&&this.addColumnDefinition(1,!1),-1!==this._childControls.indexOf(t))return s.Tools.Warn("Control (Name:"+t.name+", UniqueId:"+t.uniqueId+") is already associated with this grid. You must remove it before reattaching it"),this;var n=Math.min(r,this._rowDefinitions.length-1)+":"+Math.min(i,this._columnDefinitions.length-1),o=this._cells[n];return o||(o=new g(n),this._cells[n]=o,o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,e.prototype.addControl.call(this,o)),o.addControl(t),this._childControls.push(t),t._tag=n,t.parent=this,this._markAsDirty(),this},t.prototype.removeControl=function(e){var t=this._childControls.indexOf(e);-1!==t&&this._childControls.splice(t,1);var r=this._cells[e._tag];return r&&(r.removeControl(e),e._tag=null),this._markAsDirty(),this},t.prototype._getTypeName=function(){return"Grid"},t.prototype._getGridDefinitions=function(e){for(var t=[],r=[],i=[],n=[],o=this._currentMeasure.width,s=0,a=this._currentMeasure.height,l=0,h=0,u=0,c=this._rowDefinitions;u<c.length;u++)(g=c[u]).isPixel?(a-=_=g.getValue(this._host),r[h]=_):l+=g.internalValue,h++;var d=0;h=0;for(var p=0,f=this._rowDefinitions;p<f.length;p++){var _,g=f[p];n.push(d),g.isPixel?d+=g.getValue(this._host):(d+=_=g.internalValue/l*a,r[h]=_),h++}h=0;for(var m=0,b=this._columnDefinitions;m<b.length;m++)(g=b[m]).isPixel?(o-=O=g.getValue(this._host),t[h]=O):s+=g.internalValue,h++;var y=0;h=0;for(var v=0,T=this._columnDefinitions;v<T.length;v++){var O;g=T[v],i.push(y),g.isPixel?y+=g.getValue(this._host):(y+=O=g.internalValue/s*o,t[h]=O),h++}e(i,n,t,r)},t.prototype._additionalProcessing=function(t,r){var i=this;this._getGridDefinitions((function(e,t,r,n){for(var o in i._cells)if(i._cells.hasOwnProperty(o)){var s=o.split(":"),a=parseInt(s[0]),l=parseInt(s[1]),h=i._cells[o];h.left=e[l]+"px",h.top=t[a]+"px",h.width=r[l]+"px",h.height=n[a]+"px",h._left.ignoreAdaptiveScaling=!0,h._top.ignoreAdaptiveScaling=!0,h._width.ignoreAdaptiveScaling=!0,h._height.ignoreAdaptiveScaling=!0}})),e.prototype._additionalProcessing.call(this,t,r)},t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e in this._cells)this._cells.hasOwnProperty(e)&&this._cells[e]._markMatrixAsDirty()},t.prototype._renderHighlightSpecific=function(t){var r=this;e.prototype._renderHighlightSpecific.call(this,t),this._getGridDefinitions((function(e,i,n,o){for(var s=0;s<e.length;s++){var a=r._currentMeasure.left+e[s]+n[s];t.beginPath(),t.moveTo(a,r._currentMeasure.top),t.lineTo(a,r._currentMeasure.top+r._currentMeasure.height),t.stroke()}for(s=0;s<i.length;s++){var l=r._currentMeasure.top+i[s]+o[s];t.beginPath(),t.moveTo(r._currentMeasure.left,l),t.lineTo(r._currentMeasure.left+r._currentMeasure.width,l),t.stroke()}})),t.restore()},t.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=0,r=this._childControls;t<r.length;t++)r[t].dispose();this._childControls=[]},t}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Grid"]=M;var x=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._value=s.Color3.Red(),r._tmpColor=new s.Color3,r._pointerStartedOnSquare=!1,r._pointerStartedOnWheel=!1,r._squareLeft=0,r._squareTop=0,r._squareSize=0,r._h=360,r._s=1,r._v=1,r._lastPointerDownID=-1,r.onValueChangedObservable=new s.Observable,r._pointerIsDown=!1,r.value=new s.Color3(.88,.1,.1),r.size="200px",r.isPointerBlocker=!0,r}return n(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value.equals(e)||(this._value.copyFrom(e),this._value.toHSVToRef(this._tmpColor),this._h=this._tmpColor.r,this._s=Math.max(this._tmpColor.g,1e-5),this._v=Math.max(this._tmpColor.b,1e-5),this._markAsDirty(),this._value.r<=t._Epsilon&&(this._value.r=0),this._value.g<=t._Epsilon&&(this._value.g=0),this._value.b<=t._Epsilon&&(this._value.b=0),this._value.r>=1-t._Epsilon&&(this._value.r=1),this._value.g>=1-t._Epsilon&&(this._value.g=1),this._value.b>=1-t._Epsilon&&(this._value.b=1),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width.toString(this._host)},set:function(e){this._width.toString(this._host)!==e&&this._width.fromString(e)&&(this._height.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height.toString(this._host)},set:function(e){this._height.toString(this._host)!==e&&this._height.fromString(e)&&(this._width.fromString(e),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.width},set:function(e){this.width=e},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ColorPicker"},t.prototype._preMeasure=function(e,t){e.width<e.height?this._currentMeasure.height=e.width:this._currentMeasure.width=e.height},t.prototype._updateSquareProps=function(){var e=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),t=2*(e-.2*e)/Math.sqrt(2),r=e-.5*t;this._squareLeft=this._currentMeasure.left+r,this._squareTop=this._currentMeasure.top+r,this._squareSize=t},t.prototype._drawGradientSquare=function(e,t,r,i,n,o){var s=o.createLinearGradient(t,r,i+t,r);s.addColorStop(0,"#fff"),s.addColorStop(1,"hsl("+e+", 100%, 50%)"),o.fillStyle=s,o.fillRect(t,r,i,n);var a=o.createLinearGradient(t,r,t,n+r);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"#000"),o.fillStyle=a,o.fillRect(t,r,i,n)},t.prototype._drawCircle=function(e,t,r,i){i.beginPath(),i.arc(e,t,r+1,0,2*Math.PI,!1),i.lineWidth=3,i.strokeStyle="#333333",i.stroke(),i.beginPath(),i.arc(e,t,r,0,2*Math.PI,!1),i.lineWidth=3,i.strokeStyle="#ffffff",i.stroke()},t.prototype._createColorWheelCanvas=function(e,t){var r=document.createElement("canvas");r.width=2*e,r.height=2*e;for(var i=r.getContext("2d"),n=i.getImageData(0,0,2*e,2*e),o=n.data,a=this._tmpColor,l=e*e,h=e-t,u=h*h,c=-e;c<e;c++)for(var d=-e;d<e;d++){var p=c*c+d*d;if(!(p>l||p<u)){var f=Math.sqrt(p),_=Math.atan2(d,c);s.Color3.HSVtoRGBToRef(180*_/Math.PI+180,f/e,1,a);var g=4*(c+e+2*(d+e)*e);o[g]=255*a.r,o[g+1]=255*a.g,o[g+2]=255*a.b;var m=.2;m=e<50?.2:e>150?.04:-.16*(e-50)/100+.2;var b=(f-h)/(e-h);o[g+3]=b<m?b/m*255:b>1-m?255*(1-(b-(1-m))/m):255}}return i.putImageData(n,0,0),r},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),r=.2*t,i=this._currentMeasure.left,n=this._currentMeasure.top;this._colorWheelCanvas&&this._colorWheelCanvas.width==2*t||(this._colorWheelCanvas=this._createColorWheelCanvas(t,r)),this._updateSquareProps(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY,e.fillRect(this._squareLeft,this._squareTop,this._squareSize,this._squareSize)),e.drawImage(this._colorWheelCanvas,i,n),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._drawGradientSquare(this._h,this._squareLeft,this._squareTop,this._squareSize,this._squareSize,e);var o=this._squareLeft+this._squareSize*this._s,s=this._squareTop+this._squareSize*(1-this._v);this._drawCircle(o,s,.04*t,e);var a=t-.5*r;o=i+t+Math.cos((this._h-180)*Math.PI/180)*a,s=n+t+Math.sin((this._h-180)*Math.PI/180)*a,this._drawCircle(o,s,.35*r,e),e.restore()},t.prototype._updateValueFromPointer=function(e,r){if(this._pointerStartedOnWheel){var i=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),n=i+this._currentMeasure.left,o=i+this._currentMeasure.top;this._h=180*Math.atan2(r-o,e-n)/Math.PI+180}else this._pointerStartedOnSquare&&(this._updateSquareProps(),this._s=(e-this._squareLeft)/this._squareSize,this._v=1-(r-this._squareTop)/this._squareSize,this._s=Math.min(this._s,1),this._s=Math.max(this._s,t._Epsilon),this._v=Math.min(this._v,1),this._v=Math.max(this._v,t._Epsilon));s.Color3.HSVtoRGBToRef(this._h,this._s,this._v,this._tmpColor),this.value=this._tmpColor},t.prototype._isPointOnSquare=function(e,t){this._updateSquareProps();var r=this._squareLeft,i=this._squareTop,n=this._squareSize;return e>=r&&e<=r+n&&t>=i&&t<=i+n},t.prototype._isPointOnWheel=function(e,t){var r=.5*Math.min(this._currentMeasure.width,this._currentMeasure.height),i=r-.2*r,n=e-(r+this._currentMeasure.left),o=t-(r+this._currentMeasure.top),s=n*n+o*o;return s<=r*r&&s>=i*i},t.prototype._onPointerDown=function(t,r,i,n,o){if(!e.prototype._onPointerDown.call(this,t,r,i,n,o))return!1;this._pointerIsDown=!0,this._pointerStartedOnSquare=!1,this._pointerStartedOnWheel=!1,this._invertTransformMatrix.transformCoordinates(r.x,r.y,this._transformedPosition);var s=this._transformedPosition.x,a=this._transformedPosition.y;return this._isPointOnSquare(s,a)?this._pointerStartedOnSquare=!0:this._isPointOnWheel(s,a)&&(this._pointerStartedOnWheel=!0),this._updateValueFromPointer(s,a),this._host._capturingControl[i]=this,this._lastPointerDownID=i,!0},t.prototype._onPointerMove=function(t,r,i,n){if(i==this._lastPointerDownID){this._invertTransformMatrix.transformCoordinates(r.x,r.y,this._transformedPosition);var o=this._transformedPosition.x,s=this._transformedPosition.y;this._pointerIsDown&&this._updateValueFromPointer(o,s),e.prototype._onPointerMove.call(this,t,r,i,n)}},t.prototype._onPointerUp=function(t,r,i,n,o,s){this._pointerIsDown=!1,delete this._host._capturingControl[i],e.prototype._onPointerUp.call(this,t,r,i,n,o,s)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},t.ShowPickerDialogAsync=function(e,r){return new Promise((function(i,n){r.pickerWidth=r.pickerWidth||"640px",r.pickerHeight=r.pickerHeight||"400px",r.headerHeight=r.headerHeight||"35px",r.lastColor=r.lastColor||"#000000",r.swatchLimit=r.swatchLimit||20,r.numSwatchesPerLine=r.numSwatchesPerLine||10;var o,a,l,h,u,c,d,p,f,g,m,v,O,E,A,x,w,S,R,P=r.swatchLimit/r.numSwatchesPerLine,I=parseFloat(r.pickerWidth)/r.numSwatchesPerLine,L=Math.floor(.25*I),N=L*(r.numSwatchesPerLine+1),k=Math.floor((parseFloat(r.pickerWidth)-N)/r.numSwatchesPerLine),D=k*P+L*(P+1),B=(parseInt(r.pickerHeight)+D+Math.floor(.25*k)).toString()+"px",F=s.Color3.FromHexString("#dddddd"),V=F.r+F.g+F.b,H=["R","G","B"],j=!1;function U(e,t){R=t;var r=e.toHexString();if(w.background=r,g.name!=R&&(g.text=Math.floor(255*e.r).toString()),m.name!=R&&(m.text=Math.floor(255*e.g).toString()),v.name!=R&&(v.text=Math.floor(255*e.b).toString()),O.name!=R&&(O.text=e.r.toString()),E.name!=R&&(E.text=e.g.toString()),A.name!=R&&(A.text=e.b.toString()),x.name!=R){var i=r.split("#");x.text=i[1]}f.name!=R&&(f.value=e)}function G(e,t){var r=e.text;if(/[^0-9]/g.test(r))e.text=S;else if(""!=r&&(Math.floor(parseInt(r))<0?r="0":Math.floor(parseInt(r))>255?r="255":isNaN(parseInt(r))&&(r="0")),R==e.name&&(S=r),""!=r){r=parseInt(r).toString(),e.text=r;var i=s.Color3.FromHexString(w.background);R==e.name&&U("r"==t?new s.Color3(parseInt(r)/255,i.g,i.b):"g"==t?new s.Color3(i.r,parseInt(r)/255,i.b):new s.Color3(i.r,i.g,parseInt(r)/255),e.name)}}function W(e,t){var r=e.text;if(/[^0-9\.]/g.test(r))e.text=S;else{""!=r&&"."!=r&&0!=parseFloat(r)&&(parseFloat(r)<0?r="0.0":parseFloat(r)>1?r="1.0":isNaN(parseFloat(r))&&(r="0.0")),R==e.name&&(S=r),""!=r&&"."!=r&&0!=parseFloat(r)?(r=parseFloat(r).toString(),e.text=r):r="0.0";var i=s.Color3.FromHexString(w.background);R==e.name&&U("r"==t?new s.Color3(parseFloat(r),i.g,i.b):"g"==t?new s.Color3(i.r,parseFloat(r),i.b):new s.Color3(i.r,i.g,parseFloat(r)),e.name)}}function z(){if(r.savedColors&&r.savedColors[d]){if(j)var e="b";else e="";var t=T.CreateSimpleButton("Swatch_"+d,e);t.fontFamily="BabylonJSglyphs";var i=s.Color3.FromHexString(r.savedColors[d]),n=i.r+i.g+i.b;t.color=n>V?"#aaaaaa":"#ffffff",t.fontSize=Math.floor(.7*k),t.textBlock.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,t.height=t.width=k.toString()+"px",t.background=r.savedColors[d],t.thickness=2;var o=d;return t.pointerDownAnimation=function(){t.thickness=4},t.pointerUpAnimation=function(){t.thickness=3},t.pointerEnterAnimation=function(){t.thickness=3},t.pointerOutAnimation=function(){t.thickness=2},t.onPointerClickObservable.add((function(){var e;j?(e=o,r.savedColors&&r.savedColors.splice(e,1),r.savedColors&&0==r.savedColors.length&&(K(!1),j=!1),Y("",we)):r.savedColors&&U(s.Color3.FromHexString(r.savedColors[o]),t.name)})),t}return null}function X(e){if(void 0!==e&&(j=e),j){for(var t=0;t<p.children.length;t++)p.children[t].textBlock.text="b";void 0!==l&&(l.textBlock.text="Done")}else{for(t=0;t<p.children.length;t++)p.children[t].textBlock.text="";void 0!==l&&(l.textBlock.text="Edit")}}function Y(e,t){if(r.savedColors){""!=e&&r.savedColors.push(e),d=0,p.clearControls();var i=Math.ceil(r.savedColors.length/r.numSwatchesPerLine);if(0==i)var n=0;else n=i+1;if(p.rowCount!=i+n){for(var o=p.rowCount,s=0;s<o;s++)p.removeRowDefinition(0);for(s=0;s<i+n;s++)s%2?p.addRowDefinition(k,!0):p.addRowDefinition(L,!0)}p.height=(k*i+n*L).toString()+"px";for(var a=1,l=1;a<i+n;a+=2,l++){if(r.savedColors.length>l*r.numSwatchesPerLine)var h=r.numSwatchesPerLine;else h=r.savedColors.length-(l-1)*r.numSwatchesPerLine;for(var u=Math.min(Math.max(h,0),r.numSwatchesPerLine),c=0,f=1;c<u;c++)if(!(c>r.numSwatchesPerLine)){var _=z();null!=_&&(p.addControl(_,a,f),f+=2,d++)}}r.savedColors.length>=r.swatchLimit?$(t,!0):$(t,!1)}}function K(e){e?((l=T.CreateSimpleButton("butEdit","Edit")).width=h,l.height=u,l.left=Math.floor(.1*parseInt(h)).toString()+"px",l.top=(-1*parseFloat(l.left)).toString()+"px",l.verticalAlignment=_.VERTICAL_ALIGNMENT_BOTTOM,l.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,l.thickness=2,l.color="#c0c0c0",l.fontSize=a,l.background="#535353",l.onPointerEnterObservable.add((function(){l.background="#414141"})),l.onPointerOutObservable.add((function(){l.background="#535353"})),l.pointerDownAnimation=function(){l.background="515151"},l.pointerUpAnimation=function(){l.background="#414141"},l.onPointerClickObservable.add((function(){j=!j,X()})),ue.addControl(l,1,0)):ue.removeControl(l)}function $(e,t){t?(e.color="#555555",e.background="#454545"):(e.color="#c0c0c0",e.background="#535353")}function q(t){r.savedColors&&r.savedColors.length>0?i({savedColors:r.savedColors,pickedColor:t}):i({pickedColor:t}),e.removeControl(Z)}var Z=new M;if(Z.name="Dialog Container",Z.width=r.pickerWidth,r.savedColors){Z.height=B;var J=parseInt(r.pickerHeight)/parseInt(B);Z.addRowDefinition(J,!1),Z.addRowDefinition(1-J,!1)}else Z.height=r.pickerHeight,Z.addRowDefinition(1,!1);if(e.addControl(Z),r.savedColors){(p=new M).name="Swatch Drawer",p.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,p.background="#535353",p.width=r.pickerWidth;var Q=r.savedColors.length/r.numSwatchesPerLine;if(0==Q)var ee=0;else ee=Q+1;p.height=(k*Q+ee*L).toString()+"px",p.top=Math.floor(.25*k).toString()+"px";for(var te=0;te<2*Math.ceil(r.savedColors.length/r.numSwatchesPerLine)+1;te++)te%2!=0?p.addRowDefinition(k,!0):p.addRowDefinition(L,!0);for(te=0;te<2*r.numSwatchesPerLine+1;te++)te%2!=0?p.addColumnDefinition(k,!0):p.addColumnDefinition(L,!0);Z.addControl(p,1,0)}var re=new M;re.name="Picker Panel",re.height=r.pickerHeight;var ie=parseInt(r.headerHeight)/parseInt(r.pickerHeight),ne=[ie,1-ie];re.addRowDefinition(ne[0],!1),re.addRowDefinition(ne[1],!1),Z.addControl(re,0,0);var oe=new b;oe.name="Dialogue Header Bar",oe.background="#cccccc",oe.thickness=0,re.addControl(oe,0,0);var se=T.CreateSimpleButton("closeButton","a");se.fontFamily="BabylonJSglyphs";var ae=s.Color3.FromHexString(oe.background);o=new s.Color3(1-ae.r,1-ae.g,1-ae.b),se.color=o.toHexString(),se.fontSize=Math.floor(.6*parseInt(r.headerHeight)),se.textBlock.textVerticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,se.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_RIGHT,se.height=se.width=r.headerHeight,se.background=oe.background,se.thickness=0,se.pointerDownAnimation=function(){},se.pointerUpAnimation=function(){se.background=oe.background},se.pointerEnterAnimation=function(){se.color=oe.background,se.background="red"},se.pointerOutAnimation=function(){se.color=o.toHexString(),se.background=oe.background},se.onPointerClickObservable.add((function(){q(Oe.background)})),re.addControl(se,0,0);var le=new M;le.name="Dialogue Body",le.background="#535353";var he=[.4375,.5625];le.addRowDefinition(1,!1),le.addColumnDefinition(he[0],!1),le.addColumnDefinition(he[1],!1),re.addControl(le,1,0);var ue=new M;ue.name="Picker Grid",ue.addRowDefinition(.85,!1),ue.addRowDefinition(.15,!1),le.addControl(ue,0,0),(f=new t).name="GUI Color Picker",r.pickerHeight<r.pickerWidth?f.width=.89:f.height=.89,f.value=s.Color3.FromHexString(r.lastColor),f.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,f.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,f.onPointerDownObservable.add((function(){R=f.name,S="",X(!1)})),f.onValueChangedObservable.add((function(e){R==f.name&&U(e,f.name)})),ue.addControl(f,0,0);var ce=new M;ce.name="Dialogue Right Half",ce.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT;var de=[.514,.486];ce.addRowDefinition(de[0],!1),ce.addRowDefinition(de[1],!1),le.addControl(ce,1,1);var pe=new M;pe.name="Swatches and Buttons";var fe=[.417,.583];pe.addRowDefinition(1,!1),pe.addColumnDefinition(fe[0],!1),pe.addColumnDefinition(fe[1],!1),ce.addControl(pe,0,0);var _e=new M;_e.name="New and Current Swatches";var ge=[.04,.16,.64,.16];_e.addRowDefinition(ge[0],!1),_e.addRowDefinition(ge[1],!1),_e.addRowDefinition(ge[2],!1),_e.addRowDefinition(ge[3],!1),pe.addControl(_e,0,0);var me=new M;me.name="Active Swatches",me.width=.67,me.addRowDefinition(.5,!1),me.addRowDefinition(.5,!1),_e.addControl(me,2,0);var be=Math.floor(parseInt(r.pickerWidth)*he[1]*fe[0]*.11),ye=Math.floor(parseInt(r.pickerHeight)*ne[1]*de[0]*ge[1]*.5);if(r.pickerWidth>r.pickerHeight)var ve=ye;else ve=be;var Te=new y;Te.text="new",Te.name="New Color Label",Te.color="#c0c0c0",Te.fontSize=ve,_e.addControl(Te,1,0),(w=new b).name="New Color Swatch",w.background=r.lastColor,w.thickness=0,me.addControl(w,0,0);var Oe=T.CreateSimpleButton("currentSwatch","");Oe.background=r.lastColor,Oe.thickness=0,Oe.onPointerClickObservable.add((function(){U(s.Color3.FromHexString(Oe.background),Oe.name),X(!1)})),Oe.pointerDownAnimation=function(){},Oe.pointerUpAnimation=function(){},Oe.pointerEnterAnimation=function(){},Oe.pointerOutAnimation=function(){},me.addControl(Oe,1,0);var Ee=new b;Ee.name="Swatch Outline",Ee.width=.67,Ee.thickness=2,Ee.color="#404040",Ee.isHitTestVisible=!1,_e.addControl(Ee,2,0);var Ae=new y;Ae.name="Current Color Label",Ae.text="current",Ae.color="#c0c0c0",Ae.fontSize=ve,_e.addControl(Ae,3,0);var Ce=new M;Ce.name="Button Grid",Ce.height=.8,Ce.addRowDefinition(1/3,!1),Ce.addRowDefinition(1/3,!1),Ce.addRowDefinition(1/3,!1),pe.addControl(Ce,0,1),h=Math.floor(parseInt(r.pickerWidth)*he[1]*fe[1]*.67).toString()+"px",u=Math.floor(parseInt(r.pickerHeight)*ne[1]*de[0]*(parseFloat(Ce.height.toString())/100)*(1/3)*.7).toString()+"px",a=parseFloat(h)>parseFloat(u)?Math.floor(.45*parseFloat(u)):Math.floor(.11*parseFloat(h));var Me=T.CreateSimpleButton("butOK","OK");Me.width=h,Me.height=u,Me.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,Me.thickness=2,Me.color="#c0c0c0",Me.fontSize=a,Me.background="#535353",Me.onPointerEnterObservable.add((function(){Me.background="#414141"})),Me.onPointerOutObservable.add((function(){Me.background="#535353"})),Me.pointerDownAnimation=function(){Me.background="515151"},Me.pointerUpAnimation=function(){Me.background="#414141"},Me.onPointerClickObservable.add((function(){X(!1),q(w.background)})),Ce.addControl(Me,0,0);var xe=T.CreateSimpleButton("butCancel","Cancel");if(xe.width=h,xe.height=u,xe.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,xe.thickness=2,xe.color="#c0c0c0",xe.fontSize=a,xe.background="#535353",xe.onPointerEnterObservable.add((function(){xe.background="#414141"})),xe.onPointerOutObservable.add((function(){xe.background="#535353"})),xe.pointerDownAnimation=function(){xe.background="515151"},xe.pointerUpAnimation=function(){xe.background="#414141"},xe.onPointerClickObservable.add((function(){X(!1),q(Oe.background)})),Ce.addControl(xe,1,0),r.savedColors){var we=T.CreateSimpleButton("butSave","Save");we.width=h,we.height=u,we.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,we.thickness=2,we.fontSize=a,r.savedColors.length<r.swatchLimit?(we.color="#c0c0c0",we.background="#535353"):$(we,!0),we.onPointerEnterObservable.add((function(){r.savedColors&&r.savedColors.length<r.swatchLimit&&(we.background="#414141")})),we.onPointerOutObservable.add((function(){r.savedColors&&r.savedColors.length<r.swatchLimit&&(we.background="#535353")})),we.pointerDownAnimation=function(){r.savedColors&&r.savedColors.length<r.swatchLimit&&(we.background="515151")},we.pointerUpAnimation=function(){r.savedColors&&r.savedColors.length<r.swatchLimit&&(we.background="#414141")},we.onPointerClickObservable.add((function(){r.savedColors&&(0==r.savedColors.length&&K(!0),r.savedColors.length<r.swatchLimit&&Y(w.background,we),X(!1))})),r.savedColors.length>0&&K(!0),Ce.addControl(we,2,0)}var Se=new M;Se.name="Dialog Lower Right",Se.addRowDefinition(.02,!1),Se.addRowDefinition(.63,!1),Se.addRowDefinition(.21,!1),Se.addRowDefinition(.14,!1),ce.addControl(Se,1,0),c=s.Color3.FromHexString(r.lastColor);var Re=new M;for(Re.name="RGB Values",Re.width=.82,Re.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,Re.addRowDefinition(1/3,!1),Re.addRowDefinition(1/3,!1),Re.addRowDefinition(1/3,!1),Re.addColumnDefinition(.1,!1),Re.addColumnDefinition(.2,!1),Re.addColumnDefinition(.7,!1),Se.addControl(Re,1,0),te=0;te<H.length;te++)(Pe=new y).text=H[te],Pe.color="#c0c0c0",Pe.fontSize=a,Re.addControl(Pe,te,0);(g=new C).width=.83,g.height=.72,g.name="rIntField",g.fontSize=a,g.text=(255*c.r).toString(),g.color="#f0f0f0",g.background="#454545",g.onFocusObservable.add((function(){R=g.name,S=g.text,X(!1)})),g.onBlurObservable.add((function(){""==g.text&&(g.text="0"),G(g,"r"),R==g.name&&(R="")})),g.onTextChangedObservable.add((function(){R==g.name&&G(g,"r")})),Re.addControl(g,0,1),(m=new C).width=.83,m.height=.72,m.name="gIntField",m.fontSize=a,m.text=(255*c.g).toString(),m.color="#f0f0f0",m.background="#454545",m.onFocusObservable.add((function(){R=m.name,S=m.text,X(!1)})),m.onBlurObservable.add((function(){""==m.text&&(m.text="0"),G(m,"g"),R==m.name&&(R="")})),m.onTextChangedObservable.add((function(){R==m.name&&G(m,"g")})),Re.addControl(m,1,1),(v=new C).width=.83,v.height=.72,v.name="bIntField",v.fontSize=a,v.text=(255*c.b).toString(),v.color="#f0f0f0",v.background="#454545",v.onFocusObservable.add((function(){R=v.name,S=v.text,X(!1)})),v.onBlurObservable.add((function(){""==v.text&&(v.text="0"),G(v,"b"),R==v.name&&(R="")})),v.onTextChangedObservable.add((function(){R==v.name&&G(v,"b")})),Re.addControl(v,2,1),(O=new C).width=.95,O.height=.72,O.name="rDecField",O.fontSize=a,O.text=c.r.toString(),O.color="#f0f0f0",O.background="#454545",O.onFocusObservable.add((function(){R=O.name,S=O.text,X(!1)})),O.onBlurObservable.add((function(){0!=parseFloat(O.text)&&""!=O.text||(O.text="0",W(O,"r")),R==O.name&&(R="")})),O.onTextChangedObservable.add((function(){R==O.name&&W(O,"r")})),Re.addControl(O,0,2),(E=new C).width=.95,E.height=.72,E.name="gDecField",E.fontSize=a,E.text=c.g.toString(),E.color="#f0f0f0",E.background="#454545",E.onFocusObservable.add((function(){R=E.name,S=E.text,X(!1)})),E.onBlurObservable.add((function(){0!=parseFloat(E.text)&&""!=E.text||(E.text="0",W(E,"g")),R==E.name&&(R="")})),E.onTextChangedObservable.add((function(){R==E.name&&W(E,"g")})),Re.addControl(E,1,2),(A=new C).width=.95,A.height=.72,A.name="bDecField",A.fontSize=a,A.text=c.b.toString(),A.color="#f0f0f0",A.background="#454545",A.onFocusObservable.add((function(){R=A.name,S=A.text,X(!1)})),A.onBlurObservable.add((function(){0!=parseFloat(A.text)&&""!=A.text||(A.text="0",W(A,"b")),R==A.name&&(R="")})),A.onTextChangedObservable.add((function(){R==A.name&&W(A,"b")})),Re.addControl(A,2,2);var Pe,Ie=new M;Ie.name="Hex Value",Ie.width=.82,Ie.addRowDefinition(1,!1),Ie.addColumnDefinition(.1,!1),Ie.addColumnDefinition(.9,!1),Se.addControl(Ie,2,0),(Pe=new y).text="#",Pe.color="#c0c0c0",Pe.fontSize=a,Ie.addControl(Pe,0,0),(x=new C).width=.96,x.height=.72,x.name="hexField",x.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,x.fontSize=a;var Le=r.lastColor.split("#");x.text=Le[1],x.color="#f0f0f0",x.background="#454545",x.onFocusObservable.add((function(){R=x.name,S=x.text,X(!1)})),x.onBlurObservable.add((function(){if(3==x.text.length){var e=x.text.split("");x.text=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]}""==x.text&&(x.text="000000",U(s.Color3.FromHexString(x.text),"b")),R==x.name&&(R="")})),x.onTextChangedObservable.add((function(){var e=x.text,t=/[^0-9A-F]/i.test(e);if((x.text.length>6||t)&&R==x.name)x.text=S;else{if(x.text.length<6)for(var r=6-x.text.length,i=0;i<r;i++)e="0"+e;if(3==x.text.length){var n=x.text.split("");e=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]}e="#"+e,R==x.name&&(S=x.text,U(s.Color3.FromHexString(e),x.name))}})),Ie.addControl(x,0,1),r.savedColors&&r.savedColors.length>0&&Y("",we)}))},t._Epsilon=1e-6,t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.ColorPicker"]=x;var w=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._thickness=1,r}return n(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Ellipse"},t.prototype._localDraw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),this._background&&(e.fillStyle=this._background,e.fill()),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),this._thickness&&(this.color&&(e.strokeStyle=this.color),e.lineWidth=this._thickness,e.stroke()),e.restore()},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._measureForChildren.width-=2*this._thickness,this._measureForChildren.height-=2*this._thickness,this._measureForChildren.left+=this._thickness,this._measureForChildren.top+=this._thickness},t.prototype._clipForChildren=function(e){_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2,this._currentMeasure.height/2,e),e.clip()},t}(g);s._TypeStore.RegisteredTypes["BABYLON.GUI.Ellipse"]=w;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._beforeRenderText=function(e){for(var t=new A,r="",i=0;i<e.length;i++)r+="•";return t.text=r,t},t}(C);s._TypeStore.RegisteredTypes["BABYLON.GUI.InputPassword"]=S;var R=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._lineWidth=1,r._x1=new a(0),r._y1=new a(0),r._x2=new a(0),r._y2=new a(0),r._dash=new Array,r._automaticSize=!0,r.isHitTestVisible=!1,r._horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r}return n(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectedControl",{get:function(){return this._connectedControl},set:function(e){var t=this;this._connectedControl!==e&&(this._connectedControlDirtyObserver&&this._connectedControl&&(this._connectedControl.onDirtyObservable.remove(this._connectedControlDirtyObserver),this._connectedControlDirtyObserver=null),e&&(this._connectedControlDirtyObserver=e.onDirtyObservable.add((function(){return t._markAsDirty()}))),this._connectedControl=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x1",{get:function(){return this._x1.toString(this._host)},set:function(e){this._x1.toString(this._host)!==e&&this._x1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this._y1.toString(this._host)},set:function(e){this._y1.toString(this._host)!==e&&this._y1.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._x2.toString(this._host)},set:function(e){this._x2.toString(this._host)!==e&&this._x2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._y2.toString(this._host)},set:function(e){this._y2.toString(this._host)!==e&&this._y2.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveX2",{get:function(){return(this._connectedControl?this._connectedControl.centerX:0)+this._x2.getValue(this._host)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_effectiveY2",{get:function(){return(this._connectedControl?this._connectedControl.centerY:0)+this._y2.getValue(this._host)},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Line"},t.prototype._draw=function(e){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath(),e.moveTo(this._cachedParentMeasure.left+this._x1.getValue(this._host),this._cachedParentMeasure.top+this._y1.getValue(this._host)),e.lineTo(this._cachedParentMeasure.left+this._effectiveX2,this._cachedParentMeasure.top+this._effectiveY2),e.stroke(),e.restore()},t.prototype._measure=function(){this._currentMeasure.width=Math.abs(this._x1.getValue(this._host)-this._effectiveX2)+this._lineWidth,this._currentMeasure.height=Math.abs(this._y1.getValue(this._host)-this._effectiveY2)+this._lineWidth},t.prototype._computeAlignment=function(e,t){this._currentMeasure.left=e.left+Math.min(this._x1.getValue(this._host),this._effectiveX2)-this._lineWidth/2,this._currentMeasure.top=e.top+Math.min(this._y1.getValue(this._host),this._effectiveY2)-this._lineWidth/2},t.prototype.moveToVector3=function(e,t,r){if(void 0===r&&(r=!1),this._host&&this.parent===this._host._rootContainer){var i=this._host._getGlobalViewport(t),n=s.Vector3.Project(e,s.Matrix.Identity(),t.getTransformMatrix(),i);this._moveToProjectedPosition(n,r),n.z<0||n.z>1?this.notRenderable=!0:this.notRenderable=!1}else s.Tools.Error("Cannot move a control to a vector3 if the control is not at root level")},t.prototype._moveToProjectedPosition=function(e,t){void 0===t&&(t=!1);var r=e.x+this._linkOffsetX.getValue(this._host)+"px",i=e.y+this._linkOffsetY.getValue(this._host)+"px";t?(this.x2=r,this.y2=i,this._x2.ignoreAdaptiveScaling=!0,this._y2.ignoreAdaptiveScaling=!0):(this.x1=r,this.y1=i,this._x1.ignoreAdaptiveScaling=!0,this._y1.ignoreAdaptiveScaling=!0)},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.Line"]=R;var P=function(){function e(e){this._multiLine=e,this._x=new a(0),this._y=new a(0),this._point=new s.Vector3(0,0,0)}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x.toString(this._multiLine._host)},set:function(e){this._x.toString(this._multiLine._host)!==e&&this._x.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y.toString(this._multiLine._host)},set:function(e){this._y.toString(this._multiLine._host)!==e&&this._y.fromString(e)&&this._multiLine._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},set:function(e){this._control!==e&&(this._control&&this._controlObserver&&(this._control.onDirtyObservable.remove(this._controlObserver),this._controlObserver=null),this._control=e,this._control&&(this._controlObserver=this._control.onDirtyObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._mesh},set:function(e){this._mesh!==e&&(this._mesh&&this._meshObserver&&this._mesh.getScene().onAfterCameraRenderObservable.remove(this._meshObserver),this._mesh=e,this._mesh&&(this._meshObserver=this._mesh.getScene().onAfterCameraRenderObservable.add(this._multiLine.onPointUpdate)),this._multiLine._markAsDirty())},enumerable:!1,configurable:!0}),e.prototype.resetLinks=function(){this.control=null,this.mesh=null},e.prototype.translate=function(){return this._point=this._translatePoint(),this._point},e.prototype._translatePoint=function(){if(null!=this._mesh)return this._multiLine._host.getProjectedPositionWithZ(this._mesh.getBoundingInfo().boundingSphere.center,this._mesh.getWorldMatrix());if(null!=this._control)return new s.Vector3(this._control.centerX,this._control.centerY,1-s.Epsilon);var e=this._multiLine._host,t=this._x.getValueInPixel(e,Number(e._canvas.width)),r=this._y.getValueInPixel(e,Number(e._canvas.height));return new s.Vector3(t,r,1-s.Epsilon)},e.prototype.dispose=function(){this.resetLinks()},e}(),I=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._lineWidth=1,r.onPointUpdate=function(){r._markAsDirty()},r._automaticSize=!0,r.isHitTestVisible=!1,r._horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,r._verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,r._dash=[],r._points=[],r}return n(t,e),Object.defineProperty(t.prototype,"dash",{get:function(){return this._dash},set:function(e){this._dash!==e&&(this._dash=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype.getAt=function(e){return this._points[e]||(this._points[e]=new P(this)),this._points[e]},t.prototype.add=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.map((function(t){return e.push(t)}))},t.prototype.push=function(e){var t=this.getAt(this._points.length);return null==e||(e instanceof s.AbstractMesh?t.mesh=e:e instanceof _?t.control=e:null!=e.x&&null!=e.y&&(t.x=e.x,t.y=e.y)),t},t.prototype.remove=function(e){var t;if(e instanceof P){if(-1===(t=this._points.indexOf(e)))return}else t=e;var r=this._points[t];r&&(r.dispose(),this._points.splice(t,1))},t.prototype.reset=function(){for(;this._points.length>0;)this.remove(this._points.length-1)},t.prototype.resetLinks=function(){this._points.forEach((function(e){null!=e&&e.resetLinks()}))},Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth!==e&&(this._lineWidth=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{set:function(e){},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"MultiLine"},t.prototype._draw=function(e,t){e.save(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._applyStates(e),e.strokeStyle=this.color,e.lineWidth=this._lineWidth,e.setLineDash(this._dash),e.beginPath();var r,i=!0;this._points.forEach((function(t){t&&(i?(e.moveTo(t._point.x,t._point.y),i=!1):t._point.z<1&&r.z<1?e.lineTo(t._point.x,t._point.y):e.moveTo(t._point.x,t._point.y),r=t._point)})),e.stroke(),e.restore()},t.prototype._additionalProcessing=function(e,t){var r=this;this._minX=null,this._minY=null,this._maxX=null,this._maxY=null,this._points.forEach((function(e,t){e&&(e.translate(),(null==r._minX||e._point.x<r._minX)&&(r._minX=e._point.x),(null==r._minY||e._point.y<r._minY)&&(r._minY=e._point.y),(null==r._maxX||e._point.x>r._maxX)&&(r._maxX=e._point.x),(null==r._maxY||e._point.y>r._maxY)&&(r._maxY=e._point.y))})),null==this._minX&&(this._minX=0),null==this._minY&&(this._minY=0),null==this._maxX&&(this._maxX=0),null==this._maxY&&(this._maxY=0)},t.prototype._measure=function(){null!=this._minX&&null!=this._maxX&&null!=this._minY&&null!=this._maxY&&(this._currentMeasure.width=Math.abs(this._maxX-this._minX)+this._lineWidth,this._currentMeasure.height=Math.abs(this._maxY-this._minY)+this._lineWidth)},t.prototype._computeAlignment=function(e,t){null!=this._minX&&null!=this._minY&&(this._currentMeasure.left=this._minX-this._lineWidth/2,this._currentMeasure.top=this._minY-this._lineWidth/2)},t.prototype.dispose=function(){this.reset(),e.prototype.dispose.call(this)},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.MultiLine"]=I;var L=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._isChecked=!1,r._background="black",r._checkSizeRatio=.8,r._thickness=1,r.group="",r.onIsCheckedChangedObservable=new s.Observable,r.isPointerBlocker=!0,r}return n(t,e),Object.defineProperty(t.prototype,"thickness",{get:function(){return this._thickness},set:function(e){this._thickness!==e&&(this._thickness=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSizeRatio",{get:function(){return this._checkSizeRatio},set:function(e){e=Math.max(Math.min(1,e),0),this._checkSizeRatio!==e&&(this._checkSizeRatio=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){var t=this;this._isChecked!==e&&(this._isChecked=e,this._markAsDirty(),this.onIsCheckedChangedObservable.notifyObservers(e),this._isChecked&&this._host&&this._host.executeOnAllControls((function(e){if(e!==t&&void 0!==e.group){var r=e;r.group===t.group&&(r.isChecked=!1)}})))},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"RadioButton"},t.prototype._draw=function(e){e.save(),this._applyStates(e);var t=this._currentMeasure.width-this._thickness,r=this._currentMeasure.height-this._thickness;if((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,this._currentMeasure.width/2-this._thickness/2,this._currentMeasure.height/2-this._thickness/2,e),e.fillStyle=this._isEnabled?this._background:this._disabledColor,e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this.color,e.lineWidth=this._thickness,e.stroke(),this._isChecked){e.fillStyle=this._isEnabled?this.color:this._disabledColor;var i=t*this._checkSizeRatio,n=r*this._checkSizeRatio;_.drawEllipse(this._currentMeasure.left+this._currentMeasure.width/2,this._currentMeasure.top+this._currentMeasure.height/2,i/2-this._thickness/2,n/2-this._thickness/2,e),e.fill()}e.restore()},t.prototype._onPointerDown=function(t,r,i,n,o){return!!e.prototype._onPointerDown.call(this,t,r,i,n,o)&&(this.isChecked||(this.isChecked=!0),!0)},t.AddRadioButtonWithHeader=function(e,r,i,n){var o=new O;o.isVertical=!1,o.height="30px";var s=new t;s.width="20px",s.height="20px",s.isChecked=i,s.color="green",s.group=r,s.onIsCheckedChangedObservable.add((function(e){return n(s,e)})),o.addControl(s);var a=new y;return a.text=e,a.width="180px",a.paddingLeft="5px",a.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,a.color="white",o.addControl(a),o},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.RadioButton"]=L;var N=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._thumbWidth=new a(20,a.UNITMODE_PIXEL,!1),r._minimum=0,r._maximum=100,r._value=50,r._isVertical=!1,r._barOffset=new a(5,a.UNITMODE_PIXEL,!1),r._isThumbClamped=!1,r._displayThumb=!0,r._step=0,r._lastPointerDownID=-1,r._effectiveBarOffset=0,r.onValueChangedObservable=new s.Observable,r._pointerIsDown=!1,r.isPointerBlocker=!0,r}return n(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this._step},set:function(e){this._step!==e&&(this._step=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffset",{get:function(){return this._barOffset.toString(this._host)},set:function(e){this._barOffset.toString(this._host)!==e&&this._barOffset.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barOffsetInPixels",{get:function(){return this._barOffset.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidth",{get:function(){return this._thumbWidth.toString(this._host)},set:function(e){this._thumbWidth.toString(this._host)!==e&&this._thumbWidth.fromString(e)&&this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbWidthInPixels",{get:function(){return this._thumbWidth.getValueInPixel(this._host,this._cachedParentMeasure.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minimum",{get:function(){return this._minimum},set:function(e){this._minimum!==e&&(this._minimum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this._maximum},set:function(e){this._maximum!==e&&(this._maximum=e,this._markAsDirty(),this.value=Math.max(Math.min(this.value,this._maximum),this._minimum))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){e=Math.max(Math.min(e,this._maximum),this._minimum),this._value!==e&&(this._value=e,this._markAsDirty(),this.onValueChangedObservable.notifyObservers(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){this._isVertical!==e&&(this._isVertical=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbClamped",{get:function(){return this._isThumbClamped},set:function(e){this._isThumbClamped!==e&&(this._isThumbClamped=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"BaseSlider"},t.prototype._getThumbPosition=function(){return this.isVertical?(this.maximum-this.value)/(this.maximum-this.minimum)*this._backgroundBoxLength:(this.value-this.minimum)/(this.maximum-this.minimum)*this._backgroundBoxLength},t.prototype._getThumbThickness=function(e){var t=0;switch(e){case"circle":t=this._thumbWidth.isPixel?Math.max(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host);break;case"rectangle":t=this._thumbWidth.isPixel?Math.min(this._thumbWidth.getValue(this._host),this._backgroundBoxThickness):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)}return t},t.prototype._prepareRenderingData=function(e){this._effectiveBarOffset=0,this._renderLeft=this._currentMeasure.left,this._renderTop=this._currentMeasure.top,this._renderWidth=this._currentMeasure.width,this._renderHeight=this._currentMeasure.height,this._backgroundBoxLength=Math.max(this._currentMeasure.width,this._currentMeasure.height),this._backgroundBoxThickness=Math.min(this._currentMeasure.width,this._currentMeasure.height),this._effectiveThumbThickness=this._getThumbThickness(e),this.displayThumb&&(this._backgroundBoxLength-=this._effectiveThumbThickness),this.isVertical&&this._currentMeasure.height<this._currentMeasure.width?console.error("Height should be greater than width"):(this._barOffset.isPixel?this._effectiveBarOffset=Math.min(this._barOffset.getValue(this._host),this._backgroundBoxThickness):this._effectiveBarOffset=this._backgroundBoxThickness*this._barOffset.getValue(this._host),this._backgroundBoxThickness-=2*this._effectiveBarOffset,this.isVertical?(this._renderLeft+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderTop+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxLength,this._renderWidth=this._backgroundBoxThickness):(this._renderTop+=this._effectiveBarOffset,!this.isThumbClamped&&this.displayThumb&&(this._renderLeft+=this._effectiveThumbThickness/2),this._renderHeight=this._backgroundBoxThickness,this._renderWidth=this._backgroundBoxLength))},t.prototype._updateValueFromPointer=function(e,t){var r;0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),r=this._isVertical?this._minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this._maximum-this._minimum):this._minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this._maximum-this._minimum);var i=1/this._step|0;this.value=this._step?(r*i|0)/i:r},t.prototype._onPointerDown=function(t,r,i,n,o){return!!e.prototype._onPointerDown.call(this,t,r,i,n,o)&&(this._pointerIsDown=!0,this._updateValueFromPointer(r.x,r.y),this._host._capturingControl[i]=this,this._lastPointerDownID=i,!0)},t.prototype._onPointerMove=function(t,r,i,n){i==this._lastPointerDownID&&(this._pointerIsDown&&this._updateValueFromPointer(r.x,r.y),e.prototype._onPointerMove.call(this,t,r,i,n))},t.prototype._onPointerUp=function(t,r,i,n,o){this._pointerIsDown=!1,delete this._host._capturingControl[i],e.prototype._onPointerUp.call(this,t,r,i,n,o)},t.prototype._onCanvasBlur=function(){this._forcePointerUp(),e.prototype._onCanvasBlur.call(this)},t}(_),k=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._background="black",r._borderColor="white",r._thumbColor="",r._isThumbCircle=!1,r._displayValueBar=!0,r}return n(t,e),Object.defineProperty(t.prototype,"displayValueBar",{get:function(){return this._displayValueBar},set:function(e){this._displayValueBar!==e&&(this._displayValueBar=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbColor",{get:function(){return this._thumbColor},set:function(e){this._thumbColor!==e&&(this._thumbColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThumbCircle",{get:function(){return this._isThumbCircle},set:function(e){this._isThumbCircle!==e&&(this._isThumbCircle=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Slider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData(this.isThumbCircle?"circle":"rectangle");var r=this._renderLeft,i=this._renderTop,n=this._renderWidth,o=this._renderHeight,s=0;this.isThumbClamped&&this.isThumbCircle?(this.isVertical?i+=this._effectiveThumbThickness/2:r+=this._effectiveThumbThickness/2,s=this._backgroundBoxThickness/2):s=(this._effectiveThumbThickness-this._effectiveBarOffset)/2,(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY);var a=this._getThumbPosition();e.fillStyle=this._background,this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(r+this._backgroundBoxThickness/2,i,s,Math.PI,2*Math.PI),e.fill(),e.fillRect(r,i,n,o)):e.fillRect(r,i,n,o+this._effectiveThumbThickness):e.fillRect(r,i,n,o):this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(r+this._backgroundBoxLength,i+this._backgroundBoxThickness/2,s,0,2*Math.PI),e.fill(),e.fillRect(r,i,n,o)):e.fillRect(r,i,n+this._effectiveThumbThickness,o):e.fillRect(r,i,n,o),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillStyle=this.color,this._displayValueBar&&(this.isVertical?this.isThumbClamped?this.isThumbCircle?(e.beginPath(),e.arc(r+this._backgroundBoxThickness/2,i+this._backgroundBoxLength,s,0,2*Math.PI),e.fill(),e.fillRect(r,i+a,n,o-a)):e.fillRect(r,i+a,n,o-a+this._effectiveThumbThickness):e.fillRect(r,i+a,n,o-a):this.isThumbClamped&&this.isThumbCircle?(e.beginPath(),e.arc(r,i+this._backgroundBoxThickness/2,s,0,2*Math.PI),e.fill(),e.fillRect(r,i,a,o)):e.fillRect(r,i,a,o)),e.fillStyle=this._thumbColor||this.color,this.displayThumb&&((this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffsetX,e.shadowOffsetY=this.shadowOffsetY),this._isThumbCircle?(e.beginPath(),this.isVertical?e.arc(r+this._backgroundBoxThickness/2,i+a,s,0,2*Math.PI):e.arc(r+a,i+this._backgroundBoxThickness/2,s,0,2*Math.PI),e.fill(),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,e.stroke()):(this.isVertical?e.fillRect(r-this._effectiveBarOffset,this._currentMeasure.top+a,this._currentMeasure.width,this._effectiveThumbThickness):e.fillRect(this._currentMeasure.left+a,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),(this.shadowBlur||this.shadowOffsetX||this.shadowOffsetY)&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.strokeStyle=this._borderColor,this.isVertical?e.strokeRect(r-this._effectiveBarOffset,this._currentMeasure.top+a,this._currentMeasure.width,this._effectiveThumbThickness):e.strokeRect(this._currentMeasure.left+a,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height))),e.restore()},t}(N);s._TypeStore.RegisteredTypes["BABYLON.GUI.Slider"]=k;var D=function(){function e(e){this.name=e,this._groupPanel=new O,this._selectors=new Array,this._groupPanel.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,this._groupPanel.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,this._groupHeader=this._addGroupHeader(e)}return Object.defineProperty(e.prototype,"groupPanel",{get:function(){return this._groupPanel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectors",{get:function(){return this._selectors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"header",{get:function(){return this._groupHeader.text},set:function(e){"label"!==this._groupHeader.text&&(this._groupHeader.text=e)},enumerable:!1,configurable:!0}),e.prototype._addGroupHeader=function(e){var t=new y("groupHead",e);return t.width=.9,t.height="30px",t.textWrapping=!0,t.color="black",t.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,t.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,t.left="2px",this._groupPanel.addControl(t),t},e.prototype._getSelector=function(e){if(!(e<0||e>=this._selectors.length))return this._selectors[e]},e.prototype.removeSelector=function(e){e<0||e>=this._selectors.length||(this._groupPanel.removeControl(this._selectors[e]),this._selectors.splice(e,1))},e}(),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.addCheckbox=function(e,t,r){void 0===t&&(t=function(e){}),void 0===r&&(r=!1),r=r||!1;var i=new E;i.width="20px",i.height="20px",i.color="#364249",i.background="#CCCCCC",i.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i.onIsCheckedChangedObservable.add((function(e){t(e)}));var n=_.AddHeader(i,e,"200px",{isHorizontal:!0,controlFirst:!0});n.height="30px",n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.left="4px",this.groupPanel.addControl(n),this.selectors.push(n),i.isChecked=r,this.groupPanel.parent&&this.groupPanel.parent.parent&&(i.color=this.groupPanel.parent.parent.buttonColor,i.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(D),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectNb=0,t}return n(t,e),t.prototype.addRadio=function(e,t,r){void 0===t&&(t=function(e){}),void 0===r&&(r=!1);var i=this._selectNb++,n=new L;n.name=e,n.width="20px",n.height="20px",n.color="#364249",n.background="#CCCCCC",n.group=this.name,n.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,n.onIsCheckedChangedObservable.add((function(e){e&&t(i)}));var o=_.AddHeader(n,e,"200px",{isHorizontal:!0,controlFirst:!0});o.height="30px",o.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o.left="4px",this.groupPanel.addControl(o),this.selectors.push(o),n.isChecked=r,this.groupPanel.parent&&this.groupPanel.parent.parent&&(n.color=this.groupPanel.parent.parent.buttonColor,n.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[1].text=t},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[0].background=t},t}(D),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.addSlider=function(e,t,r,i,n,o,s){void 0===t&&(t=function(e){}),void 0===r&&(r="Units"),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=function(e){return 0|e});var a=new k;a.name=r,a.value=o,a.minimum=i,a.maximum=n,a.width=.9,a.height="20px",a.color="#364249",a.background="#CCCCCC",a.borderColor="black",a.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,a.left="4px",a.paddingBottom="4px",a.onValueChangedObservable.add((function(e){a.parent.children[0].text=a.parent.children[0].name+": "+s(e)+" "+a.name,t(e)}));var l=_.AddHeader(a,e+": "+s(o)+" "+r,"30px",{isHorizontal:!1,controlFirst:!1});l.height="60px",l.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,l.left="4px",l.children[0].name=e,this.groupPanel.addControl(l),this.selectors.push(l),this.groupPanel.parent&&this.groupPanel.parent.parent&&(a.color=this.groupPanel.parent.parent.buttonColor,a.background=this.groupPanel.parent.parent.buttonBackground)},t.prototype._setSelectorLabel=function(e,t){this.selectors[e].children[0].name=t,this.selectors[e].children[0].text=t+": "+this.selectors[e].children[1].value+" "+this.selectors[e].children[1].name},t.prototype._setSelectorLabelColor=function(e,t){this.selectors[e].children[0].color=t},t.prototype._setSelectorButtonColor=function(e,t){this.selectors[e].children[1].color=t},t.prototype._setSelectorButtonBackground=function(e,t){this.selectors[e].children[1].background=t},t}(D),H=function(e){function t(t,r){void 0===r&&(r=[]);var i=e.call(this,t)||this;if(i.name=t,i.groups=r,i._buttonColor="#364249",i._buttonBackground="#CCCCCC",i._headerColor="black",i._barColor="white",i._barHeight="2px",i._spacerHeight="20px",i._bars=new Array,i._groups=r,i.thickness=2,i._panel=new O,i._panel.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i._panel.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._panel.top=5,i._panel.left=5,i._panel.width=.95,r.length>0){for(var n=0;n<r.length-1;n++)i._panel.addControl(r[n].groupPanel),i._addSpacer();i._panel.addControl(r[r.length-1].groupPanel)}return i.addControl(i._panel),i}return n(t,e),t.prototype._getTypeName=function(){return"SelectionPanel"},Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerColor",{get:function(){return this._headerColor},set:function(e){this._headerColor!==e&&(this._headerColor=e,this._setHeaderColor())},enumerable:!1,configurable:!0}),t.prototype._setHeaderColor=function(){for(var e=0;e<this._groups.length;e++)this._groups[e].groupPanel.children[0].color=this._headerColor},Object.defineProperty(t.prototype,"buttonColor",{get:function(){return this._buttonColor},set:function(e){this._buttonColor!==e&&(this._buttonColor=e,this._setbuttonColor())},enumerable:!1,configurable:!0}),t.prototype._setbuttonColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonColor(t,this._buttonColor)},Object.defineProperty(t.prototype,"labelColor",{get:function(){return this._labelColor},set:function(e){this._labelColor!==e&&(this._labelColor=e,this._setLabelColor())},enumerable:!1,configurable:!0}),t.prototype._setLabelColor=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorLabelColor(t,this._labelColor)},Object.defineProperty(t.prototype,"buttonBackground",{get:function(){return this._buttonBackground},set:function(e){this._buttonBackground!==e&&(this._buttonBackground=e,this._setButtonBackground())},enumerable:!1,configurable:!0}),t.prototype._setButtonBackground=function(){for(var e=0;e<this._groups.length;e++)for(var t=0;t<this._groups[e].selectors.length;t++)this._groups[e]._setSelectorButtonBackground(t,this._buttonBackground)},Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._setBarColor())},enumerable:!1,configurable:!0}),t.prototype._setBarColor=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].background=this._barColor},Object.defineProperty(t.prototype,"barHeight",{get:function(){return this._barHeight},set:function(e){this._barHeight!==e&&(this._barHeight=e,this._setBarHeight())},enumerable:!1,configurable:!0}),t.prototype._setBarHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].children[0].height=this._barHeight},Object.defineProperty(t.prototype,"spacerHeight",{get:function(){return this._spacerHeight},set:function(e){this._spacerHeight!==e&&(this._spacerHeight=e,this._setSpacerHeight())},enumerable:!1,configurable:!0}),t.prototype._setSpacerHeight=function(){for(var e=0;e<this._bars.length;e++)this._bars[e].height=this._spacerHeight},t.prototype._addSpacer=function(){var e=new g;e.width=1,e.height=this._spacerHeight,e.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT;var t=new b;t.width=1,t.height=this._barHeight,t.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,t.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,t.background=this._barColor,t.color="transparent",e.addControl(t),this._panel.addControl(e),this._bars.push(e)},t.prototype.addGroup=function(e){this._groups.length>0&&this._addSpacer(),this._panel.addControl(e.groupPanel),this._groups.push(e),e.groupPanel.children[0].color=this._headerColor;for(var t=0;t<e.selectors.length;t++)e._setSelectorButtonColor(t,this._buttonColor),e._setSelectorButtonBackground(t,this._buttonBackground)},t.prototype.removeGroup=function(e){if(!(e<0||e>=this._groups.length)){var t=this._groups[e];this._panel.removeControl(t.groupPanel),this._groups.splice(e,1),e<this._bars.length&&(this._panel.removeControl(this._bars[e]),this._bars.splice(e,1))}},t.prototype.setHeaderName=function(e,t){t<0||t>=this._groups.length||(this._groups[t].groupPanel.children[0].text=e)},t.prototype.relabel=function(e,t,r){if(!(t<0||t>=this._groups.length)){var i=this._groups[t];r<0||r>=i.selectors.length||i._setSelectorLabel(r,e)}},t.prototype.removeFromGroupSelector=function(e,t){if(!(e<0||e>=this._groups.length)){var r=this._groups[e];t<0||t>=r.selectors.length||r.removeSelector(t)}},t.prototype.addToGroupCheckbox=function(e,t,r,i){void 0===r&&(r=function(){}),void 0===i&&(i=!1),e<0||e>=this._groups.length||this._groups[e].addCheckbox(t,r,i)},t.prototype.addToGroupRadio=function(e,t,r,i){void 0===r&&(r=function(){}),void 0===i&&(i=!1),e<0||e>=this._groups.length||this._groups[e].addRadio(t,r,i)},t.prototype.addToGroupSlider=function(e,t,r,i,n,o,s,a){void 0===r&&(r=function(){}),void 0===i&&(i="Units"),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=function(e){return 0|e}),e<0||e>=this._groups.length||this._groups[e].addSlider(t,r,i,n,o,s,a)},t}(b),j=function(e){function t(t){var r=e.call(this,t)||this;return r._freezeControls=!1,r._bucketWidth=0,r._bucketHeight=0,r._buckets={},r}return n(t,e),Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._freezeControls},set:function(e){if(this._freezeControls!==e){e||this._restoreMeasures(),this._freezeControls=!1;var t=this.host.getSize(),r=t.width,i=t.height,n=this.host.getContext(),o=new d(0,0,r,i);this.host._numLayoutCalls=0,this.host._rootContainer._layout(o,n),e&&(this._updateMeasures(),this._useBuckets()&&this._makeBuckets()),this._freezeControls=e,this.host.markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._bucketWidth=e,this._bucketHeight=t,this._useBuckets()?this._freezeControls&&this._makeBuckets():this._buckets={}},t.prototype._useBuckets=function(){return this._bucketWidth>0&&this._bucketHeight>0},t.prototype._makeBuckets=function(){this._buckets={},this._bucketLen=Math.ceil(this.widthInPixels/this._bucketWidth),this._dispatchInBuckets(this._children),this._oldLeft=null,this._oldTop=null},t.prototype._dispatchInBuckets=function(e){for(var t=0;t<e.length;++t){for(var r=e[t],i=Math.max(0,Math.floor((r._customData._origLeft-this._customData.origLeft)/this._bucketWidth)),n=Math.floor((r._customData._origLeft-this._customData.origLeft+r._currentMeasure.width-1)/this._bucketWidth),o=Math.max(0,Math.floor((r._customData._origTop-this._customData.origTop)/this._bucketHeight)),s=Math.floor((r._customData._origTop-this._customData.origTop+r._currentMeasure.height-1)/this._bucketHeight);o<=s;){for(var a=i;a<=n;++a){var l=o*this._bucketLen+a,h=this._buckets[l];h||(h=[],this._buckets[l]=h),h.push(r)}o++}r instanceof g&&r._children.length>0&&this._dispatchInBuckets(r._children)}},t.prototype._updateMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left-=e,this._measureForChildren.top-=t,this._currentMeasure.left-=e,this._currentMeasure.top-=t,this._customData.origLeftForChildren=this._measureForChildren.left,this._customData.origTopForChildren=this._measureForChildren.top,this._customData.origLeft=this._currentMeasure.left,this._customData.origTop=this._currentMeasure.top,this._updateChildrenMeasures(this._children,e,t)},t.prototype._updateChildrenMeasures=function(e,t,r){for(var i=0;i<e.length;++i){var n=e[i];n._currentMeasure.left-=t,n._currentMeasure.top-=r,n._customData._origLeft=n._currentMeasure.left,n._customData._origTop=n._currentMeasure.top,n instanceof g&&n._children.length>0&&this._updateChildrenMeasures(n._children,t,r)}},t.prototype._restoreMeasures=function(){var e=0|this.leftInPixels,t=0|this.topInPixels;this._measureForChildren.left=this._customData.origLeftForChildren+e,this._measureForChildren.top=this._customData.origTopForChildren+t,this._currentMeasure.left=this._customData.origLeft+e,this._currentMeasure.top=this._customData.origTop+t},t.prototype._getTypeName=function(){return"ScrollViewerWindow"},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._parentMeasure=t,this._measureForChildren.left=this._currentMeasure.left,this._measureForChildren.top=this._currentMeasure.top,this._measureForChildren.width=t.width,this._measureForChildren.height=t.height},t.prototype._layout=function(t,r){return this._freezeControls?(this.invalidateRect(),!1):e.prototype._layout.call(this,t,r)},t.prototype._scrollChildren=function(e,t,r){for(var i=0;i<e.length;++i){var n=e[i];n._currentMeasure.left=n._customData._origLeft+t,n._currentMeasure.top=n._customData._origTop+r,n._isClipped=!1,n instanceof g&&n._children.length>0&&this._scrollChildren(n._children,t,r)}},t.prototype._scrollChildrenWithBuckets=function(e,t,r,i){for(var n=Math.max(0,Math.floor(-e/this._bucketWidth)),o=Math.floor((-e+this._parentMeasure.width-1)/this._bucketWidth),s=Math.max(0,Math.floor(-t/this._bucketHeight)),a=Math.floor((-t+this._parentMeasure.height-1)/this._bucketHeight);s<=a;){for(var l=n;l<=o;++l){var h=s*this._bucketLen+l,u=this._buckets[h];if(u)for(var c=0;c<u.length;++c){var d=u[c];d._currentMeasure.left=d._customData._origLeft+r,d._currentMeasure.top=d._customData._origTop+i,d._isClipped=!1}}s++}},t.prototype._draw=function(t,r){if(this._freezeControls){this._localDraw(t),this.clipChildren&&this._clipForChildren(t);var i=0|this.leftInPixels,n=0|this.topInPixels;this._useBuckets()&&null!==this._oldLeft&&null!==this._oldTop?(this._scrollChildrenWithBuckets(this._oldLeft,this._oldTop,i,n),this._scrollChildrenWithBuckets(i,n,i,n)):this._scrollChildren(this._children,i,n),this._oldLeft=i,this._oldTop=n;for(var o=0,s=this._children;o<s.length;o++){var a=s[o];a._intersectsRect(this._parentMeasure)&&a._render(t,this._parentMeasure)}}else e.prototype._draw.call(this,t,r)},t.prototype._postMeasure=function(){if(this._freezeControls)e.prototype._postMeasure.call(this);else{for(var t=this.parentClientWidth,r=this.parentClientHeight,i=0,n=this.children;i<n.length;i++){var o=n[i];o.isVisible&&!o.notRenderable&&(o.horizontalAlignment===_.HORIZONTAL_ALIGNMENT_CENTER&&o._offsetLeft(this._currentMeasure.left-o._currentMeasure.left),o.verticalAlignment===_.VERTICAL_ALIGNMENT_CENTER&&o._offsetTop(this._currentMeasure.top-o._currentMeasure.top),t=Math.max(t,o._currentMeasure.left-this._currentMeasure.left+o._currentMeasure.width+o.paddingRightInPixels),r=Math.max(r,o._currentMeasure.top-this._currentMeasure.top+o._currentMeasure.height+o.paddingBottomInPixels))}this._currentMeasure.width!==t&&(this._width.updateInPlace(t,a.UNITMODE_PIXEL),this._currentMeasure.width=t,this._rebuildLayout=!0,this._isDirty=!0),this._currentMeasure.height!==r&&(this._height.updateInPlace(r,a.UNITMODE_PIXEL),this._currentMeasure.height=r,this._rebuildLayout=!0,this._isDirty=!0),e.prototype._postMeasure.call(this)}},t}(g),U=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._background="black",r._borderColor="white",r._tempMeasure=new d(0,0,0,0),r}return n(t,e),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor!==e&&(this._borderColor=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"Scrollbar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._renderLeft,r=this._getThumbPosition();e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height),e.fillStyle=this.color,this.isVertical?(this._tempMeasure.left=t-this._effectiveBarOffset,this._tempMeasure.top=this._currentMeasure.top+r,this._tempMeasure.width=this._currentMeasure.width,this._tempMeasure.height=this._effectiveThumbThickness):(this._tempMeasure.left=this._currentMeasure.left+r,this._tempMeasure.top=this._currentMeasure.top,this._tempMeasure.width=this._effectiveThumbThickness,this._tempMeasure.height=this._currentMeasure.height),e.fillRect(this._tempMeasure.left,this._tempMeasure.top,this._tempMeasure.width,this._tempMeasure.height),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var r=0;r=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=r*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,r,i,n,o){return this._first=!0,e.prototype._onPointerDown.call(this,t,r,i,n,o)},t}(N),G=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._thumbLength=.5,r._thumbHeight=1,r._barImageHeight=1,r._tempMeasure=new d(0,0,0,0),r.num90RotationInVerticalMode=1,r}return n(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundBaseImage},set:function(e){var t=this;this._backgroundBaseImage!==e&&(this._backgroundBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._backgroundImage=e._rotate90(this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce((function(){var r=e._rotate90(t.num90RotationInVerticalMode,!0);t._backgroundImage=r,r.isLoaded||r.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),t._markAsDirty()})):(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbBaseImage},set:function(e){var t=this;this._thumbBaseImage!==e&&(this._thumbBaseImage=e,this.isVertical&&0!==this.num90RotationInVerticalMode?e.isLoaded?(this._thumbImage=e._rotate90(-this.num90RotationInVerticalMode,!0),this._markAsDirty()):e.onImageLoadedObservable.addOnce((function(){var r=e._rotate90(-t.num90RotationInVerticalMode,!0);t._thumbImage=r,r.isLoaded||r.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),t._markAsDirty()})):(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){t._markAsDirty()})),this._markAsDirty()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){this._thumbLength!==e&&(this._thumbLength=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){this._thumbLength!==e&&(this._thumbHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){this._barImageHeight!==e&&(this._barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageScrollBar"},t.prototype._getThumbThickness=function(){return this._thumbWidth.isPixel?this._thumbWidth.getValue(this._host):this._backgroundBoxThickness*this._thumbWidth.getValue(this._host)},t.prototype._draw=function(e){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var t=this._getThumbPosition(),r=this._renderLeft,i=this._renderTop,n=this._renderWidth,o=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(r,i,n,o),this.isVertical?(this._tempMeasure.copyFromFloats(r+n*(1-this._barImageHeight)*.5,this._currentMeasure.top,n*this._barImageHeight,o),this._tempMeasure.height+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)):(this._tempMeasure.copyFromFloats(this._currentMeasure.left,i+o*(1-this._barImageHeight)*.5,n,o*this._barImageHeight),this._tempMeasure.width+=this._effectiveThumbThickness,this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure)),this._backgroundImage._draw(e)),this.isVertical?this._tempMeasure.copyFromFloats(r-this._effectiveBarOffset+this._currentMeasure.width*(1-this._thumbHeight)*.5,this._currentMeasure.top+t,this._currentMeasure.width*this._thumbHeight,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+t,this._currentMeasure.top+this._currentMeasure.height*(1-this._thumbHeight)*.5,this._effectiveThumbThickness,this._currentMeasure.height*this._thumbHeight),this._thumbImage&&(this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t.prototype._updateValueFromPointer=function(e,t){0!=this.rotation&&(this._invertTransformMatrix.transformCoordinates(e,t,this._transformedPosition),e=this._transformedPosition.x,t=this._transformedPosition.y),this._first&&(this._first=!1,this._originX=e,this._originY=t,(e<this._tempMeasure.left||e>this._tempMeasure.left+this._tempMeasure.width||t<this._tempMeasure.top||t>this._tempMeasure.top+this._tempMeasure.height)&&(this.isVertical?this.value=this.minimum+(1-(t-this._currentMeasure.top)/this._currentMeasure.height)*(this.maximum-this.minimum):this.value=this.minimum+(e-this._currentMeasure.left)/this._currentMeasure.width*(this.maximum-this.minimum)));var r=0;r=this.isVertical?-(t-this._originY)/(this._currentMeasure.height-this._effectiveThumbThickness):(e-this._originX)/(this._currentMeasure.width-this._effectiveThumbThickness),this.value+=r*(this.maximum-this.minimum),this._originX=e,this._originY=t},t.prototype._onPointerDown=function(t,r,i,n,o){return this._first=!0,e.prototype._onPointerDown.call(this,t,r,i,n,o)},t}(N),W=function(e){function t(t,r){var i=e.call(this,t)||this;return i._barSize=20,i._pointerIsOver=!1,i._wheelPrecision=.05,i._thumbLength=.5,i._thumbHeight=1,i._barImageHeight=1,i._horizontalBarImageHeight=1,i._verticalBarImageHeight=1,i._oldWindowContentsWidth=0,i._oldWindowContentsHeight=0,i._forceHorizontalBar=!1,i._forceVerticalBar=!1,i._useImageBar=r||!1,i.onDirtyObservable.add((function(){i._horizontalBarSpace.color=i.color,i._verticalBarSpace.color=i.color,i._dragSpace.color=i.color})),i.onPointerEnterObservable.add((function(){i._pointerIsOver=!0})),i.onPointerOutObservable.add((function(){i._pointerIsOver=!1})),i._grid=new M,i._useImageBar?(i._horizontalBar=new G,i._verticalBar=new G):(i._horizontalBar=new U,i._verticalBar=new U),i._window=new j("scrollViewer_window"),i._window.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._window.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i._grid.addColumnDefinition(1),i._grid.addColumnDefinition(0,!0),i._grid.addRowDefinition(1),i._grid.addRowDefinition(0,!0),e.prototype.addControl.call(i,i._grid),i._grid.addControl(i._window,0,0),i._verticalBarSpace=new b,i._verticalBarSpace.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._verticalBarSpace.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i._verticalBarSpace.thickness=1,i._grid.addControl(i._verticalBarSpace,0,1),i._addBar(i._verticalBar,i._verticalBarSpace,!0,Math.PI),i._horizontalBarSpace=new b,i._horizontalBarSpace.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,i._horizontalBarSpace.verticalAlignment=_.VERTICAL_ALIGNMENT_TOP,i._horizontalBarSpace.thickness=1,i._grid.addControl(i._horizontalBarSpace,1,0),i._addBar(i._horizontalBar,i._horizontalBarSpace,!1,0),i._dragSpace=new b,i._dragSpace.thickness=1,i._grid.addControl(i._dragSpace,1,1),i._useImageBar||(i.barColor="grey",i.barBackground="transparent"),i}return n(t,e),Object.defineProperty(t.prototype,"horizontalBar",{get:function(){return this._horizontalBar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBar",{get:function(){return this._verticalBar},enumerable:!1,configurable:!0}),t.prototype.addControl=function(e){return e?(this._window.addControl(e),this):this},t.prototype.removeControl=function(e){return this._window.removeControl(e),this},Object.defineProperty(t.prototype,"children",{get:function(){return this._window.children},enumerable:!1,configurable:!0}),t.prototype._flagDescendantsAsMatrixDirty=function(){for(var e=0,t=this._children;e<t.length;e++)t[e]._markMatrixAsDirty()},Object.defineProperty(t.prototype,"freezeControls",{get:function(){return this._window.freezeControls},set:function(e){this._window.freezeControls=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketWidth",{get:function(){return this._window.bucketWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucketHeight",{get:function(){return this._window.bucketHeight},enumerable:!1,configurable:!0}),t.prototype.setBucketSizes=function(e,t){this._window.setBucketSizes(e,t)},Object.defineProperty(t.prototype,"forceHorizontalBar",{get:function(){return this._forceHorizontalBar},set:function(e){this._grid.setRowDefinition(1,e?this._barSize:0,!0),this._horizontalBar.isVisible=e,this._forceHorizontalBar=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forceVerticalBar",{get:function(){return this._forceVerticalBar},set:function(e){this._grid.setColumnDefinition(1,e?this._barSize:0,!0),this._verticalBar.isVisible=e,this._forceVerticalBar=e},enumerable:!1,configurable:!0}),t.prototype.resetWindow=function(){this._window.width="100%",this._window.height="100%"},t.prototype._getTypeName=function(){return"ScrollViewer"},t.prototype._buildClientSizes=function(){var e=this.host.idealRatio;this._window.parentClientWidth=this._currentMeasure.width-(this._verticalBar.isVisible||this.forceVerticalBar?this._barSize*e:0)-2*this.thickness,this._window.parentClientHeight=this._currentMeasure.height-(this._horizontalBar.isVisible||this.forceHorizontalBar?this._barSize*e:0)-2*this.thickness,this._clientWidth=this._window.parentClientWidth,this._clientHeight=this._window.parentClientHeight},t.prototype._additionalProcessing=function(t,r){e.prototype._additionalProcessing.call(this,t,r),this._buildClientSizes()},t.prototype._postMeasure=function(){e.prototype._postMeasure.call(this),this._updateScroller(),this._setWindowPosition(!1)},Object.defineProperty(t.prototype,"wheelPrecision",{get:function(){return this._wheelPrecision},set:function(e){this._wheelPrecision!==e&&(e<0&&(e=0),e>1&&(e=1),this._wheelPrecision=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollBackground",{get:function(){return this._horizontalBarSpace.background},set:function(e){this._horizontalBarSpace.background!==e&&(this._horizontalBarSpace.background=e,this._verticalBarSpace.background=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barColor",{get:function(){return this._barColor},set:function(e){this._barColor!==e&&(this._barColor=e,this._horizontalBar.color=e,this._verticalBar.color=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._barImage},set:function(e){if(this._barImage!==e){this._barImage=e;var t=this._horizontalBar,r=this._verticalBar;t.thumbImage=e,r.thumbImage=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalThumbImage",{get:function(){return this._horizontalBarImage},set:function(e){this._horizontalBarImage!==e&&(this._horizontalBarImage=e,this._horizontalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalThumbImage",{get:function(){return this._verticalBarImage},set:function(e){this._verticalBarImage!==e&&(this._verticalBarImage=e,this._verticalBar.thumbImage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barSize",{get:function(){return this._barSize},set:function(e){this._barSize!==e&&(this._barSize=e,this._markAsDirty(),this._horizontalBar.isVisible&&this._grid.setRowDefinition(1,this._barSize,!0),this._verticalBar.isVisible&&this._grid.setColumnDefinition(1,this._barSize,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbLength",{get:function(){return this._thumbLength},set:function(e){if(this._thumbLength!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbLength=e;var t=this._horizontalBar,r=this._verticalBar;t.thumbLength=e,r.thumbLength=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbHeight",{get:function(){return this._thumbHeight},set:function(e){if(this._thumbHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._thumbHeight=e;var t=this._horizontalBar,r=this._verticalBar;t.thumbHeight=e,r.thumbHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImageHeight",{get:function(){return this._barImageHeight},set:function(e){if(this._barImageHeight!==e){e<=0&&(e=.1),e>1&&(e=1),this._barImageHeight=e;var t=this._horizontalBar,r=this._verticalBar;t.barImageHeight=e,r.barImageHeight=e,this._markAsDirty()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImageHeight",{get:function(){return this._horizontalBarImageHeight},set:function(e){this._horizontalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._horizontalBarImageHeight=e,this._horizontalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImageHeight",{get:function(){return this._verticalBarImageHeight},set:function(e){this._verticalBarImageHeight!==e&&(e<=0&&(e=.1),e>1&&(e=1),this._verticalBarImageHeight=e,this._verticalBar.barImageHeight=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barBackground",{get:function(){return this._barBackground},set:function(e){if(this._barBackground!==e){this._barBackground=e;var t=this._horizontalBar,r=this._verticalBar;t.background=e,r.background=e,this._dragSpace.background=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"barImage",{get:function(){return this._barBackgroundImage},set:function(e){this._barBackgroundImage,this._barBackgroundImage=e;var t=this._horizontalBar,r=this._verticalBar;t.backgroundImage=e,r.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalBarImage",{get:function(){return this._horizontalBarBackgroundImage},set:function(e){this._horizontalBarBackgroundImage,this._horizontalBarBackgroundImage=e,this._horizontalBar.backgroundImage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalBarImage",{get:function(){return this._verticalBarBackgroundImage},set:function(e){this._verticalBarBackgroundImage,this._verticalBarBackgroundImage=e,this._verticalBar.backgroundImage=e},enumerable:!1,configurable:!0}),t.prototype._setWindowPosition=function(e){void 0===e&&(e=!0);var t=this.host.idealRatio,r=this._window._currentMeasure.width,i=this._window._currentMeasure.height;if(e||this._oldWindowContentsWidth!==r||this._oldWindowContentsHeight!==i){this._oldWindowContentsWidth=r,this._oldWindowContentsHeight=i;var n=this._clientWidth-r,o=this._clientHeight-i,s=this._horizontalBar.value/t*n+"px",a=this._verticalBar.value/t*o+"px";s!==this._window.left&&(this._window.left=s,this.freezeControls||(this._rebuildLayout=!0)),a!==this._window.top&&(this._window.top=a,this.freezeControls||(this._rebuildLayout=!0))}},t.prototype._updateScroller=function(){var e=this._window._currentMeasure.width,t=this._window._currentMeasure.height;this._horizontalBar.isVisible&&e<=this._clientWidth&&!this.forceHorizontalBar?(this._grid.setRowDefinition(1,0,!0),this._horizontalBar.isVisible=!1,this._horizontalBar.value=0,this._rebuildLayout=!0):!this._horizontalBar.isVisible&&(e>this._clientWidth||this.forceHorizontalBar)&&(this._grid.setRowDefinition(1,this._barSize,!0),this._horizontalBar.isVisible=!0,this._rebuildLayout=!0),this._verticalBar.isVisible&&t<=this._clientHeight&&!this.forceVerticalBar?(this._grid.setColumnDefinition(1,0,!0),this._verticalBar.isVisible=!1,this._verticalBar.value=0,this._rebuildLayout=!0):!this._verticalBar.isVisible&&(t>this._clientHeight||this.forceVerticalBar)&&(this._grid.setColumnDefinition(1,this._barSize,!0),this._verticalBar.isVisible=!0,this._rebuildLayout=!0),this._buildClientSizes();var r=this.host.idealRatio;this._horizontalBar.thumbWidth=.9*this._thumbLength*(this._clientWidth/r)+"px",this._verticalBar.thumbWidth=.9*this._thumbLength*(this._clientHeight/r)+"px"},t.prototype._link=function(t){e.prototype._link.call(this,t),this._attachWheel()},t.prototype._addBar=function(e,t,r,i){var n=this;e.paddingLeft=0,e.width="100%",e.height="100%",e.barOffset=0,e.value=0,e.maximum=1,e.horizontalAlignment=_.HORIZONTAL_ALIGNMENT_CENTER,e.verticalAlignment=_.VERTICAL_ALIGNMENT_CENTER,e.isVertical=r,e.rotation=i,e.isVisible=!1,t.addControl(e),e.onValueChangedObservable.add((function(e){n._setWindowPosition()}))},t.prototype._attachWheel=function(){var e=this;this._host&&!this._onWheelObserver&&(this._onWheelObserver=this.onWheelObservable.add((function(t){e._pointerIsOver&&(1==e._verticalBar.isVisible&&(t.y<0&&e._verticalBar.value>0?e._verticalBar.value-=e._wheelPrecision:t.y>0&&e._verticalBar.value<e._verticalBar.maximum&&(e._verticalBar.value+=e._wheelPrecision)),1==e._horizontalBar.isVisible&&(t.x<0&&e._horizontalBar.value<e._horizontalBar.maximum?e._horizontalBar.value+=e._wheelPrecision:t.x>0&&e._horizontalBar.value>0&&(e._horizontalBar.value-=e._wheelPrecision)))})))},t.prototype._renderHighlightSpecific=function(t){this.isHighlighted&&(e.prototype._renderHighlightSpecific.call(this,t),this._grid._renderHighlightSpecific(t),t.restore())},t.prototype.dispose=function(){this.onWheelObservable.remove(this._onWheelObserver),this._onWheelObserver=null,e.prototype.dispose.call(this)},t}(b);s._TypeStore.RegisteredTypes["BABYLON.GUI.ScrollViewer"]=W;var z=function(){},X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyPressObservable=new s.Observable,t.defaultButtonWidth="40px",t.defaultButtonHeight="40px",t.defaultButtonPaddingLeft="2px",t.defaultButtonPaddingRight="2px",t.defaultButtonPaddingTop="2px",t.defaultButtonPaddingBottom="2px",t.defaultButtonColor="#DDD",t.defaultButtonBackground="#070707",t.shiftButtonColor="#7799FF",t.selectedShiftThickness=1,t.shiftState=0,t._currentlyConnectedInputText=null,t._connectedInputTexts=[],t._onKeyPressObserver=null,t}return n(t,e),t.prototype._getTypeName=function(){return"VirtualKeyboard"},t.prototype._createKey=function(e,t){var r=this,i=T.CreateSimpleButton(e,e);return i.width=t&&t.width?t.width:this.defaultButtonWidth,i.height=t&&t.height?t.height:this.defaultButtonHeight,i.color=t&&t.color?t.color:this.defaultButtonColor,i.background=t&&t.background?t.background:this.defaultButtonBackground,i.paddingLeft=t&&t.paddingLeft?t.paddingLeft:this.defaultButtonPaddingLeft,i.paddingRight=t&&t.paddingRight?t.paddingRight:this.defaultButtonPaddingRight,i.paddingTop=t&&t.paddingTop?t.paddingTop:this.defaultButtonPaddingTop,i.paddingBottom=t&&t.paddingBottom?t.paddingBottom:this.defaultButtonPaddingBottom,i.thickness=0,i.isFocusInvisible=!0,i.shadowColor=this.shadowColor,i.shadowBlur=this.shadowBlur,i.shadowOffsetX=this.shadowOffsetX,i.shadowOffsetY=this.shadowOffsetY,i.onPointerUpObservable.add((function(){r.onKeyPressObservable.notifyObservers(e)})),i},t.prototype.addKeysRow=function(e,t){var r=new O;r.isVertical=!1,r.isFocusInvisible=!0;for(var i=null,n=0;n<e.length;n++){var o=null;t&&t.length===e.length&&(o=t[n]);var s=this._createKey(e[n],o);(!i||s.heightInPixels>i.heightInPixels)&&(i=s),r.addControl(s)}r.height=i?i.height:this.defaultButtonHeight,this.addControl(r)},t.prototype.applyShiftState=function(e){if(this.children)for(var t=0;t<this.children.length;t++){var r=this.children[t];if(r&&r.children)for(var i=r,n=0;n<i.children.length;n++){var o=i.children[n];if(o&&o.children[0]){var s=o.children[0];"⇧"===s.text&&(o.color=e?this.shiftButtonColor:this.defaultButtonColor,o.thickness=e>1?this.selectedShiftThickness:0),s.text=e>0?s.text.toUpperCase():s.text.toLowerCase()}}}},Object.defineProperty(t.prototype,"connectedInputText",{get:function(){return this._currentlyConnectedInputText},enumerable:!1,configurable:!0}),t.prototype.connect=function(e){var t=this;if(!this._connectedInputTexts.some((function(t){return t.input===e}))){null===this._onKeyPressObserver&&(this._onKeyPressObserver=this.onKeyPressObservable.add((function(e){if(t._currentlyConnectedInputText){switch(t._currentlyConnectedInputText._host.focusedControl=t._currentlyConnectedInputText,e){case"⇧":return t.shiftState++,t.shiftState>2&&(t.shiftState=0),void t.applyShiftState(t.shiftState);case"←":return void t._currentlyConnectedInputText.processKey(8);case"↵":return void t._currentlyConnectedInputText.processKey(13)}t._currentlyConnectedInputText.processKey(-1,t.shiftState?e.toUpperCase():e),1===t.shiftState&&(t.shiftState=0,t.applyShiftState(t.shiftState))}}))),this.isVisible=!1,this._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=this;var r=e.onFocusObservable.add((function(){t._currentlyConnectedInputText=e,e._connectedVirtualKeyboard=t,t.isVisible=!0})),i=e.onBlurObservable.add((function(){e._connectedVirtualKeyboard=null,t._currentlyConnectedInputText=null,t.isVisible=!1}));this._connectedInputTexts.push({input:e,onBlurObserver:i,onFocusObserver:r})}},t.prototype.disconnect=function(e){var t=this;if(e){var r=this._connectedInputTexts.filter((function(t){return t.input===e}));1===r.length&&(this._removeConnectedInputObservables(r[0]),this._connectedInputTexts=this._connectedInputTexts.filter((function(t){return t.input!==e})),this._currentlyConnectedInputText===e&&(this._currentlyConnectedInputText=null))}else this._connectedInputTexts.forEach((function(e){t._removeConnectedInputObservables(e)})),this._connectedInputTexts=[];0===this._connectedInputTexts.length&&(this._currentlyConnectedInputText=null,this.onKeyPressObservable.remove(this._onKeyPressObserver),this._onKeyPressObserver=null)},t.prototype._removeConnectedInputObservables=function(e){e.input._connectedVirtualKeyboard=null,e.input.onFocusObservable.remove(e.onFocusObserver),e.input.onBlurObservable.remove(e.onBlurObserver)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.disconnect()},t.CreateDefaultLayout=function(e){var r=new t(e);return r.addKeysRow(["1","2","3","4","5","6","7","8","9","0","←"]),r.addKeysRow(["q","w","e","r","t","y","u","i","o","p"]),r.addKeysRow(["a","s","d","f","g","h","j","k","l",";","'","↵"]),r.addKeysRow(["⇧","z","x","c","v","b","n","m",",",".","/"]),r.addKeysRow([" "],[{width:"200px"}]),r},t}(O);s._TypeStore.RegisteredTypes["BABYLON.GUI.VirtualKeyboard"]=X;var Y=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._cellWidth=20,r._cellHeight=20,r._minorLineTickness=1,r._minorLineColor="DarkGray",r._majorLineTickness=2,r._majorLineColor="White",r._majorLineFrequency=5,r._background="Black",r._displayMajorLines=!0,r._displayMinorLines=!0,r}return n(t,e),Object.defineProperty(t.prototype,"displayMinorLines",{get:function(){return this._displayMinorLines},set:function(e){this._displayMinorLines!==e&&(this._displayMinorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMajorLines",{get:function(){return this._displayMajorLines},set:function(e){this._displayMajorLines!==e&&(this._displayMajorLines=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellWidth",{get:function(){return this._cellWidth},set:function(e){this._cellWidth=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellHeight",{get:function(){return this._cellHeight},set:function(e){this._cellHeight=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineTickness",{get:function(){return this._minorLineTickness},set:function(e){this._minorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLineColor",{get:function(){return this._minorLineColor},set:function(e){this._minorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineTickness",{get:function(){return this._majorLineTickness},set:function(e){this._majorLineTickness=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineColor",{get:function(){return this._majorLineColor},set:function(e){this._majorLineColor=e,this._markAsDirty()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLineFrequency",{get:function(){return this._majorLineFrequency},set:function(e){this._majorLineFrequency=e,this._markAsDirty()},enumerable:!1,configurable:!0}),t.prototype._draw=function(e,t){if(e.save(),this._applyStates(e),this._isEnabled){this._background&&(e.fillStyle=this._background,e.fillRect(this._currentMeasure.left,this._currentMeasure.top,this._currentMeasure.width,this._currentMeasure.height));var r=this._currentMeasure.width/this._cellWidth,i=this._currentMeasure.height/this._cellHeight,n=this._currentMeasure.left+this._currentMeasure.width/2,o=this._currentMeasure.top+this._currentMeasure.height/2;if(this._displayMinorLines){e.strokeStyle=this._minorLineColor,e.lineWidth=this._minorLineTickness;for(var s=-r/2;s<r/2;s++){var a=n+s*this.cellWidth;e.beginPath(),e.moveTo(a,this._currentMeasure.top),e.lineTo(a,this._currentMeasure.top+this._currentMeasure.height),e.stroke()}for(var l=-i/2;l<i/2;l++){var h=o+l*this.cellHeight;e.beginPath(),e.moveTo(this._currentMeasure.left,h),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,h),e.stroke()}}if(this._displayMajorLines){for(e.strokeStyle=this._majorLineColor,e.lineWidth=this._majorLineTickness,s=-r/2+this._majorLineFrequency;s<r/2;s+=this._majorLineFrequency)a=n+s*this.cellWidth,e.beginPath(),e.moveTo(a,this._currentMeasure.top),e.lineTo(a,this._currentMeasure.top+this._currentMeasure.height),e.stroke();for(l=-i/2+this._majorLineFrequency;l<i/2;l+=this._majorLineFrequency)h=o+l*this.cellHeight,e.moveTo(this._currentMeasure.left,h),e.lineTo(this._currentMeasure.left+this._currentMeasure.width,h),e.closePath(),e.stroke()}}e.restore()},t.prototype._getTypeName=function(){return"DisplayGrid"},t}(_);s._TypeStore.RegisteredTypes["BABYLON.GUI.DisplayGrid"]=Y;var K=function(e){function t(t){var r=e.call(this,t)||this;return r.name=t,r._tempMeasure=new d(0,0,0,0),r}return n(t,e),Object.defineProperty(t.prototype,"displayThumb",{get:function(){return this._displayThumb&&null!=this.thumbImage},set:function(e){this._displayThumb!==e&&(this._displayThumb=e,this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this._backgroundImage},set:function(e){var t=this;this._backgroundImage!==e&&(this._backgroundImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueBarImage",{get:function(){return this._valueBarImage},set:function(e){var t=this;this._valueBarImage!==e&&(this._valueBarImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thumbImage",{get:function(){return this._thumbImage},set:function(e){var t=this;this._thumbImage!==e&&(this._thumbImage=e,e&&!e.isLoaded&&e.onImageLoadedObservable.addOnce((function(){return t._markAsDirty()})),this._markAsDirty())},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"ImageBasedSlider"},t.prototype._draw=function(e,t){e.save(),this._applyStates(e),this._prepareRenderingData("rectangle");var r=this._getThumbPosition(),i=this._renderLeft,n=this._renderTop,o=this._renderWidth,s=this._renderHeight;this._backgroundImage&&(this._tempMeasure.copyFromFloats(i,n,o,s),this.isThumbClamped&&this.displayThumb&&(this.isVertical?this._tempMeasure.height+=this._effectiveThumbThickness:this._tempMeasure.width+=this._effectiveThumbThickness),this._backgroundImage._currentMeasure.copyFrom(this._tempMeasure),this._backgroundImage._draw(e)),this._valueBarImage&&(this.isVertical?this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(i,n+r,o,s-r+this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(i,n+r,o,s-r):this.isThumbClamped&&this.displayThumb?this._tempMeasure.copyFromFloats(i,n,r+this._effectiveThumbThickness/2,s):this._tempMeasure.copyFromFloats(i,n,r,s),this._valueBarImage._currentMeasure.copyFrom(this._tempMeasure),this._valueBarImage._draw(e)),this.displayThumb&&(this.isVertical?this._tempMeasure.copyFromFloats(i-this._effectiveBarOffset,this._currentMeasure.top+r,this._currentMeasure.width,this._effectiveThumbThickness):this._tempMeasure.copyFromFloats(this._currentMeasure.left+r,this._currentMeasure.top,this._effectiveThumbThickness,this._currentMeasure.height),this._thumbImage._currentMeasure.copyFrom(this._tempMeasure),this._thumbImage._draw(e)),e.restore()},t}(N);s._TypeStore.RegisteredTypes["BABYLON.GUI.ImageBasedSlider"]=K;var $="Statics";_.AddHeader=function(e,t,r,i){var n=new O("panel"),o=!i||i.isHorizontal,s=!i||i.controlFirst;n.isVertical=!o;var a=new y("header");return a.text=t,a.textHorizontalAlignment=_.HORIZONTAL_ALIGNMENT_LEFT,o?a.width=r:a.height=r,s?(n.addControl(e),n.addControl(a),a.paddingLeft="5px"):(n.addControl(a),n.addControl(e),a.paddingRight="5px"),a.shadowBlur=e.shadowBlur,a.shadowColor=e.shadowColor,a.shadowOffsetX=e.shadowOffsetX,a.shadowOffsetY=e.shadowOffsetY,n};var q=function(){function e(e){this._fontFamily="Arial",this._fontStyle="",this._fontWeight="",this._fontSize=new a(18,a.UNITMODE_PIXEL,!1),this.onChangedObservable=new s.Observable,this._host=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize.toString(this._host)},set:function(e){this._fontSize.toString(this._host)!==e&&this._fontSize.fromString(e)&&this.onChangedObservable.notifyObservers(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this._fontFamily!==e&&(this._fontFamily=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.onChangedObservable.notifyObservers(this))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.onChangedObservable.clear()},e}(),Z=function(e){function t(t,r,i,n,o,a,l){void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=!1),void 0===a&&(a=s.Texture.NEAREST_SAMPLINGMODE);var h=e.call(this,t,{width:r,height:i},n,o,a,s.Constants.TEXTUREFORMAT_RGBA,l)||this;return h._isDirty=!1,h._rootContainer=new g("root"),h._lastControlOver={},h._lastControlDown={},h._capturingControl={},h._linkedControls=new Array,h._isFullscreen=!1,h._fullscreenViewport=new s.Viewport(0,0,1,1),h._idealWidth=0,h._idealHeight=0,h._useSmallestIdeal=!1,h._renderAtIdealSize=!1,h._blockNextFocusCheck=!1,h._renderScale=1,h._cursorChanged=!1,h._defaultMousePointerId=0,h._numLayoutCalls=0,h._numRenderCalls=0,h._clipboardData="",h.onClipboardObservable=new s.Observable,h.onControlPickedObservable=new s.Observable,h.onBeginLayoutObservable=new s.Observable,h.onEndLayoutObservable=new s.Observable,h.onBeginRenderObservable=new s.Observable,h.onEndRenderObservable=new s.Observable,h.premulAlpha=!1,h.applyYInversionOnUpdate=!0,h._useInvalidateRectOptimization=!0,h._invalidatedRectangle=null,h._clearMeasure=new d(0,0,0,0),h.onClipboardCopy=function(e){var t=e,r=new s.ClipboardInfo(s.ClipboardEventTypes.COPY,t);h.onClipboardObservable.notifyObservers(r),t.preventDefault()},h.onClipboardCut=function(e){var t=e,r=new s.ClipboardInfo(s.ClipboardEventTypes.CUT,t);h.onClipboardObservable.notifyObservers(r),t.preventDefault()},h.onClipboardPaste=function(e){var t=e,r=new s.ClipboardInfo(s.ClipboardEventTypes.PASTE,t);h.onClipboardObservable.notifyObservers(r),t.preventDefault()},(n=h.getScene())&&h._texture?(h._rootElement=n.getEngine().getInputElement(),h._renderObserver=n.onBeforeCameraRenderObservable.add((function(e){return h._checkUpdate(e)})),h._preKeyboardObserver=n.onPreKeyboardObservable.add((function(e){h._focusedControl&&(e.type===s.KeyboardEventTypes.KEYDOWN&&h._focusedControl.processKeyboard(e.event),e.skipOnPointerObservable=!0)})),h._rootContainer._link(h),h.hasAlpha=!0,r&&i||(h._resizeObserver=n.getEngine().onResizeObservable.add((function(){return h._onResize()})),h._onResize()),h._texture.isReady=!0,h):h}return n(t,e),Object.defineProperty(t.prototype,"numLayoutCalls",{get:function(){return this._numLayoutCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numRenderCalls",{get:function(){return this._numRenderCalls},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderScale",{get:function(){return this._renderScale},set:function(e){e!==this._renderScale&&(this._renderScale=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,this.markAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealWidth",{get:function(){return this._idealWidth},set:function(e){this._idealWidth!==e&&(this._idealWidth=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealHeight",{get:function(){return this._idealHeight},set:function(e){this._idealHeight!==e&&(this._idealHeight=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useSmallestIdeal",{get:function(){return this._useSmallestIdeal},set:function(e){this._useSmallestIdeal!==e&&(this._useSmallestIdeal=e,this.markAsDirty(),this._rootContainer._markAllAsDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderAtIdealSize",{get:function(){return this._renderAtIdealSize},set:function(e){this._renderAtIdealSize!==e&&(this._renderAtIdealSize=e,this._onResize())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idealRatio",{get:function(){var e=0,t=0;return this._idealWidth&&(e=this.getSize().width/this._idealWidth),this._idealHeight&&(t=this.getSize().height/this._idealHeight),this._useSmallestIdeal&&this._idealWidth&&this._idealHeight?window.innerWidth<window.innerHeight?e:t:this._idealWidth?e:this._idealHeight?t:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this._layerToDispose},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),t.prototype.getChildren=function(){return[this._rootContainer]},t.prototype.getDescendants=function(e,t){return this._rootContainer.getDescendants(e,t)},Object.defineProperty(t.prototype,"focusedControl",{get:function(){return this._focusedControl},set:function(e){this._focusedControl!=e&&(this._focusedControl&&this._focusedControl.onBlur(),e&&e.onFocus(),this._focusedControl=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isForeground",{get:function(){return!this.layer||!this.layer.isBackground},set:function(e){this.layer&&this.layer.isBackground!==!e&&(this.layer.isBackground=!e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipboardData",{get:function(){return this._clipboardData},set:function(e){this._clipboardData=e},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"AdvancedDynamicTexture"},t.prototype.executeOnAllControls=function(e,t){t||(t=this._rootContainer),e(t);for(var r=0,i=t.children;r<i.length;r++){var n=i[r];n.children?this.executeOnAllControls(e,n):e(n)}},Object.defineProperty(t.prototype,"useInvalidateRectOptimization",{get:function(){return this._useInvalidateRectOptimization},set:function(e){this._useInvalidateRectOptimization=e},enumerable:!1,configurable:!0}),t.prototype.invalidateRect=function(e,t,r,i){if(this._useInvalidateRectOptimization)if(this._invalidatedRectangle){var n=Math.ceil(Math.max(this._invalidatedRectangle.left+this._invalidatedRectangle.width-1,r)),o=Math.ceil(Math.max(this._invalidatedRectangle.top+this._invalidatedRectangle.height-1,i));this._invalidatedRectangle.left=Math.floor(Math.min(this._invalidatedRectangle.left,e)),this._invalidatedRectangle.top=Math.floor(Math.min(this._invalidatedRectangle.top,t)),this._invalidatedRectangle.width=n-this._invalidatedRectangle.left+1,this._invalidatedRectangle.height=o-this._invalidatedRectangle.top+1}else this._invalidatedRectangle=new d(e,t,r-e+1,i-t+1)},t.prototype.markAsDirty=function(){this._isDirty=!0},t.prototype.createStyle=function(){return new q(this)},t.prototype.addControl=function(e){return this._rootContainer.addControl(e),this},t.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),this},t.prototype.dispose=function(){var t=this.getScene();t&&(this._rootElement=null,t.onBeforeCameraRenderObservable.remove(this._renderObserver),this._resizeObserver&&t.getEngine().onResizeObservable.remove(this._resizeObserver),this._pointerMoveObserver&&t.onPrePointerObservable.remove(this._pointerMoveObserver),this._pointerObserver&&t.onPointerObservable.remove(this._pointerObserver),this._preKeyboardObserver&&t.onPreKeyboardObservable.remove(this._preKeyboardObserver),this._canvasPointerOutObserver&&t.getEngine().onCanvasPointerOutObservable.remove(this._canvasPointerOutObserver),this._canvasBlurObserver&&t.getEngine().onCanvasBlurObservable.remove(this._canvasBlurObserver),this._layerToDispose&&(this._layerToDispose.texture=null,this._layerToDispose.dispose(),this._layerToDispose=null),this._rootContainer.dispose(),this.onClipboardObservable.clear(),this.onControlPickedObservable.clear(),this.onBeginRenderObservable.clear(),this.onEndRenderObservable.clear(),this.onBeginLayoutObservable.clear(),this.onEndLayoutObservable.clear(),e.prototype.dispose.call(this))},t.prototype._onResize=function(){var e=this.getScene();if(e){var t=e.getEngine(),r=this.getSize(),i=t.getRenderWidth()*this._renderScale,n=t.getRenderHeight()*this._renderScale;this._renderAtIdealSize&&(this._idealWidth?(n=n*this._idealWidth/i,i=this._idealWidth):this._idealHeight&&(i=i*this._idealHeight/n,n=this._idealHeight)),r.width===i&&r.height===n||(this.scaleTo(i,n),this.markAsDirty(),(this._idealWidth||this._idealHeight)&&this._rootContainer._markAllAsDirty()),this.invalidateRect(0,0,r.width-1,r.height-1)}},t.prototype._getGlobalViewport=function(e){var t=e.getEngine();return this._fullscreenViewport.toGlobal(t.getRenderWidth(),t.getRenderHeight())},t.prototype.getProjectedPosition=function(e,t){var r=this.getScene();if(!r)return s.Vector2.Zero();var i=this._getGlobalViewport(r),n=s.Vector3.Project(e,t,r.getTransformMatrix(),i);return n.scaleInPlace(this.renderScale),new s.Vector2(n.x,n.y)},t.prototype.getProjectedPositionWithZ=function(e,t){var r=this.getScene();if(!r)return s.Vector3.Zero();var i=this._getGlobalViewport(r),n=s.Vector3.Project(e,t,r.getTransformMatrix(),i);return n.scaleInPlace(this.renderScale),new s.Vector3(n.x,n.y,n.z)},t.prototype._checkUpdate=function(e){if(!this._layerToDispose||0!=(e.layerMask&this._layerToDispose.layerMask)){if(this._isFullscreen&&this._linkedControls.length){var t=this.getScene();if(!t)return;for(var r=this._getGlobalViewport(t),i=function(e){if(!e.isVisible)return"continue";var i=e._linkedMesh;if(!i||i.isDisposed())return s.Tools.SetImmediate((function(){e.linkWithMesh(null)})),"continue";var o=i.getBoundingInfo?i.getBoundingInfo().boundingSphere.center:s.Vector3.ZeroReadOnly,a=s.Vector3.Project(o,i.getWorldMatrix(),t.getTransformMatrix(),r);if(a.z<0||a.z>1)return e.notRenderable=!0,"continue";e.notRenderable=!1,a.scaleInPlace(n.renderScale),e._moveToProjectedPosition(a)},n=this,o=0,a=this._linkedControls;o<a.length;o++)i(a[o])}(this._isDirty||this._rootContainer.isDirty)&&(this._isDirty=!1,this._render(),this.update(this.applyYInversionOnUpdate,this.premulAlpha))}},t.prototype._render=function(){var e=this.getSize(),t=e.width,r=e.height,i=this.getContext();i.font="18px Arial",i.strokeStyle="white",this.onBeginLayoutObservable.notifyObservers(this);var n=new d(0,0,t,r);this._numLayoutCalls=0,this._rootContainer._layout(n,i),this.onEndLayoutObservable.notifyObservers(this),this._isDirty=!1,this._invalidatedRectangle?this._clearMeasure.copyFrom(this._invalidatedRectangle):this._clearMeasure.copyFromFloats(0,0,t,r),i.clearRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),this._background&&(i.save(),i.fillStyle=this._background,i.fillRect(this._clearMeasure.left,this._clearMeasure.top,this._clearMeasure.width,this._clearMeasure.height),i.restore()),this.onBeginRenderObservable.notifyObservers(this),this._numRenderCalls=0,this._rootContainer._render(i,this._invalidatedRectangle),this.onEndRenderObservable.notifyObservers(this),this._invalidatedRectangle=null},t.prototype._changeCursor=function(e){this._rootElement&&(this._rootElement.style.cursor=e,this._cursorChanged=!0)},t.prototype._registerLastControlDown=function(e,t){this._lastControlDown[t]=e,this.onControlPickedObservable.notifyObservers(e)},t.prototype._doPicking=function(e,t,r,i,n,o,a,l){var h=this.getScene();if(h){var u=h.getEngine(),c=this.getSize();if(this._isFullscreen){var d=(h.cameraToUseForPointers||h.activeCamera).viewport;e*=c.width/(u.getRenderWidth()*d.width),t*=c.height/(u.getRenderHeight()*d.height)}this._capturingControl[n]?this._capturingControl[n]._processObservables(i,e,t,r,n,o):(this._cursorChanged=!1,this._rootContainer._processPicking(e,t,r,i,n,o,a,l)||(this._changeCursor(""),i===s.PointerEventTypes.POINTERMOVE&&this._lastControlOver[n]&&(this._lastControlOver[n]._onPointerOut(this._lastControlOver[n],r),delete this._lastControlOver[n])),this._cursorChanged||this._changeCursor(""),this._manageFocus())}},t.prototype._cleanControlAfterRemovalFromList=function(e,t){for(var r in e)e.hasOwnProperty(r)&&e[r]===t&&delete e[r]},t.prototype._cleanControlAfterRemoval=function(e){this._cleanControlAfterRemovalFromList(this._lastControlDown,e),this._cleanControlAfterRemovalFromList(this._lastControlOver,e)},t.prototype.attach=function(){var e=this,t=this.getScene();if(t){var r=new s.Viewport(0,0,0,0);this._pointerMoveObserver=t.onPrePointerObservable.add((function(i,n){if(!t.isPointerCaptured(i.event.pointerId)&&(i.type===s.PointerEventTypes.POINTERMOVE||i.type===s.PointerEventTypes.POINTERUP||i.type===s.PointerEventTypes.POINTERDOWN||i.type===s.PointerEventTypes.POINTERWHEEL)&&t){i.type===s.PointerEventTypes.POINTERMOVE&&i.event.pointerId&&(e._defaultMousePointerId=i.event.pointerId);var o=t.cameraToUseForPointers||t.activeCamera,a=t.getEngine();o?o.viewport.toGlobalToRef(a.getRenderWidth(),a.getRenderHeight(),r):(r.x=0,r.y=0,r.width=a.getRenderWidth(),r.height=a.getRenderHeight());var l=t.pointerX/a.getHardwareScalingLevel()-r.x,h=t.pointerY/a.getHardwareScalingLevel()-(a.getRenderHeight()-r.y-r.height);e._shouldBlockPointer=!1;var u=i.event.pointerId||e._defaultMousePointerId;e._doPicking(l,h,i,i.type,u,i.event.button,i.event.deltaX,i.event.deltaY),e._shouldBlockPointer&&(i.skipOnPointerObservable=e._shouldBlockPointer)}})),this._attachToOnPointerOut(t),this._attachToOnBlur(t)}},t.prototype.registerClipboardEvents=function(){self.addEventListener("copy",this.onClipboardCopy,!1),self.addEventListener("cut",this.onClipboardCut,!1),self.addEventListener("paste",this.onClipboardPaste,!1)},t.prototype.unRegisterClipboardEvents=function(){self.removeEventListener("copy",this.onClipboardCopy),self.removeEventListener("cut",this.onClipboardCut),self.removeEventListener("paste",this.onClipboardPaste)},t.prototype.attachToMesh=function(e,t){var r=this;void 0===t&&(t=!0);var i=this.getScene();i&&(this._pointerObserver=i.onPointerObservable.add((function(t,i){if(t.type===s.PointerEventTypes.POINTERMOVE||t.type===s.PointerEventTypes.POINTERUP||t.type===s.PointerEventTypes.POINTERDOWN){var n=t.event.pointerId||r._defaultMousePointerId;if(t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh===e){var o=t.pickInfo.getTextureCoordinates();if(o){var a=r.getSize();r._doPicking(o.x*a.width,(r.applyYInversionOnUpdate?1-o.y:o.y)*a.height,t,t.type,n,t.event.button)}}else if(t.type===s.PointerEventTypes.POINTERUP){if(r._lastControlDown[n]&&r._lastControlDown[n]._forcePointerUp(n),delete r._lastControlDown[n],r.focusedControl){var l=r.focusedControl.keepsFocusWith(),h=!0;if(l)for(var u=0,c=l;u<c.length;u++){var d=c[u];if(r!==d._host){var p=d._host;if(p._lastControlOver[n]&&p._lastControlOver[n].isAscendant(d)){h=!1;break}}}h&&(r.focusedControl=null)}}else t.type===s.PointerEventTypes.POINTERMOVE&&(r._lastControlOver[n]&&r._lastControlOver[n]._onPointerOut(r._lastControlOver[n],t,!0),delete r._lastControlOver[n])}})),e.enablePointerMoveEvents=t,this._attachToOnPointerOut(i),this._attachToOnBlur(i))},t.prototype.moveFocusToControl=function(e){this.focusedControl=e,this._lastPickedControl=e,this._blockNextFocusCheck=!0},t.prototype._manageFocus=function(){if(this._blockNextFocusCheck)return this._blockNextFocusCheck=!1,void(this._lastPickedControl=this._focusedControl);if(this._focusedControl&&this._focusedControl!==this._lastPickedControl){if(this._lastPickedControl.isFocusInvisible)return;this.focusedControl=null}},t.prototype._attachToOnPointerOut=function(e){var t=this;this._canvasPointerOutObserver=e.getEngine().onCanvasPointerOutObservable.add((function(e){t._lastControlOver[e.pointerId]&&t._lastControlOver[e.pointerId]._onPointerOut(t._lastControlOver[e.pointerId],null),delete t._lastControlOver[e.pointerId],t._lastControlDown[e.pointerId]&&t._lastControlDown[e.pointerId]!==t._capturingControl[e.pointerId]&&(t._lastControlDown[e.pointerId]._forcePointerUp(),delete t._lastControlDown[e.pointerId])}))},t.prototype._attachToOnBlur=function(e){var t=this;this._canvasBlurObserver=e.getEngine().onCanvasBlurObservable.add((function(e){Object.entries(t._lastControlDown).forEach((function(e){e[0],e[1]._onCanvasBlur()})),t._lastControlDown={}}))},t.CreateForMesh=function(e,r,i,n,o,a){void 0===r&&(r=1024),void 0===i&&(i=1024),void 0===n&&(n=!0),void 0===o&&(o=!1);var l=new t(e.name+" AdvancedDynamicTexture",r,i,e.getScene(),!0,s.Texture.TRILINEAR_SAMPLINGMODE,a),h=new s.StandardMaterial("AdvancedDynamicTextureMaterial",e.getScene());return h.backFaceCulling=!1,h.diffuseColor=s.Color3.Black(),h.specularColor=s.Color3.Black(),o?(h.diffuseTexture=l,h.emissiveTexture=l,l.hasAlpha=!0):(h.emissiveTexture=l,h.opacityTexture=l),e.material=h,l.attachToMesh(e,n),l},t.CreateForMeshTexture=function(e,r,i,n,o){void 0===r&&(r=1024),void 0===i&&(i=1024),void 0===n&&(n=!0);var a=new t(e.name+" AdvancedDynamicTexture",r,i,e.getScene(),!0,s.Texture.TRILINEAR_SAMPLINGMODE,o);return a.attachToMesh(e,n),a},t.CreateFullscreenUI=function(e,r,i,n){void 0===r&&(r=!0),void 0===i&&(i=null),void 0===n&&(n=s.Texture.BILINEAR_SAMPLINGMODE);var o=new t(e,0,0,i,!1,n),a=new s.Layer(e+"_layer",null,i,!r);return a.texture=o,o._layerToDispose=a,o._isFullscreen=!0,o.attach(),o},t}(s.DynamicTexture),J=function(){function e(e){this.texture=e,this._captureRenderTime=!1,this._renderTime=new s.PerfCounter,this._captureLayoutTime=!1,this._layoutTime=new s.PerfCounter,this._onBeginRenderObserver=null,this._onEndRenderObserver=null,this._onBeginLayoutObserver=null,this._onEndLayoutObserver=null}return Object.defineProperty(e.prototype,"renderTimeCounter",{get:function(){return this._renderTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutTimeCounter",{get:function(){return this._layoutTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureRenderTime",{get:function(){return this._captureRenderTime},set:function(e){var t=this;e!==this._captureRenderTime&&(this._captureRenderTime=e,e?(this._onBeginRenderObserver=this.texture.onBeginRenderObservable.add((function(){t._renderTime.beginMonitoring()})),this._onEndRenderObserver=this.texture.onEndRenderObservable.add((function(){t._renderTime.endMonitoring(!0)}))):(this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"captureLayoutTime",{get:function(){return this._captureLayoutTime},set:function(e){var t=this;e!==this._captureLayoutTime&&(this._captureLayoutTime=e,e?(this._onBeginLayoutObserver=this.texture.onBeginLayoutObservable.add((function(){t._layoutTime.beginMonitoring()})),this._onEndLayoutObserver=this.texture.onEndLayoutObservable.add((function(){t._layoutTime.endMonitoring(!0)}))):(this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null))},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.texture.onBeginRenderObservable.remove(this._onBeginRenderObserver),this._onBeginRenderObserver=null,this.texture.onEndRenderObservable.remove(this._onEndRenderObserver),this._onEndRenderObserver=null,this.texture.onBeginLayoutObservable.remove(this._onBeginLayoutObserver),this._onBeginLayoutObserver=null,this.texture.onEndLayoutObservable.remove(this._onEndLayoutObserver),this._onEndLayoutObserver=null,this.texture=null},e}(),Q=function(){function e(e){void 0===e&&(e=null),this._nodes={},this._nodeTypes={element:1,attribute:2,text:3},this._isLoaded=!1,this._objectAttributes={textHorizontalAlignment:1,textVerticalAlignment:2,horizontalAlignment:3,verticalAlignment:4,stretch:5},e&&(this._parentClass=e)}return e.prototype._getChainElement=function(e){var t=window;this._parentClass&&(t=this._parentClass);var r=e;r=r.split(".");for(var i=0;i<r.length;i++)t=t[r[i]];return t},e.prototype._getClassAttribute=function(e){var t=e.split(".");return s._TypeStore.GetClass("BABYLON.GUI."+t[0])[t[1]]},e.prototype._createGuiElement=function(e,t,r){void 0===r&&(r=!0);try{var i=new(s._TypeStore.GetClass("BABYLON.GUI."+e.nodeName));t&&r&&t.addControl(i);for(var n=0;n<e.attributes.length;n++)if(!e.attributes[n].name.toLowerCase().includes("datasource"))if(e.attributes[n].name.toLowerCase().includes("observable")){var o=this._getChainElement(e.attributes[n].value);i[e.attributes[n].name].add(o)}else"linkWithMesh"==e.attributes[n].name?this._parentClass?i.linkWithMesh(this._parentClass[e.attributes[n].value]):i.linkWithMesh(window[e.attributes[n].value]):e.attributes[n].value.startsWith("{{")&&e.attributes[n].value.endsWith("}}")?(o=this._getChainElement(e.attributes[n].value.substring(2,e.attributes[n].value.length-2)),i[e.attributes[n].name]=o):this._objectAttributes[e.attributes[n].name]?i[e.attributes[n].name]=this._getClassAttribute(e.attributes[n].value):"true"==e.attributes[n].value||"false"==e.attributes[n].value?i[e.attributes[n].name]="true"==e.attributes[n].value:i[e.attributes[n].name]=isNaN(Number(e.attributes[n].value))?e.attributes[n].value:Number(e.attributes[n].value);if(!e.attributes.getNamedItem("id"))return this._nodes[e.nodeName+Object.keys(this._nodes).length+"_gen"]=i,i;var a=e.attributes.getNamedItem("id").value;if(a.startsWith("{{")&&a.endsWith("}}")&&(a=this._getChainElement(a.substring(2,a.length-2))),this._nodes[a])throw"XmlLoader Exception : Duplicate ID, every element should have an unique ID attribute";return this._nodes[a]=i,i}catch(t){throw"XmlLoader Exception : Error parsing Control "+e.nodeName+","+t+"."}},e.prototype._parseGrid=function(e,t,r){for(var i,n,o,s,a,l=e.children,h=!1,u=-1,c=-1,d=0,p=0;p<l.length;p++)if(l[p].nodeType==this._nodeTypes.element){if("Row"!=l[p].nodeName)throw"XmlLoader Exception : Expecting Row node, received "+l[p].nodeName;if(u+=1,o=l[p].children,!l[p].attributes.getNamedItem("height"))throw"XmlLoader Exception : Height must be defined for grid rows";n=Number(l[p].attributes.getNamedItem("height").nodeValue),h=!!l[p].attributes.getNamedItem("isPixel")&&JSON.parse(l[p].attributes.getNamedItem("isPixel").nodeValue),t.addRowDefinition(n,h);for(var f=0;f<o.length;f++)if(o[f].nodeType==this._nodeTypes.element){if("Column"!=o[f].nodeName)throw"XmlLoader Exception : Expecting Column node, received "+o[f].nodeName;if(c+=1,u>0&&c>d)throw"XmlLoader Exception : In the Grid element, the number of columns is defined in the first row, do not add more columns in the subsequent rows.";if(0==u){if(!o[f].attributes.getNamedItem("width"))throw"XmlLoader Exception : Width must be defined for all the grid columns in the first row";i=Number(o[f].attributes.getNamedItem("width").nodeValue),h=!!o[f].attributes.getNamedItem("isPixel")&&JSON.parse(o[f].attributes.getNamedItem("isPixel").nodeValue),t.addColumnDefinition(i,h)}s=o[f].children;for(var _=0;_<s.length;_++)s[_].nodeType==this._nodeTypes.element&&(a=this._createGuiElement(s[_],t,!1),t.addControl(a,u,c),s[_].firstChild&&this._parseXml(s[_].firstChild,a))}0==u&&(d=c),c=-1}e.nextSibling&&this._parseXml(e.nextSibling,r)},e.prototype._parseElement=function(e,t,r){e.firstChild&&this._parseXml(e.firstChild,t),e.nextSibling&&this._parseXml(e.nextSibling,r)},e.prototype._prepareSourceElement=function(e,t,r,i,n){this._parentClass?this._parentClass[r]=i[n]:window[r]=i[n],e.firstChild&&this._parseXml(e.firstChild,t,!0)},e.prototype._parseElementsFromSource=function(e,t,r){var i=e.attributes.getNamedItem("dataSource").value;if(!i.includes(" in "))throw"XmlLoader Exception : Malformed XML, Data Source must include an in";var n=!0,o=i.split(" in ");if(o.length<2)throw"XmlLoader Exception : Malformed XML, Data Source must an iterator and a source";var s=o[1];if(s.startsWith("{")&&s.endsWith("}")&&(n=!1),(!n||s.startsWith("[")&&s.endsWith("]"))&&(s=s.substring(1,s.length-1)),s=this._parentClass?this._parentClass[s]:window[s],n)for(var a=0;a<s.length;a++)this._prepareSourceElement(e,t,o[0],s,a);else for(var a in s)this._prepareSourceElement(e,t,o[0],s,a);e.nextSibling&&this._parseXml(e.nextSibling,r)},e.prototype._parseXml=function(e,t,r){if(void 0===r&&(r=!1),e.nodeType==this._nodeTypes.element){r&&e.setAttribute("id",t.id+(t._children.length+1));var i=this._createGuiElement(e,t);"Grid"==e.nodeName?this._parseGrid(e,i,t):e.attributes.getNamedItem("dataSource")?this._parseElementsFromSource(e,i,t):this._parseElement(e,i,t)}else e.nextSibling&&this._parseXml(e.nextSibling,t,r)},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.getNodeById=function(e){return this._nodes[e]},e.prototype.getNodes=function(){return this._nodes},e.prototype.loadLayout=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){if(!i.responseXML)throw"XmlLoader Exception : XML file is malformed or corrupted.";var e=i.responseXML.documentElement;this._parseXml(e.firstChild,t),this._isLoaded=!0,r&&r()}}.bind(this),i.open("GET",e,!0),i.send()},e}(),ee=function(e){function t(t,r){void 0===r&&(r=0);var i=e.call(this,t.x,t.y,t.z)||this;return i.buttonIndex=r,i}return n(t,e),t}(s.Vector3),te=function(){function e(e){this.name=e,this._downCount=0,this._enterCount=-1,this._downPointerIds={},this._isVisible=!0,this.onPointerMoveObservable=new s.Observable,this.onPointerOutObservable=new s.Observable,this.onPointerDownObservable=new s.Observable,this.onPointerUpObservable=new s.Observable,this.onPointerClickObservable=new s.Observable,this.onPointerEnterObservable=new s.Observable,this._behaviors=new Array}return Object.defineProperty(e.prototype,"position",{get:function(){return this._node?this._node.position:s.Vector3.Zero()},set:function(e){this._node&&(this._node.position=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this._node?this._node.scaling:new s.Vector3(1,1,1)},set:function(e){this._node&&(this._node.scaling=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),e.prototype.addBehavior=function(e){var t=this;if(-1!==this._behaviors.indexOf(e))return this;e.init();var r=this._host.scene;return r.isLoading?r.onDataLoadedObservable.addOnce((function(){e.attach(t)})):e.attach(this),this._behaviors.push(e),this},e.prototype.removeBehavior=function(e){var t=this._behaviors.indexOf(e);return-1===t||(this._behaviors[t].detach(),this._behaviors.splice(t,1)),this},e.prototype.getBehaviorByName=function(e){for(var t=0,r=this._behaviors;t<r.length;t++){var i=r[t];if(i.name===e)return i}return null},Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){if(this._isVisible!==e){this._isVisible=e;var t=this.mesh;t&&t.setEnabled(e)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this._getTypeName()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return this._getTypeName()},e.prototype._getTypeName=function(){return"Control3D"},Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mesh",{get:function(){return this._node instanceof s.AbstractMesh?this._node:null},enumerable:!1,configurable:!0}),e.prototype.linkToTransformNode=function(e){return this._node&&(this._node.parent=e),this},e.prototype._prepareNode=function(e){if(!this._node){if(this._node=this._createNode(e),!this.node)return;this._node.metadata=this,this._node.position=this.position,this._node.scaling=this.scaling;var t=this.mesh;t&&(t.isPickable=!0,this._affectMaterial(t))}},e.prototype._createNode=function(e){return null},e.prototype._affectMaterial=function(e){e.material=null},e.prototype._onPointerMove=function(e,t){this.onPointerMoveObservable.notifyObservers(t,-1,e,this)},e.prototype._onPointerEnter=function(e){return!(this._enterCount>0)&&(-1===this._enterCount&&(this._enterCount=0),this._enterCount++,this.onPointerEnterObservable.notifyObservers(this,-1,e,this),this.pointerEnterAnimation&&this.pointerEnterAnimation(),!0)},e.prototype._onPointerOut=function(e){this._enterCount=0,this.onPointerOutObservable.notifyObservers(this,-1,e,this),this.pointerOutAnimation&&this.pointerOutAnimation()},e.prototype._onPointerDown=function(e,t,r,i){return 0!==this._downCount?(this._downCount++,!1):(this._downCount++,this._downPointerIds[r]=!0,this.onPointerDownObservable.notifyObservers(new ee(t,i),-1,e,this),this.pointerDownAnimation&&this.pointerDownAnimation(),!0)},e.prototype._onPointerUp=function(e,t,r,i,n){this._downCount--,delete this._downPointerIds[r],this._downCount<0?this._downCount=0:0==this._downCount&&(n&&(this._enterCount>0||-1===this._enterCount)&&this.onPointerClickObservable.notifyObservers(new ee(t,i),-1,e,this),this.onPointerUpObservable.notifyObservers(new ee(t,i),-1,e,this),this.pointerUpAnimation&&this.pointerUpAnimation())},e.prototype.forcePointerUp=function(e){if(void 0===e&&(e=null),null!==e)this._onPointerUp(this,s.Vector3.Zero(),e,0,!0);else{for(var t in this._downPointerIds)this._onPointerUp(this,s.Vector3.Zero(),+t,0,!0);this._downCount>0&&(this._downCount=1,this._onPointerUp(this,s.Vector3.Zero(),0,0,!0))}},e.prototype._processObservables=function(e,t,r,i){if(e===s.PointerEventTypes.POINTERMOVE){this._onPointerMove(this,t);var n=this._host._lastControlOver[r];return n&&n!==this&&n._onPointerOut(this),n!==this&&this._onPointerEnter(this),this._host._lastControlOver[r]=this,!0}return e===s.PointerEventTypes.POINTERDOWN?(this._onPointerDown(this,t,r,i),this._host._lastControlDown[r]=this,this._host._lastPickedControl=this,!0):(e===s.PointerEventTypes.POINTERUP||e===s.PointerEventTypes.POINTERDOUBLETAP)&&(this._host._lastControlDown[r]&&this._host._lastControlDown[r]._onPointerUp(this,t,r,i,!0),delete this._host._lastControlDown[r],!0)},e.prototype._disposeNode=function(){this._node&&(this._node.dispose(),this._node=null)},e.prototype.dispose=function(){this.onPointerDownObservable.clear(),this.onPointerEnterObservable.clear(),this.onPointerMoveObservable.clear(),this.onPointerOutObservable.clear(),this.onPointerUpObservable.clear(),this.onPointerClickObservable.clear(),this._disposeNode();for(var e=0,t=this._behaviors;e<t.length;e++)t[e].detach()},e}(),re=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype._getTypeName=function(){return"AbstractButton3D"},t.prototype._createNode=function(e){return new s.TransformNode("button"+this.name)},t}(te),ie=function(e){function t(t){var r=e.call(this,t)||this;return r._contentResolution=512,r._contentScaleRatio=2,r.pointerEnterAnimation=function(){r.mesh&&(r._currentMaterial.emissiveColor=s.Color3.Red())},r.pointerOutAnimation=function(){r._currentMaterial.emissiveColor=s.Color3.Black()},r.pointerDownAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(.95)},r.pointerUpAnimation=function(){r.mesh&&r.mesh.scaling.scaleInPlace(1/.95)},r}return n(t,e),Object.defineProperty(t.prototype,"contentResolution",{get:function(){return this._contentResolution},set:function(e){this._contentResolution!==e&&(this._contentResolution=e,this._resetContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentScaleRatio",{get:function(){return this._contentScaleRatio},set:function(e){this._contentScaleRatio!==e&&(this._contentScaleRatio=e,this._resetContent())},enumerable:!1,configurable:!0}),t.prototype._disposeFacadeTexture=function(){this._facadeTexture&&(this._facadeTexture.dispose(),this._facadeTexture=null)},t.prototype._resetContent=function(){this._disposeFacadeTexture(),this.content=this._content},Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this._host&&this._host.utilityLayer&&(this._facadeTexture?this._facadeTexture.rootContainer.clearControls():(this._facadeTexture=new Z("Facade",this._contentResolution,this._contentResolution,this._host.utilityLayer.utilityLayerScene,!0,s.Texture.TRILINEAR_SAMPLINGMODE),this._facadeTexture.rootContainer.scaleX=this._contentScaleRatio,this._facadeTexture.rootContainer.scaleY=this._contentScaleRatio,this._facadeTexture.premulAlpha=!0),this._facadeTexture.addControl(e),this._applyFacade(this._facadeTexture))},enumerable:!1,configurable:!0}),t.prototype._applyFacade=function(e){this._currentMaterial.emissiveTexture=e},t.prototype._getTypeName=function(){return"Button3D"},t.prototype._createNode=function(e){for(var t=new Array(6),r=0;r<6;r++)t[r]=new s.Vector4(0,0,0,0);return t[1]=new s.Vector4(0,0,1,1),s.BoxBuilder.CreateBox(this.name+"_rootMesh",{width:1,height:1,depth:.08,faceUV:t},e)},t.prototype._affectMaterial=function(e){var t=new s.StandardMaterial(this.name+"Material",e.getScene());t.specularColor=s.Color3.Black(),e.material=t,this._currentMaterial=t,this._resetContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeFacadeTexture(),this._currentMaterial&&this._currentMaterial.dispose()},t}(re),ne=function(e){function t(t){var r=e.call(this,t)||this;return r._blockLayout=!1,r._children=new Array,r}return n(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blockLayout",{get:function(){return this._blockLayout},set:function(e){this._blockLayout!==e&&(this._blockLayout=e,this._blockLayout||this._arrangeChildren())},enumerable:!1,configurable:!0}),t.prototype.updateLayout=function(){return this._arrangeChildren(),this},t.prototype.containsControl=function(e){return-1!==this._children.indexOf(e)},t.prototype.addControl=function(e){return-1!==this._children.indexOf(e)||(e.parent=this,e._host=this._host,this._children.push(e),this._host.utilityLayer&&(e._prepareNode(this._host.utilityLayer.utilityLayerScene),e.node&&(e.node.parent=this.node),this.blockLayout||this._arrangeChildren())),this},t.prototype._arrangeChildren=function(){},t.prototype._createNode=function(e){return new s.TransformNode("ContainerNode",e)},t.prototype.removeControl=function(e){var t=this._children.indexOf(e);return-1!==t&&(this._children.splice(t,1),e.parent=null,e._disposeNode()),this},t.prototype._getTypeName=function(){return"Container3D"},t.prototype.dispose=function(){for(var t=0,r=this._children;t<r.length;t++)r[t].dispose();this._children=[],e.prototype.dispose.call(this)},t.UNSET_ORIENTATION=0,t.FACEORIGIN_ORIENTATION=1,t.FACEORIGINREVERSED_ORIENTATION=2,t.FACEFORWARD_ORIENTATION=3,t.FACEFORWARDREVERSED_ORIENTATION=4,t}(te),oe=function(e){function t(){var t=e.call(this)||this;return t._columns=10,t._rows=0,t._rowThenColum=!0,t._orientation=ne.FACEORIGIN_ORIENTATION,t.margin=0,t}return n(t,e),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(e){var t=this;this._orientation!==e&&(this._orientation=e,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},set:function(e){var t=this;this._columns!==e&&(this._columns=e,this._rowThenColum=!0,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(e){var t=this;this._rows!==e&&(this._rows=e,this._rowThenColum=!1,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){this._cellWidth=0,this._cellHeight=0;for(var e=0,t=0,r=0,i=s.Matrix.Invert(this.node.computeWorldMatrix(!0)),n=0,o=this._children;n<o.length;n++)if((b=o[n]).mesh){r++,b.mesh.computeWorldMatrix(!0);var a=b.mesh.getHierarchyBoundingVectors(),l=s.TmpVectors.Vector3[0],h=s.TmpVectors.Vector3[1];a.max.subtractToRef(a.min,h),h.scaleInPlace(.5),s.Vector3.TransformNormalToRef(h,i,l),this._cellWidth=Math.max(this._cellWidth,2*l.x),this._cellHeight=Math.max(this._cellHeight,2*l.y)}this._cellWidth+=2*this.margin,this._cellHeight+=2*this.margin,this._rowThenColum?(t=this._columns,e=Math.ceil(r/this._columns)):(e=this._rows,t=Math.ceil(r/this._rows));var u=.5*t*this._cellWidth,c=.5*e*this._cellHeight,d=[],p=0;if(this._rowThenColum)for(var f=0;f<e;f++)for(var _=0;_<t&&(d.push(new s.Vector3(_*this._cellWidth-u+this._cellWidth/2,f*this._cellHeight-c+this._cellHeight/2,0)),!(++p>r));_++);else for(_=0;_<t;_++)for(f=0;f<e&&(d.push(new s.Vector3(_*this._cellWidth-u+this._cellWidth/2,f*this._cellHeight-c+this._cellHeight/2,0)),!(++p>r));f++);p=0;for(var g=0,m=this._children;g<m.length;g++){var b;(b=m[g]).mesh&&(this._mapGridNode(b,d[p]),p++)}this._finalProcessing()},t.prototype._finalProcessing=function(){},t}(ne),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return n(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var r=e.mesh;if(r){var i=this._cylindricalMapping(t);switch(e.position=i,this.orientation){case ne.FACEORIGIN_ORIENTATION:r.lookAt(new s.Vector3(2*i.x,i.y,2*i.z));break;case ne.FACEORIGINREVERSED_ORIENTATION:r.lookAt(new s.Vector3(-i.x,i.y,-i.z));break;case ne.FACEFORWARD_ORIENTATION:break;case ne.FACEFORWARDREVERSED_ORIENTATION:r.rotate(s.Axis.Y,Math.PI,s.Space.LOCAL)}}},t.prototype._cylindricalMapping=function(e){var t=new s.Vector3(0,e.y,this._radius),r=e.x/this._radius;return s.Matrix.RotationYawPitchRollToRef(r,0,0,s.TmpVectors.Matrix[0]),s.Vector3.TransformNormal(t,s.TmpVectors.Matrix[0])},t}(oe),ae="precision highp float;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 world;\nuniform mat4 viewProjection;\nvarying vec2 vUV;\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float borderWidth;\nuniform vec3 scaleFactor;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\n#endif\nvoid main(void) {\nvUV=uv;\n#ifdef BORDER\nvec3 scale=scaleFactor;\nfloat minScale=min(min(scale.x,scale.y),scale.z);\nfloat maxScale=max(max(scale.x,scale.y),scale.z);\nfloat minOverMiddleScale=minScale/(scale.x+scale.y+scale.z-minScale-maxScale);\nfloat areaYZ=scale.y*scale.z;\nfloat areaXZ=scale.x*scale.z;\nfloat areaXY=scale.x*scale.y;\nfloat scaledBorderWidth=borderWidth;\nif (abs(normal.x) == 1.0)\n{\nscale.x=scale.y;\nscale.y=scale.z;\nif (areaYZ>areaXZ && areaYZ>areaXY)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse if (abs(normal.y) == 1.0)\n{\nscale.x=scale.z;\nif (areaXZ>areaXY && areaXZ>areaYZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nelse\n{\nif (areaXY>areaYZ && areaXY>areaXZ)\n{\nscaledBorderWidth*=minOverMiddleScale;\n}\n}\nfloat scaleRatio=min(scale.x,scale.y)/max(scale.x,scale.y);\nif (scale.x>scale.y)\n{\nscaleInfo.x=1.0-(scaledBorderWidth*scaleRatio);\nscaleInfo.y=1.0-scaledBorderWidth;\n}\nelse\n{\nscaleInfo.x=1.0-scaledBorderWidth;\nscaleInfo.y=1.0-(scaledBorderWidth*scaleRatio);\n}\n#endif\nvec4 worldPos=world*vec4(position,1.0);\n#ifdef HOVERLIGHT\nworldPosition=worldPos.xyz;\n#endif\ngl_Position=viewProjection*worldPos;\n}\n";s.Effect.ShadersStore.fluentVertexShader=ae;var le="precision highp float;\nvarying vec2 vUV;\nuniform vec4 albedoColor;\n#ifdef INNERGLOW\nuniform vec4 innerGlowColor;\n#endif\n#ifdef BORDER\nvarying vec2 scaleInfo;\nuniform float edgeSmoothingValue;\nuniform float borderMinValue;\n#endif\n#ifdef HOVERLIGHT\nvarying vec3 worldPosition;\nuniform vec3 hoverPosition;\nuniform vec4 hoverColor;\nuniform float hoverRadius;\n#endif\n#ifdef TEXTURE\nuniform sampler2D albedoSampler;\n#endif\nvoid main(void) {\nvec3 albedo=albedoColor.rgb;\nfloat alpha=albedoColor.a;\n#ifdef TEXTURE\nalbedo=texture2D(albedoSampler,vUV).rgb;\n#endif\n#ifdef HOVERLIGHT\nfloat pointToHover=(1.0-clamp(length(hoverPosition-worldPosition)/hoverRadius,0.,1.))*hoverColor.a;\nalbedo=clamp(albedo+hoverColor.rgb*pointToHover,0.,1.);\n#else\nfloat pointToHover=1.0;\n#endif\n#ifdef BORDER\nfloat borderPower=10.0;\nfloat inverseBorderPower=1.0/borderPower;\nvec3 borderColor=albedo*borderPower;\nvec2 distanceToEdge;\ndistanceToEdge.x=abs(vUV.x-0.5)*2.0;\ndistanceToEdge.y=abs(vUV.y-0.5)*2.0;\nfloat borderValue=max(smoothstep(scaleInfo.x-edgeSmoothingValue,scaleInfo.x+edgeSmoothingValue,distanceToEdge.x),\nsmoothstep(scaleInfo.y-edgeSmoothingValue,scaleInfo.y+edgeSmoothingValue,distanceToEdge.y));\nborderColor=borderColor*borderValue*max(borderMinValue*inverseBorderPower,pointToHover);\nalbedo+=borderColor;\nalpha=max(alpha,borderValue);\n#endif\n#ifdef INNERGLOW\n\nvec2 uvGlow=(vUV-vec2(0.5,0.5))*(innerGlowColor.a*2.0);\nuvGlow=uvGlow*uvGlow;\nuvGlow=uvGlow*uvGlow;\nalbedo+=mix(vec3(0.0,0.0,0.0),innerGlowColor.rgb,uvGlow.x+uvGlow.y);\n#endif\ngl_FragColor=vec4(albedo,alpha);\n}";s.Effect.ShadersStore.fluentPixelShader=le;var he=function(e){function t(){var t=e.call(this)||this;return t.INNERGLOW=!1,t.BORDER=!1,t.HOVERLIGHT=!1,t.TEXTURE=!1,t.rebuild(),t}return n(t,e),t}(s.MaterialDefines),ue=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.innerGlowColorIntensity=.5,i.innerGlowColor=new s.Color3(1,1,1),i.albedoColor=new s.Color3(.3,.35,.4),i.renderBorders=!1,i.borderWidth=.5,i.edgeSmoothingValue=.02,i.borderMinValue=.1,i.renderHoverLight=!1,i.hoverRadius=1,i.hoverColor=new s.Color4(.3,.3,.3,1),i.hoverPosition=s.Vector3.Zero(),i}return n(t,e),t.prototype.needAlphaBlending=function(){return 1!==this.alpha},t.prototype.needAlphaTesting=function(){return!1},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.isReadyForSubMesh=function(e,t,r){if(this.isFrozen&&t.effect&&t.effect._wasPreviouslyReady)return!0;t._materialDefines||(t._materialDefines=new he);var i=this.getScene(),n=t._materialDefines;if(!this.checkReadyOnEveryCall&&t.effect&&n._renderId===i.getRenderId())return!0;if(n._areTexturesDirty)if(n.INNERGLOW=this.innerGlowColorIntensity>0,n.BORDER=this.renderBorders,n.HOVERLIGHT=this.renderHoverLight,this._albedoTexture){if(!this._albedoTexture.isReadyOrNotBlocking())return!1;n.TEXTURE=!0}else n.TEXTURE=!1;var o=i.getEngine();if(n.isDirty){n.markAsProcessed(),i.resetCachedMaterial();var a=[s.VertexBuffer.PositionKind];a.push(s.VertexBuffer.NormalKind),a.push(s.VertexBuffer.UVKind);var l=["world","viewProjection","innerGlowColor","albedoColor","borderWidth","edgeSmoothingValue","scaleFactor","borderMinValue","hoverColor","hoverPosition","hoverRadius"],h=["albedoSampler"],u=new Array;s.MaterialHelper.PrepareUniformsAndSamplersList({uniformsNames:l,uniformBuffersNames:u,samplers:h,defines:n,maxSimultaneousLights:4});var c=n.toString();t.setEffect(i.getEngine().createEffect("fluent",{attributes:a,uniformsNames:l,uniformBuffersNames:u,samplers:h,defines:c,fallbacks:null,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:4}},o))}return!(!t.effect||!t.effect.isReady())&&(n._renderId=i.getRenderId(),t.effect._wasPreviouslyReady=!0,!0)},t.prototype.bindForSubMesh=function(e,t,r){var i=this.getScene(),n=r._materialDefines;if(n){var o=r.effect;o&&(this._activeEffect=o,this.bindOnlyWorldMatrix(e),this._activeEffect.setMatrix("viewProjection",i.getTransformMatrix()),this._mustRebind(i,o)&&(this._activeEffect.setColor4("albedoColor",this.albedoColor,this.alpha),n.INNERGLOW&&this._activeEffect.setColor4("innerGlowColor",this.innerGlowColor,this.innerGlowColorIntensity),n.BORDER&&(this._activeEffect.setFloat("borderWidth",this.borderWidth),this._activeEffect.setFloat("edgeSmoothingValue",this.edgeSmoothingValue),this._activeEffect.setFloat("borderMinValue",this.borderMinValue),t.getBoundingInfo().boundingBox.extendSize.multiplyToRef(t.scaling,s.TmpVectors.Vector3[0]),this._activeEffect.setVector3("scaleFactor",s.TmpVectors.Vector3[0])),n.HOVERLIGHT&&(this._activeEffect.setDirectColor4("hoverColor",this.hoverColor),this._activeEffect.setFloat("hoverRadius",this.hoverRadius),this._activeEffect.setVector3("hoverPosition",this.hoverPosition)),n.TEXTURE&&this._activeEffect.setTexture("albedoSampler",this._albedoTexture)),this._afterBind(t,this._activeEffect))}},t.prototype.getActiveTextures=function(){return e.prototype.getActiveTextures.call(this)},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var r=this;return s.SerializationHelper.Clone((function(){return new t(e,r.getScene())}),this)},t.prototype.serialize=function(){var e=s.SerializationHelper.Serialize(this);return e.customType="BABYLON.GUI.FluentMaterial",e},t.prototype.getClassName=function(){return"FluentMaterial"},t.Parse=function(e,r,i){return s.SerializationHelper.Parse((function(){return new t(e.name,r)}),e,r,i)},o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"innerGlowColorIntensity",void 0),o([Object(s.serializeAsColor3)()],t.prototype,"innerGlowColor",void 0),o([Object(s.serializeAsColor3)()],t.prototype,"albedoColor",void 0),o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderBorders",void 0),o([Object(s.serialize)()],t.prototype,"borderWidth",void 0),o([Object(s.serialize)()],t.prototype,"edgeSmoothingValue",void 0),o([Object(s.serialize)()],t.prototype,"borderMinValue",void 0),o([Object(s.serialize)(),Object(s.expandToProperty)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"renderHoverLight",void 0),o([Object(s.serialize)()],t.prototype,"hoverRadius",void 0),o([Object(s.serializeAsColor4)()],t.prototype,"hoverColor",void 0),o([Object(s.serializeAsVector3)()],t.prototype,"hoverPosition",void 0),o([Object(s.serializeAsTexture)("albedoTexture")],t.prototype,"_albedoTexture",void 0),o([Object(s.expandToProperty)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"albedoTexture",void 0),t}(s.PushMaterial);s._TypeStore.RegisteredTypes["BABYLON.GUI.FluentMaterial"]=ue;var ce=function(e){function t(t,r){void 0===r&&(r=!0);var i=e.call(this,t)||this;return i._shareMaterials=!0,i._shareMaterials=r,i.pointerEnterAnimation=function(){i.mesh&&i._frontPlate.setEnabled(!0)},i.pointerOutAnimation=function(){i.mesh&&i._frontPlate.setEnabled(!1)},i}return n(t,e),t.prototype._disposeTooltip=function(){this._tooltipFade=null,this._tooltipTextBlock&&this._tooltipTextBlock.dispose(),this._tooltipTexture&&this._tooltipTexture.dispose(),this._tooltipMesh&&this._tooltipMesh.dispose(),this.onPointerEnterObservable.remove(this._tooltipHoverObserver),this.onPointerOutObservable.remove(this._tooltipOutObserver)},Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._backPlate.renderingGroupId},set:function(e){this._backPlate.renderingGroupId=e,this._textPlate.renderingGroupId=e,this._frontPlate.renderingGroupId=e,this._tooltipMesh&&(this._tooltipMesh.renderingGroupId=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltipText",{get:function(){return this._tooltipTextBlock?this._tooltipTextBlock.text:null},set:function(e){var t=this;if(e){if(!this._tooltipFade){this._tooltipMesh=s.PlaneBuilder.CreatePlane("",{size:1},this._backPlate._scene);var r=s.PlaneBuilder.CreatePlane("",{size:1,sideOrientation:s.Mesh.DOUBLESIDE},this._backPlate._scene),i=new s.StandardMaterial("",this._backPlate._scene);i.diffuseColor=s.Color3.FromHexString("#212121"),r.material=i,r.isPickable=!1,this._tooltipMesh.addChild(r),r.position.z=.05,this._tooltipMesh.scaling.y=1/3,this._tooltipMesh.position.y=.7,this._tooltipMesh.position.z=-.15,this._tooltipMesh.isPickable=!1,this._tooltipMesh.parent=this._backPlate,this._tooltipTexture=Z.CreateForMesh(this._tooltipMesh),this._tooltipTextBlock=new y,this._tooltipTextBlock.scaleY=3,this._tooltipTextBlock.color="white",this._tooltipTextBlock.fontSize=130,this._tooltipTexture.addControl(this._tooltipTextBlock),this._tooltipFade=new s.FadeInOutBehavior,this._tooltipFade.delay=500,this._tooltipMesh.addBehavior(this._tooltipFade),this._tooltipHoverObserver=this.onPointerEnterObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!0)})),this._tooltipOutObserver=this.onPointerOutObservable.add((function(){t._tooltipFade&&t._tooltipFade.fadeIn(!1)}))}this._tooltipTextBlock&&(this._tooltipTextBlock.text=e)}else this._disposeTooltip()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl!==e&&(this._imageUrl=e,this._rebuildContent())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backMaterial",{get:function(){return this._backMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontMaterial",{get:function(){return this._frontMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plateMaterial",{get:function(){return this._plateMaterial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shareMaterials",{get:function(){return this._shareMaterials},enumerable:!1,configurable:!0}),t.prototype._getTypeName=function(){return"HolographicButton"},t.prototype._rebuildContent=function(){this._disposeFacadeTexture();var e=new O;if(e.isVertical=!0,this._imageUrl){var t=new v;t.source=this._imageUrl,t.paddingTop="40px",t.height="180px",t.width="100px",t.paddingBottom="40px",e.addControl(t)}if(this._text){var r=new y;r.text=this._text,r.color="white",r.height="30px",r.fontSize=24,e.addControl(r)}this._frontPlate&&(this.content=e)},t.prototype._createNode=function(t){return this._backPlate=s.BoxBuilder.CreateBox(this.name+"BackMesh",{width:1,height:1,depth:.08},t),this._frontPlate=s.BoxBuilder.CreateBox(this.name+"FrontMesh",{width:1,height:1,depth:.08},t),this._frontPlate.parent=this._backPlate,this._frontPlate.position.z=-.08,this._frontPlate.isPickable=!1,this._frontPlate.setEnabled(!1),this._textPlate=e.prototype._createNode.call(this,t),this._textPlate.parent=this._backPlate,this._textPlate.position.z=-.08,this._textPlate.isPickable=!1,this._backPlate},t.prototype._applyFacade=function(e){this._plateMaterial.emissiveTexture=e,this._plateMaterial.opacityTexture=e},t.prototype._createBackMaterial=function(e){var t=this;this._backMaterial=new ue(this.name+"Back Material",e.getScene()),this._backMaterial.renderHoverLight=!0,this._pickedPointObserver=this._host.onPickedPointChangedObservable.add((function(e){e?(t._backMaterial.hoverPosition=e,t._backMaterial.hoverColor.a=1):t._backMaterial.hoverColor.a=0}))},t.prototype._createFrontMaterial=function(e){this._frontMaterial=new ue(this.name+"Front Material",e.getScene()),this._frontMaterial.innerGlowColorIntensity=0,this._frontMaterial.alpha=.5,this._frontMaterial.renderBorders=!0},t.prototype._createPlateMaterial=function(e){this._plateMaterial=new s.StandardMaterial(this.name+"Plate Material",e.getScene()),this._plateMaterial.specularColor=s.Color3.Black()},t.prototype._affectMaterial=function(e){this._shareMaterials?(this._host._sharedMaterials.backFluentMaterial?this._backMaterial=this._host._sharedMaterials.backFluentMaterial:(this._createBackMaterial(e),this._host._sharedMaterials.backFluentMaterial=this._backMaterial),this._host._sharedMaterials.frontFluentMaterial?this._frontMaterial=this._host._sharedMaterials.frontFluentMaterial:(this._createFrontMaterial(e),this._host._sharedMaterials.frontFluentMaterial=this._frontMaterial)):(this._createBackMaterial(e),this._createFrontMaterial(e)),this._createPlateMaterial(e),this._backPlate.material=this._backMaterial,this._frontPlate.material=this._frontMaterial,this._textPlate.material=this._plateMaterial,this._rebuildContent()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeTooltip(),this.shareMaterials||(this._backMaterial.dispose(),this._frontMaterial.dispose(),this._plateMaterial.dispose(),this._pickedPointObserver&&(this._host.onPickedPointChangedObservable.remove(this._pickedPointObserver),this._pickedPointObserver=null))},t}(ie),de=function(e){function t(t,r){var i=e.call(this,r)||this;return i._currentMesh=t,i.pointerEnterAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1.1)},i.pointerOutAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1/1.1)},i.pointerDownAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(.95)},i.pointerUpAnimation=function(){i.mesh&&i.mesh.scaling.scaleInPlace(1/.95)},i}return n(t,e),t.prototype._getTypeName=function(){return"MeshButton3D"},t.prototype._createNode=function(e){var t=this;return this._currentMesh.getChildMeshes().forEach((function(e){e.metadata=t})),this._currentMesh},t.prototype._affectMaterial=function(e){},t}(ie),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._mapGridNode=function(e,t){var r=e.mesh;if(r){e.position=t.clone();var i=s.TmpVectors.Vector3[0];switch(i.copyFrom(t),this.orientation){case ne.FACEORIGIN_ORIENTATION:case ne.FACEFORWARD_ORIENTATION:i.addInPlace(new s.Vector3(0,0,1)),r.lookAt(i);break;case ne.FACEFORWARDREVERSED_ORIENTATION:case ne.FACEORIGINREVERSED_ORIENTATION:i.addInPlace(new s.Vector3(0,0,-1)),r.lookAt(i)}}},t}(oe),fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._iteration=100,t}return n(t,e),Object.defineProperty(t.prototype,"iteration",{get:function(){return this._iteration},set:function(e){var t=this;this._iteration!==e&&(this._iteration=e,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var r=e.mesh,i=this._scatterMapping(t);if(r){switch(this.orientation){case ne.FACEORIGIN_ORIENTATION:case ne.FACEFORWARD_ORIENTATION:r.lookAt(new s.Vector3(0,0,1));break;case ne.FACEFORWARDREVERSED_ORIENTATION:case ne.FACEORIGINREVERSED_ORIENTATION:r.lookAt(new s.Vector3(0,0,-1))}e.position=i}},t.prototype._scatterMapping=function(e){return e.x=(1-2*Math.random())*this._cellWidth,e.y=(1-2*Math.random())*this._cellHeight,e},t.prototype._finalProcessing=function(){for(var e=[],t=0,r=this._children;t<r.length;t++){var i=r[t];i.mesh&&e.push(i.mesh)}for(var n=0;n<this._iteration;n++){e.sort((function(e,t){var r=e.position.lengthSquared(),i=t.position.lengthSquared();return r<i?1:r>i?-1:0}));for(var o=Math.pow(this.margin,2),a=Math.max(this._cellWidth,this._cellHeight),l=s.TmpVectors.Vector2[0],h=s.TmpVectors.Vector3[0],u=0;u<e.length-1;u++)for(var c=u+1;c<e.length;c++)if(u!=c){e[c].position.subtractToRef(e[u].position,h),l.x=h.x,l.y=h.y;var d=a,p=l.lengthSquared()-o;(p-=Math.min(p,o))<Math.pow(d,2)&&(l.normalize(),h.scaleInPlace(.5*(d-Math.sqrt(p))),e[c].position.addInPlace(h),e[u].position.subtractInPlace(h))}}},t}(oe),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._radius=5,t}return n(t,e),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){var t=this;this._radius!==e&&(this._radius=e,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._mapGridNode=function(e,t){var r=e.mesh;if(r){var i=this._sphericalMapping(t);switch(e.position=i,this.orientation){case ne.FACEORIGIN_ORIENTATION:r.lookAt(new s.Vector3(2*i.x,2*i.y,2*i.z));break;case ne.FACEORIGINREVERSED_ORIENTATION:r.lookAt(new s.Vector3(-i.x,-i.y,-i.z));break;case ne.FACEFORWARD_ORIENTATION:break;case ne.FACEFORWARDREVERSED_ORIENTATION:r.rotate(s.Axis.Y,Math.PI,s.Space.LOCAL)}}},t.prototype._sphericalMapping=function(e){var t=new s.Vector3(0,0,this._radius),r=e.y/this._radius,i=-e.x/this._radius;return s.Matrix.RotationYawPitchRollToRef(i,r,0,s.TmpVectors.Matrix[0]),s.Vector3.TransformNormal(t,s.TmpVectors.Matrix[0])},t}(oe),ge=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._isVertical=!1,r.margin=.1,r._isVertical=t,r}return n(t,e),Object.defineProperty(t.prototype,"isVertical",{get:function(){return this._isVertical},set:function(e){var t=this;this._isVertical!==e&&(this._isVertical=e,s.Tools.SetImmediate((function(){t._arrangeChildren()})))},enumerable:!1,configurable:!0}),t.prototype._arrangeChildren=function(){for(var e,t=0,r=0,i=0,n=[],o=s.Matrix.Invert(this.node.computeWorldMatrix(!0)),a=0,l=this._children;a<l.length;a++)if((f=l[a]).mesh){i++,f.mesh.computeWorldMatrix(!0),f.mesh.getWorldMatrix().multiplyToRef(o,s.TmpVectors.Matrix[0]);var h=f.mesh.getBoundingInfo().boundingBox,u=s.Vector3.TransformNormal(h.extendSize,s.TmpVectors.Matrix[0]);n.push(u),this._isVertical?r+=u.y:t+=u.x}this._isVertical?r+=(i-1)*this.margin/2:t+=(i-1)*this.margin/2,e=this._isVertical?-r:-t;for(var c=0,d=0,p=this._children;d<p.length;d++){var f;(f=p[d]).mesh&&(i--,u=n[c++],this._isVertical?(f.position.y=e+u.y,f.position.x=0,e+=2*u.y):(f.position.x=e+u.x,f.position.y=0,e+=2*u.x),e+=i>0?this.margin:0)}},t}(ne),me=function(){function e(e){var t=this;this._lastControlOver={},this._lastControlDown={},this.onPickedPointChangedObservable=new s.Observable,this._sharedMaterials={},this._scene=e||s.EngineStore.LastCreatedScene,this._sceneDisposeObserver=this._scene.onDisposeObservable.add((function(){t._sceneDisposeObserver=null,t._utilityLayer=null,t.dispose()})),this._utilityLayer=new s.UtilityLayerRenderer(this._scene),this._utilityLayer.onlyCheckPointerDownEvents=!1,this._utilityLayer.pickUtilitySceneFirst=!1,this._utilityLayer.mainSceneTrackerPredicate=function(e){return e&&e.metadata&&e.metadata._node},this._rootContainer=new ne("RootContainer"),this._rootContainer._host=this;var r=this._utilityLayer.utilityLayerScene;this._pointerOutObserver=this._utilityLayer.onPointerOutObservable.add((function(e){t._handlePointerOut(e,!0)})),this._pointerObserver=r.onPointerObservable.add((function(e,r){t._doPicking(e)})),this._utilityLayer.utilityLayerScene.autoClear=!1,this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!1,new s.HemisphericLight("hemi",s.Vector3.Up(),this._utilityLayer.utilityLayerScene)}return Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!1,configurable:!0}),e.prototype._handlePointerOut=function(e,t){var r=this._lastControlOver[e];r&&(r._onPointerOut(r),delete this._lastControlOver[e]),t&&this._lastControlDown[e]&&(this._lastControlDown[e].forcePointerUp(),delete this._lastControlDown[e]),this.onPickedPointChangedObservable.notifyObservers(null)},e.prototype._doPicking=function(e){if(!this._utilityLayer||!this._utilityLayer.shouldRender||!this._utilityLayer.utilityLayerScene.activeCamera)return!1;var t=e.event,r=t.pointerId||0,i=t.button,n=e.pickInfo;if(!n||!n.hit)return this._handlePointerOut(r,e.type===s.PointerEventTypes.POINTERUP),!1;var o=n.pickedMesh.metadata;return n.pickedPoint&&this.onPickedPointChangedObservable.notifyObservers(n.pickedPoint),o._processObservables(e.type,n.pickedPoint,r,i)||e.type===s.PointerEventTypes.POINTERMOVE&&(this._lastControlOver[r]&&this._lastControlOver[r]._onPointerOut(this._lastControlOver[r]),delete this._lastControlOver[r]),e.type===s.PointerEventTypes.POINTERUP&&(this._lastControlDown[t.pointerId]&&(this._lastControlDown[t.pointerId].forcePointerUp(),delete this._lastControlDown[t.pointerId]),"touch"===t.pointerType&&this._handlePointerOut(r,!1)),!0},Object.defineProperty(e.prototype,"rootContainer",{get:function(){return this._rootContainer},enumerable:!1,configurable:!0}),e.prototype.containsControl=function(e){return this._rootContainer.containsControl(e)},e.prototype.addControl=function(e){return this._rootContainer.addControl(e),this},e.prototype.removeControl=function(e){return this._rootContainer.removeControl(e),this},e.prototype.dispose=function(){for(var e in this._rootContainer.dispose(),this._sharedMaterials)this._sharedMaterials.hasOwnProperty(e)&&this._sharedMaterials[e].dispose();this._sharedMaterials={},this._pointerOutObserver&&this._utilityLayer&&(this._utilityLayer.onPointerOutObservable.remove(this._pointerOutObserver),this._pointerOutObserver=null),this.onPickedPointChangedObservable.clear();var t=this._utilityLayer?this._utilityLayer.utilityLayerScene:null;t&&this._pointerObserver&&(t.onPointerObservable.remove(this._pointerObserver),this._pointerObserver=null),this._scene&&this._sceneDisposeObserver&&(this._scene.onDisposeObservable.remove(this._sceneDisposeObserver),this._sceneDisposeObserver=null),this._utilityLayer&&this._utilityLayer.dispose()},e}()},function(e,t,r){"use strict";r.r(t),function(e){var i=r(1);r.d(t,"Button",(function(){return i.Button})),r.d(t,"Checkbox",(function(){return i.Checkbox})),r.d(t,"ColorPicker",(function(){return i.ColorPicker})),r.d(t,"Container",(function(){return i.Container})),r.d(t,"Control",(function(){return i.Control})),r.d(t,"Ellipse",(function(){return i.Ellipse})),r.d(t,"Grid",(function(){return i.Grid})),r.d(t,"Image",(function(){return i.Image})),r.d(t,"InputText",(function(){return i.InputText})),r.d(t,"InputPassword",(function(){return i.InputPassword})),r.d(t,"Line",(function(){return i.Line})),r.d(t,"MultiLine",(function(){return i.MultiLine})),r.d(t,"RadioButton",(function(){return i.RadioButton})),r.d(t,"StackPanel",(function(){return i.StackPanel})),r.d(t,"SelectorGroup",(function(){return i.SelectorGroup})),r.d(t,"CheckboxGroup",(function(){return i.CheckboxGroup})),r.d(t,"RadioGroup",(function(){return i.RadioGroup})),r.d(t,"SliderGroup",(function(){return i.SliderGroup})),r.d(t,"SelectionPanel",(function(){return i.SelectionPanel})),r.d(t,"ScrollViewer",(function(){return i.ScrollViewer})),r.d(t,"TextWrapping",(function(){return i.TextWrapping})),r.d(t,"TextBlock",(function(){return i.TextBlock})),r.d(t,"TextWrapper",(function(){return i.TextWrapper})),r.d(t,"KeyPropertySet",(function(){return i.KeyPropertySet})),r.d(t,"VirtualKeyboard",(function(){return i.VirtualKeyboard})),r.d(t,"Rectangle",(function(){return i.Rectangle})),r.d(t,"DisplayGrid",(function(){return i.DisplayGrid})),r.d(t,"BaseSlider",(function(){return i.BaseSlider})),r.d(t,"Slider",(function(){return i.Slider})),r.d(t,"ImageBasedSlider",(function(){return i.ImageBasedSlider})),r.d(t,"ScrollBar",(function(){return i.ScrollBar})),r.d(t,"ImageScrollBar",(function(){return i.ImageScrollBar})),r.d(t,"name",(function(){return i.name})),r.d(t,"AdvancedDynamicTexture",(function(){return i.AdvancedDynamicTexture})),r.d(t,"AdvancedDynamicTextureInstrumentation",(function(){return i.AdvancedDynamicTextureInstrumentation})),r.d(t,"Vector2WithInfo",(function(){return i.Vector2WithInfo})),r.d(t,"Matrix2D",(function(){return i.Matrix2D})),r.d(t,"Measure",(function(){return i.Measure})),r.d(t,"MultiLinePoint",(function(){return i.MultiLinePoint})),r.d(t,"Style",(function(){return i.Style})),r.d(t,"ValueAndUnit",(function(){return i.ValueAndUnit})),r.d(t,"XmlLoader",(function(){return i.XmlLoader})),r.d(t,"AbstractButton3D",(function(){return i.AbstractButton3D})),r.d(t,"Button3D",(function(){return i.Button3D})),r.d(t,"Container3D",(function(){return i.Container3D})),r.d(t,"Control3D",(function(){return i.Control3D})),r.d(t,"CylinderPanel",(function(){return i.CylinderPanel})),r.d(t,"HolographicButton",(function(){return i.HolographicButton})),r.d(t,"MeshButton3D",(function(){return i.MeshButton3D})),r.d(t,"PlanePanel",(function(){return i.PlanePanel})),r.d(t,"ScatterPanel",(function(){return i.ScatterPanel})),r.d(t,"SpherePanel",(function(){return i.SpherePanel})),r.d(t,"StackPanel3D",(function(){return i.StackPanel3D})),r.d(t,"VolumeBasedPanel",(function(){return i.VolumeBasedPanel})),r.d(t,"FluentMaterialDefines",(function(){return i.FluentMaterialDefines})),r.d(t,"FluentMaterial",(function(){return i.FluentMaterial})),r.d(t,"GUI3DManager",(function(){return i.GUI3DManager})),r.d(t,"Vector3WithInfo",(function(){return i.Vector3WithInfo}));var n=void 0!==e?e:"undefined"!=typeof window?window:void 0;void 0!==n&&(n.BABYLON=n.BABYLON||{},n.BABYLON.GUI=i)}.call(this,r(3))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])}))}).call(this,r("c8ba"))},"714b":function(e,t,r){"use strict";var i=r("8336"),n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"modal-bg",on:{click:e.hideModal}},[t("div",{staticClass:"modal-container",on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[e._v(" "+e._s(e.title)+" ")]),t("div",{staticClass:"modal-main"},[e._t("default")],2),t("div",{staticClass:"modal-footer"},[t(i["a"],{attrs:{color:"green darken-1",text:""},on:{click:function(t){return t.stopPropagation(),e.submit.apply(null,arguments)}}},[e._v(" 保存 ")])],1)])])},o=[],s={name:"modal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""}},methods:{hideModal(){this.$emit("hideModal")},submit(){this.$emit("submit")}}},a=s,l=(r("6cd8"),r("2877")),h=Object(l["a"])(a,n,o,!1,null,"84d82d18",null);t["a"]=h.exports},"75eb":function(e,t,r){"use strict";var i=r("9d65"),n=r("80d2"),o=r("58df"),s=r("d9bd");function a(e){const t=typeof e;return"boolean"===t||"string"===t||e.nodeType===Node.ELEMENT_NODE}function l(e){e.forEach(e=>{e.elm&&e.elm.parentNode&&e.elm.parentNode.removeChild(e.elm)})}t["a"]=Object(o["a"])(i["a"]).extend({name:"detachable",props:{attach:{default:!1,validator:a},contentClass:{type:String,default:""}},data:()=>({activatorNode:null,hasDetached:!1}),watch:{attach(){this.hasDetached=!1,this.initDetach()},hasContent(){this.$nextTick(this.initDetach)}},beforeMount(){this.$nextTick(()=>{if(this.activatorNode){const e=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];e.forEach(e=>{if(!e.elm)return;if(!this.$el.parentNode)return;const t=this.$el===this.$el.parentNode.firstChild?this.$el:this.$el.nextSibling;this.$el.parentNode.insertBefore(e.elm,t)})}})},mounted(){this.hasContent&&this.initDetach()},deactivated(){this.isActive=!1},beforeDestroy(){this.$refs.content&&this.$refs.content.parentNode&&this.$refs.content.parentNode.removeChild(this.$refs.content)},destroyed(){if(this.activatorNode){const e=Array.isArray(this.activatorNode)?this.activatorNode:[this.activatorNode];if(this.$el.isConnected){const t=new MutationObserver(r=>{r.some(e=>Array.from(e.removedNodes).includes(this.$el))&&(t.disconnect(),l(e))});t.observe(this.$el.parentNode,{subtree:!1,childList:!0})}else l(e)}},methods:{getScopeIdAttrs(){const e=Object(n["o"])(this.$vnode,"context.$options._scopeId");return e&&{[e]:""}},initDetach(){if(this._isDestroyed||!this.$refs.content||this.hasDetached||""===this.attach||!0===this.attach||"attach"===this.attach)return;let e;e=!1===this.attach?document.querySelector("[data-app]"):"string"===typeof this.attach?document.querySelector(this.attach):this.attach,e?(e.appendChild(this.$refs.content),this.hasDetached=!0):Object(s["c"])("Unable to locate target "+(this.attach||"[data-app]"),this)}}})},7724:function(module,exports,__webpack_require__){(function(e,t){module.exports=t()})(0,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/js-interpreter.js")}({"./node_modules/vm-browserify/index.js":
/*!*********************************************!*\
  !*** ./node_modules/vm-browserify/index.js ***!
  \*********************************************/
/*! no static exports found */function(module,exports){var indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e)t.push(r);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,r){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:r})}}catch(e){return function(e,t,r){e[t]=r}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var r=t.contentWindow,i=r.eval,n=r.execScript;!i&&n&&(n.call(r,"null"),i=r.eval),forEach(Object_keys(e),(function(t){r[t]=e[t]})),forEach(globals,(function(t){e[t]&&(r[t]=e[t])}));var o=Object_keys(r),s=i.call(r,this.code);return forEach(Object_keys(r),(function(t){(t in e||-1===indexOf(o,t))&&(e[t]=r[t])})),forEach(globals,(function(t){t in e||defineProp(e,t,r[t])})),document.body.removeChild(t),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),r=this.runInContext(t);return e&&forEach(Object_keys(t),(function(r){e[r]=t[r]})),r},forEach(Object_keys(Script.prototype),(function(e){exports[e]=Script[e]=function(t){var r=Script(t);return r[e].apply(r,[].slice.call(arguments,1))}})),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"===typeof e&&forEach(Object_keys(e),(function(r){t[r]=e[r]})),t}},"./original-repo/acorn.js":
/*!********************************!*\
  !*** ./original-repo/acorn.js ***!
  \********************************/
/*! no static exports found */function(e,t,r){(function(e,r){r(t)})(0,(function(e){"use strict";var t,r,i,n;e.version="0.4.1",e.parse=function(e,n){return r=String(e),i=r.length,s(n),Ye(),Pt(t.program)};var o=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function s(e){for(var r in t=e||{},o)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=o[r]);n=t.sourceFile||null}var a,l,h,u,c,d,p,f,_,g,m,b,y,v,T,O,E=e.getLineInfo=function(e,t){for(var r=1,i=0;;){Ge.lastIndex=i;var n=Ge.exec(e);if(!(n&&n.index<t))break;++r,i=n.index+n[0].length}return{line:r,column:t-i}};function A(e,t){var i=E(r,e);t+=" ("+i.line+":"+i.column+")";var n=new SyntaxError(t);throw n.pos=e,n.loc=i,n.raisedAt=a,n}e.tokenize=function(e,n){r=String(e),i=r.length,s(n),Ye();var o={};function m(e){return at(e),o.start=l,o.end=h,o.startLoc=u,o.endLoc=c,o.type=d,o.value=p,o}return m.jumpTo=function(e,i){if(a=e,t.locations){var n;_=1,g=Ge.lastIndex=0;while((n=Ge.exec(r))&&n.index<e)++_,g=n.index+n[0].length}f=i,Ze()},m};var C=[],M={type:"num"},x={type:"regexp"},w={type:"string"},S={type:"name"},R={type:"eof"},P={keyword:"break"},I={keyword:"case",beforeExpr:!0},L={keyword:"catch"},N={keyword:"continue"},k={keyword:"debugger"},D={keyword:"default"},B={keyword:"do",isLoop:!0},F={keyword:"else",beforeExpr:!0},V={keyword:"finally"},H={keyword:"for",isLoop:!0},j={keyword:"function"},U={keyword:"if"},G={keyword:"return",beforeExpr:!0},W={keyword:"switch"},z={keyword:"throw",beforeExpr:!0},X={keyword:"try"},Y={keyword:"var"},K={keyword:"while",isLoop:!0},$={keyword:"with"},q={keyword:"new",beforeExpr:!0},Z={keyword:"this"},J={keyword:"null",atomValue:null},Q={keyword:"true",atomValue:!0},ee={keyword:"false",atomValue:!1},te={keyword:"in",binop:7,beforeExpr:!0},re={break:P,case:I,catch:L,continue:N,debugger:k,default:D,do:B,else:F,finally:V,for:H,function:j,if:U,return:G,switch:W,throw:z,try:X,var:Y,while:K,with:$,null:J,true:Q,false:ee,new:q,in:te,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Z,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},ie={type:"[",beforeExpr:!0},ne={type:"]"},oe={type:"{",beforeExpr:!0},se={type:"}"},ae={type:"(",beforeExpr:!0},le={type:")"},he={type:",",beforeExpr:!0},ue={type:";",beforeExpr:!0},ce={type:":",beforeExpr:!0},de={type:"."},pe={type:"?",beforeExpr:!0},fe={binop:10,beforeExpr:!0},_e={isAssign:!0,beforeExpr:!0},ge={isAssign:!0,beforeExpr:!0},me={postfix:!0,prefix:!0,isUpdate:!0},be={prefix:!0,beforeExpr:!0},ye={binop:1,beforeExpr:!0},ve={binop:2,beforeExpr:!0},Te={binop:3,beforeExpr:!0},Oe={binop:4,beforeExpr:!0},Ee={binop:5,beforeExpr:!0},Ae={binop:6,beforeExpr:!0},Ce={binop:7,beforeExpr:!0},Me={binop:8,beforeExpr:!0},xe={binop:9,prefix:!0,beforeExpr:!0},we={binop:10,beforeExpr:!0};for(var Se in e.tokTypes={bracketL:ie,bracketR:ne,braceL:oe,braceR:se,parenL:ae,parenR:le,comma:he,semi:ue,colon:ce,dot:de,question:pe,slash:fe,eq:_e,name:S,eof:R,num:M,regexp:x,string:w},re)e.tokTypes["_"+Se]=re[Se];function Re(e){e=e.split(" ");var t="",r=[];e:for(var i=0;i<e.length;++i){for(var n=0;n<r.length;++n)if(r[n][0].length==e[i].length){r[n].push(e[i]);continue e}r.push([e[i]])}function o(e){if(1==e.length)return t+="return str === "+JSON.stringify(e[0])+";";t+="switch(str){";for(var r=0;r<e.length;++r)t+="case "+JSON.stringify(e[r])+":";t+="return true}return false;"}if(r.length>3){r.sort((function(e,t){return t.length-e.length})),t+="switch(str.length){";for(i=0;i<r.length;++i){var s=r[i];t+="case "+s[0].length+":",o(s)}t+="}"}else o(e);return new Function("str",t)}var Pe,Ie=Re("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Le=Re("class enum extends super const export import"),Ne=Re("implements interface let package private protected public static yield"),ke=Re("eval arguments"),De=Re("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Be=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Fe="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Ve="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",He=new RegExp("["+Fe+"]"),je=new RegExp("["+Fe+Ve+"]"),Ue=/[\n\r\u2028\u2029]/,Ge=/\r\n|[\n\r\u2028\u2029]/g,We=e.isIdentifierStart=function(e){return e<65?36===e:e<91||(e<97?95===e:e<123||e>=170&&He.test(String.fromCharCode(e)))},ze=e.isIdentifierChar=function(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>=170&&je.test(String.fromCharCode(e))))};function Xe(){this.line=_,this.column=a-g}function Ye(){_=1,a=g=0,f=!0,Ze()}function Ke(e,r){h=a,t.locations&&(c=new Xe),d=e,Ze(),p=r,f=e.beforeExpr}function $e(){var e=t.onComment&&t.locations&&new Xe,i=a,n=r.indexOf("*/",a+=2);if(-1===n&&A(a-2,"Unterminated comment"),a=n+2,t.locations){var o;Ge.lastIndex=i;while((o=Ge.exec(r))&&o.index<a)++_,g=o.index+o[0].length}t.onComment&&t.onComment(!0,r.slice(i+2,n),i,a,e,t.locations&&new Xe)}function qe(){var e=a,n=t.onComment&&t.locations&&new Xe,o=r.charCodeAt(a+=2);while(a<i&&10!==o&&13!==o&&8232!==o&&8233!==o)++a,o=r.charCodeAt(a);t.onComment&&t.onComment(!1,r.slice(e+2,a),e,a,n,t.locations&&new Xe)}function Ze(){while(a<i){var e=r.charCodeAt(a);if(32===e)++a;else if(13===e){++a;var n=r.charCodeAt(a);10===n&&++a,t.locations&&(++_,g=a)}else if(10===e||8232===e||8233===e)++a,t.locations&&(++_,g=a);else if(e>8&&e<14)++a;else if(47===e){n=r.charCodeAt(a+1);if(42===n)$e();else{if(47!==n)break;qe()}}else if(160===e)++a;else{if(!(e>=5760&&Be.test(String.fromCharCode(e))))break;++a}}}function Je(){var e=r.charCodeAt(a+1);return e>=48&&e<=57?dt(!0):(++a,Ke(de))}function Qe(){var e=r.charCodeAt(a+1);return f?(++a,ht()):61===e?lt(ge,2):lt(fe,1)}function et(){var e=r.charCodeAt(a+1);return 61===e?lt(ge,2):lt(we,1)}function tt(e){var t=r.charCodeAt(a+1);return t===e?lt(124===e?ye:ve,2):61===t?lt(ge,2):lt(124===e?Te:Ee,1)}function rt(){var e=r.charCodeAt(a+1);return 61===e?lt(ge,2):lt(Oe,1)}function it(e){var t=r.charCodeAt(a+1);return t===e?45==t&&62==r.charCodeAt(a+2)&&Ue.test(r.slice(b,a))?(a+=3,qe(),Ze(),at()):lt(me,2):61===t?lt(ge,2):lt(xe,1)}function nt(e){var t=r.charCodeAt(a+1),i=1;return t===e?(i=62===e&&62===r.charCodeAt(a+2)?3:2,61===r.charCodeAt(a+i)?lt(ge,i+1):lt(Me,i)):33==t&&60==e&&45==r.charCodeAt(a+2)&&45==r.charCodeAt(a+3)?(a+=4,qe(),Ze(),at()):(61===t&&(i=61===r.charCodeAt(a+2)?3:2),lt(Ce,i))}function ot(e){var t=r.charCodeAt(a+1);return 61===t?lt(Ae,61===r.charCodeAt(a+2)?3:2):lt(61===e?_e:be,1)}function st(e){switch(e){case 46:return Je();case 40:return++a,Ke(ae);case 41:return++a,Ke(le);case 59:return++a,Ke(ue);case 44:return++a,Ke(he);case 91:return++a,Ke(ie);case 93:return++a,Ke(ne);case 123:return++a,Ke(oe);case 125:return++a,Ke(se);case 58:return++a,Ke(ce);case 63:return++a,Ke(pe);case 48:var t=r.charCodeAt(a+1);if(120===t||88===t)return ct();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return dt(!1);case 34:case 39:return pt(e);case 47:return Qe(e);case 37:case 42:return et();case 124:case 38:return tt(e);case 94:return rt();case 43:case 45:return it(e);case 60:case 62:return nt(e);case 61:case 33:return ot(e);case 126:return lt(be,1)}return!1}function at(e){if(e?a=l+1:l=a,t.locations&&(u=new Xe),e)return ht();if(a>=i)return Ke(R);var n=r.charCodeAt(a);if(We(n)||92===n)return gt();var o=st(n);if(!1===o){var s=String.fromCharCode(n);if("\\"===s||He.test(s))return gt();A(a,"Unexpected character '"+s+"'")}return o}function lt(e,t){var i=r.slice(a,a+t);a+=t,Ke(e,i)}function ht(){for(var e,t,n="",o=a;;){a>=i&&A(o,"Unterminated regular expression");var s=r.charAt(a);if(Ue.test(s)&&A(o,"Unterminated regular expression"),e)e=!1;else{if("["===s)t=!0;else if("]"===s&&t)t=!1;else if("/"===s&&!t)break;e="\\"===s}++a}n=r.slice(o,a);++a;var l=_t();return l&&!/^[gmsiy]*$/.test(l)&&A(o,"Invalid regexp flag"),Ke(x,new RegExp(n,l))}function ut(e,t){for(var i=a,n=0,o=0,s=null==t?1/0:t;o<s;++o){var l,h=r.charCodeAt(a);if(l=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0,l>=e)break;++a,n=n*e+l}return a===i||null!=t&&a-i!==t?null:n}function ct(){a+=2;var e=ut(16);return null==e&&A(l+2,"Expected hexadecimal number"),We(r.charCodeAt(a))&&A(a,"Identifier directly after number"),Ke(M,e)}function dt(e){var t=a,i=!1,n=48===r.charCodeAt(a);e||null!==ut(10)||A(t,"Invalid number"),46===r.charCodeAt(a)&&(++a,ut(10),i=!0);var o=r.charCodeAt(a);69!==o&&101!==o||(o=r.charCodeAt(++a),43!==o&&45!==o||++a,null===ut(10)&&A(t,"Invalid number"),i=!0),We(r.charCodeAt(a))&&A(a,"Identifier directly after number");var s,l=r.slice(t,a);return i?s=parseFloat(l):n&&1!==l.length?/[89]/.test(l)||O?A(t,"Invalid number"):s=parseInt(l,8):s=parseInt(l,10),Ke(M,s)}function pt(e){a++;for(var n="";;){a>=i&&A(l,"Unterminated string constant");var o=r.charCodeAt(a);if(o===e)return++a,Ke(w,n);if(92===o){o=r.charCodeAt(++a);var s=/^[0-7]+/.exec(r.slice(a,a+3));s&&(s=s[0]);while(s&&parseInt(s,8)>255)s=s.slice(0,-1);if("0"===s&&(s=null),++a,s)O&&A(a-2,"Octal literal in strict mode"),n+=String.fromCharCode(parseInt(s,8)),a+=s.length-1;else switch(o){case 110:n+="\n";break;case 114:n+="\r";break;case 120:n+=String.fromCharCode(ft(2));break;case 117:n+=String.fromCharCode(ft(4));break;case 85:n+=String.fromCharCode(ft(8));break;case 116:n+="\t";break;case 98:n+="\b";break;case 118:n+="\v";break;case 102:n+="\f";break;case 48:n+="\0";break;case 13:10===r.charCodeAt(a)&&++a;case 10:t.locations&&(g=a,++_);break;default:n+=String.fromCharCode(o);break}}else 13!==o&&10!==o&&8232!==o&&8233!==o||A(l,"Unterminated string constant"),n+=String.fromCharCode(o),++a}}function ft(e){var t=ut(16,e);return null===t&&A(l,"Bad character escape sequence"),t}function _t(){Pe=!1;for(var e,t=!0,i=a;;){var n=r.charCodeAt(a);if(ze(n))Pe&&(e+=r.charAt(a)),++a;else{if(92!==n)break;Pe||(e=r.slice(i,a)),Pe=!0,117!=r.charCodeAt(++a)&&A(a,"Expecting Unicode escape sequence \\uXXXX"),++a;var o=ft(4),s=String.fromCharCode(o);s||A(a-1,"Invalid Unicode escape"),(t?We(o):ze(o))||A(a-4,"Invalid Unicode escape"),e+=s}t=!1}return Pe?e:r.slice(i,a)}function gt(){var e=_t(),r=S;return Pe||(De(e)?r=re[e]:(t.forbidReserved&&(3===t.ecmaVersion?Ie:Le)(e)||O&&Ne(e))&&A(l,"The keyword '"+e+"' is reserved")),Ke(r,e)}function mt(){m=l,b=h,y=c,at()}function bt(e){if(O=e,a=b,t.locations)while(a<g)g=r.lastIndexOf("\n",g-2)+1,--_;Ze(),at()}function yt(){this.type=null,this.start=l,this.end=null}function vt(){this.start=u,this.end=null,null!==n&&(this.source=n)}function Tt(){var e=new yt;return t.locations&&(e.loc=new vt),t.directSourceFile&&(e.sourceFile=t.directSourceFile),t.ranges&&(e.range=[l,0]),e}function Ot(e){var r=new yt;return r.start=e.start,t.locations&&(r.loc=new vt,r.loc.start=e.loc.start),t.ranges&&(r.range=[e.range[0],0]),r}function Et(e,r){return e.type=r,e.end=b,t.locations&&(e.loc.end=y),t.ranges&&(e.range[1]=b),e}function At(e){return t.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function Ct(e){if(d===e)return mt(),!0}function Mt(){return!t.strictSemicolons&&(d===R||d===se||Ue.test(r.slice(b,l)))}function xt(){Ct(ue)||Mt()||St()}function wt(e){d===e?mt():St()}function St(){A(l,"Unexpected token")}function Rt(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&A(e.start,"Assigning to rvalue"),O&&"Identifier"===e.type&&ke(e.name)&&A(e.start,"Assigning to "+e.name+" in strict mode")}function Pt(e){m=b=a,t.locations&&(y=new Xe),v=O=null,T=[],at();var r=e||Tt(),i=!0;e||(r.body=[]);while(d!==R){var n=Nt();r.body.push(n),i&&At(n)&&bt(!0),i=!1}return Et(r,"Program")}var It={kind:"loop"},Lt={kind:"switch"};function Nt(){(d===fe||d===ge&&"/="==p)&&at(!0);var e=d,t=Tt();switch(e){case P:case N:mt();var i=e===P;Ct(ue)||Mt()?t.label=null:d!==S?St():(t.label=er(),xt());for(var n=0;n<T.length;++n){var o=T[n];if(null==t.label||o.name===t.label.name){if(null!=o.kind&&(i||"loop"===o.kind))break;if(t.label&&i)break}}return n===T.length&&A(t.start,"Unsyntactic "+e.keyword),Et(t,i?"BreakStatement":"ContinueStatement");case k:return mt(),xt(),Et(t,"DebuggerStatement");case B:return mt(),T.push(It),t.body=Nt(),T.pop(),wt(K),t.test=kt(),xt(),Et(t,"DoWhileStatement");case H:if(mt(),T.push(It),wt(ae),d===ue)return Bt(t,null);if(d===Y){var s=Tt();return mt(),Vt(s,!0),Et(s,"VariableDeclaration"),1===s.declarations.length&&Ct(te)?Ft(t,s):Bt(t,s)}s=Ht(!1,!0);return Ct(te)?(Rt(s),Ft(t,s)):Bt(t,s);case j:return mt(),Jt(t,!0);case U:return mt(),t.test=kt(),t.consequent=Nt(),t.alternate=Ct(F)?Nt():null,Et(t,"IfStatement");case G:return v||A(l,"'return' outside of function"),mt(),Ct(ue)||Mt()?t.argument=null:(t.argument=Ht(),xt()),Et(t,"ReturnStatement");case W:mt(),t.discriminant=kt(),t.cases=[],wt(oe),T.push(Lt);for(var a,h;d!=se;)if(d===I||d===D){var u=d===I;a&&Et(a,"SwitchCase"),t.cases.push(a=Tt()),a.consequent=[],mt(),u?a.test=Ht():(h&&A(m,"Multiple default clauses"),h=!0,a.test=null),wt(ce)}else a||St(),a.consequent.push(Nt());return a&&Et(a,"SwitchCase"),mt(),T.pop(),Et(t,"SwitchStatement");case z:return mt(),Ue.test(r.slice(b,l))&&A(b,"Illegal newline after throw"),t.argument=Ht(),xt(),Et(t,"ThrowStatement");case X:if(mt(),t.block=Dt(),t.handler=null,d===L){var c=Tt();mt(),wt(ae),c.param=er(),O&&ke(c.param.name)&&A(c.param.start,"Binding "+c.param.name+" in strict mode"),wt(le),c.guard=null,c.body=Dt(),t.handler=Et(c,"CatchClause")}return t.guardedHandlers=C,t.finalizer=Ct(V)?Dt():null,t.handler||t.finalizer||A(t.start,"Missing catch or finally clause"),Et(t,"TryStatement");case Y:return mt(),Vt(t),xt(),Et(t,"VariableDeclaration");case K:return mt(),t.test=kt(),T.push(It),t.body=Nt(),T.pop(),Et(t,"WhileStatement");case $:return O&&A(l,"'with' in strict mode"),mt(),t.object=kt(),t.body=Nt(),Et(t,"WithStatement");case oe:return Dt();case ue:return mt(),Et(t,"EmptyStatement");default:var f=p,_=Ht();if(e===S&&"Identifier"===_.type&&Ct(ce)){for(n=0;n<T.length;++n)T[n].name===f&&A(_.start,"Label '"+f+"' is already declared");var g=d.isLoop?"loop":d===W?"switch":null;return T.push({name:f,kind:g}),t.body=Nt(),T.pop(),t.label=_,Et(t,"LabeledStatement")}return t.expression=_,xt(),Et(t,"ExpressionStatement")}}function kt(){wt(ae);var e=Ht();return wt(le),e}function Dt(e){var t,r=Tt(),i=!0,n=!1;r.body=[],wt(oe);while(!Ct(se)){var o=Nt();r.body.push(o),i&&e&&At(o)&&(t=n,bt(n=!0)),i=!1}return n&&!t&&bt(!1),Et(r,"BlockStatement")}function Bt(e,t){return e.init=t,wt(ue),e.test=d===ue?null:Ht(),wt(ue),e.update=d===le?null:Ht(),wt(le),e.body=Nt(),T.pop(),Et(e,"ForStatement")}function Ft(e,t){return e.left=t,e.right=Ht(),wt(le),e.body=Nt(),T.pop(),Et(e,"ForInStatement")}function Vt(e,t){for(e.declarations=[],e.kind="var";;){var r=Tt();if(r.id=er(),O&&ke(r.id.name)&&A(r.id.start,"Binding "+r.id.name+" in strict mode"),r.init=Ct(_e)?Ht(!0,t):null,e.declarations.push(Et(r,"VariableDeclarator")),!Ct(he))break}return e}function Ht(e,t){var r=jt(t);if(!e&&d===he){var i=Ot(r);i.expressions=[r];while(Ct(he))i.expressions.push(jt(t));return Et(i,"SequenceExpression")}return r}function jt(e){var t=Ut(e);if(d.isAssign){var r=Ot(t);return r.operator=p,r.left=t,mt(),r.right=jt(e),Rt(t),Et(r,"AssignmentExpression")}return t}function Ut(e){var t=Gt(e);if(Ct(pe)){var r=Ot(t);return r.test=t,r.consequent=Ht(!0),wt(ce),r.alternate=Ht(!0,e),Et(r,"ConditionalExpression")}return t}function Gt(e){return Wt(zt(),-1,e)}function Wt(e,t,r){var i=d.binop;if(null!=i&&(!r||d!==te)&&i>t){var n=Ot(e);n.left=e,n.operator=p;var o=d;mt(),n.right=Wt(zt(),i,r);var s=Et(n,o===ye||o===ve?"LogicalExpression":"BinaryExpression");return Wt(s,t,r)}return e}function zt(){if(d.prefix){var e=Tt(),t=d.isUpdate;return e.operator=p,e.prefix=!0,f=!0,mt(),e.argument=zt(),t?Rt(e.argument):O&&"delete"===e.operator&&"Identifier"===e.argument.type&&A(e.start,"Deleting local variable in strict mode"),Et(e,t?"UpdateExpression":"UnaryExpression")}var r=Xt();while(d.postfix&&!Mt()){e=Ot(r);e.operator=p,e.prefix=!1,e.argument=r,Rt(r),mt(),r=Et(e,"UpdateExpression")}return r}function Xt(){return Yt(Kt())}function Yt(e,t){if(Ct(de)){var r=Ot(e);return r.object=e,r.property=er(!0),r.computed=!1,Yt(Et(r,"MemberExpression"),t)}if(Ct(ie)){r=Ot(e);return r.object=e,r.property=Ht(),r.computed=!0,wt(ne),Yt(Et(r,"MemberExpression"),t)}if(!t&&Ct(ae)){r=Ot(e);return r.callee=e,r.arguments=Qt(le,!1),Yt(Et(r,"CallExpression"),t)}return e}function Kt(){switch(d){case Z:var e=Tt();return mt(),Et(e,"ThisExpression");case S:return er();case M:case w:case x:e=Tt();return e.value=p,e.raw=r.slice(l,h),mt(),Et(e,"Literal");case J:case Q:case ee:e=Tt();return e.value=d.atomValue,e.raw=d.keyword,mt(),Et(e,"Literal");case ae:var i=u,n=l;mt();var o=Ht();return o.start=n,o.end=h,t.locations&&(o.loc.start=i,o.loc.end=c),t.ranges&&(o.range=[n,h]),wt(le),o;case ie:e=Tt();return mt(),e.elements=Qt(ne,!0,!0),Et(e,"ArrayExpression");case oe:return qt();case j:e=Tt();return mt(),Jt(e,!1);case q:return $t();default:St()}}function $t(){var e=Tt();return mt(),e.callee=Yt(Kt(),!0),Ct(ae)?e.arguments=Qt(le,!1):e.arguments=C,Et(e,"NewExpression")}function qt(){var e=Tt(),r=!0,i=!1;e.properties=[],mt();while(!Ct(se)){if(r)r=!1;else if(wt(he),t.allowTrailingCommas&&Ct(se))break;var n,o={key:Zt()},s=!1;if(Ct(ce)?(o.value=Ht(!0),n=o.kind="init"):t.ecmaVersion>=5&&"Identifier"===o.key.type&&("get"===o.key.name||"set"===o.key.name)?(s=i=!0,n=o.kind=o.key.name,o.key=Zt(),d!==ae&&St(),o.value=Jt(Tt(),!1)):St(),"Identifier"===o.key.type&&(O||i))for(var a=0;a<e.properties.length;++a){var l=e.properties[a];if(l.key.name===o.key.name){var h=n==l.kind||s&&"init"===l.kind||"init"===n&&("get"===l.kind||"set"===l.kind);h&&!O&&"init"===n&&"init"===l.kind&&(h=!1),h&&A(o.key.start,"Redefinition of property")}}e.properties.push(o)}return Et(e,"ObjectExpression")}function Zt(){return d===M||d===w?Kt():er(!0)}function Jt(e,t){d===S?e.id=er():t?St():e.id=null,e.params=[];var r=!0;wt(ae);while(!Ct(le))r?r=!1:wt(he),e.params.push(er());var i=v,n=T;if(v=!0,T=[],e.body=Dt(!0),v=i,T=n,O||e.body.body.length&&At(e.body.body[0]))for(var o=e.id?-1:0;o<e.params.length;++o){var s=o<0?e.id:e.params[o];if((Ne(s.name)||ke(s.name))&&A(s.start,"Defining '"+s.name+"' in strict mode"),o>=0)for(var a=0;a<o;++a)s.name===e.params[a].name&&A(s.start,"Argument name clash in strict mode")}return Et(e,t?"FunctionDeclaration":"FunctionExpression")}function Qt(e,r,i){var n=[],o=!0;while(!Ct(e)){if(o)o=!1;else if(wt(he),r&&t.allowTrailingCommas&&Ct(e))break;i&&d===he?n.push(null):n.push(Ht(!0))}return n}function er(e){var r=Tt();return r.name=d===S?p:e&&!t.forbidReserved&&d.keyword||St(),f=!1,mt(),Et(r,"Identifier")}}))},"./original-repo/interpreter.js":
/*!**************************************!*\
  !*** ./original-repo/interpreter.js ***!
  \**************************************/
/*! no static exports found */function(e,t,r){"use strict";(function(e){
/**
 * @license
 * Copyright 2013 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
var t=function(r,i){"string"===typeof r&&(r=e.parse(r,t.PARSE_OPTIONS)),this.nodeConstructor=r.constructor;var n=new this.nodeConstructor({options:{}});for(var o in r)n[o]="body"===o?r[o].slice():r[o];this.ast=n,this.initFunc_=i,this.paused_=!1,this.polyfills_=[],this.functionCounter_=0,this.stepFunctions_=Object.create(null);var s,a=/^step([A-Z]\w*)$/;for(var l in this)"function"===typeof this[l]&&(s=l.match(a))&&(this.stepFunctions_[s[1]]=this[l].bind(this));this.globalScope=this.createScope(this.ast,null),this.globalObject=this.globalScope.object,this.ast=e.parse(this.polyfills_.join("\n"),t.PARSE_OPTIONS),this.polyfills_=void 0,t.stripLocations_(this.ast,void 0,void 0);var h=new t.State(this.ast,this.globalScope);h.done=!1,this.stateStack=[h],this.run(),this.value=void 0,this.ast=n;h=new t.State(this.ast,this.globalScope);h.done=!1,this.stateStack.length=0,this.stateStack[0]=h,this["stateStack"]=this.stateStack};t.Completion={NORMAL:0,BREAK:1,CONTINUE:2,RETURN:3,THROW:4},t.PARSE_OPTIONS={ecmaVersion:5},t.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},t.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},t.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!1,enumerable:!1,writable:!1},t.VARIABLE_DESCRIPTOR={configurable:!1,enumerable:!0,writable:!0},t.STEP_ERROR={STEP_ERROR:!0},t.SCOPE_REFERENCE={SCOPE_REFERENCE:!0},t.VALUE_IN_DESCRIPTOR={VALUE_IN_DESCRIPTOR:!0},t.REGEXP_TIMEOUT={REGEXP_TIMEOUT:!0},t.toStringCycles_=[],t.vm=null,t.nativeGlobal=this,t.WORKER_CODE=["onmessage = function(e) {","var result;","var data = e.data;","switch (data[0]) {","case 'split':","result = data[1].split(data[2], data[3]);","break;","case 'match':","result = data[1].match(data[2]);","break;","case 'search':","result = data[1].search(data[2]);","break;","case 'replace':","result = data[1].replace(data[2], data[3]);","break;","case 'exec':","var regexp = data[1];","regexp.lastIndex = data[2];","result = [regexp.exec(data[3]), data[1].lastIndex];","break;","default:","throw Error('Unknown RegExp operation: ' + data[0]);","}","postMessage(result);","};"],t.legalArrayLength=function(e){var t=e>>>0;return t===Number(e)?t:NaN},t.legalArrayIndex=function(e){var t=e>>>0;return String(t)===String(e)&&4294967295!==t?t:NaN},t.stripLocations_=function(e,r,i){for(var n in r?e["start"]=r:delete e["start"],i?e["end"]=i:delete e["end"],e)if(e.hasOwnProperty(n)){var o=e[n];o&&"object"===typeof o&&t.stripLocations_(o,r,i)}},t.prototype["REGEXP_MODE"]=2,t.prototype["REGEXP_THREAD_TIMEOUT"]=1e3,t.prototype["POLYFILL_TIMEOUT"]=1e3,t.prototype.getterStep_=!1,t.prototype.setterStep_=!1,t.prototype.appendCode=function(r){var i=this.stateStack[0];if(!i||"Program"!==i.node["type"])throw Error("Expecting original AST to start with a Program node.");if("string"===typeof r&&(r=e.parse(r,t.PARSE_OPTIONS)),!r||"Program"!==r["type"])throw Error("Expecting new AST to start with a Program node.");this.populateScope_(r,i.scope),Array.prototype.push.apply(i.node["body"],r["body"]),i.done=!1},t.prototype.step=function(){var e=this.stateStack,r=Date.now();do{var i=e[e.length-1];if(!i)return!1;var n=i.node,o=n["type"];if("Program"===o&&i.done)return!1;if(this.paused_)return!0;try{var s=this.stepFunctions_[o](e,i,n)}catch(a){if(a!==t.STEP_ERROR)throw a}if(s&&e.push(s),this.getterStep_)throw Error("Getter not supported in this context");if(this.setterStep_)throw Error("Setter not supported in this context")}while(!n["end"]&&r+this["POLYFILL_TIMEOUT"]>Date.now());return!0},t.prototype.run=function(){while(!this.paused_&&this.step());return this.paused_},t.prototype.initGlobal=function(e){this.setProperty(e,"NaN",NaN,t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"Infinity",1/0,t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"undefined",void 0,t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"window",e,t.READONLY_DESCRIPTOR),this.setProperty(e,"this",e,t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"self",e),this.OBJECT_PROTO=new t.Object(null),this.FUNCTION_PROTO=new t.Object(this.OBJECT_PROTO),this.initFunction(e),this.initObject(e),e.proto=this.OBJECT_PROTO,this.setProperty(e,"constructor",this.OBJECT,t.NONENUMERABLE_DESCRIPTOR),this.initArray(e),this.initString(e),this.initBoolean(e),this.initNumber(e),this.initDate(e),this.initRegExp(e),this.initError(e),this.initMath(e),this.initJSON(e);var r=this,i=this.createNativeFunction((function(e){throw EvalError("Can't happen")}),!1);i.eval=!0,this.setProperty(e,"eval",i,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"parseInt",this.createNativeFunction(parseInt,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"parseFloat",this.createNativeFunction(parseFloat,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"isNaN",this.createNativeFunction(isNaN,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"isFinite",this.createNativeFunction(isFinite,!1),t.NONENUMERABLE_DESCRIPTOR);for(var n=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],o=0;o<n.length;o++){var s=function(e){return function(t){try{return e(t)}catch(i){r.throwException(r.URI_ERROR,i.message)}}}(n[o][0]);this.setProperty(e,n[o][1],this.createNativeFunction(s,!1),t.NONENUMERABLE_DESCRIPTOR)}this["OBJECT"]=this.OBJECT,this["OBJECT_PROTO"]=this.OBJECT_PROTO,this["FUNCTION"]=this.FUNCTION,this["FUNCTION_PROTO"]=this.FUNCTION_PROTO,this["ARRAY"]=this.ARRAY,this["ARRAY_PROTO"]=this.ARRAY_PROTO,this["REGEXP"]=this.REGEXP,this["REGEXP_PROTO"]=this.REGEXP_PROTO,this["DATE"]=this.DATE,this["DATE_PROTO"]=this.DATE_PROTO,this.initFunc_&&this.initFunc_(this,e)},t.prototype.initFunction=function(r){var i,n=this,o=/^[A-Za-z_$][\w$]*$/;i=function(r){if(arguments.length)var i=String(arguments[arguments.length-1]);else i="";var s=Array.prototype.slice.call(arguments,0,-1).join(",").trim();if(s){for(var a=s.split(/\s*,\s*/),l=0;l<a.length;l++){var h=a[l];o.test(h)||n.throwException(n.SYNTAX_ERROR,"Invalid function argument: "+h)}s=a.join(", ")}try{var u=e.parse("(function("+s+") {"+i+"})",t.PARSE_OPTIONS)}catch(d){n.throwException(n.SYNTAX_ERROR,"Invalid code: "+d.message)}1!==u["body"].length&&n.throwException(n.SYNTAX_ERROR,"Invalid code in function body.");var c=u["body"][0]["expression"];return n.createFunction(c,n.globalScope,"anonymous")},this.FUNCTION=this.createNativeFunction(i,!0),this.setProperty(r,"Function",this.FUNCTION,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION,"prototype",this.FUNCTION_PROTO,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.FUNCTION_PROTO,"constructor",this.FUNCTION,t.NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.nativeFunc=function(){},this.FUNCTION_PROTO.nativeFunc.id=this.functionCounter_++,this.FUNCTION_PROTO.illegalConstructor=!0,this.setProperty(this.FUNCTION_PROTO,"length",0,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.FUNCTION_PROTO.class="Function",i=function(e,r){var i=n.stateStack[n.stateStack.length-1];i.func_=this,i.funcThis_=e,i.arguments_=[],null!==r&&void 0!==r&&(r instanceof t.Object?i.arguments_=n.arrayPseudoToNative(r):n.throwException(n.TYPE_ERROR,"CreateListFromArrayLike called on non-object")),i.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"apply",i),i=function(e){var t=n.stateStack[n.stateStack.length-1];t.func_=this,t.funcThis_=e,t.arguments_=[];for(var r=1;r<arguments.length;r++)t.arguments_.push(arguments[r]);t.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",i),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind',","{configurable: true, writable: true, value:","function bind(oThis) {","if (typeof this !== 'function') {","throw TypeError('What is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),i=function(){return String(this)},this.setNativeFunctionPrototype(this.FUNCTION,"toString",i),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(i,!1),t.NONENUMERABLE_DESCRIPTOR),i=function(){return this.valueOf()},this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",i),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(i,!1),t.NONENUMERABLE_DESCRIPTOR)},t.prototype.initObject=function(e){var r,i=this;r=function(e){if(void 0===e||null===e)return i.calledWithNew()?this:i.createObjectProto(i.OBJECT_PROTO);if(!(e instanceof t.Object)){var r=i.createObjectProto(i.getPrototype(e));return r.data=e,r}return e},this.OBJECT=this.createNativeFunction(r,!0),this.setProperty(this.OBJECT,"prototype",this.OBJECT_PROTO,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.OBJECT_PROTO,"constructor",this.OBJECT,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"Object",this.OBJECT,t.NONENUMERABLE_DESCRIPTOR);var n=function(e){void 0!==e&&null!==e||i.throwException(i.TYPE_ERROR,"Cannot convert '"+e+"' to object")};r=function(e){n(e);var r=e instanceof t.Object?e.properties:e;return i.arrayNativeToPseudo(Object.getOwnPropertyNames(r))},this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),r=function(e){return n(e),e instanceof t.Object&&(e=e.properties),i.arrayNativeToPseudo(Object.keys(e))},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),r=function(e){return null===e?i.createObjectProto(null):(e instanceof t.Object||i.throwException(i.TYPE_ERROR,"Object prototype may only be an Object or null"),i.createObjectProto(e))},this.setProperty(this.OBJECT,"create",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var create_ = Object.create;","Object.create = function create(proto, props) {","var obj = create_(proto);","props && Object.defineProperties(obj, props);","return obj;","};","})();",""),r=function(e,r,n){return r=String(r),e instanceof t.Object||i.throwException(i.TYPE_ERROR,"Object.defineProperty called on non-object"),n instanceof t.Object||i.throwException(i.TYPE_ERROR,"Property description must be an object"),!e.properties[r]&&e.preventExtensions&&i.throwException(i.TYPE_ERROR,"Can't define property '"+r+"', object is not extensible"),i.setProperty(e,r,t.VALUE_IN_DESCRIPTOR,n.properties),e},this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("(function() {","var defineProperty_ = Object.defineProperty;","Object.defineProperty = function defineProperty(obj, prop, d1) {","var d2 = {};","if ('configurable' in d1) d2.configurable = d1.configurable;","if ('enumerable' in d1) d2.enumerable = d1.enumerable;","if ('writable' in d1) d2.writable = d1.writable;","if ('value' in d1) d2.value = d1.value;","if ('get' in d1) d2.get = d1.get;","if ('set' in d1) d2.set = d1.set;","return defineProperty_(obj, prop, d2);","};","})();","Object.defineProperty(Object, 'defineProperties',","{configurable: true, writable: true, value:","function defineProperties(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),r=function(e,r){if(e instanceof t.Object||i.throwException(i.TYPE_ERROR,"Object.getOwnPropertyDescriptor called on non-object"),r=String(r),r in e.properties){var n=Object.getOwnPropertyDescriptor(e.properties,r),o=e.getter[r],s=e.setter[r],a=i.createObjectProto(i.OBJECT_PROTO);return o||s?(i.setProperty(a,"get",o),i.setProperty(a,"set",s)):(i.setProperty(a,"value",n.value),i.setProperty(a,"writable",n.writable)),i.setProperty(a,"configurable",n.configurable),i.setProperty(a,"enumerable",n.enumerable),a}},this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),r=function(e){return n(e),i.getPrototype(e)},this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),r=function(e){return Boolean(e)&&!e.preventExtensions},this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),r=function(e){return e instanceof t.Object&&(e.preventExtensions=!0),e},this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),this.setNativeFunctionPrototype(this.OBJECT,"toString",t.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",t.Object.prototype.toString),this.setNativeFunctionPrototype(this.OBJECT,"valueOf",t.Object.prototype.valueOf),r=function(e){return n(this),this instanceof t.Object?String(e)in this.properties:this.hasOwnProperty(e)},this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",r),r=function(e){return n(this),this instanceof t.Object?Object.prototype.propertyIsEnumerable.call(this.properties,e):this.propertyIsEnumerable(e)},this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",r),r=function(e){while(1){if(e=i.getPrototype(e),!e)return!1;if(e===this)return!0}},this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",r)},t.prototype.initArray=function(e){var r,i=this;r=function(e){if(i.calledWithNew())var r=this;else r=i.createArray();var n=arguments[0];if(1===arguments.length&&"number"===typeof n)isNaN(t.legalArrayLength(n))&&i.throwException(i.RANGE_ERROR,"Invalid array length"),r.properties.length=n;else{for(var o=0;o<arguments.length;o++)r.properties[o]=arguments[o];r.properties.length=o}return r},this.ARRAY=this.createNativeFunction(r,!0),this.ARRAY_PROTO=this.ARRAY.properties["prototype"],this.setProperty(e,"Array",this.ARRAY,t.NONENUMERABLE_DESCRIPTOR),r=function(e){return e&&"Array"===e.class},this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(r,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ARRAY_PROTO,"length",0,{configurable:!1,enumerable:!1,writable:!0}),this.ARRAY_PROTO.class="Array",this.polyfills_.push("Object.defineProperty(Array.prototype, 'pop',","{configurable: true, writable: true, value:","function pop() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","len--;","var x = o[len];","delete o[len];","o.length = len;","return x;","}","});","Object.defineProperty(Array.prototype, 'push',","{configurable: true, writable: true, value:","function push(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","for (var i = 0; i < arguments.length; i++) {","o[len] = arguments[i];","len++;","}","o.length = len;","return len;","}","});","Object.defineProperty(Array.prototype, 'shift',","{configurable: true, writable: true, value:","function shift() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","o.length = 0;","return undefined;","}","var value = o[0];","for (var i = 0; i < len - 1; i++) {","o[i] = o[i + 1];","}","delete o[i];","o.length = len - 1;","return value;","}","});","Object.defineProperty(Array.prototype, 'unshift',","{configurable: true, writable: true, value:","function unshift(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 0) {","len = 0;","}","for (var i = len - 1; i >= 0; i--) {","o[i + arguments.length] = o[i];","}","for (var i = 0; i < arguments.length; i++) {","o[i] = arguments[i];","}","return o.length = len + arguments.length;","}","});","Object.defineProperty(Array.prototype, 'reverse',","{configurable: true, writable: true, value:","function reverse() {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len || len < 2) {","return o;","}","for (var i = 0; i < len / 2 - 0.5; i++) {","var x = o[i];","o[i] = o[len - i - 1];","o[len - i - 1] = x;","}","return o;","}","});","Object.defineProperty(Array.prototype, 'indexOf',","{configurable: true, writable: true, value:","function indexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var n = fromIndex | 0;","if (!len || n >= len) {","return -1;","}","var i = Math.max(n >= 0 ? n : len - Math.abs(n), 0);","while (i < len) {","if (i in o && o[i] === searchElement) {","return i;","}","i++;","}","return -1;","}","});","Object.defineProperty(Array.prototype, 'lastIndexOf',","{configurable: true, writable: true, value:","function lastIndexOf(searchElement, fromIndex) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","if (!len) {","return -1;","}","var n = len - 1;","if (arguments.length > 1) {","n = fromIndex | 0;","if (n) {","n = (n > 0 || -1) * Math.floor(Math.abs(n));","}","}","var i = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);","while (i >= 0) {","if (i in o && o[i] === searchElement) {","return i;","}","i--;","}","return -1;","}","});","Object.defineProperty(Array.prototype, 'slice',","{configurable: true, writable: true, value:","function slice(start, end) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","start |= 0;","start = (start >= 0) ? start : Math.max(0, len + start);","if (typeof end !== 'undefined') {","if (end !== Infinity) {","end |= 0;","}","if (end < 0) {","end = len + end;","} else {","end = Math.min(end, len);","}","} else {","end = len;","}","var size = end - start;","var cloned = [];","for (var i = 0; i < size; i++) {","cloned[i] = o[start + i];","}","return cloned;","}","});","Object.defineProperty(Array.prototype, 'splice',","{configurable: true, writable: true, value:","function splice(start, deleteCount, var_args) {","if (!this) throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","start |= 0;","if (start < 0) {","start = Math.max(len + start, 0);","} else {","start = Math.min(start, len);","}","if (arguments.length < 1) {","deleteCount = len - start;","} else {","deleteCount |= 0;","deleteCount = Math.max(0, Math.min(deleteCount, len - start));","}","var removed = [];","for (var i = start; i < start + deleteCount; i++) {","removed[removed.length++] = o[i];","o[i] = o[i + deleteCount];","}","for (var i = start + deleteCount; i < len - deleteCount; i++) {","o[i] = o[i + deleteCount];","}","for (var i = len - deleteCount; i < len; i++) {","delete o[i];","}","len -= deleteCount;","for (var i = len - 1; i >= start; i--) {","o[i + arguments.length - 2] = o[i];","}","len += arguments.length - 2;","for (var i = 2; i < arguments.length; i++) {","o[start + i - 2] = arguments[i];","}","o.length = len;","return removed;","}","});","Object.defineProperty(Array.prototype, 'concat',","{configurable: true, writable: true, value:","function concat(var_args) {","if (!this) throw TypeError();","var o = Object(this);","var cloned = [];","for (var i = -1; i < arguments.length; i++) {","var value = (i === -1) ? o : arguments[i];","if (Array.isArray(value)) {","cloned.push.apply(cloned, value);","} else {","cloned.push(value);","}","}","return cloned;","}","});","Object.defineProperty(Array.prototype, 'join',","{configurable: true, writable: true, value:","function join(opt_separator) {","if (!this) throw TypeError();","var o = Object(this);","var sep = typeof opt_separator === 'undefined' ?","',' : ('' + opt_separator);","var str = '';","for (var i = 0; i < o.length; i++) {","if (i && sep) {","str += sep;","}","str += o[i];","}","return str;","}","});","Object.defineProperty(Array.prototype, 'every',","{configurable: true, writable: true, value:","function every(callbackfn, thisArg) {","if (!this || typeof callbackfn !== 'function') throw TypeError();","var t, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","k = 0;","while (k < len) {","if (k in o && !callbackfn.call(t, o[k], k, o)) return false;","k++;","}","return true;","}","});","Object.defineProperty(Array.prototype, 'filter',","{configurable: true, writable: true, value:","function filter(fun, var_args) {","if (this === void 0 || this === null || typeof fun !== 'function') throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o) {","var val = o[i];","if (fun.call(thisArg, val, i, o)) res.push(val);","}","}","return res;","}","});","Object.defineProperty(Array.prototype, 'forEach',","{configurable: true, writable: true, value:","function forEach(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","k = 0;","while (k < len) {","if (k in o) callback.call(t, o[k], k, o);","k++;","}","}","});","Object.defineProperty(Array.prototype, 'map',","{configurable: true, writable: true, value:","function map(callback, thisArg) {","if (!this || typeof callback !== 'function') throw TypeError();","var t, a, k;","var o = Object(this);","var len = o.length >>> 0;","if (arguments.length > 1) t = thisArg;","a = new Array(len);","k = 0;","while (k < len) {","if (k in o) a[k] = callback.call(t, o[k], k, o);","k++;","}","return a;","}","});","Object.defineProperty(Array.prototype, 'reduce',","{configurable: true, writable: true, value:","function reduce(callback /*, initialValue*/) {","if (!this || typeof callback !== 'function') throw TypeError();","var o = Object(this), len = o.length >>> 0, k = 0, value;","if (arguments.length === 2) {","value = arguments[1];","} else {","while (k < len && !(k in o)) k++;","if (k >= len) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k++];","}","for (; k < len; k++) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'reduceRight',","{configurable: true, writable: true, value:","function reduceRight(callback /*, initialValue*/) {","if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw TypeError();","var o = Object(this), len = o.length >>> 0, k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in o)) k--;","if (k < 0) {","throw TypeError('Reduce of empty array with no initial value');","}","value = o[k--];","}","for (; k >= 0; k--) {","if (k in o) value = callback(value, o[k], k, o);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'some',","{configurable: true, writable: true, value:","function some(fun/*, thisArg*/) {","if (!this || typeof fun !== 'function') throw TypeError();","var o = Object(this);","var len = o.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in o && fun.call(thisArg, o[i], i, o)) {","return true;","}","}","return false;","}","});","Object.defineProperty(Array.prototype, 'sort',","{configurable: true, writable: true, value:","function sort(opt_comp) {","if (!this) throw TypeError();","if (typeof opt_comp !== 'function') {","opt_comp = undefined;","}","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ? (opt_comp(this[j], this[j + 1]) > 0) :","(String(this[j]) > String(this[j + 1]))) {","var swap = this[j];","this[j] = this[j + 1];","this[j + 1] = swap;","changes++;","}","}","if (!changes) break;","}","return this;","}","});","Object.defineProperty(Array.prototype, 'toLocaleString',","{configurable: true, writable: true, value:","function toLocaleString() {","if (!this) throw TypeError();","var o = Object(this);","var out = [];","for (var i = 0; i < o.length; i++) {","out[i] = (o[i] === null || o[i] === undefined) ? '' : o[i].toLocaleString();","}","return out.join(',');","}","});","")},t.prototype.initString=function(e){var r,i=this;r=function(e){return e=arguments.length?t.nativeGlobal.String(e):"",i.calledWithNew()?(this.data=e,this):e},this.STRING=this.createNativeFunction(r,!0),this.setProperty(e,"String",this.STRING,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(String.fromCharCode,!1),t.NONENUMERABLE_DESCRIPTOR);for(var n=["charAt","charCodeAt","concat","indexOf","lastIndexOf","slice","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],o=0;o<n.length;o++)this.setNativeFunctionPrototype(this.STRING,n[o],String.prototype[n[o]]);r=function(e,t,r){t=i.pseudoToNative(t),r=i.pseudoToNative(r);try{return String(this).localeCompare(e,t,r)}catch(n){i.throwException(i.ERROR,"localeCompare: "+n.message)}},this.setNativeFunctionPrototype(this.STRING,"localeCompare",r),r=function(e,r,n){var o=String(this);if(r=r?Number(r):void 0,i.isa(e,i.REGEXP)&&(e=e.data,i.maybeThrowRegExp(e,n),2===i["REGEXP_MODE"]))if(t.vm){var s={string:o,separator:e,limit:r},a="string.split(separator, limit)",l=i.vmCall(a,s,e,n);l!==t.REGEXP_TIMEOUT&&n(i.arrayNativeToPseudo(l))}else{var h=i.createWorker(),u=i.regExpTimeout(e,h,n);h.onmessage=function(e){clearTimeout(u),n(i.arrayNativeToPseudo(e.data))},h.postMessage(["split",o,e,r])}else{l=o.split(e,r);n(i.arrayNativeToPseudo(l))}},this.setAsyncFunctionPrototype(this.STRING,"split",r),r=function(e,r){var n=String(this);if(e=i.isa(e,i.REGEXP)?e.data:new RegExp(e),i.maybeThrowRegExp(e,r),2!==i["REGEXP_MODE"]){a=n.match(e);r(a&&i.arrayNativeToPseudo(a))}else if(t.vm){var o={string:n,regexp:e},s="string.match(regexp)",a=i.vmCall(s,o,e,r);a!==t.REGEXP_TIMEOUT&&r(a&&i.arrayNativeToPseudo(a))}else{var l=i.createWorker(),h=i.regExpTimeout(e,l,r);l.onmessage=function(e){clearTimeout(h),r(e.data&&i.arrayNativeToPseudo(e.data))},l.postMessage(["match",n,e])}},this.setAsyncFunctionPrototype(this.STRING,"match",r),r=function(e,r){var n=String(this);if(e=i.isa(e,i.REGEXP)?e.data:new RegExp(e),i.maybeThrowRegExp(e,r),2!==i["REGEXP_MODE"])r(n.search(e));else if(t.vm){var o={string:n,regexp:e},s="string.search(regexp)",a=i.vmCall(s,o,e,r);a!==t.REGEXP_TIMEOUT&&r(a)}else{var l=i.createWorker(),h=i.regExpTimeout(e,l,r);l.onmessage=function(e){clearTimeout(h),r(e.data)},l.postMessage(["search",n,e])}},this.setAsyncFunctionPrototype(this.STRING,"search",r),r=function(e,r,n){var o=String(this);if(r=String(r),i.isa(e,i.REGEXP)&&(e=e.data,i.maybeThrowRegExp(e,n),2===i["REGEXP_MODE"]))if(t.vm){var s={string:o,substr:e,newSubstr:r},a="string.replace(substr, newSubstr)",l=i.vmCall(a,s,e,n);l!==t.REGEXP_TIMEOUT&&n(l)}else{var h=i.createWorker(),u=i.regExpTimeout(e,h,n);h.onmessage=function(e){clearTimeout(u),n(e.data)},h.postMessage(["replace",o,e,r])}else n(o.replace(e,r))},this.setAsyncFunctionPrototype(this.STRING,"replace",r),this.polyfills_.push("(function() {","var replace_ = String.prototype.replace;","String.prototype.replace = function replace(substr, newSubstr) {","if (typeof newSubstr !== 'function') {","return replace_.call(this, substr, newSubstr);","}","var str = this;","if (substr instanceof RegExp) {","var subs = [];","var m = substr.exec(str);","while (m) {","m.push(m.index, str);","var inject = newSubstr.apply(null, m);","subs.push([m.index, m[0].length, inject]);","m = substr.global ? substr.exec(str) : null;","}","for (var i = subs.length - 1; i >= 0; i--) {","str = str.substring(0, subs[i][0]) + subs[i][2] + str.substring(subs[i][0] + subs[i][1]);","}","} else {","var i = str.indexOf(substr);","if (i !== -1) {","var inject = newSubstr(str.substr(i, substr.length), i, str);","str = str.substring(0, i) + inject + str.substring(i + substr.length);","}","}","return str;","};","})();","")},t.prototype.initBoolean=function(e){var r,i=this;r=function(e){return e=t.nativeGlobal.Boolean(e),i.calledWithNew()?(this.data=e,this):e},this.BOOLEAN=this.createNativeFunction(r,!0),this.setProperty(e,"Boolean",this.BOOLEAN,t.NONENUMERABLE_DESCRIPTOR)},t.prototype.initNumber=function(e){var r,i=this;r=function(e){return e=arguments.length?t.nativeGlobal.Number(e):0,i.calledWithNew()?(this.data=e,this):e},this.NUMBER=this.createNativeFunction(r,!0),this.setProperty(e,"Number",this.NUMBER,t.NONENUMERABLE_DESCRIPTOR);for(var n=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],o=0;o<n.length;o++)this.setProperty(this.NUMBER,n[o],Number[n[o]],t.NONCONFIGURABLE_READONLY_NONENUMERABLE_DESCRIPTOR);r=function(e){try{return Number(this).toExponential(e)}catch(t){i.throwException(i.ERROR,t.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toExponential",r),r=function(e){try{return Number(this).toFixed(e)}catch(t){i.throwException(i.ERROR,t.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toFixed",r),r=function(e){try{return Number(this).toPrecision(e)}catch(t){i.throwException(i.ERROR,t.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",r),r=function(e){try{return Number(this).toString(e)}catch(t){i.throwException(i.ERROR,t.message)}},this.setNativeFunctionPrototype(this.NUMBER,"toString",r),r=function(e,t){return e=e?i.pseudoToNative(e):void 0,t=t?i.pseudoToNative(t):void 0,Number(this).toLocaleString(e,t)},this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",r)},t.prototype.initDate=function(e){var r,i=this;r=function(e,r){if(!i.calledWithNew())return t.nativeGlobal.Date();var n=[null].concat(Array.from(arguments));return this.data=new(Function.prototype.bind.apply(t.nativeGlobal.Date,n)),this},this.DATE=this.createNativeFunction(r,!0),this.DATE_PROTO=this.DATE.properties["prototype"],this.setProperty(e,"Date",this.DATE,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"now",this.createNativeFunction(Date.now,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"parse",this.createNativeFunction(Date.parse,!1),t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.DATE,"UTC",this.createNativeFunction(Date.UTC,!1),t.NONENUMERABLE_DESCRIPTOR);for(var n=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toISOString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],o=0;o<n.length;o++)r=function(e){return function(t){var r=this.data;r instanceof Date||i.throwException(i.TYPE_ERROR,e+" not called on a Date");for(var n=[],o=0;o<arguments.length;o++)n[o]=i.pseudoToNative(arguments[o]);return r[e].apply(r,n)}}(n[o]),this.setNativeFunctionPrototype(this.DATE,n[o],r)},t.prototype.initRegExp=function(e){var r,i=this;r=function(e,r){if(i.calledWithNew())var n=this;else n=i.createObjectProto(i.REGEXP_PROTO);return e=e?String(e):"",r=r?String(r):"",i.populateRegExp(n,new t.nativeGlobal.RegExp(e,r)),n},this.REGEXP=this.createNativeFunction(r,!0),this.REGEXP_PROTO=this.REGEXP.properties["prototype"],this.setProperty(e,"RegExp",this.REGEXP,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"global",void 0,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"ignoreCase",void 0,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"multiline",void 0,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties["prototype"],"source","(?:)",t.READONLY_NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(RegExp.prototype, 'test',","{configurable: true, writable: true, value:","function test(str) {","return String(str).search(this) !== -1","}","});"),r=function(e,r){var n=this.data;if(e=String(e),n.lastIndex=Number(i.getProperty(this,"lastIndex")),i.maybeThrowRegExp(n,r),2!==i["REGEXP_MODE"]){a=n.exec(e);i.setProperty(this,"lastIndex",n.lastIndex),r(c(a))}else if(t.vm){var o={string:e,regexp:n},s="regexp.exec(string)",a=i.vmCall(s,o,n,r);a!==t.REGEXP_TIMEOUT&&(i.setProperty(this,"lastIndex",n.lastIndex),r(c(a)))}else{var l=i.createWorker(),h=i.regExpTimeout(n,l,r),u=this;l.onmessage=function(e){clearTimeout(h),i.setProperty(u,"lastIndex",e.data[1]),r(c(e.data[0]))},l.postMessage(["exec",n,n.lastIndex,e])}function c(e){if(e){var t=i.arrayNativeToPseudo(e);return i.setProperty(t,"index",e.index),i.setProperty(t,"input",e.input),t}return null}},this.setAsyncFunctionPrototype(this.REGEXP,"exec",r)},t.prototype.initError=function(e){var r=this;this.ERROR=this.createNativeFunction((function(e){if(r.calledWithNew())var i=this;else i=r.createObject(r.ERROR);return e&&r.setProperty(i,"message",String(e),t.NONENUMERABLE_DESCRIPTOR),i}),!0),this.setProperty(e,"Error",this.ERROR,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties["prototype"],"message","",t.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties["prototype"],"name","Error",t.NONENUMERABLE_DESCRIPTOR);var i=function(i){var n=r.createNativeFunction((function(e){if(r.calledWithNew())var i=this;else i=r.createObject(n);return e&&r.setProperty(i,"message",String(e),t.NONENUMERABLE_DESCRIPTOR),i}),!0);return r.setProperty(n,"prototype",r.createObject(r.ERROR),t.NONENUMERABLE_DESCRIPTOR),r.setProperty(n.properties["prototype"],"name",i,t.NONENUMERABLE_DESCRIPTOR),r.setProperty(e,i,n,t.NONENUMERABLE_DESCRIPTOR),n};this.EVAL_ERROR=i("EvalError"),this.RANGE_ERROR=i("RangeError"),this.REFERENCE_ERROR=i("ReferenceError"),this.SYNTAX_ERROR=i("SyntaxError"),this.TYPE_ERROR=i("TypeError"),this.URI_ERROR=i("URIError")},t.prototype.initMath=function(e){var r=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(e,"Math",r,t.NONENUMERABLE_DESCRIPTOR);for(var i=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],n=0;n<i.length;n++)this.setProperty(r,i[n],Math[i[n]],t.READONLY_NONENUMERABLE_DESCRIPTOR);var o=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];for(n=0;n<o.length;n++)this.setProperty(r,o[n],this.createNativeFunction(Math[o[n]],!1),t.NONENUMERABLE_DESCRIPTOR)},t.prototype.initJSON=function(e){var r=this,i=r.createObjectProto(this.OBJECT_PROTO);this.setProperty(e,"JSON",i,t.NONENUMERABLE_DESCRIPTOR);var n=function(e){try{var t=JSON.parse(String(e))}catch(i){r.throwException(r.SYNTAX_ERROR,i.message)}return r.nativeToPseudo(t)};this.setProperty(i,"parse",this.createNativeFunction(n,!1)),n=function(e,t,i){t&&"Function"===t.class?r.throwException(r.TYPE_ERROR,"Function replacer on JSON.stringify not supported"):t&&"Array"===t.class?(t=r.arrayPseudoToNative(t),t=t.filter((function(e){return"string"===typeof e||"number"===typeof e}))):t=null,"string"!==typeof i&&"number"!==typeof i&&(i=void 0);var n=r.pseudoToNative(e);try{var o=JSON.stringify(n,t,i)}catch(s){r.throwException(r.TYPE_ERROR,s.message)}return o},this.setProperty(i,"stringify",this.createNativeFunction(n,!1))},t.prototype.isa=function(e,t){if(null===e||void 0===e||!t)return!1;var r=t.properties["prototype"];if(e===r)return!0;e=this.getPrototype(e);while(e){if(e===r)return!0;e=e.proto}return!1},t.prototype.populateRegExp=function(e,r){e.data=new RegExp(r.source,r.flags),this.setProperty(e,"lastIndex",r.lastIndex,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"source",r.source,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"global",r.global,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"ignoreCase",r.ignoreCase,t.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(e,"multiline",r.multiline,t.READONLY_NONENUMERABLE_DESCRIPTOR)},t.prototype.createWorker=function(){var e=this.createWorker.blob_;return e||(e=new Blob([t.WORKER_CODE.join("\n")],{type:"application/javascript"}),this.createWorker.blob_=e),new Worker(URL.createObjectURL(e))},t.prototype.vmCall=function(e,r,i,n){var o={timeout:this["REGEXP_THREAD_TIMEOUT"]};try{return t.vm["runInNewContext"](e,r,o)}catch(s){n(null),this.throwException(this.ERROR,"RegExp Timeout: "+i)}return t.REGEXP_TIMEOUT},t.prototype.maybeThrowRegExp=function(e,i){var n;if(0===this["REGEXP_MODE"])n=!1;else if(1===this["REGEXP_MODE"])n=!0;else if(t.vm)n=!0;else if("function"===typeof Worker&&"function"===typeof URL)n=!0;else{try{t.vm=r(/*! vm */"./node_modules/vm-browserify/index.js")}catch(o){}n=!!t.vm}n||(i(null),this.throwException(this.ERROR,"Regular expressions not supported: "+e))},t.prototype.regExpTimeout=function(e,t,r){var i=this;return setTimeout((function(){t.terminate(),r(null);try{i.throwException(i.ERROR,"RegExp Timeout: "+e)}catch(n){}}),this["REGEXP_THREAD_TIMEOUT"])},t.prototype.createObject=function(e){return this.createObjectProto(e&&e.properties["prototype"])},t.prototype.createObjectProto=function(e){if("object"!==typeof e)throw Error("Non object prototype");var r=new t.Object(e);return this.isa(r,this.ERROR)&&(r.class="Error"),r},t.prototype.createArray=function(){var e=this.createObjectProto(this.ARRAY_PROTO);return this.setProperty(e,"length",0,{configurable:!1,enumerable:!1,writable:!0}),e.class="Array",e},t.prototype.createFunctionBase_=function(e,r){var i=this.createObjectProto(this.FUNCTION_PROTO);if(r){var n=this.createObjectProto(this.OBJECT_PROTO);this.setProperty(i,"prototype",n,t.NONENUMERABLE_DESCRIPTOR),this.setProperty(n,"constructor",i,t.NONENUMERABLE_DESCRIPTOR)}else i.illegalConstructor=!0;return this.setProperty(i,"length",e,t.READONLY_NONENUMERABLE_DESCRIPTOR),i.class="Function",i},t.prototype.createFunction=function(e,r,i){var n=this.createFunctionBase_(e["params"].length,!0);n.parentScope=r,n.node=e;var o=e["id"]?String(e["id"]["name"]):i||"";return this.setProperty(n,"name",o,t.READONLY_NONENUMERABLE_DESCRIPTOR),n},t.prototype.createNativeFunction=function(e,r){var i=this.createFunctionBase_(e.length,r);return i.nativeFunc=e,e.id=this.functionCounter_++,this.setProperty(i,"name",e.name,t.READONLY_NONENUMERABLE_DESCRIPTOR),i},t.prototype.createAsyncFunction=function(e){var r=this.createFunctionBase_(e.length,!0);return r.asyncFunc=e,e.id=this.functionCounter_++,this.setProperty(r,"name",e.name,t.READONLY_NONENUMERABLE_DESCRIPTOR),r},t.prototype.nativeToPseudo=function(e){if(e instanceof t.Object)throw Error("Object is already pseudo");if("object"!==typeof e&&"function"!==typeof e||null===e)return e;if(e instanceof RegExp){var r=this.createObjectProto(this.REGEXP_PROTO);return this.populateRegExp(r,e),r}if(e instanceof Date){var i=this.createObjectProto(this.DATE_PROTO);return i.data=new Date(e.valueOf()),i}if("function"===typeof e){var n=this,o=function(){var t=Array.prototype.slice.call(arguments).map((function(e){return n.pseudoToNative(e)})),r=e.apply(n,t);return n.nativeToPseudo(r)},s=Object.getOwnPropertyDescriptor(e,"prototype");return this.createNativeFunction(o,!!s)}if(Array.isArray(e)){for(var a=this.createArray(),l=0;l<e.length;l++)l in e&&this.setProperty(a,l,this.nativeToPseudo(e[l]));return a}var h=this.createObjectProto(this.OBJECT_PROTO);for(var u in e)this.setProperty(h,u,this.nativeToPseudo(e[u]));return h},t.prototype.pseudoToNative=function(e,r){if("object"!==typeof e&&"function"!==typeof e||null===e)return e;if(!(e instanceof t.Object))throw Error("Object is not pseudo");if(this.isa(e,this.REGEXP)){var i=new RegExp(e.data.source,e.data.flags);return i.lastIndex=e.data.lastIndex,i}if(this.isa(e,this.DATE))return new Date(e.data.valueOf());var n,o=r||{pseudo:[],native:[]},s=o.pseudo.indexOf(e);if(-1!==s)return o.native[s];if(o.pseudo.push(e),this.isa(e,this.ARRAY)){n=[],o.native.push(n);var a=this.getProperty(e,"length");for(s=0;s<a;s++)this.hasProperty(e,s)&&(n[s]=this.pseudoToNative(this.getProperty(e,s),o))}else{var l;for(var h in n={},o.native.push(n),e.properties)l=this.pseudoToNative(e.properties[h],o),Object.defineProperty(n,h,{value:l,writable:!0,enumerable:!0,configurable:!0})}return o.pseudo.pop(),o.native.pop(),n},t.prototype.arrayNativeToPseudo=function(e){for(var t=this.createArray(),r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++)this.setProperty(t,r[i],e[r[i]]);return t},t.prototype.arrayPseudoToNative=function(e){var r=[];for(var i in e.properties)r[i]=this.getProperty(e,i);return r.length=t.legalArrayLength(this.getProperty(e,"length"))||0,r},t.prototype.getPrototype=function(e){switch(typeof e){case"number":return this.NUMBER.properties["prototype"];case"boolean":return this.BOOLEAN.properties["prototype"];case"string":return this.STRING.properties["prototype"]}return e?e.proto:null},t.prototype.getProperty=function(e,r){if(this.getterStep_)throw Error("Getter not supported in that context");if(r=String(r),void 0!==e&&null!==e||this.throwException(this.TYPE_ERROR,"Cannot read property '"+r+"' of "+e),"object"===typeof e&&!(e instanceof t.Object))throw TypeError("Expecting native value or pseudo object");if("length"===r){if(this.isa(e,this.STRING))return String(e).length}else if(r.charCodeAt(0)<64&&this.isa(e,this.STRING)){var i=t.legalArrayIndex(r);if(!isNaN(i)&&i<String(e).length)return String(e)[i]}do{if(e.properties&&r in e.properties){var n=e.getter[r];return n?(this.getterStep_=!0,n):e.properties[r]}}while(e=this.getPrototype(e))},t.prototype.hasProperty=function(e,r){if(!(e instanceof t.Object))throw TypeError("Primitive data type has no properties");if(r=String(r),"length"===r&&this.isa(e,this.STRING))return!0;if(this.isa(e,this.STRING)){var i=t.legalArrayIndex(r);if(!isNaN(i)&&i<String(e).length)return!0}do{if(e.properties&&r in e.properties)return!0}while(e=this.getPrototype(e));return!1},t.prototype.setProperty=function(e,r,i,n){if(this.setterStep_)throw Error("Setter not supported in that context");if(r=String(r),void 0!==e&&null!==e||this.throwException(this.TYPE_ERROR,"Cannot set property '"+r+"' of "+e),"object"===typeof e&&!(e instanceof t.Object))throw TypeError("Expecting native value or pseudo object");n&&("get"in n||"set"in n)&&("value"in n||"writable"in n)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var o=!this.stateStack||this.getScope().strict;if(e instanceof t.Object){if(this.isa(e,this.STRING)){var s=t.legalArrayIndex(r);if("length"===r||!isNaN(s)&&s<String(e).length)return void(o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+r+"' of String '"+e.data+"'"))}if("Array"===e.class){var a,l=e.properties.length;if("length"===r){if(n){if(!("value"in n))return;i=n.value}if(i=t.legalArrayLength(i),isNaN(i)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),i<l)for(a in e.properties)a=t.legalArrayIndex(a),!isNaN(a)&&i<=a&&delete e.properties[a]}else isNaN(a=t.legalArrayIndex(r))||(e.properties.length=Math.max(l,a+1))}if(!e.preventExtensions||r in e.properties)if(n){var h={};"get"in n&&n.get&&(e.getter[r]=n.get,h.get=this.setProperty.placeholderGet_),"set"in n&&n.set&&(e.setter[r]=n.set,h.set=this.setProperty.placeholderSet_),"configurable"in n&&(h.configurable=n.configurable),"enumerable"in n&&(h.enumerable=n.enumerable),"writable"in n&&(h.writable=n.writable,delete e.getter[r],delete e.setter[r]),"value"in n?(h.value=n.value,delete e.getter[r],delete e.setter[r]):i!==t.VALUE_IN_DESCRIPTOR&&(h.value=i,delete e.getter[r],delete e.setter[r]);try{Object.defineProperty(e.properties,r,h)}catch(c){this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+r)}"get"in n&&!n.get&&delete e.getter[r],"set"in n&&!n.set&&delete e.setter[r]}else{if(i===t.VALUE_IN_DESCRIPTOR)throw ReferenceError("Value not specified.");var u=e;while(!(r in u.properties))if(u=this.getPrototype(u),!u){u=e;break}if(u.setter&&u.setter[r])return this.setterStep_=!0,u.setter[r];if(u.getter&&u.getter[r])o&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+r+"' of object '"+e+"' which only has a getter");else try{e.properties[r]=i}catch(c){o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+r+"' of object '"+e+"'")}}else o&&this.throwException(this.TYPE_ERROR,"Can't add property '"+r+"', object is not extensible")}else o&&this.throwException(this.TYPE_ERROR,"Can't create property '"+r+"' on '"+e+"'")},t.prototype.setProperty.placeholderGet_=function(){throw Error("Placeholder getter")},t.prototype.setProperty.placeholderSet_=function(){throw Error("Placeholder setter")},t.prototype.setNativeFunctionPrototype=function(e,r,i){this.setProperty(e.properties["prototype"],r,this.createNativeFunction(i,!1),t.NONENUMERABLE_DESCRIPTOR)},t.prototype.setAsyncFunctionPrototype=function(e,r,i){this.setProperty(e.properties["prototype"],r,this.createAsyncFunction(i),t.NONENUMERABLE_DESCRIPTOR)},t.prototype.getScope=function(){var e=this.stateStack[this.stateStack.length-1].scope;if(!e)throw Error("No scope found.");return e},t.prototype.createScope=function(e,r){var i=!1;if(r&&r.strict)i=!0;else{var n=e["body"]&&e["body"][0];n&&n.expression&&"Literal"===n.expression["type"]&&"use strict"===n.expression.value&&(i=!0)}var o=this.createObjectProto(null),s=new t.Scope(r,i,o);return r||this.initGlobal(s.object),this.populateScope_(e,s),s},t.prototype.createSpecialScope=function(e,r){if(!e)throw Error("parentScope required");var i=r||this.createObjectProto(null);return new t.Scope(e,e.strict,i)},t.prototype.getValueFromScope=function(e){var t=this.getScope();while(t&&t!==this.globalScope){if(e in t.object.properties)return t.object.properties[e];t=t.parentScope}if(t===this.globalScope&&this.hasProperty(t.object,e))return this.getProperty(t.object,e);var r=this.stateStack[this.stateStack.length-1].node;"UnaryExpression"===r["type"]&&"typeof"===r["operator"]||this.throwException(this.REFERENCE_ERROR,e+" is not defined")},t.prototype.setValueToScope=function(e,t){var r=this.getScope(),i=r.strict;while(r&&r!==this.globalScope){if(e in r.object.properties)return void(r.object.properties[e]=t);r=r.parentScope}if(r===this.globalScope&&(!i||this.hasProperty(r.object,e)))return this.setProperty(r.object,e,t);this.throwException(this.REFERENCE_ERROR,e+" is not defined")},t.prototype.populateScope_=function(e,r){if("VariableDeclaration"===e["type"])for(var i=0;i<e["declarations"].length;i++)this.setProperty(r.object,e["declarations"][i]["id"]["name"],void 0,t.VARIABLE_DESCRIPTOR);else{if("FunctionDeclaration"===e["type"])return void this.setProperty(r.object,e["id"]["name"],this.createFunction(e,r),t.VARIABLE_DESCRIPTOR);if("FunctionExpression"===e["type"])return;if("ExpressionStatement"===e["type"])return}var n=e["constructor"];for(var o in e){var s=e[o];if(s&&"object"===typeof s)if(Array.isArray(s))for(i=0;i<s.length;i++)s[i]&&s[i].constructor===n&&this.populateScope_(s[i],r);else s.constructor===n&&this.populateScope_(s,r)}},t.prototype.calledWithNew=function(){return this.stateStack[this.stateStack.length-1].isConstructor},t.prototype.getValue=function(e){return e[0]===t.SCOPE_REFERENCE?this.getValueFromScope(e[1]):this.getProperty(e[0],e[1])},t.prototype.setValue=function(e,r){return e[0]===t.SCOPE_REFERENCE?this.setValueToScope(e[1],r):this.setProperty(e[0],e[1],r)},t.prototype.throwException=function(e,r){if(void 0===r)var i=e;else{i=this.createObject(e);this.setProperty(i,"message",r,t.NONENUMERABLE_DESCRIPTOR)}throw this.unwind(t.Completion.THROW,i,void 0),t.STEP_ERROR},t.prototype.unwind=function(e,r,i){if(e===t.Completion.NORMAL)throw TypeError("Should not unwind for NORMAL completions");e:for(var n=this.stateStack;n.length>0;n.pop()){var o=n[n.length-1];switch(o.node["type"]){case"TryStatement":return void(o.cv={type:e,value:r,label:i});case"CallExpression":case"NewExpression":if(e===t.Completion.RETURN)return void(o.value=r);if(e!==t.Completion.THROW)throw Error("Unsynatctic break/continue not rejected by Acorn");break;case"Program":o.done=!0;break e}if(e===t.Completion.BREAK){if(i?o.labels&&-1!==o.labels.indexOf(i):o.isLoop||o.isSwitch)return void n.pop()}else if(e===t.Completion.CONTINUE&&(i?o.labels&&-1!==o.labels.indexOf(i):o.isLoop))return}var s;if(this.isa(r,this.ERROR)){var a={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},l=String(this.getProperty(r,"name")),h=this.getProperty(r,"message").valueOf(),u=a[l]||Error;s=u(h)}else s=String(r);throw s},t.prototype.createGetter_=function(e,r){if(!this.getterStep_)throw Error("Unexpected call to createGetter");this.getterStep_=!1;var i=Array.isArray(r)?r[0]:r,n=new this.nodeConstructor({options:{}});n["type"]="CallExpression";var o=new t.State(n,this.stateStack[this.stateStack.length-1].scope);return o.doneCallee_=!0,o.funcThis_=i,o.func_=e,o.doneArgs_=!0,o.arguments_=[],o},t.prototype.createSetter_=function(e,r,i){if(!this.setterStep_)throw Error("Unexpected call to createSetter");this.setterStep_=!1;var n=Array.isArray(r)?r[0]:this.globalObject,o=new this.nodeConstructor({options:{}});o["type"]="CallExpression";var s=new t.State(o,this.stateStack[this.stateStack.length-1].scope);return s.doneCallee_=!0,s.funcThis_=n,s.func_=e,s.doneArgs_=!0,s.arguments_=[i],s},t.prototype.boxThis_=function(e){if(void 0===e||null===e)return this.globalObject;if(!(e instanceof t.Object)){var r=this.createObjectProto(this.getPrototype(e));return r.data=e,r}return e},t.Value,t.State=function(e,t){this.node=e,this.scope=t},t.Scope=function(e,t,r){this.parentScope=e,this.strict=t,this.object=r},t.Object=function(e){this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.proto=e},t.Object.prototype.proto=null,t.Object.prototype.class="Object",t.Object.prototype.data=null,t.Object.prototype.toString=function(){if(!(this instanceof t.Object))return String(this);if("Array"===this.class){var e=t.toStringCycles_;e.push(this);try{var r=[],i=this.properties.length,n=!1;i>1024&&(i=1e3,n=!0);for(var o=0;o<i;o++){var s=this.properties[o];r[o]=s instanceof t.Object&&-1!==e.indexOf(s)?"...":s}n&&r.push("...")}finally{e.pop()}return r.join(",")}if("Error"===this.class){var a,l;e=t.toStringCycles_;if(-1!==e.indexOf(this))return"[object Error]";var h=this;do{if("name"in h.properties){a=h.properties["name"];break}}while(h=h.proto);h=this;do{if("message"in h.properties){l=h.properties["message"];break}}while(h=h.proto);e.push(this);try{a=a&&String(a),l=l&&String(l)}finally{e.pop()}return l?a+": "+l:String(a)}return null!==this.data?String(this.data):"[object "+this.class+"]"},t.Object.prototype.valueOf=function(){return void 0===this.data||null===this.data||this.data instanceof RegExp?this:this.data instanceof Date?this.data.valueOf():this.data},t.prototype["stepArrayExpression"]=function(e,r,i){var n=i["elements"],o=r.n_||0;r.array_?(this.setProperty(r.array_,o,r.value),o++):(r.array_=this.createArray(),r.array_.properties.length=n.length);while(o<n.length){if(n[o])return r.n_=o,new t.State(n[o],r.scope);o++}e.pop(),e[e.length-1].value=r.array_},t.prototype["stepAssignmentExpression"]=function(e,r,i){if(!r.doneLeft_){r.doneLeft_=!0;var n=new t.State(i["left"],r.scope);return n.components=!0,n}if(!r.doneRight_){if(r.leftReference_||(r.leftReference_=r.value),r.doneGetter_&&(r.leftValue_=r.value),!r.doneGetter_&&"="!==i["operator"]){var o=this.getValue(r.leftReference_);if(r.leftValue_=o,this.getterStep_){r.doneGetter_=!0;var s=o;return this.createGetter_(s,r.leftReference_)}}return r.doneRight_=!0,"="===i["operator"]&&"Identifier"===i["left"]["type"]&&(r.destinationName=i["left"]["name"]),new t.State(i["right"],r.scope)}if(r.doneSetter_)return e.pop(),void(e[e.length-1].value=r.setterValue_);var a=r.leftValue_,l=r.value;switch(i["operator"]){case"=":a=l;break;case"+=":a+=l;break;case"-=":a-=l;break;case"*=":a*=l;break;case"/=":a/=l;break;case"%=":a%=l;break;case"<<=":a<<=l;break;case">>=":a>>=l;break;case">>>=":a>>>=l;break;case"&=":a&=l;break;case"^=":a^=l;break;case"|=":a|=l;break;default:throw SyntaxError("Unknown assignment expression: "+i["operator"])}var h=this.setValue(r.leftReference_,a);if(h)return r.doneSetter_=!0,r.setterValue_=a,this.createSetter_(h,r.leftReference_,a);e.pop(),e[e.length-1].value=a},t.prototype["stepBinaryExpression"]=function(e,r,i){if(!r.doneLeft_)return r.doneLeft_=!0,new t.State(i["left"],r.scope);if(!r.doneRight_)return r.doneRight_=!0,r.leftValue_=r.value,new t.State(i["right"],r.scope);e.pop();var n,o=r.leftValue_,s=r.value;switch(i["operator"]){case"==":n=o==s;break;case"!=":n=o!=s;break;case"===":n=o===s;break;case"!==":n=o!==s;break;case">":n=o>s;break;case">=":n=o>=s;break;case"<":n=o<s;break;case"<=":n=o<=s;break;case"+":n=o+s;break;case"-":n=o-s;break;case"*":n=o*s;break;case"/":n=o/s;break;case"%":n=o%s;break;case"&":n=o&s;break;case"|":n=o|s;break;case"^":n=o^s;break;case"<<":n=o<<s;break;case">>":n=o>>s;break;case">>>":n=o>>>s;break;case"in":s instanceof t.Object||this.throwException(this.TYPE_ERROR,"'in' expects an object, not '"+s+"'"),n=this.hasProperty(s,o);break;case"instanceof":this.isa(s,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"Right-hand side of instanceof is not an object"),n=o instanceof t.Object&&this.isa(o,s);break;default:throw SyntaxError("Unknown binary operator: "+i["operator"])}e[e.length-1].value=n},t.prototype["stepBlockStatement"]=function(e,r,i){var n=r.n_||0,o=i["body"][n];if(o)return r.n_=n+1,new t.State(o,r.scope);e.pop()},t.prototype["stepBreakStatement"]=function(e,r,i){var n=i["label"]&&i["label"]["name"];this.unwind(t.Completion.BREAK,void 0,n)},t.prototype["stepCallExpression"]=function(r,i,n){if(!i.doneCallee_){i.doneCallee_=1;var o=new t.State(n["callee"],i.scope);return o.components=!0,o}if(1===i.doneCallee_){i.doneCallee_=2;var s=i.value;if(Array.isArray(s)){if(i.func_=this.getValue(s),s[0]===t.SCOPE_REFERENCE?i.directEval_="eval"===s[1]:i.funcThis_=s[0],s=i.func_,this.getterStep_)return i.doneCallee_=1,this.createGetter_(s,i.value)}else i.func_=s;i.arguments_=[],i.n_=0}s=i.func_;if(!i.doneArgs_){if(0!==i.n_&&i.arguments_.push(i.value),n["arguments"][i.n_])return new t.State(n["arguments"][i.n_++],i.scope);if("NewExpression"===n["type"]){if(s instanceof t.Object&&!s.illegalConstructor||this.throwException(this.TYPE_ERROR,s+" is not a constructor"),s===this.ARRAY)i.funcThis_=this.createArray();else{var a=s.properties["prototype"];"object"===typeof a&&null!==a||(a=this.OBJECT_PROTO),i.funcThis_=this.createObjectProto(a)}i.isConstructor=!0}i.doneArgs_=!0}if(i.doneExec_)r.pop(),i.isConstructor&&"object"!==typeof i.value?r[r.length-1].value=i.funcThis_:r[r.length-1].value=i.value;else{i.doneExec_=!0,s instanceof t.Object||this.throwException(this.TYPE_ERROR,s+" is not a function");var l=s.node;if(l){for(var h=this.createScope(l["body"],s.parentScope),u=0;u<l["params"].length;u++){var c=l["params"][u]["name"],d=i.arguments_.length>u?i.arguments_[u]:void 0;this.setProperty(h.object,c,d)}var p=this.createArray();for(u=0;u<i.arguments_.length;u++)this.setProperty(p,u,i.arguments_[u]);this.setProperty(h.object,"arguments",p);var f=l["id"]&&l["id"]["name"];return f&&this.setProperty(h.object,f,s),h.strict||(i.funcThis_=this.boxThis_(i.funcThis_)),this.setProperty(h.object,"this",i.funcThis_,t.READONLY_DESCRIPTOR),i.value=void 0,new t.State(l["body"],h)}if(s.eval){var _=i.arguments_[0];if("string"===typeof _){try{var g=e.parse(String(_),t.PARSE_OPTIONS)}catch(O){this.throwException(this.SYNTAX_ERROR,"Invalid code: "+O.message)}var m=new this.nodeConstructor({options:{}});m["type"]="EvalProgram_",m["body"]=g["body"],t.stripLocations_(m,n["start"],n["end"]);h=i.directEval_?i.scope:this.globalScope;return h.strict?h=this.createScope(g,h):this.populateScope_(g,h),this.value=void 0,new t.State(m,h)}i.value=_}else if(s.nativeFunc)i.scope.strict||(i.funcThis_=this.boxThis_(i.funcThis_)),i.value=s.nativeFunc.apply(i.funcThis_,i.arguments_);else{if(s.asyncFunc){var b=this,y=function(e){i.value=e,b.paused_=!1},v=s.asyncFunc.length-1,T=i.arguments_.concat(new Array(v)).slice(0,v);return T.push(y),this.paused_=!0,i.scope.strict||(i.funcThis_=this.boxThis_(i.funcThis_)),void s.asyncFunc.apply(i.funcThis_,T)}this.throwException(this.TYPE_ERROR,s.class+" is not callable")}}},t.prototype["stepCatchClause"]=function(e,r,i){if(!r.done_){r.done_=!0;var n=this.createSpecialScope(r.scope);return this.setProperty(n.object,i["param"]["name"],r.throwValue),new t.State(i["body"],n)}e.pop()},t.prototype["stepConditionalExpression"]=function(e,r,i){var n=r.mode_||0;if(0===n)return r.mode_=1,new t.State(i["test"],r.scope);if(1===n){r.mode_=2;var o=Boolean(r.value);if(o&&i["consequent"])return new t.State(i["consequent"],r.scope);if(!o&&i["alternate"])return new t.State(i["alternate"],r.scope);this.value=void 0}e.pop(),"ConditionalExpression"===i["type"]&&(e[e.length-1].value=r.value)},t.prototype["stepContinueStatement"]=function(e,r,i){var n=i["label"]&&i["label"]["name"];this.unwind(t.Completion.CONTINUE,void 0,n)},t.prototype["stepDebuggerStatement"]=function(e,t,r){e.pop()},t.prototype["stepDoWhileStatement"]=function(e,r,i){if("DoWhileStatement"===i["type"]&&void 0===r.test_&&(r.value=!0,r.test_=!0),!r.test_)return r.test_=!0,new t.State(i["test"],r.scope);if(r.value){if(i["body"])return r.test_=!1,r.isLoop=!0,new t.State(i["body"],r.scope)}else e.pop()},t.prototype["stepEmptyStatement"]=function(e,t,r){e.pop()},t.prototype["stepEvalProgram_"]=function(e,r,i){var n=r.n_||0,o=i["body"][n];if(o)return r.n_=n+1,new t.State(o,r.scope);e.pop(),e[e.length-1].value=this.value},t.prototype["stepExpressionStatement"]=function(e,r,i){if(!r.done_)return r.done_=!0,new t.State(i["expression"],r.scope);e.pop(),this.value=r.value},t.prototype["stepForInStatement"]=function(e,r,i){if(!r.doneInit_&&(r.doneInit_=!0,i["left"]["declarations"]&&i["left"]["declarations"][0]["init"]))return r.scope.strict&&this.throwException(this.SYNTAX_ERROR,"for-in loop variable declaration may not have an initializer."),new t.State(i["left"],r.scope);if(!r.doneObject_)return r.doneObject_=!0,r.variable_||(r.variable_=r.value),new t.State(i["right"],r.scope);if(r.isLoop||(r.isLoop=!0,r.object_=r.value,r.visited_=Object.create(null)),void 0===r.name_)e:while(1){if(r.object_ instanceof t.Object){r.props_||(r.props_=Object.getOwnPropertyNames(r.object_.properties));while(1){var n=r.props_.shift();if(void 0===n)break;if(Object.prototype.hasOwnProperty.call(r.object_.properties,n)&&(!r.visited_[n]&&(r.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(r.object_.properties,n)))){r.name_=n;break e}}}else if(null!==r.object_&&void 0!==r.object_){r.props_||(r.props_=Object.getOwnPropertyNames(r.object_));while(1){n=r.props_.shift();if(void 0===n)break;if(r.visited_[n]=!0,Object.prototype.propertyIsEnumerable.call(r.object_,n)){r.name_=n;break e}}}if(r.object_=this.getPrototype(r.object_),r.props_=null,null===r.object_)return void e.pop()}if(!r.doneVariable_){r.doneVariable_=!0;var o=i["left"];if("VariableDeclaration"!==o["type"]){r.variable_=null;var s=new t.State(o,r.scope);return s.components=!0,s}r.variable_=[t.SCOPE_REFERENCE,o["declarations"][0]["id"]["name"]]}if(r.variable_||(r.variable_=r.value),!r.doneSetter_){r.doneSetter_=!0;var a=r.name_,l=this.setValue(r.variable_,a);if(l)return this.createSetter_(l,r.variable_,a)}return r.name_=void 0,r.doneVariable_=!1,r.doneSetter_=!1,i["body"]?new t.State(i["body"],r.scope):void 0},t.prototype["stepForStatement"]=function(e,r,i){var n=r.mode_||0;if(0===n){if(r.mode_=1,i["init"])return new t.State(i["init"],r.scope)}else if(1===n){if(r.mode_=2,i["test"])return new t.State(i["test"],r.scope)}else if(2===n){if(r.mode_=3,!i["test"]||r.value)return r.isLoop=!0,new t.State(i["body"],r.scope);e.pop()}else if(3===n&&(r.mode_=1,i["update"]))return new t.State(i["update"],r.scope)},t.prototype["stepFunctionDeclaration"]=function(e,t,r){e.pop()},t.prototype["stepFunctionExpression"]=function(e,t,r){e.pop(),t=e[e.length-1],t.value=this.createFunction(r,t.scope,t.destinationName)},t.prototype["stepIdentifier"]=function(e,r,i){if(e.pop(),r.components)e[e.length-1].value=[t.SCOPE_REFERENCE,i["name"]];else{var n=this.getValueFromScope(i["name"]);if(this.getterStep_){var o=n;return this.createGetter_(o,this.globalObject)}e[e.length-1].value=n}},t.prototype["stepIfStatement"]=t.prototype["stepConditionalExpression"],t.prototype["stepLabeledStatement"]=function(e,r,i){e.pop();var n=r.labels||[];n.push(i["label"]["name"]);var o=new t.State(i["body"],r.scope);return o.labels=n,o},t.prototype["stepLiteral"]=function(e,t,r){e.pop();var i=r["value"];if(i instanceof RegExp){var n=this.createObjectProto(this.REGEXP_PROTO);this.populateRegExp(n,i),i=n}e[e.length-1].value=i},t.prototype["stepLogicalExpression"]=function(e,r,i){if("&&"!==i["operator"]&&"||"!==i["operator"])throw SyntaxError("Unknown logical operator: "+i["operator"]);if(!r.doneLeft_)return r.doneLeft_=!0,new t.State(i["left"],r.scope);if(r.doneRight_)e.pop(),e[e.length-1].value=r.value;else{if(!("&&"===i["operator"]&&!r.value||"||"===i["operator"]&&r.value))return r.doneRight_=!0,new t.State(i["right"],r.scope);e.pop(),e[e.length-1].value=r.value}},t.prototype["stepMemberExpression"]=function(e,r,i){if(!r.doneObject_)return r.doneObject_=!0,new t.State(i["object"],r.scope);var n;if(i["computed"]){if(!r.doneProperty_)return r.object_=r.value,r.doneProperty_=!0,new t.State(i["property"],r.scope);n=r.value}else r.object_=r.value,n=i["property"]["name"];if(e.pop(),r.components)e[e.length-1].value=[r.object_,n];else{var o=this.getProperty(r.object_,n);if(this.getterStep_){var s=o;return this.createGetter_(s,r.object_)}e[e.length-1].value=o}},t.prototype["stepNewExpression"]=t.prototype["stepCallExpression"],t.prototype["stepObjectExpression"]=function(e,r,i){var n=r.n_||0,o=i["properties"][n];if(r.object_){var s=r.destinationName;r.properties_[s]||(r.properties_[s]={}),r.properties_[s][o["kind"]]=r.value,r.n_=++n,o=i["properties"][n]}else r.object_=this.createObjectProto(this.OBJECT_PROTO),r.properties_=Object.create(null);if(o){var a=o["key"];if("Identifier"===a["type"])s=a["name"];else{if("Literal"!==a["type"])throw SyntaxError("Unknown object structure: "+a["type"]);s=a["value"]}return r.destinationName=s,new t.State(o["value"],r.scope)}for(var a in r.properties_){var l=r.properties_[a];if("get"in l||"set"in l){var h={configurable:!0,enumerable:!0,get:l["get"],set:l["set"]};this.setProperty(r.object_,a,t.VALUE_IN_DESCRIPTOR,h)}else this.setProperty(r.object_,a,l["init"])}e.pop(),e[e.length-1].value=r.object_},t.prototype["stepProgram"]=function(e,r,i){var n=i["body"].shift();if(n)return r.done=!1,new t.State(n,r.scope);r.done=!0},t.prototype["stepReturnStatement"]=function(e,r,i){if(i["argument"]&&!r.done_)return r.done_=!0,new t.State(i["argument"],r.scope);this.unwind(t.Completion.RETURN,r.value,void 0)},t.prototype["stepSequenceExpression"]=function(e,r,i){var n=r.n_||0,o=i["expressions"][n];if(o)return r.n_=n+1,new t.State(o,r.scope);e.pop(),e[e.length-1].value=r.value},t.prototype["stepSwitchStatement"]=function(e,r,i){if(!r.test_)return r.test_=1,new t.State(i["discriminant"],r.scope);1===r.test_&&(r.test_=2,r.switchValue_=r.value,r.defaultCase_=-1);while(1){var n=r.index_||0,o=i["cases"][n];if(r.matched_||!o||o["test"])if(o||r.matched_||-1===r.defaultCase_){if(!o)return void e.pop();if(!r.matched_&&!r.tested_&&o["test"])return r.tested_=!0,new t.State(o["test"],r.scope);if(r.matched_||r.value===r.switchValue_){r.matched_=!0;var s=r.n_||0;if(o["consequent"][s])return r.isSwitch=!0,r.n_=s+1,new t.State(o["consequent"][s],r.scope)}r.tested_=!1,r.n_=0,r.index_=n+1}else r.matched_=!0,r.index_=r.defaultCase_;else r.defaultCase_=n,r.index_=n+1}},t.prototype["stepThisExpression"]=function(e,t,r){e.pop(),e[e.length-1].value=this.getValueFromScope("this")},t.prototype["stepThrowStatement"]=function(e,r,i){if(!r.done_)return r.done_=!0,new t.State(i["argument"],r.scope);this.throwException(r.value)},t.prototype["stepTryStatement"]=function(e,r,i){if(!r.doneBlock_)return r.doneBlock_=!0,new t.State(i["block"],r.scope);if(r.cv&&r.cv.type===t.Completion.THROW&&!r.doneHandler_&&i["handler"]){r.doneHandler_=!0;var n=new t.State(i["handler"],r.scope);return n.throwValue=r.cv.value,r.cv=void 0,n}if(!r.doneFinalizer_&&i["finalizer"])return r.doneFinalizer_=!0,new t.State(i["finalizer"],r.scope);e.pop(),r.cv&&this.unwind(r.cv.type,r.cv.value,r.cv.label)},t.prototype["stepUnaryExpression"]=function(e,r,i){if(!r.done_){r.done_=!0;var n=new t.State(i["argument"],r.scope);return n.components="delete"===i["operator"],n}e.pop();var o=r.value;if("-"===i["operator"])o=-o;else if("+"===i["operator"])o=+o;else if("!"===i["operator"])o=!o;else if("~"===i["operator"])o=~o;else if("delete"===i["operator"]){var s=!0;if(Array.isArray(o)){var a=o[0];a===t.SCOPE_REFERENCE&&(a=r.scope);var l=String(o[1]);try{delete a.properties[l]}catch(h){r.scope.strict?this.throwException(this.TYPE_ERROR,"Cannot delete property '"+l+"' of '"+a+"'"):s=!1}}o=s}else if("typeof"===i["operator"])o=o&&"Function"===o.class?"function":typeof o;else{if("void"!==i["operator"])throw SyntaxError("Unknown unary operator: "+i["operator"]);o=void 0}e[e.length-1].value=o},t.prototype["stepUpdateExpression"]=function(e,r,i){if(!r.doneLeft_){r.doneLeft_=!0;var n=new t.State(i["argument"],r.scope);return n.components=!0,n}if(r.leftSide_||(r.leftSide_=r.value),r.doneGetter_&&(r.leftValue_=r.value),!r.doneGetter_){var o=this.getValue(r.leftSide_);if(r.leftValue_=o,this.getterStep_){r.doneGetter_=!0;var s=o;return this.createGetter_(s,r.leftSide_)}}if(r.doneSetter_)return e.pop(),void(e[e.length-1].value=r.setterValue_);var a;o=Number(r.leftValue_);if("++"===i["operator"])a=o+1;else{if("--"!==i["operator"])throw SyntaxError("Unknown update expression: "+i["operator"]);a=o-1}var l=i["prefix"]?a:o,h=this.setValue(r.leftSide_,a);if(h)return r.doneSetter_=!0,r.setterValue_=l,this.createSetter_(h,r.leftSide_,a);e.pop(),e[e.length-1].value=l},t.prototype["stepVariableDeclaration"]=function(e,r,i){var n=i["declarations"],o=r.n_||0,s=n[o];r.init_&&s&&(this.setValueToScope(s["id"]["name"],r.value),r.init_=!1,s=n[++o]);while(s){if(s["init"])return r.n_=o,r.init_=!0,r.destinationName=s["id"]["name"],new t.State(s["init"],r.scope);s=n[++o]}e.pop()},t.prototype["stepWithStatement"]=function(e,r,i){if(!r.doneObject_)return r.doneObject_=!0,new t.State(i["object"],r.scope);if(!r.doneBody_){r.doneBody_=!0;var n=this.createSpecialScope(r.scope,r.value);return new t.State(i["body"],n)}e.pop()},t.prototype["stepWhileStatement"]=t.prototype["stepDoWhileStatement"],this["Interpreter"]=t,t.prototype["step"]=t.prototype.step,t.prototype["run"]=t.prototype.run,t.prototype["appendCode"]=t.prototype.appendCode,t.prototype["createObject"]=t.prototype.createObject,t.prototype["createObjectProto"]=t.prototype.createObjectProto,t.prototype["createAsyncFunction"]=t.prototype.createAsyncFunction,t.prototype["createNativeFunction"]=t.prototype.createNativeFunction,t.prototype["getProperty"]=t.prototype.getProperty,t.prototype["setProperty"]=t.prototype.setProperty,t.prototype["nativeToPseudo"]=t.prototype.nativeToPseudo,t.prototype["pseudoToNative"]=t.prototype.pseudoToNative}).call(this,r(/*! ./original-repo/acorn.js */"./original-repo/acorn.js"))},"./src/js-interpreter.js":
/*!*******************************!*\
  !*** ./src/js-interpreter.js ***!
  \*******************************/
/*! exports provided: default */function(e,t,r){"use strict";r.r(t);var i=r(/*! ../original-repo/interpreter */"./original-repo/interpreter.js");t["default"]=i["Interpreter"]}})["default"]}))},8464:function(e,t,r){"use strict";var i=r("b7fd"),n=r("d722");i["defineBlocksWithJsonArray"]([{type:"while_program_start",message0:"当程序运行 %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"while_content"}],previousStatement:null,nextStatement:null,colour:"#609FD6",strokeColour:"#4088C8",tooltip:"123",helpUrl:"1"},{type:"move",message0:"移动 %1 CM",args0:[{type:"field_input",name:"move_distance",text:"50"}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"turn",message0:"向 %1 %2",args0:[{type:"field_dropdown",name:"dirction",options:[["左转","0"],["右转","1"]]},{type:"field_angle",name:"degree",angle:90}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"arc",message0:"弧形 %1 %2 ，半径 %3 CM",args0:[{type:"field_dropdown",name:"dirction",options:[["向左","0"],["向右","1"]]},{type:"field_angle",name:"degree",angle:90},{type:"field_number",name:"radius",value:50,min:1,max:100}],previousStatement:null,nextStatement:null,colour:"#F7D233",strokeColour:"#CCAD2B",tooltip:"",helpUrl:""},{type:"draw",message0:"设置 %1",args0:[{type:"field_dropdown",name:"pencilState",options:[[{src:n["a"].simulatorUrl+"pencil_down.png",width:50,height:50,alt:"pencil down"},"1"],[{src:n["a"].simulatorUrl+"pencil_up.png",width:50,height:50,alt:"pencil up"},"0"]]}],previousStatement:null,nextStatement:null,colour:"#81C679",tooltip:"",helpUrl:""},{type:"pencilcolor",message0:"设置笔颜色： 红 %1 绿 %2 蓝 %3",args0:[{type:"field_number",name:"red",value:100,min:0,max:255},{type:"field_number",name:"green",value:100,min:0,max:255},{type:"field_number",name:"blue",value:100,min:0,max:255}],previousStatement:null,nextStatement:null,colour:"#81C679",tooltip:"",helpUrl:""}]),i["JavaScript"]["while_program_start"]=function(e){var t=i["JavaScript"].statementToCode(e,"while_content"),r="robot.init();\n"+t+"robot.stop();\n";return r},i["JavaScript"]["move"]=function(e){var t=e.getFieldValue("move_distance"),r="robot.move("+t+");\n";return r},i["JavaScript"]["turn"]=function(e){var t=e.getFieldValue("dirction"),r=e.getFieldValue("degree"),i="robot.turn("+t+", "+r+");\n";return i},i["JavaScript"]["arc"]=function(e){var t=e.getFieldValue("dirction"),r=e.getFieldValue("degree"),i=e.getFieldValue("radius"),n="robot.arc("+t+", "+r+","+i+");\n";return n},i["JavaScript"]["draw"]=function(e){var t=e.getFieldValue("pencilState"),r="robot.drawable("+t+");\n";return r},i["JavaScript"]["pencilcolor"]=function(e){var t=e.getFieldValue("red")/255,r=e.getFieldValue("green")/255,i=e.getFieldValue("blue")/255,n="await robot.pencilcolor("+t+","+r+","+i+");\n";return n}},8654:function(e,t,r){"use strict";r("4ff9");var i=r("c37a"),n=(r("e9b1"),r("7560")),o=r("58df"),s=Object(o["a"])(n["a"]).extend({name:"v-counter",functional:!0,props:{value:{type:[Number,String],default:""},max:[Number,String]},render(e,t){const{props:r}=t,i=parseInt(r.max,10),o=parseInt(r.value,10),s=i?`${o} / ${i}`:String(r.value),a=i&&o>i;return e("div",{staticClass:"v-counter",class:{"error--text":a,...Object(n["b"])(t)}},s)}}),a=s,l=r("ba87"),h=r("90a2"),u=r("d9bd"),c=r("2b0e");function d(e){return c["a"].extend({name:"intersectable",data:()=>({isIntersecting:!1}),mounted(){h["a"].inserted(this.$el,{name:"intersect",value:this.onObserve},this.$vnode)},destroyed(){h["a"].unbind(this.$el,{name:"intersect",value:this.onObserve},this.$vnode)},methods:{onObserve(t,r,i){if(this.isIntersecting=i,i)for(let n=0,o=e.onVisible.length;n<o;n++){const t=this[e.onVisible[n]];"function"!==typeof t?Object(u["c"])(e.onVisible[n]+" method is not available on the instance but referenced in intersectable mixin options"):t()}}}})}var p=r("297c"),f=r("38cb"),_=r("dc22"),g=r("5607"),m=r("dd89"),b=r("80d2");const y=Object(o["a"])(i["a"],d({onVisible:["onResize","tryAutofocus"]}),p["a"]),v=["color","file","time","date","datetime-local","week","month"];t["a"]=y.extend().extend({name:"v-text-field",directives:{resize:_["a"],ripple:g["a"]},inheritAttrs:!1,props:{appendOuterIcon:String,autofocus:Boolean,clearable:Boolean,clearIcon:{type:String,default:"$clear"},counter:[Boolean,Number,String],counterValue:Function,filled:Boolean,flat:Boolean,fullWidth:Boolean,label:String,outlined:Boolean,placeholder:String,prefix:String,prependInnerIcon:String,persistentPlaceholder:Boolean,reverse:Boolean,rounded:Boolean,shaped:Boolean,singleLine:Boolean,solo:Boolean,soloInverted:Boolean,suffix:String,type:{type:String,default:"text"}},data:()=>({badInput:!1,labelWidth:0,prefixWidth:0,prependWidth:0,initialValue:null,isBooted:!1,isClearing:!1}),computed:{classes(){return{...i["a"].options.computed.classes.call(this),"v-text-field":!0,"v-text-field--full-width":this.fullWidth,"v-text-field--prefix":this.prefix,"v-text-field--single-line":this.isSingle,"v-text-field--solo":this.isSolo,"v-text-field--solo-inverted":this.soloInverted,"v-text-field--solo-flat":this.flat,"v-text-field--filled":this.filled,"v-text-field--is-booted":this.isBooted,"v-text-field--enclosed":this.isEnclosed,"v-text-field--reverse":this.reverse,"v-text-field--outlined":this.outlined,"v-text-field--placeholder":this.placeholder,"v-text-field--rounded":this.rounded,"v-text-field--shaped":this.shaped}},computedColor(){const e=f["a"].options.computed.computedColor.call(this);return this.soloInverted&&this.isFocused?this.color||"primary":e},computedCounterValue(){return"function"===typeof this.counterValue?this.counterValue(this.internalValue):[...(this.internalValue||"").toString()].length},hasCounter(){return!1!==this.counter&&null!=this.counter},hasDetails(){return i["a"].options.computed.hasDetails.call(this)||this.hasCounter},internalValue:{get(){return this.lazyValue},set(e){this.lazyValue=e,this.$emit("input",this.lazyValue)}},isDirty(){var e;return(null===(e=this.lazyValue)||void 0===e?void 0:e.toString().length)>0||this.badInput},isEnclosed(){return this.filled||this.isSolo||this.outlined},isLabelActive(){return this.isDirty||v.includes(this.type)},isSingle(){return this.isSolo||this.singleLine||this.fullWidth||this.filled&&!this.hasLabel},isSolo(){return this.solo||this.soloInverted},labelPosition(){let e=this.prefix&&!this.labelValue?this.prefixWidth:0;return this.labelValue&&this.prependWidth&&(e-=this.prependWidth),this.$vuetify.rtl===this.reverse?{left:e,right:"auto"}:{left:"auto",right:e}},showLabel(){return this.hasLabel&&!(this.isSingle&&this.labelValue)},labelValue(){return this.isFocused||this.isLabelActive||this.persistentPlaceholder}},watch:{outlined:"setLabelWidth",label(){this.$nextTick(this.setLabelWidth)},prefix(){this.$nextTick(this.setPrefixWidth)},isFocused:"updateValue",value(e){this.lazyValue=e}},created(){this.$attrs.hasOwnProperty("box")&&Object(u["a"])("box","filled",this),this.$attrs.hasOwnProperty("browser-autocomplete")&&Object(u["a"])("browser-autocomplete","autocomplete",this),this.shaped&&!(this.filled||this.outlined||this.isSolo)&&Object(u["c"])("shaped should be used with either filled or outlined",this)},mounted(){this.$watch(()=>this.labelValue,this.setLabelWidth),this.autofocus&&this.tryAutofocus(),requestAnimationFrame(()=>{this.isBooted=!0,requestAnimationFrame(()=>{this.isIntersecting||this.onResize()})})},methods:{focus(){this.onFocus()},blur(e){window.requestAnimationFrame(()=>{this.$refs.input&&this.$refs.input.blur()})},clearableCallback(){this.$refs.input&&this.$refs.input.focus(),this.$nextTick(()=>this.internalValue=null)},genAppendSlot(){const e=[];return this.$slots["append-outer"]?e.push(this.$slots["append-outer"]):this.appendOuterIcon&&e.push(this.genIcon("appendOuter")),this.genSlot("append","outer",e)},genPrependInnerSlot(){const e=[];return this.$slots["prepend-inner"]?e.push(this.$slots["prepend-inner"]):this.prependInnerIcon&&e.push(this.genIcon("prependInner")),this.genSlot("prepend","inner",e)},genIconSlot(){const e=[];return this.$slots.append?e.push(this.$slots.append):this.appendIcon&&e.push(this.genIcon("append")),this.genSlot("append","inner",e)},genInputSlot(){const e=i["a"].options.methods.genInputSlot.call(this),t=this.genPrependInnerSlot();return t&&(e.children=e.children||[],e.children.unshift(t)),e},genClearIcon(){return this.clearable?this.isDirty?this.genSlot("append","inner",[this.genIcon("clear",this.clearableCallback)]):this.genSlot("append","inner",[this.$createElement("div")]):null},genCounter(){var e,t,r;if(!this.hasCounter)return null;const i=!0===this.counter?this.attrs$.maxlength:this.counter,n={dark:this.dark,light:this.light,max:i,value:this.computedCounterValue};return null!==(r=null===(t=(e=this.$scopedSlots).counter)||void 0===t?void 0:t.call(e,{props:n}))&&void 0!==r?r:this.$createElement(a,{props:n})},genControl(){return i["a"].options.methods.genControl.call(this)},genDefaultSlot(){return[this.genFieldset(),this.genTextFieldSlot(),this.genClearIcon(),this.genIconSlot(),this.genProgress()]},genFieldset(){return this.outlined?this.$createElement("fieldset",{attrs:{"aria-hidden":!0}},[this.genLegend()]):null},genLabel(){if(!this.showLabel)return null;const e={props:{absolute:!0,color:this.validationState,dark:this.dark,disabled:this.isDisabled,focused:!this.isSingle&&(this.isFocused||!!this.validationState),for:this.computedId,left:this.labelPosition.left,light:this.light,right:this.labelPosition.right,value:this.labelValue}};return this.$createElement(l["a"],e,this.$slots.label||this.label)},genLegend(){const e=this.singleLine||!this.labelValue&&!this.isDirty?0:this.labelWidth,t=this.$createElement("span",{domProps:{innerHTML:"&#8203;"},staticClass:"notranslate"});return this.$createElement("legend",{style:{width:this.isSingle?void 0:Object(b["h"])(e)}},[t])},genInput(){const e=Object.assign({},this.listeners$);delete e.change;const{title:t,...r}=this.attrs$;return this.$createElement("input",{style:{},domProps:{value:"number"===this.type&&Object.is(this.lazyValue,-0)?"-0":this.lazyValue},attrs:{...r,autofocus:this.autofocus,disabled:this.isDisabled,id:this.computedId,placeholder:this.persistentPlaceholder||this.isFocused||!this.hasLabel?this.placeholder:void 0,readonly:this.isReadonly,type:this.type},on:Object.assign(e,{blur:this.onBlur,input:this.onInput,focus:this.onFocus,keydown:this.onKeyDown}),ref:"input",directives:[{name:"resize",modifiers:{quiet:!0},value:this.onResize}]})},genMessages(){if(!this.showDetails)return null;const e=i["a"].options.methods.genMessages.call(this),t=this.genCounter();return this.$createElement("div",{staticClass:"v-text-field__details"},[e,t])},genTextFieldSlot(){return this.$createElement("div",{staticClass:"v-text-field__slot"},[this.genLabel(),this.prefix?this.genAffix("prefix"):null,this.genInput(),this.suffix?this.genAffix("suffix"):null])},genAffix(e){return this.$createElement("div",{class:"v-text-field__"+e,ref:e},this[e])},onBlur(e){this.isFocused=!1,e&&this.$nextTick(()=>this.$emit("blur",e))},onClick(){this.isFocused||this.isDisabled||!this.$refs.input||this.$refs.input.focus()},onFocus(e){if(!this.$refs.input)return;const t=Object(m["a"])(this.$el);return t?t.activeElement!==this.$refs.input?this.$refs.input.focus():void(this.isFocused||(this.isFocused=!0,e&&this.$emit("focus",e))):void 0},onInput(e){const t=e.target;this.internalValue=t.value,this.badInput=t.validity&&t.validity.badInput},onKeyDown(e){e.keyCode===b["w"].enter&&this.lazyValue!==this.initialValue&&(this.initialValue=this.lazyValue,this.$emit("change",this.initialValue)),this.$emit("keydown",e)},onMouseDown(e){e.target!==this.$refs.input&&(e.preventDefault(),e.stopPropagation()),i["a"].options.methods.onMouseDown.call(this,e)},onMouseUp(e){this.hasMouseDown&&this.focus(),i["a"].options.methods.onMouseUp.call(this,e)},setLabelWidth(){this.outlined&&(this.labelWidth=this.$refs.label?Math.min(.75*this.$refs.label.scrollWidth+6,this.$el.offsetWidth-24):0)},setPrefixWidth(){this.$refs.prefix&&(this.prefixWidth=this.$refs.prefix.offsetWidth)},setPrependWidth(){this.outlined&&this.$refs["prepend-inner"]&&(this.prependWidth=this.$refs["prepend-inner"].offsetWidth)},tryAutofocus(){if(!this.autofocus||"undefined"===typeof document||!this.$refs.input)return!1;const e=Object(m["a"])(this.$el);return!(!e||e.activeElement===this.$refs.input)&&(this.$refs.input.focus(),!0)},updateValue(e){this.hasColor=e,e?this.initialValue=this.lazyValue:this.initialValue!==this.lazyValue&&this.$emit("change",this.lazyValue)},onResize(){this.setLabelWidth(),this.setPrefixWidth(),this.setPrependWidth()}}})},"8ff2":function(e,t,r){},"99d9":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return l}));var i=r("b0af"),n=r("80d2");const o=Object(n["i"])("v-card__actions"),s=Object(n["i"])("v-card__subtitle"),a=Object(n["i"])("v-card__text"),l=Object(n["i"])("v-card__title");i["a"]},"9a63":function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},"9c0d":function(e,t,r){"use strict";r("5e35")},"9d26":function(e,t,r){"use strict";var i=r("132d");t["a"]=i["a"]},"9d65":function(e,t,r){"use strict";var i=r("d9bd"),n=r("2b0e");t["a"]=n["a"].extend().extend({name:"bootable",props:{eager:Boolean},data:()=>({isBooted:!1}),computed:{hasContent(){return this.isBooted||this.eager||this.isActive}},watch:{isActive(){this.isBooted=!0}},created(){"lazy"in this.$attrs&&Object(i["e"])("lazy",this)},methods:{showLazyContent(e){return this.hasContent&&e?e():[this.$createElement()]}}})},a293:function(e,t,r){"use strict";var i=r("dd89");function n(){return!0}function o(e,t,r){if(!e||!1===s(e,r))return!1;const n=Object(i["a"])(t);if("undefined"!==typeof ShadowRoot&&n instanceof ShadowRoot&&n.host===e.target)return!1;const o=("object"===typeof r.value&&r.value.include||(()=>[]))();return o.push(t),!o.some(t=>t.contains(e.target))}function s(e,t){const r="object"===typeof t.value&&t.value.closeConditional||n;return r(e)}function a(e,t,r){const i="function"===typeof r.value?r.value:r.value.handler;t._clickOutside.lastMousedownWasOutside&&o(e,t,r)&&setTimeout(()=>{s(e,r)&&i&&i(e)},0)}function l(e,t){const r=Object(i["a"])(e);t(document),"undefined"!==typeof ShadowRoot&&r instanceof ShadowRoot&&t(r)}const h={inserted(e,t,r){const i=r=>a(r,e,t),n=r=>{e._clickOutside.lastMousedownWasOutside=o(r,e,t)};l(e,e=>{e.addEventListener("click",i,!0),e.addEventListener("mousedown",n,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[r.context._uid]={onClick:i,onMousedown:n}},unbind(e,t,r){e._clickOutside&&(l(e,t=>{var i;if(!t||!(null===(i=e._clickOutside)||void 0===i?void 0:i[r.context._uid]))return;const{onClick:n,onMousedown:o}=e._clickOutside[r.context._uid];t.removeEventListener("click",n,!0),t.removeEventListener("mousedown",o,!0)}),delete e._clickOutside[r.context._uid])}};t["a"]=h},a452:function(e,t,r){"use strict";var i=r("2b0e");function n(e="value",t="change"){return i["a"].extend({name:"proxyable",model:{prop:e,event:t},props:{[e]:{required:!1}},data(){return{internalLazyValue:this[e]}},computed:{internalValue:{get(){return this.internalLazyValue},set(e){e!==this.internalLazyValue&&(this.internalLazyValue=e,this.$emit(t,e))}}},watch:{[e](e){this.internalLazyValue=e}}})}const o=n();t["a"]=o},b0af:function(e,t,r){"use strict";r("615b");var i=r("10d2"),n=r("297c"),o=r("1c87"),s=r("58df");t["a"]=Object(s["a"])(n["a"],o["a"],i["a"]).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes(){return{"v-card":!0,...o["a"].options.computed.classes.call(this),"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised,...i["a"].options.computed.classes.call(this)}},styles(){const e={...i["a"].options.computed.styles.call(this)};return this.img&&(e.background=`url("${this.img}") center center / cover no-repeat`),e}},methods:{genProgress(){const e=n["a"].options.methods.genProgress.call(this);return e?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[e]):null}},render(e){const{tag:t,data:r}=this.generateRouteLink();return r.style=this.styles,this.isClickable&&(r.attrs=r.attrs||{},r.attrs.tabindex=0),e(t,this.setBackgroundColor(this.color,r),[this.genProgress(),this.$slots.default])}})},b234:function(e,t,r){(function(t){!function(t,i){e.exports=i(r("633b"))}("undefined"!=typeof self&&self,(function(e){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=20)}([function(t,r){t.exports=e},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var i=r(0),n=r(2),o=function(){function e(){}return e.Get=function(e,t,r){if(!t||null==r||!t[r])throw new Error(e+": Failed to find index ("+r+")");return t[r]},e.Assign=function(e){if(e)for(var t=0;t<e.length;t++)e[t].index=t},e}(),s=function(){function e(e){this._completePromises=new Array,this._forAssetContainer=!1,this._babylonLights=[],this._disableInstancedMesh=0,this._disposed=!1,this._state=null,this._extensions=new Array,this._defaultBabylonMaterialData={},this._parent=e}return e.RegisterExtension=function(t,r){e.UnregisterExtension(t)&&i.Logger.Warn("Extension with the name '"+t+"' already exists"),e._RegisteredExtensions[t]={factory:r}},e.UnregisterExtension=function(t){return!!e._RegisteredExtensions[t]&&(delete e._RegisteredExtensions[t],!0)},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gltf",{get:function(){return this._gltf},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bin",{get:function(){return this._bin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"babylonScene",{get:function(){return this._babylonScene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootBabylonMesh",{get:function(){return this._rootBabylonMesh},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){if(!this._disposed){for(var e in this._disposed=!0,this._completePromises.length=0,this._extensions){var t=this._extensions[e];t.dispose&&t.dispose(),delete this._extensions[e]}this._gltf=null,this._babylonScene=null,this._rootBabylonMesh=null,this._parent.dispose()}},e.prototype.importMeshAsync=function(e,t,r,i,n,o,s){var a=this;return Promise.resolve().then((function(){a._babylonScene=t,a._rootUrl=n,a._fileName=s||"scene",a._forAssetContainer=r,a._loadData(i);var o=null;if(e){var l={};if(a._gltf.nodes)for(var h=0,u=a._gltf.nodes;h<u.length;h++){var c=u[h];c.name&&(l[c.name]=c.index)}o=(e instanceof Array?e:[e]).map((function(e){var t=l[e];if(void 0===t)throw new Error("Failed to find node '"+e+"'");return t}))}return a._loadAsync(o,(function(){return{meshes:a._getMeshes(),particleSystems:[],skeletons:a._getSkeletons(),animationGroups:a._getAnimationGroups(),lights:a._babylonLights,transformNodes:a._getTransformNodes(),geometries:a._getGeometries()}}))}))},e.prototype.loadAsync=function(e,t,r,i,n){var o=this;return Promise.resolve().then((function(){return o._babylonScene=e,o._rootUrl=r,o._fileName=n||"scene",o._loadData(t),o._loadAsync(null,(function(){}))}))},e.prototype._loadAsync=function(e,t){var r=this;return Promise.resolve().then((function(){r._uniqueRootUrl=-1===r._rootUrl.indexOf("file:")&&r._fileName?r._rootUrl:""+r._rootUrl+Date.now()+"/",r._loadExtensions(),r._checkExtensions();var s=n.GLTFLoaderState[n.GLTFLoaderState.LOADING]+" => "+n.GLTFLoaderState[n.GLTFLoaderState.READY],a=n.GLTFLoaderState[n.GLTFLoaderState.LOADING]+" => "+n.GLTFLoaderState[n.GLTFLoaderState.COMPLETE];r._parent._startPerformanceCounter(s),r._parent._startPerformanceCounter(a),r._setState(n.GLTFLoaderState.LOADING),r._extensionsOnLoading();var l=new Array,h=r._babylonScene.blockMaterialDirtyMechanism;if(r._babylonScene.blockMaterialDirtyMechanism=!0,e)l.push(r.loadSceneAsync("/nodes",{nodes:e,index:-1}));else if(null!=r._gltf.scene||r._gltf.scenes&&r._gltf.scenes[0]){var u=o.Get("/scene",r._gltf.scenes,r._gltf.scene||0);l.push(r.loadSceneAsync("/scenes/"+u.index,u))}if(r.parent.loadAllMaterials&&r._gltf.materials)for(var c=0;c<r._gltf.materials.length;++c){var d=r._gltf.materials[c],p="/materials/"+c,f=i.Material.TriangleFillMode;l.push(r._loadMaterialAsync(p,d,null,f,(function(e){})))}r._babylonScene.blockMaterialDirtyMechanism=h,r._parent.compileMaterials&&l.push(r._compileMaterialsAsync()),r._parent.compileShadowGenerators&&l.push(r._compileShadowGeneratorsAsync());var _=Promise.all(l).then((function(){return r._rootBabylonMesh&&r._rootBabylonMesh.setEnabled(!0),r._extensionsOnReady(),r._setState(n.GLTFLoaderState.READY),r._startAnimations(),t()}));return _.then((function(){r._parent._endPerformanceCounter(s),i.Tools.SetImmediate((function(){r._disposed||Promise.all(r._completePromises).then((function(){r._parent._endPerformanceCounter(a),r._setState(n.GLTFLoaderState.COMPLETE),r._parent.onCompleteObservable.notifyObservers(void 0),r._parent.onCompleteObservable.clear(),r.dispose()}),(function(e){r._parent.onErrorObservable.notifyObservers(e),r._parent.onErrorObservable.clear(),r.dispose()}))}))})),_})).catch((function(e){throw r._disposed||(r._parent.onErrorObservable.notifyObservers(e),r._parent.onErrorObservable.clear(),r.dispose()),e}))},e.prototype._loadData=function(e){if(this._gltf=e.json,this._setupData(),e.bin){var t=this._gltf.buffers;if(t&&t[0]&&!t[0].uri){var r=t[0];(r.byteLength<e.bin.byteLength-3||r.byteLength>e.bin.byteLength)&&i.Logger.Warn("Binary buffer length ("+r.byteLength+") from JSON does not match chunk length ("+e.bin.byteLength+")"),this._bin=e.bin}else i.Logger.Warn("Unexpected BIN chunk")}},e.prototype._setupData=function(){if(o.Assign(this._gltf.accessors),o.Assign(this._gltf.animations),o.Assign(this._gltf.buffers),o.Assign(this._gltf.bufferViews),o.Assign(this._gltf.cameras),o.Assign(this._gltf.images),o.Assign(this._gltf.materials),o.Assign(this._gltf.meshes),o.Assign(this._gltf.nodes),o.Assign(this._gltf.samplers),o.Assign(this._gltf.scenes),o.Assign(this._gltf.skins),o.Assign(this._gltf.textures),this._gltf.nodes){for(var e={},t=0,r=this._gltf.nodes;t<r.length;t++)if((h=r[t]).children)for(var i=0,n=h.children;i<n.length;i++)e[n[i]]=h.index;for(var s=this._createRootNode(),a=0,l=this._gltf.nodes;a<l.length;a++){var h,u=e[(h=l[a]).index];h.parent=void 0===u?s:this._gltf.nodes[u]}}},e.prototype._loadExtensions=function(){for(var t in e._RegisteredExtensions){var r=e._RegisteredExtensions[t].factory(this);r.name!==t&&i.Logger.Warn("The name of the glTF loader extension instance does not match the registered name: "+r.name+" !== "+t),this._extensions.push(r),this._parent.onExtensionLoadedObservable.notifyObservers(r)}this._extensions.sort((function(e,t){return(e.order||Number.MAX_VALUE)-(t.order||Number.MAX_VALUE)})),this._parent.onExtensionLoadedObservable.clear()},e.prototype._checkExtensions=function(){if(this._gltf.extensionsRequired)for(var e=function(e){if(!t._extensions.some((function(t){return t.name===e&&t.enabled})))throw new Error("Require extension "+e+" is not available")},t=this,r=0,i=this._gltf.extensionsRequired;r<i.length;r++)e(i[r])},e.prototype._setState=function(e){this._state=e,this.log(n.GLTFLoaderState[this._state])},e.prototype._createRootNode=function(){this._babylonScene._blockEntityCollection=this._forAssetContainer,this._rootBabylonMesh=new i.Mesh("__root__",this._babylonScene),this._babylonScene._blockEntityCollection=!1,this._rootBabylonMesh.setEnabled(!1);var t={_babylonTransformNode:this._rootBabylonMesh,index:-1};switch(this._parent.coordinateSystemMode){case n.GLTFLoaderCoordinateSystemMode.AUTO:this._babylonScene.useRightHandedSystem||(t.rotation=[0,1,0,0],t.scale=[1,1,-1],e._LoadTransform(t,this._rootBabylonMesh));break;case n.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED:this._babylonScene.useRightHandedSystem=!0;break;default:throw new Error("Invalid coordinate system mode ("+this._parent.coordinateSystemMode+")")}return this._parent.onMeshLoadedObservable.notifyObservers(this._rootBabylonMesh),t},e.prototype.loadSceneAsync=function(e,t){var r=this,i=this._extensionsLoadSceneAsync(e,t);if(i)return i;var n=new Array;if(this.logOpen(e+" "+(t.name||"")),t.nodes)for(var s=0,a=t.nodes;s<a.length;s++){var l=a[s],h=o.Get(e+"/nodes/"+l,this._gltf.nodes,l);n.push(this.loadNodeAsync("/nodes/"+h.index,h,(function(e){e.parent=r._rootBabylonMesh})))}if(this._gltf.nodes)for(var u=0,c=this._gltf.nodes;u<c.length;u++)if((h=c[u])._babylonTransformNode&&h._babylonBones)for(var d=0,p=h._babylonBones;d<p.length;d++)p[d].linkTransformNode(h._babylonTransformNode);return n.push(this._loadAnimationsAsync()),this.logClose(),Promise.all(n).then((function(){}))},e.prototype._forEachPrimitive=function(e,t){if(e._primitiveBabylonMeshes)for(var r=0,i=e._primitiveBabylonMeshes;r<i.length;r++)t(i[r])},e.prototype._getGeometries=function(){var e=new Array,t=this._gltf.nodes;if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];this._forEachPrimitive(n,(function(t){var r=t.geometry;r&&-1===e.indexOf(r)&&e.push(r)}))}return e},e.prototype._getMeshes=function(){var e=new Array;e.push(this._rootBabylonMesh);var t=this._gltf.nodes;if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];this._forEachPrimitive(n,(function(t){e.push(t)}))}return e},e.prototype._getTransformNodes=function(){var e=new Array,t=this._gltf.nodes;if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];n._babylonTransformNode&&"TransformNode"===n._babylonTransformNode.getClassName()&&e.push(n._babylonTransformNode)}return e},e.prototype._getSkeletons=function(){var e=new Array,t=this._gltf.skins;if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];n._data&&e.push(n._data.babylonSkeleton)}return e},e.prototype._getAnimationGroups=function(){var e=new Array,t=this._gltf.animations;if(t)for(var r=0,i=t;r<i.length;r++){var n=i[r];n._babylonAnimationGroup&&e.push(n._babylonAnimationGroup)}return e},e.prototype._startAnimations=function(){switch(this._parent.animationStartMode){case n.GLTFLoaderAnimationStartMode.NONE:break;case n.GLTFLoaderAnimationStartMode.FIRST:0!==(e=this._getAnimationGroups()).length&&e[0].start(!0);break;case n.GLTFLoaderAnimationStartMode.ALL:for(var e,t=0,r=e=this._getAnimationGroups();t<r.length;t++)r[t].start(!0);break;default:return void i.Logger.Error("Invalid animation start mode ("+this._parent.animationStartMode+")")}},e.prototype.loadNodeAsync=function(t,r,n){var s=this;void 0===n&&(n=function(){});var a=this._extensionsLoadNodeAsync(t,r,n);if(a)return a;if(r._babylonTransformNode)throw new Error(t+": Invalid recursive node hierarchy");var l=new Array;this.logOpen(t+" "+(r.name||""));var h=function(i){if(e.AddPointerMetadata(i,t),e._LoadTransform(r,i),null!=r.camera){var a=o.Get(t+"/camera",s._gltf.cameras,r.camera);l.push(s.loadCameraAsync("/cameras/"+a.index,a,(function(e){e.parent=i})))}if(r.children)for(var h=0,u=r.children;h<u.length;h++){var c=u[h],d=o.Get(t+"/children/"+c,s._gltf.nodes,c);l.push(s.loadNodeAsync("/nodes/"+d.index,d,(function(e){e.parent=i})))}n(i)};if(null==r.mesh){var u=r.name||"node"+r.index;this._babylonScene._blockEntityCollection=this._forAssetContainer,r._babylonTransformNode=new i.TransformNode(u,this._babylonScene),this._babylonScene._blockEntityCollection=!1,h(r._babylonTransformNode)}else{var c=o.Get(t+"/mesh",this._gltf.meshes,r.mesh);l.push(this._loadMeshAsync("/meshes/"+c.index,r,c,h))}return this.logClose(),Promise.all(l).then((function(){return s._forEachPrimitive(r,(function(e){e.geometry&&e.geometry.useBoundingInfoFromGeometry?e._updateBoundingInfo():e.refreshBoundingInfo(!0)})),r._babylonTransformNode}))},e.prototype._loadMeshAsync=function(e,t,r,n){var s=r.primitives;if(!s||!s.length)throw new Error(e+": Primitives are missing");null==s[0].index&&o.Assign(s);var a=new Array;this.logOpen(e+" "+(r.name||""));var l=t.name||"node"+t.index;if(1===s.length){var h=r.primitives[0];a.push(this._loadMeshPrimitiveAsync(e+"/primitives/"+h.index,l,t,r,h,(function(e){t._babylonTransformNode=e,t._primitiveBabylonMeshes=[e]})))}else{this._babylonScene._blockEntityCollection=this._forAssetContainer,t._babylonTransformNode=new i.TransformNode(l,this._babylonScene),this._babylonScene._blockEntityCollection=!1,t._primitiveBabylonMeshes=[];for(var u=0,c=s;u<c.length;u++)h=c[u],a.push(this._loadMeshPrimitiveAsync(e+"/primitives/"+h.index,l+"_primitive"+h.index,t,r,h,(function(e){e.parent=t._babylonTransformNode,t._primitiveBabylonMeshes.push(e)})))}if(null!=t.skin){var d=o.Get(e+"/skin",this._gltf.skins,t.skin);a.push(this._loadSkinAsync("/skins/"+d.index,t,d))}return n(t._babylonTransformNode),this.logClose(),Promise.all(a).then((function(){return t._babylonTransformNode}))},e.prototype._loadMeshPrimitiveAsync=function(t,r,n,s,a,l){var h=this,u=this._extensionsLoadMeshPrimitiveAsync(t,r,n,s,a,l);if(u)return u;this.logOpen(""+t);var c,d,p=0===this._disableInstancedMesh&&this._parent.createInstances&&null==n.skin&&!s.primitives[0].targets;if(p&&a._instanceData)c=a._instanceData.babylonSourceMesh.createInstance(r),d=a._instanceData.promise;else{var f=new Array;this._babylonScene._blockEntityCollection=this._forAssetContainer;var _=new i.Mesh(r,this._babylonScene);this._babylonScene._blockEntityCollection=!1,_.overrideMaterialSideOrientation=this._babylonScene.useRightHandedSystem?i.Material.CounterClockWiseSideOrientation:i.Material.ClockWiseSideOrientation,this._createMorphTargets(t,n,s,a,_),f.push(this._loadVertexDataAsync(t,a,_).then((function(e){return h._loadMorphTargetsAsync(t,a,_,e).then((function(){h._babylonScene._blockEntityCollection=h._forAssetContainer,e.applyToMesh(_),h._babylonScene._blockEntityCollection=!1}))})));var g=e._GetDrawMode(t,a.mode);if(null==a.material){var m=this._defaultBabylonMaterialData[g];m||(m=this._createDefaultMaterial("__GLTFLoader._default",g),this._parent.onMaterialLoadedObservable.notifyObservers(m),this._defaultBabylonMaterialData[g]=m),_.material=m}else{var b=o.Get(t+"/material",this._gltf.materials,a.material);f.push(this._loadMaterialAsync("/materials/"+b.index,b,_,g,(function(e){_.material=e})))}d=Promise.all(f),p&&(a._instanceData={babylonSourceMesh:_,promise:d}),c=_}return e.AddPointerMetadata(c,t),this._parent.onMeshLoadedObservable.notifyObservers(c),l(c),this.logClose(),d.then((function(){return c}))},e.prototype._loadVertexDataAsync=function(e,t,r){var n=this,s=this._extensionsLoadVertexDataAsync(e,t,r);if(s)return s;var a=t.attributes;if(!a)throw new Error(e+": Attributes are missing");var l=new Array,h=new i.Geometry(r.name,this._babylonScene);if(null==t.indices)r.isUnIndexed=!0;else{var u=o.Get(e+"/indices",this._gltf.accessors,t.indices);l.push(this._loadIndicesAccessorAsync("/accessors/"+u.index,u).then((function(e){h.setIndices(e)})))}var c=function(t,s,u){if(null!=a[t]){r._delayInfo=r._delayInfo||[],-1===r._delayInfo.indexOf(s)&&r._delayInfo.push(s);var c=o.Get(e+"/attributes/"+t,n._gltf.accessors,a[t]);l.push(n._loadVertexAccessorAsync("/accessors/"+c.index,c,s).then((function(e){if(e.getKind()===i.VertexBuffer.PositionKind&&!n.parent.alwaysComputeBoundingBox&&!r.skeleton){var t=c.min,o=c.max;if(void 0!==t&&void 0!==o){var s=i.TmpVectors.Vector3[0],a=i.TmpVectors.Vector3[1];s.copyFromFloats.apply(s,t),a.copyFromFloats.apply(a,o),h._boundingInfo=new i.BoundingInfo(s,a),h.useBoundingInfoFromGeometry=!0}}h.setVerticesBuffer(e,c.count)}))),s==i.VertexBuffer.MatricesIndicesExtraKind&&(r.numBoneInfluencers=8),u&&u(c)}};return c("POSITION",i.VertexBuffer.PositionKind),c("NORMAL",i.VertexBuffer.NormalKind),c("TANGENT",i.VertexBuffer.TangentKind),c("TEXCOORD_0",i.VertexBuffer.UVKind),c("TEXCOORD_1",i.VertexBuffer.UV2Kind),c("JOINTS_0",i.VertexBuffer.MatricesIndicesKind),c("WEIGHTS_0",i.VertexBuffer.MatricesWeightsKind),c("JOINTS_1",i.VertexBuffer.MatricesIndicesExtraKind),c("WEIGHTS_1",i.VertexBuffer.MatricesWeightsExtraKind),c("COLOR_0",i.VertexBuffer.ColorKind,(function(e){"VEC4"===e.type&&(r.hasVertexAlpha=!0)})),Promise.all(l).then((function(){return h}))},e.prototype._createMorphTargets=function(e,t,r,n,o){if(n.targets){if(null==t._numMorphTargets)t._numMorphTargets=n.targets.length;else if(n.targets.length!==t._numMorphTargets)throw new Error(e+": Primitives do not have the same number of targets");var s=r.extras?r.extras.targetNames:null;o.morphTargetManager=new i.MorphTargetManager(o.getScene());for(var a=0;a<n.targets.length;a++){var l=t.weights?t.weights[a]:r.weights?r.weights[a]:0,h=s?s[a]:"morphTarget"+a;o.morphTargetManager.addTarget(new i.MorphTarget(h,l,o.getScene()))}}},e.prototype._loadMorphTargetsAsync=function(e,t,r,i){if(!t.targets)return Promise.resolve();for(var n=new Array,o=r.morphTargetManager,s=0;s<o.numTargets;s++){var a=o.getTarget(s);n.push(this._loadMorphTargetVertexDataAsync(e+"/targets/"+s,i,t.targets[s],a))}return Promise.all(n).then((function(){}))},e.prototype._loadMorphTargetVertexDataAsync=function(e,t,r,n){var s=this,a=new Array,l=function(i,n,l){if(null!=r[i]){var h=t.getVertexBuffer(n);if(h){var u=o.Get(e+"/"+i,s._gltf.accessors,r[i]);a.push(s._loadFloatAccessorAsync("/accessors/"+u.index,u).then((function(e){l(h,e)})))}}};return l("POSITION",i.VertexBuffer.PositionKind,(function(e,t){var r=new Float32Array(t.length);e.forEach(t.length,(function(e,i){r[i]=t[i]+e})),n.setPositions(r)})),l("NORMAL",i.VertexBuffer.NormalKind,(function(e,t){var r=new Float32Array(t.length);e.forEach(r.length,(function(e,i){r[i]=t[i]+e})),n.setNormals(r)})),l("TANGENT",i.VertexBuffer.TangentKind,(function(e,t){var r=new Float32Array(t.length/3*4),i=0;e.forEach(t.length/3*4,(function(e,n){(n+1)%4!=0&&(r[i]=t[i]+e,i++)})),n.setTangents(r)})),Promise.all(a).then((function(){}))},e._LoadTransform=function(e,t){if(null==e.skin){var r=i.Vector3.Zero(),n=i.Quaternion.Identity(),o=i.Vector3.One();e.matrix?i.Matrix.FromArray(e.matrix).decompose(o,n,r):(e.translation&&(r=i.Vector3.FromArray(e.translation)),e.rotation&&(n=i.Quaternion.FromArray(e.rotation)),e.scale&&(o=i.Vector3.FromArray(e.scale))),t.position=r,t.rotationQuaternion=n,t.scaling=o}},e.prototype._loadSkinAsync=function(e,t,r){var n=this,o=this._extensionsLoadSkinAsync(e,t,r);if(o)return o;var s=function(e){n._forEachPrimitive(t,(function(t){t.skeleton=e}))};if(r._data)return s(r._data.babylonSkeleton),r._data.promise;var a="skeleton"+r.index;this._babylonScene._blockEntityCollection=this._forAssetContainer;var l=new i.Skeleton(r.name||a,a,this._babylonScene);this._babylonScene._blockEntityCollection=!1,l.overrideMesh=this._rootBabylonMesh,this._loadBones(e,r,l),s(l);var h=this._loadSkinInverseBindMatricesDataAsync(e,r).then((function(e){n._updateBoneMatrices(l,e)}));return r._data={babylonSkeleton:l,promise:h},h},e.prototype._loadBones=function(e,t,r){for(var i={},n=0,s=t.joints;n<s.length;n++){var a=s[n],l=o.Get(e+"/joints/"+a,this._gltf.nodes,a);this._loadBone(l,t,r,i)}},e.prototype._loadBone=function(e,t,r,n){var o=n[e.index];if(o)return o;var s=null;e.parent&&e.parent._babylonTransformNode!==this._rootBabylonMesh&&(s=this._loadBone(e.parent,t,r,n));var a=t.joints.indexOf(e.index);return o=new i.Bone(e.name||"joint"+e.index,r,s,this._getNodeMatrix(e),null,null,a),n[e.index]=o,e._babylonBones=e._babylonBones||[],e._babylonBones.push(o),o},e.prototype._loadSkinInverseBindMatricesDataAsync=function(e,t){if(null==t.inverseBindMatrices)return Promise.resolve(null);var r=o.Get(e+"/inverseBindMatrices",this._gltf.accessors,t.inverseBindMatrices);return this._loadFloatAccessorAsync("/accessors/"+r.index,r)},e.prototype._updateBoneMatrices=function(e,t){for(var r=0,n=e.bones;r<n.length;r++){var o=n[r],s=i.Matrix.Identity(),a=o._index;t&&-1!==a&&(i.Matrix.FromArrayToRef(t,16*a,s),s.invertToRef(s));var l=o.getParent();l&&s.multiplyToRef(l.getInvertedAbsoluteTransform(),s),o.setBindPose(s),o.updateMatrix(s,!1,!1),o._updateDifferenceMatrix(void 0,!1)}},e.prototype._getNodeMatrix=function(e){return e.matrix?i.Matrix.FromArray(e.matrix):i.Matrix.Compose(e.scale?i.Vector3.FromArray(e.scale):i.Vector3.One(),e.rotation?i.Quaternion.FromArray(e.rotation):i.Quaternion.Identity(),e.translation?i.Vector3.FromArray(e.translation):i.Vector3.Zero())},e.prototype.loadCameraAsync=function(t,r,n){void 0===n&&(n=function(){});var o=this._extensionsLoadCameraAsync(t,r,n);if(o)return o;var s=new Array;this.logOpen(t+" "+(r.name||"")),this._babylonScene._blockEntityCollection=this._forAssetContainer;var a=new i.FreeCamera(r.name||"camera"+r.index,i.Vector3.Zero(),this._babylonScene,!1);switch(this._babylonScene._blockEntityCollection=!1,a.ignoreParentScaling=!0,a.rotation=new i.Vector3(0,Math.PI,0),r.type){case"perspective":var l=r.perspective;if(!l)throw new Error(t+": Camera perspective properties are missing");a.fov=l.yfov,a.minZ=l.znear,a.maxZ=l.zfar||Number.MAX_VALUE;break;case"orthographic":if(!r.orthographic)throw new Error(t+": Camera orthographic properties are missing");a.mode=i.Camera.ORTHOGRAPHIC_CAMERA,a.orthoLeft=-r.orthographic.xmag,a.orthoRight=r.orthographic.xmag,a.orthoBottom=-r.orthographic.ymag,a.orthoTop=r.orthographic.ymag,a.minZ=r.orthographic.znear,a.maxZ=r.orthographic.zfar;break;default:throw new Error(t+": Invalid camera type ("+r.type+")")}return e.AddPointerMetadata(a,t),this._parent.onCameraLoadedObservable.notifyObservers(a),n(a),this.logClose(),Promise.all(s).then((function(){return a}))},e.prototype._loadAnimationsAsync=function(){var e=this._gltf.animations;if(!e)return Promise.resolve();for(var t=new Array,r=0;r<e.length;r++){var i=e[r];t.push(this.loadAnimationAsync("/animations/"+i.index,i))}return Promise.all(t).then((function(){}))},e.prototype.loadAnimationAsync=function(e,t){var r=this._extensionsLoadAnimationAsync(e,t);if(r)return r;this._babylonScene._blockEntityCollection=this._forAssetContainer;var n=new i.AnimationGroup(t.name||"animation"+t.index,this._babylonScene);this._babylonScene._blockEntityCollection=!1,t._babylonAnimationGroup=n;var s=new Array;o.Assign(t.channels),o.Assign(t.samplers);for(var a=0,l=t.channels;a<l.length;a++){var h=l[a];s.push(this._loadAnimationChannelAsync(e+"/channels/"+h.index,e,t,h,n))}return Promise.all(s).then((function(){return n.normalize(0),n}))},e.prototype._loadAnimationChannelAsync=function(e,t,r,n,s,a){var l=this;if(void 0===a&&(a=null),null==n.target.node)return Promise.resolve();var h=o.Get(e+"/target/node",this._gltf.nodes,n.target.node);if("weights"===n.target.path&&!h._numMorphTargets||"weights"!==n.target.path&&!h._babylonTransformNode)return Promise.resolve();var u=o.Get(e+"/sampler",r.samplers,n.sampler);return this._loadAnimationSamplerAsync(t+"/samplers/"+n.sampler,u).then((function(t){var r,o;switch(n.target.path){case"translation":r="position",o=i.Animation.ANIMATIONTYPE_VECTOR3;break;case"rotation":r="rotationQuaternion",o=i.Animation.ANIMATIONTYPE_QUATERNION;break;case"scale":r="scaling",o=i.Animation.ANIMATIONTYPE_VECTOR3;break;case"weights":r="influence",o=i.Animation.ANIMATIONTYPE_FLOAT;break;default:throw new Error(e+"/target/path: Invalid value ("+n.target.path+")")}var u,c,d=0;switch(r){case"position":u=function(){var e=i.Vector3.FromArray(t.output,d);return d+=3,e};break;case"rotationQuaternion":u=function(){var e=i.Quaternion.FromArray(t.output,d);return d+=4,e};break;case"scaling":u=function(){var e=i.Vector3.FromArray(t.output,d);return d+=3,e};break;case"influence":u=function(){for(var e=new Array(h._numMorphTargets),r=0;r<h._numMorphTargets;r++)e[r]=t.output[d++];return e}}switch(t.interpolation){case"STEP":c=function(e){return{frame:t.input[e],value:u(),interpolation:i.AnimationKeyInterpolation.STEP}};break;case"LINEAR":c=function(e){return{frame:t.input[e],value:u()}};break;case"CUBICSPLINE":c=function(e){return{frame:t.input[e],inTangent:u(),value:u(),outTangent:u()}}}for(var p=new Array(t.input.length),f=0;f<t.input.length;f++)p[f]=c(f);if("influence"===r)for(var _=function(e){var t=s.name+"_channel"+s.targetedAnimations.length,n=new i.Animation(t,r,1,o);n.setKeys(p.map((function(t){return{frame:t.frame,inTangent:t.inTangent?t.inTangent[e]:void 0,value:t.value[e],outTangent:t.outTangent?t.outTangent[e]:void 0}}))),l._forEachPrimitive(h,(function(t){var r=t.morphTargetManager.getTarget(e),i=n.clone();r.animations.push(i),s.addTargetedAnimation(i,r)}))},g=0;g<h._numMorphTargets;g++)_(g);else{var m=s.name+"_channel"+s.targetedAnimations.length,b=new i.Animation(m,r,1,o);b.setKeys(p),null!=a&&null!=a.animations?(a.animations.push(b),s.addTargetedAnimation(b,a)):(h._babylonTransformNode.animations.push(b),s.addTargetedAnimation(b,h._babylonTransformNode))}}))},e.prototype._loadAnimationSamplerAsync=function(e,t){if(t._data)return t._data;var r=t.interpolation||"LINEAR";switch(r){case"STEP":case"LINEAR":case"CUBICSPLINE":break;default:throw new Error(e+"/interpolation: Invalid value ("+t.interpolation+")")}var i=o.Get(e+"/input",this._gltf.accessors,t.input),n=o.Get(e+"/output",this._gltf.accessors,t.output);return t._data=Promise.all([this._loadFloatAccessorAsync("/accessors/"+i.index,i),this._loadFloatAccessorAsync("/accessors/"+n.index,n)]).then((function(e){var t=e[0],i=e[1];return{input:t,interpolation:r,output:i}})),t._data},e.prototype._loadBufferAsync=function(e,t,r,i){var n=this._extensionsLoadBufferAsync(e,t,r,i);if(n)return n;if(!t._data)if(t.uri)t._data=this.loadUriAsync(e+"/uri",t,t.uri);else{if(!this._bin)throw new Error(e+": Uri is missing or the binary glTF is missing its binary chunk");t._data=this._bin.readAsync(0,t.byteLength)}return t._data.then((function(t){try{return new Uint8Array(t.buffer,t.byteOffset+r,i)}catch(t){throw new Error(e+": "+t.message)}}))},e.prototype.loadBufferViewAsync=function(e,t){var r=this._extensionsLoadBufferViewAsync(e,t);if(r)return r;if(t._data)return t._data;var i=o.Get(e+"/buffer",this._gltf.buffers,t.buffer);return t._data=this._loadBufferAsync("/buffers/"+i.index,i,t.byteOffset||0,t.byteLength),t._data},e.prototype._loadAccessorAsync=function(t,r,n){var s=this;if(r._data)return r._data;var a=e._GetNumComponents(t,r.type),l=a*i.VertexBuffer.GetTypeByteLength(r.componentType),h=a*r.count;if(null==r.bufferView)r._data=Promise.resolve(new n(h));else{var u=o.Get(t+"/bufferView",this._gltf.bufferViews,r.bufferView);r._data=this.loadBufferViewAsync("/bufferViews/"+u.index,u).then((function(o){if(5126!==r.componentType||r.normalized||u.byteStride&&u.byteStride!==l){var s=new n(h);return i.VertexBuffer.ForEach(o,r.byteOffset||0,u.byteStride||l,a,r.componentType,s.length,r.normalized||!1,(function(e,t){s[t]=e})),s}return e._GetTypedArray(t,r.componentType,o,r.byteOffset,h)}))}if(r.sparse){var c=r.sparse;r._data=r._data.then((function(h){var u=h,d=o.Get(t+"/sparse/indices/bufferView",s._gltf.bufferViews,c.indices.bufferView),p=o.Get(t+"/sparse/values/bufferView",s._gltf.bufferViews,c.values.bufferView);return Promise.all([s.loadBufferViewAsync("/bufferViews/"+d.index,d),s.loadBufferViewAsync("/bufferViews/"+p.index,p)]).then((function(o){var s,h=o[0],d=o[1],p=e._GetTypedArray(t+"/sparse/indices",c.indices.componentType,h,c.indices.byteOffset,c.count),f=a*c.count;if(5126!==r.componentType||r.normalized){var _=e._GetTypedArray(t+"/sparse/values",r.componentType,d,c.values.byteOffset,f);s=new n(f),i.VertexBuffer.ForEach(_,0,l,a,r.componentType,s.length,r.normalized||!1,(function(e,t){s[t]=e}))}else s=e._GetTypedArray(t+"/sparse/values",r.componentType,d,c.values.byteOffset,f);for(var g=0,m=0;m<p.length;m++)for(var b=p[m]*a,y=0;y<a;y++)u[b++]=s[g++];return u}))}))}return r._data},e.prototype._loadFloatAccessorAsync=function(e,t){return this._loadAccessorAsync(e,t,Float32Array)},e.prototype._loadIndicesAccessorAsync=function(t,r){if("SCALAR"!==r.type)throw new Error(t+"/type: Invalid value "+r.type);if(5121!==r.componentType&&5123!==r.componentType&&5125!==r.componentType)throw new Error(t+"/componentType: Invalid value "+r.componentType);if(r._data)return r._data;if(r.sparse){var i=e._GetTypedArrayConstructor(t+"/componentType",r.componentType);r._data=this._loadAccessorAsync(t,r,i)}else{var n=o.Get(t+"/bufferView",this._gltf.bufferViews,r.bufferView);r._data=this.loadBufferViewAsync("/bufferViews/"+n.index,n).then((function(i){return e._GetTypedArray(t,r.componentType,i,r.byteOffset,r.count)}))}return r._data},e.prototype._loadVertexBufferViewAsync=function(e,t){var r=this;return e._babylonBuffer||(e._babylonBuffer=this.loadBufferViewAsync("/bufferViews/"+e.index,e).then((function(e){return new i.Buffer(r._babylonScene.getEngine(),e,!1)}))),e._babylonBuffer},e.prototype._loadVertexAccessorAsync=function(t,r,n){var s=this;if(r._babylonVertexBuffer)return r._babylonVertexBuffer;if(r.sparse)r._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+r.index,r).then((function(e){return new i.VertexBuffer(s._babylonScene.getEngine(),e,n,!1)}));else if(r.byteOffset&&r.byteOffset%i.VertexBuffer.GetTypeByteLength(r.componentType)!=0)i.Logger.Warn("Accessor byte offset is not a multiple of component type byte length"),r._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+r.index,r).then((function(e){return new i.VertexBuffer(s._babylonScene.getEngine(),e,n,!1)}));else if(n===i.VertexBuffer.MatricesIndicesKind||n===i.VertexBuffer.MatricesIndicesExtraKind)r._babylonVertexBuffer=this._loadFloatAccessorAsync("/accessors/"+r.index,r).then((function(e){return new i.VertexBuffer(s._babylonScene.getEngine(),e,n,!1)}));else{var a=o.Get(t+"/bufferView",this._gltf.bufferViews,r.bufferView);r._babylonVertexBuffer=this._loadVertexBufferViewAsync(a,n).then((function(o){var l=e._GetNumComponents(t,r.type);return new i.VertexBuffer(s._babylonScene.getEngine(),o,n,!1,!1,a.byteStride,!1,r.byteOffset,l,r.componentType,r.normalized,!0,1,!0)}))}return r._babylonVertexBuffer},e.prototype._loadMaterialMetallicRoughnessPropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;return t&&(t.baseColorFactor?(r.albedoColor=i.Color3.FromArray(t.baseColorFactor),r.alpha=t.baseColorFactor[3]):r.albedoColor=i.Color3.White(),r.metallic=null==t.metallicFactor?1:t.metallicFactor,r.roughness=null==t.roughnessFactor?1:t.roughnessFactor,t.baseColorTexture&&n.push(this.loadTextureInfoAsync(e+"/baseColorTexture",t.baseColorTexture,(function(e){e.name=r.name+" (Base Color)",r.albedoTexture=e}))),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(e+"/metallicRoughnessTexture",t.metallicRoughnessTexture,(function(e){e.name=r.name+" (Metallic Roughness)",r.metallicTexture=e}))),r.useMetallnessFromMetallicTextureBlue=!0,r.useRoughnessFromMetallicTextureGreen=!0,r.useRoughnessFromMetallicTextureAlpha=!1)),Promise.all(n).then((function(){}))},e.prototype._loadMaterialAsync=function(t,r,i,n,o){void 0===o&&(o=function(){});var s=this._extensionsLoadMaterialAsync(t,r,i,n,o);if(s)return s;r._data=r._data||{};var a=r._data[n];if(!a){this.logOpen(t+" "+(r.name||""));var l=this.createMaterial(t,r,n);a={babylonMaterial:l,babylonMeshes:[],promise:this.loadMaterialPropertiesAsync(t,r,l)},r._data[n]=a,e.AddPointerMetadata(l,t),this._parent.onMaterialLoadedObservable.notifyObservers(l),this.logClose()}return i&&(a.babylonMeshes.push(i),i.onDisposeObservable.addOnce((function(){var e=a.babylonMeshes.indexOf(i);-1!==e&&a.babylonMeshes.splice(e,1)}))),o(a.babylonMaterial),a.promise.then((function(){return a.babylonMaterial}))},e.prototype._createDefaultMaterial=function(e,t){this._babylonScene._blockEntityCollection=this._forAssetContainer;var r=new i.PBRMaterial(e,this._babylonScene);return this._babylonScene._blockEntityCollection=!1,r.fillMode=t,r.enableSpecularAntiAliasing=!0,r.useRadianceOverAlpha=!this._parent.transparencyAsCoverage,r.useSpecularOverAlpha=!this._parent.transparencyAsCoverage,r.transparencyMode=i.PBRMaterial.PBRMATERIAL_OPAQUE,r.metallic=1,r.roughness=1,r},e.prototype.createMaterial=function(e,t,r){var i=this._extensionsCreateMaterial(e,t,r);if(i)return i;var n=t.name||"material"+t.index;return this._createDefaultMaterial(n,r)},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this._extensionsLoadMaterialPropertiesAsync(e,t,r);if(i)return i;var n=new Array;return n.push(this.loadMaterialBasePropertiesAsync(e,t,r)),t.pbrMetallicRoughness&&n.push(this._loadMaterialMetallicRoughnessPropertiesAsync(e+"/pbrMetallicRoughness",t.pbrMetallicRoughness,r)),this.loadMaterialAlphaProperties(e,t,r),Promise.all(n).then((function(){}))},e.prototype.loadMaterialBasePropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;return r.emissiveColor=t.emissiveFactor?i.Color3.FromArray(t.emissiveFactor):new i.Color3(0,0,0),t.doubleSided&&(r.backFaceCulling=!1,r.twoSidedLighting=!0),t.normalTexture&&(t.normalTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(e+"/normalTexture",t.normalTexture,(function(e){e.name=r.name+" (Normal)",r.bumpTexture=e}))),r.invertNormalMapX=!this._babylonScene.useRightHandedSystem,r.invertNormalMapY=this._babylonScene.useRightHandedSystem,null!=t.normalTexture.scale&&(r.bumpTexture.level=t.normalTexture.scale),r.forceIrradianceInFragment=!0),t.occlusionTexture&&(t.occlusionTexture.nonColorData=!0,n.push(this.loadTextureInfoAsync(e+"/occlusionTexture",t.occlusionTexture,(function(e){e.name=r.name+" (Occlusion)",r.ambientTexture=e}))),r.useAmbientInGrayScale=!0,null!=t.occlusionTexture.strength&&(r.ambientTextureStrength=t.occlusionTexture.strength)),t.emissiveTexture&&n.push(this.loadTextureInfoAsync(e+"/emissiveTexture",t.emissiveTexture,(function(e){e.name=r.name+" (Emissive)",r.emissiveTexture=e}))),Promise.all(n).then((function(){}))},e.prototype.loadMaterialAlphaProperties=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");switch(t.alphaMode||"OPAQUE"){case"OPAQUE":r.transparencyMode=i.PBRMaterial.PBRMATERIAL_OPAQUE;break;case"MASK":r.transparencyMode=i.PBRMaterial.PBRMATERIAL_ALPHATEST,r.alphaCutOff=null==t.alphaCutoff?.5:t.alphaCutoff,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0);break;case"BLEND":r.transparencyMode=i.PBRMaterial.PBRMATERIAL_ALPHABLEND,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0,r.useAlphaFromAlbedoTexture=!0);break;default:throw new Error(e+"/alphaMode: Invalid value ("+t.alphaMode+")")}},e.prototype.loadTextureInfoAsync=function(t,r,i){var n=this;void 0===i&&(i=function(){});var s=this._extensionsLoadTextureInfoAsync(t,r,i);if(s)return s;if(this.logOpen(""+t),r.texCoord>=2)throw new Error(t+"/texCoord: Invalid value ("+r.texCoord+")");var a=o.Get(t+"/index",this._gltf.textures,r.index);a._textureInfo=r;var l=this._loadTextureAsync("/textures/"+r.index,a,(function(o){o.coordinatesIndex=r.texCoord||0,e.AddPointerMetadata(o,t),n._parent.onTextureLoadedObservable.notifyObservers(o),i(o)}));return this.logClose(),l},e.prototype._loadTextureAsync=function(t,r,i){void 0===i&&(i=function(){});var n=this._extensionsLoadTextureAsync(t,r,i);if(n)return n;this.logOpen(t+" "+(r.name||""));var s=null==r.sampler?e.DefaultSampler:o.Get(t+"/sampler",this._gltf.samplers,r.sampler),a=o.Get(t+"/source",this._gltf.images,r.source),l=this._createTextureAsync(t,s,a,i);return this.logClose(),l},e.prototype._createTextureAsync=function(e,t,r,n,o){var s=this;void 0===n&&(n=function(){});var a=this._loadSampler("/samplers/"+t.index,t),l=new Array,h=new i.Deferred;this._babylonScene._blockEntityCollection=this._forAssetContainer;var u=new i.Texture(null,this._babylonScene,a.noMipMaps,!1,a.samplingMode,(function(){s._disposed||h.resolve()}),(function(t,r){s._disposed||h.reject(new Error(e+": "+(r&&r.message?r.message:t||"Failed to load texture")))}),void 0,void 0,void 0,r.mimeType,o);return this._babylonScene._blockEntityCollection=!1,l.push(h.promise),l.push(this.loadImageAsync("/images/"+r.index,r).then((function(e){var t=r.uri||s._fileName+"#image"+r.index,i="data:"+s._uniqueRootUrl+t;u.updateURL(i,e)}))),u.wrapU=a.wrapU,u.wrapV=a.wrapV,n(u),Promise.all(l).then((function(){return u}))},e.prototype._loadSampler=function(t,r){return r._data||(r._data={noMipMaps:9728===r.minFilter||9729===r.minFilter,samplingMode:e._GetTextureSamplingMode(t,r),wrapU:e._GetTextureWrapMode(t+"/wrapS",r.wrapS),wrapV:e._GetTextureWrapMode(t+"/wrapT",r.wrapT)}),r._data},e.prototype.loadImageAsync=function(e,t){if(!t._data){if(this.logOpen(e+" "+(t.name||"")),t.uri)t._data=this.loadUriAsync(e+"/uri",t,t.uri);else{var r=o.Get(e+"/bufferView",this._gltf.bufferViews,t.bufferView);t._data=this.loadBufferViewAsync("/bufferViews/"+r.index,r)}this.logClose()}return t._data},e.prototype.loadUriAsync=function(t,r,n){var o=this,s=this._extensionsLoadUriAsync(t,r,n);if(s)return s;if(!e._ValidateUri(n))throw new Error(t+": '"+n+"' is invalid");if(i.Tools.IsBase64(n)){var a=new Uint8Array(i.Tools.DecodeBase64(n));return this.log("Decoded "+n.substr(0,64)+"... ("+a.length+" bytes)"),Promise.resolve(a)}return this.log("Loading "+n),this._parent.preprocessUrlAsync(this._rootUrl+n).then((function(e){return new Promise((function(r,s){o._parent._loadFile(e,o._babylonScene,(function(e){o._disposed||(o.log("Loaded "+n+" ("+e.byteLength+" bytes)"),r(new Uint8Array(e)))}),!0,(function(e){s(new i.LoadFileError(t+": Failed to load '"+n+"'"+(e?": "+e.status+" "+e.statusText:""),e))}))}))}))},e.AddPointerMetadata=function(e,t){var r=e.metadata=e.metadata||{},i=r.gltf=r.gltf||{};(i.pointers=i.pointers||[]).push(t)},e._GetTextureWrapMode=function(e,t){switch(t=null==t?10497:t){case 33071:return i.Texture.CLAMP_ADDRESSMODE;case 33648:return i.Texture.MIRROR_ADDRESSMODE;case 10497:return i.Texture.WRAP_ADDRESSMODE;default:return i.Logger.Warn(e+": Invalid value ("+t+")"),i.Texture.WRAP_ADDRESSMODE}},e._GetTextureSamplingMode=function(e,t){var r=null==t.magFilter?9729:t.magFilter,n=null==t.minFilter?9987:t.minFilter;if(9729===r)switch(n){case 9728:return i.Texture.LINEAR_NEAREST;case 9729:return i.Texture.LINEAR_LINEAR;case 9984:return i.Texture.LINEAR_NEAREST_MIPNEAREST;case 9985:return i.Texture.LINEAR_LINEAR_MIPNEAREST;case 9986:return i.Texture.LINEAR_NEAREST_MIPLINEAR;case 9987:return i.Texture.LINEAR_LINEAR_MIPLINEAR;default:return i.Logger.Warn(e+"/minFilter: Invalid value ("+n+")"),i.Texture.LINEAR_LINEAR_MIPLINEAR}else switch(9728!==r&&i.Logger.Warn(e+"/magFilter: Invalid value ("+r+")"),n){case 9728:return i.Texture.NEAREST_NEAREST;case 9729:return i.Texture.NEAREST_LINEAR;case 9984:return i.Texture.NEAREST_NEAREST_MIPNEAREST;case 9985:return i.Texture.NEAREST_LINEAR_MIPNEAREST;case 9986:return i.Texture.NEAREST_NEAREST_MIPLINEAR;case 9987:return i.Texture.NEAREST_LINEAR_MIPLINEAR;default:return i.Logger.Warn(e+"/minFilter: Invalid value ("+n+")"),i.Texture.NEAREST_NEAREST_MIPNEAREST}},e._GetTypedArrayConstructor=function(e,t){switch(t){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw new Error(e+": Invalid component type "+t)}},e._GetTypedArray=function(t,r,i,n,o){var s=i.buffer;n=i.byteOffset+(n||0);var a=e._GetTypedArrayConstructor(t+"/componentType",r);try{return new a(s,n,o)}catch(e){throw new Error(t+": "+e)}},e._GetNumComponents=function(e,t){switch(t){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw new Error(e+": Invalid type ("+t+")")},e._ValidateUri=function(e){return i.Tools.IsBase64(e)||-1===e.indexOf("..")},e._GetDrawMode=function(e,t){switch(null==t&&(t=4),t){case 0:return i.Material.PointListDrawMode;case 1:return i.Material.LineListDrawMode;case 2:return i.Material.LineLoopDrawMode;case 3:return i.Material.LineStripDrawMode;case 4:return i.Material.TriangleFillMode;case 5:return i.Material.TriangleStripDrawMode;case 6:return i.Material.TriangleFanDrawMode}throw new Error(e+": Invalid mesh primitive mode ("+t+")")},e.prototype._compileMaterialsAsync=function(){var e=this;this._parent._startPerformanceCounter("Compile materials");var t=new Array;if(this._gltf.materials)for(var r=0,i=this._gltf.materials;r<i.length;r++){var n=i[r];if(n._data)for(var o in n._data)for(var s=n._data[o],a=0,l=s.babylonMeshes;a<l.length;a++){var h=l[a];h.computeWorldMatrix(!0);var u=s.babylonMaterial;t.push(u.forceCompilationAsync(h)),t.push(u.forceCompilationAsync(h,{useInstances:!0})),this._parent.useClipPlane&&(t.push(u.forceCompilationAsync(h,{clipPlane:!0})),t.push(u.forceCompilationAsync(h,{clipPlane:!0,useInstances:!0})))}}return Promise.all(t).then((function(){e._parent._endPerformanceCounter("Compile materials")}))},e.prototype._compileShadowGeneratorsAsync=function(){var e=this;this._parent._startPerformanceCounter("Compile shadow generators");for(var t=new Array,r=0,i=this._babylonScene.lights;r<i.length;r++){var n=i[r].getShadowGenerator();n&&t.push(n.forceCompilationAsync())}return Promise.all(t).then((function(){e._parent._endPerformanceCounter("Compile shadow generators")}))},e.prototype._forEachExtensions=function(e){for(var t=0,r=this._extensions;t<r.length;t++){var i=r[t];i.enabled&&e(i)}},e.prototype._applyExtensions=function(e,t,r){for(var i=0,n=this._extensions;i<n.length;i++){var o=n[i];if(o.enabled){var s=o.name+"."+t,a=e;a._activeLoaderExtensionFunctions=a._activeLoaderExtensionFunctions||{};var l=a._activeLoaderExtensionFunctions;if(!l[s]){l[s]=!0;try{var h=r(o);if(h)return h}finally{delete l[s]}}}}return null},e.prototype._extensionsOnLoading=function(){this._forEachExtensions((function(e){return e.onLoading&&e.onLoading()}))},e.prototype._extensionsOnReady=function(){this._forEachExtensions((function(e){return e.onReady&&e.onReady()}))},e.prototype._extensionsLoadSceneAsync=function(e,t){return this._applyExtensions(t,"loadScene",(function(r){return r.loadSceneAsync&&r.loadSceneAsync(e,t)}))},e.prototype._extensionsLoadNodeAsync=function(e,t,r){return this._applyExtensions(t,"loadNode",(function(i){return i.loadNodeAsync&&i.loadNodeAsync(e,t,r)}))},e.prototype._extensionsLoadCameraAsync=function(e,t,r){return this._applyExtensions(t,"loadCamera",(function(i){return i.loadCameraAsync&&i.loadCameraAsync(e,t,r)}))},e.prototype._extensionsLoadVertexDataAsync=function(e,t,r){return this._applyExtensions(t,"loadVertexData",(function(i){return i._loadVertexDataAsync&&i._loadVertexDataAsync(e,t,r)}))},e.prototype._extensionsLoadMeshPrimitiveAsync=function(e,t,r,i,n,o){return this._applyExtensions(n,"loadMeshPrimitive",(function(s){return s._loadMeshPrimitiveAsync&&s._loadMeshPrimitiveAsync(e,t,r,i,n,o)}))},e.prototype._extensionsLoadMaterialAsync=function(e,t,r,i,n){return this._applyExtensions(t,"loadMaterial",(function(o){return o._loadMaterialAsync&&o._loadMaterialAsync(e,t,r,i,n)}))},e.prototype._extensionsCreateMaterial=function(e,t,r){return this._applyExtensions(t,"createMaterial",(function(i){return i.createMaterial&&i.createMaterial(e,t,r)}))},e.prototype._extensionsLoadMaterialPropertiesAsync=function(e,t,r){return this._applyExtensions(t,"loadMaterialProperties",(function(i){return i.loadMaterialPropertiesAsync&&i.loadMaterialPropertiesAsync(e,t,r)}))},e.prototype._extensionsLoadTextureInfoAsync=function(e,t,r){return this._applyExtensions(t,"loadTextureInfo",(function(i){return i.loadTextureInfoAsync&&i.loadTextureInfoAsync(e,t,r)}))},e.prototype._extensionsLoadTextureAsync=function(e,t,r){return this._applyExtensions(t,"loadTexture",(function(i){return i._loadTextureAsync&&i._loadTextureAsync(e,t,r)}))},e.prototype._extensionsLoadAnimationAsync=function(e,t){return this._applyExtensions(t,"loadAnimation",(function(r){return r.loadAnimationAsync&&r.loadAnimationAsync(e,t)}))},e.prototype._extensionsLoadSkinAsync=function(e,t,r){return this._applyExtensions(r,"loadSkin",(function(i){return i._loadSkinAsync&&i._loadSkinAsync(e,t,r)}))},e.prototype._extensionsLoadUriAsync=function(e,t,r){return this._applyExtensions(t,"loadUri",(function(i){return i._loadUriAsync&&i._loadUriAsync(e,t,r)}))},e.prototype._extensionsLoadBufferViewAsync=function(e,t){return this._applyExtensions(t,"loadBufferView",(function(r){return r.loadBufferViewAsync&&r.loadBufferViewAsync(e,t)}))},e.prototype._extensionsLoadBufferAsync=function(e,t,r,i){return this._applyExtensions(t,"loadBuffer",(function(n){return n.loadBufferAsync&&n.loadBufferAsync(e,t,r,i)}))},e.LoadExtensionAsync=function(e,t,r,i){if(!t.extensions)return null;var n=t.extensions[r];return n?i(e+"/extensions/"+r,n):null},e.LoadExtraAsync=function(e,t,r,i){if(!t.extras)return null;var n=t.extras[r];return n?i(e+"/extras/"+r,n):null},e.prototype.isExtensionUsed=function(e){return!!this._gltf.extensionsUsed&&-1!==this._gltf.extensionsUsed.indexOf(e)},e.prototype.logOpen=function(e){this._parent._logOpen(e)},e.prototype.logClose=function(){this._parent._logClose()},e.prototype.log=function(e){this._parent._log(e)},e.prototype.startPerformanceCounter=function(e){this._parent._startPerformanceCounter(e)},e.prototype.endPerformanceCounter=function(e){this._parent._endPerformanceCounter(e)},e._RegisteredExtensions={},e.DefaultSampler={index:-1},e}();n.GLTFFileLoader._CreateGLTF2Loader=function(e){return new s(e)}},function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFLoaderCoordinateSystemMode",(function(){return i})),r.d(t,"GLTFLoaderAnimationStartMode",(function(){return n})),r.d(t,"GLTFLoaderState",(function(){return o})),r.d(t,"GLTFFileLoader",(function(){return l}));var i,n,o,s=r(0),a=r(3);!function(e){e[e.AUTO=0]="AUTO",e[e.FORCE_RIGHT_HANDED=1]="FORCE_RIGHT_HANDED"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.FIRST=1]="FIRST",e[e.ALL=2]="ALL"}(n||(n={})),function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.COMPLETE=2]="COMPLETE"}(o||(o={}));var l=function(){function e(){this.onParsedObservable=new s.Observable,this.coordinateSystemMode=i.AUTO,this.animationStartMode=n.FIRST,this.compileMaterials=!1,this.useClipPlane=!1,this.compileShadowGenerators=!1,this.transparencyAsCoverage=!1,this.useRangeRequests=!1,this.createInstances=!0,this.alwaysComputeBoundingBox=!1,this.loadAllMaterials=!1,this.preprocessUrlAsync=function(e){return Promise.resolve(e)},this.onMeshLoadedObservable=new s.Observable,this.onTextureLoadedObservable=new s.Observable,this.onMaterialLoadedObservable=new s.Observable,this.onCameraLoadedObservable=new s.Observable,this.onCompleteObservable=new s.Observable,this.onErrorObservable=new s.Observable,this.onDisposeObservable=new s.Observable,this.onExtensionLoadedObservable=new s.Observable,this.validate=!1,this.onValidatedObservable=new s.Observable,this._loader=null,this._requests=new Array,this.name="gltf",this.extensions={".gltf":{isBinary:!1},".glb":{isBinary:!0}},this._logIndentLevel=0,this._loggingEnabled=!1,this._log=this._logDisabled,this._capturePerformanceCounters=!1,this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled}return Object.defineProperty(e.prototype,"onParsed",{set:function(e){this._onParsedObserver&&this.onParsedObservable.remove(this._onParsedObserver),this._onParsedObserver=this.onParsedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMeshLoaded",{set:function(e){this._onMeshLoadedObserver&&this.onMeshLoadedObservable.remove(this._onMeshLoadedObserver),this._onMeshLoadedObserver=this.onMeshLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTextureLoaded",{set:function(e){this._onTextureLoadedObserver&&this.onTextureLoadedObservable.remove(this._onTextureLoadedObserver),this._onTextureLoadedObserver=this.onTextureLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMaterialLoaded",{set:function(e){this._onMaterialLoadedObserver&&this.onMaterialLoadedObservable.remove(this._onMaterialLoadedObserver),this._onMaterialLoadedObserver=this.onMaterialLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCameraLoaded",{set:function(e){this._onCameraLoadedObserver&&this.onCameraLoadedObservable.remove(this._onCameraLoadedObserver),this._onCameraLoadedObserver=this.onCameraLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{set:function(e){this._onCompleteObserver&&this.onCompleteObservable.remove(this._onCompleteObserver),this._onCompleteObserver=this.onCompleteObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{set:function(e){this._onErrorObserver&&this.onErrorObservable.remove(this._onErrorObserver),this._onErrorObserver=this.onErrorObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onExtensionLoaded",{set:function(e){this._onExtensionLoadedObserver&&this.onExtensionLoadedObservable.remove(this._onExtensionLoadedObserver),this._onExtensionLoadedObserver=this.onExtensionLoadedObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loggingEnabled",{get:function(){return this._loggingEnabled},set:function(e){this._loggingEnabled!==e&&(this._loggingEnabled=e,this._loggingEnabled?this._log=this._logEnabled:this._log=this._logDisabled)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capturePerformanceCounters",{get:function(){return this._capturePerformanceCounters},set:function(e){this._capturePerformanceCounters!==e&&(this._capturePerformanceCounters=e,this._capturePerformanceCounters?(this._startPerformanceCounter=this._startPerformanceCounterEnabled,this._endPerformanceCounter=this._endPerformanceCounterEnabled):(this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onValidated",{set:function(e){this._onValidatedObserver&&this.onValidatedObservable.remove(this._onValidatedObserver),this._onValidatedObserver=this.onValidatedObservable.add(e)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._loader&&(this._loader.dispose(),this._loader=null);for(var e=0,t=this._requests;e<t.length;e++)t[e].abort();this._requests.length=0,delete this._progressCallback,this.preprocessUrlAsync=function(e){return Promise.resolve(e)},this.onMeshLoadedObservable.clear(),this.onTextureLoadedObservable.clear(),this.onMaterialLoadedObservable.clear(),this.onCameraLoadedObservable.clear(),this.onCompleteObservable.clear(),this.onExtensionLoadedObservable.clear(),this.onDisposeObservable.notifyObservers(void 0),this.onDisposeObservable.clear()},e.prototype.requestFile=function(e,t,r,i,n,o){var a=this;if(this._progressCallback=i,n){if(this.useRangeRequests){this.validate&&s.Logger.Warn("glTF validation is not supported when range requests are enabled");var l={abort:function(){},onCompleteObservable:new s.Observable},h={readAsync:function(r,i){return new Promise((function(n,o){a._requestFile(t,e,(function(e){n(new Uint8Array(e))}),!0,(function(e){o(e)}),(function(e){e.setRequestHeader("Range","bytes="+r+"-"+(r+i-1))}))}))},byteLength:0};return this._unpackBinaryAsync(new s.DataReader(h)).then((function(e){l.onCompleteObservable.notifyObservers(l),r(e)}),o),l}return this._requestFile(t,e,(function(e,t){var i=e;a._unpackBinaryAsync(new s.DataReader({readAsync:function(e,t){return Promise.resolve(new Uint8Array(i,e,t))},byteLength:i.byteLength})).then((function(e){r(e,t)}),o)}),!0,o)}return this._requestFile(t,e,(function(i,n){a._validate(e,i,s.Tools.GetFolderPath(t),s.Tools.GetFilename(t)),r({json:a._parseJson(i)},n)}),n,o)},e.prototype.readFile=function(e,t,r,i,n,o){var a=this;return e._readFile(t,(function(i){if(a._validate(e,i,"file:",t.name),n){var l=i;a._unpackBinaryAsync(new s.DataReader({readAsync:function(e,t){return Promise.resolve(new Uint8Array(l,e,t))},byteLength:l.byteLength})).then(r,o)}else r({json:a._parseJson(i)})}),i,n,o)},e.prototype.importMeshAsync=function(e,t,r,i,n,o){var s=this;return Promise.resolve().then((function(){return s.onParsedObservable.notifyObservers(r),s.onParsedObservable.clear(),s._log("Loading "+(o||"")),s._loader=s._getLoader(r),s._loader.importMeshAsync(e,t,!1,r,i,n,o)}))},e.prototype.loadAsync=function(e,t,r,i,n){var o=this;return Promise.resolve().then((function(){return o.onParsedObservable.notifyObservers(t),o.onParsedObservable.clear(),o._log("Loading "+(n||"")),o._loader=o._getLoader(t),o._loader.loadAsync(e,t,r,i,n)}))},e.prototype.loadAssetContainerAsync=function(e,t,r,i,n){var o=this;return Promise.resolve().then((function(){o.onParsedObservable.notifyObservers(t),o.onParsedObservable.clear(),o._log("Loading "+(n||"")),o._loader=o._getLoader(t);var a=new s.AssetContainer(e),l=[];o.onMaterialLoadedObservable.add((function(e){l.push(e),e.onDisposeObservable.addOnce((function(){var t=a.materials.indexOf(e);t>-1&&a.materials.splice(t,1),(t=l.indexOf(e))>-1&&l.splice(t,1)}))}));var h=[];o.onTextureLoadedObservable.add((function(e){h.push(e),e.onDisposeObservable.addOnce((function(){var t=a.textures.indexOf(e);t>-1&&a.textures.splice(t,1),(t=h.indexOf(e))>-1&&h.splice(t,1)}))}));var u=[];return o.onCameraLoadedObservable.add((function(e){u.push(e)})),o._loader.importMeshAsync(null,e,!0,t,r,i,n).then((function(e){return Array.prototype.push.apply(a.geometries,e.geometries),Array.prototype.push.apply(a.meshes,e.meshes),Array.prototype.push.apply(a.particleSystems,e.particleSystems),Array.prototype.push.apply(a.skeletons,e.skeletons),Array.prototype.push.apply(a.animationGroups,e.animationGroups),Array.prototype.push.apply(a.materials,l),Array.prototype.push.apply(a.textures,h),Array.prototype.push.apply(a.lights,e.lights),Array.prototype.push.apply(a.transformNodes,e.transformNodes),Array.prototype.push.apply(a.cameras,u),a}))}))},e.prototype.canDirectLoad=function(t){return-1!==t.indexOf("asset")&&-1!==t.indexOf("version")||s.StringTools.StartsWith(t,"data:base64,"+e.magicBase64Encoded)||s.StringTools.StartsWith(t,"data:application/octet-stream;base64,"+e.magicBase64Encoded)||s.StringTools.StartsWith(t,"data:model/gltf-binary;base64,"+e.magicBase64Encoded)},e.prototype.directLoad=function(t,r){if(s.StringTools.StartsWith(r,"base64,"+e.magicBase64Encoded)||s.StringTools.StartsWith(r,"application/octet-stream;base64,"+e.magicBase64Encoded)||s.StringTools.StartsWith(r,"model/gltf-binary;base64,"+e.magicBase64Encoded)){var i=s.Tools.DecodeBase64(r);return this._validate(t,i),this._unpackBinaryAsync(new s.DataReader({readAsync:function(e,t){return Promise.resolve(new Uint8Array(i,e,t))},byteLength:i.byteLength}))}return this._validate(t,r),Promise.resolve({json:this._parseJson(r)})},e.prototype.createPlugin=function(){return new e},Object.defineProperty(e.prototype,"loaderState",{get:function(){return this._loader?this._loader.state:null},enumerable:!1,configurable:!0}),e.prototype.whenCompleteAsync=function(){var e=this;return new Promise((function(t,r){e.onCompleteObservable.addOnce((function(){t()})),e.onErrorObservable.addOnce((function(e){r(e)}))}))},e.prototype._loadFile=function(e,t,r,i,n){var o=this,s=t._loadFile(e,r,(function(e){o._onProgress(e,s)}),void 0,i,n);return s.onCompleteObservable.add((function(e){o._requests.splice(o._requests.indexOf(e),1)})),this._requests.push(s),s},e.prototype._requestFile=function(e,t,r,i,n,o){var s=this,a=t._requestFile(e,r,(function(e){s._onProgress(e,a)}),void 0,i,n,o);return a.onCompleteObservable.add((function(e){s._requests.splice(s._requests.indexOf(e),1)})),this._requests.push(a),a},e.prototype._onProgress=function(e,t){if(this._progressCallback){t._lengthComputable=e.lengthComputable,t._loaded=e.loaded,t._total=e.total;for(var r=!0,i=0,n=0,o=0,s=this._requests;o<s.length;o++){var a=s[o];if(void 0===a._lengthComputable||void 0===a._loaded||void 0===a._total)return;r=r&&a._lengthComputable,i+=a._loaded,n+=a._total}this._progressCallback({lengthComputable:r,loaded:i,total:r?n:0})}},e.prototype._validate=function(e,t,r,i){var n=this;void 0===r&&(r=""),void 0===i&&(i=""),this.validate&&(this._startPerformanceCounter("Validate JSON"),a.GLTFValidation.ValidateAsync(t,r,i,(function(t){return n.preprocessUrlAsync(r+t).then((function(t){return e._loadFileAsync(t,void 0,!0,!0)}))})).then((function(e){n._endPerformanceCounter("Validate JSON"),n.onValidatedObservable.notifyObservers(e),n.onValidatedObservable.clear()}),(function(e){n._endPerformanceCounter("Validate JSON"),s.Tools.Warn("Failed to validate: "+e.message),n.onValidatedObservable.clear()})))},e.prototype._getLoader=function(t){var r=t.json.asset||{};this._log("Asset version: "+r.version),r.minVersion&&this._log("Asset minimum version: "+r.minVersion),r.generator&&this._log("Asset generator: "+r.generator);var i=e._parseVersion(r.version);if(!i)throw new Error("Invalid version: "+r.version);if(void 0!==r.minVersion){var n=e._parseVersion(r.minVersion);if(!n)throw new Error("Invalid minimum version: "+r.minVersion);if(e._compareVersion(n,{major:2,minor:0})>0)throw new Error("Incompatible minimum version: "+r.minVersion)}var o={1:e._CreateGLTF1Loader,2:e._CreateGLTF2Loader}[i.major];if(!o)throw new Error("Unsupported version: "+r.version);return o(this)},e.prototype._parseJson=function(e){this._startPerformanceCounter("Parse JSON"),this._log("JSON length: "+e.length);var t=JSON.parse(e);return this._endPerformanceCounter("Parse JSON"),t},e.prototype._unpackBinaryAsync=function(e){var t=this;return this._startPerformanceCounter("Unpack Binary"),e.loadAsync(20).then((function(){var r=e.readUint32();if(1179937895!==r)throw new Error("Unexpected magic: "+r);var i=e.readUint32();t.loggingEnabled&&t._log("Binary version: "+i);var n,o=e.readUint32();if(0!==e.buffer.byteLength&&o!==e.buffer.byteLength)throw new Error("Length in header does not match actual data length: "+o+" != "+e.buffer.byteLength);switch(i){case 1:n=t._unpackBinaryV1Async(e,o);break;case 2:n=t._unpackBinaryV2Async(e,o);break;default:throw new Error("Unsupported version: "+i)}return t._endPerformanceCounter("Unpack Binary"),n}))},e.prototype._unpackBinaryV1Async=function(e,t){var r=e.readUint32(),i=e.readUint32();if(0!==i)throw new Error("Unexpected content format: "+i);var n=t-e.byteOffset,o={json:this._parseJson(e.readString(r)),bin:null};if(0!==n){var s=e.byteOffset;o.bin={readAsync:function(t,r){return e.buffer.readAsync(s+t,r)},byteLength:n}}return Promise.resolve(o)},e.prototype._unpackBinaryV2Async=function(e,t){var r=this,i=1313821514,n=5130562,o=e.readUint32();if(e.readUint32()!==i)throw new Error("First chunk format is not JSON");return e.byteOffset+o===t?e.loadAsync(o).then((function(){return{json:r._parseJson(e.readString(o)),bin:null}})):e.loadAsync(o+8).then((function(){var s={json:r._parseJson(e.readString(o)),bin:null},a=function(){var r=e.readUint32();switch(e.readUint32()){case i:throw new Error("Unexpected JSON chunk");case n:var o=e.byteOffset;s.bin={readAsync:function(t,r){return e.buffer.readAsync(o+t,r)},byteLength:r},e.skipBytes(r);break;default:e.skipBytes(r)}return e.byteOffset!==t?e.loadAsync(8).then(a):Promise.resolve(s)};return a()}))},e._parseVersion=function(e){if("1.0"===e||"1.0.1"===e)return{major:1,minor:0};var t=(e+"").match(/^(\d+)\.(\d+)/);return t?{major:parseInt(t[1]),minor:parseInt(t[2])}:null},e._compareVersion=function(e,t){return e.major>t.major?1:e.major<t.major?-1:e.minor>t.minor?1:e.minor<t.minor?-1:0},e.prototype._logOpen=function(e){this._log(e),this._logIndentLevel++},e.prototype._logClose=function(){--this._logIndentLevel},e.prototype._logEnabled=function(t){var r=e._logSpaces.substr(0,2*this._logIndentLevel);s.Logger.Log(""+r+t)},e.prototype._logDisabled=function(e){},e.prototype._startPerformanceCounterEnabled=function(e){s.Tools.StartPerformanceCounter(e)},e.prototype._startPerformanceCounterDisabled=function(e){},e.prototype._endPerformanceCounterEnabled=function(e){s.Tools.EndPerformanceCounter(e)},e.prototype._endPerformanceCounterDisabled=function(e){},e.IncrementalLoading=!0,e.HomogeneousCoordinates=!1,e.magicBase64Encoded="Z2xURg",e._logSpaces="                                ",e}();s.SceneLoader&&s.SceneLoader.RegisterPlugin(new l)},function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFValidation",(function(){return s}));var i=r(0);function n(e,t,r,i){var n={externalResourceFunction:function(e){return i(e).then((function(e){return new Uint8Array(e)}))}};return r&&(n.uri="file:"===t?r:t+r),e instanceof ArrayBuffer?GLTFValidator.validateBytes(new Uint8Array(e),n):GLTFValidator.validateString(e,n)}function o(){var e=[];onmessage=function(t){var r=t.data;switch(r.id){case"init":importScripts(r.url);break;case"validate":n(r.data,r.rootUrl,r.fileName,(function(t){return new Promise((function(r,i){var n=e.length;e.push({resolve:r,reject:i}),postMessage({id:"getExternalResource",index:n,uri:t})}))})).then((function(e){postMessage({id:"validate.resolve",value:e})}),(function(e){postMessage({id:"validate.reject",reason:e})}));break;case"getExternalResource.resolve":e[r.index].resolve(r.value);break;case"getExternalResource.reject":e[r.index].reject(r.reason)}}}var s=function(){function e(){}return e.ValidateAsync=function(e,t,r,s){var a=this;return"function"==typeof Worker?new Promise((function(l,h){var u=n+"("+o+")()",c=URL.createObjectURL(new Blob([u],{type:"application/javascript"})),d=new Worker(c),p=function(e){d.removeEventListener("error",p),d.removeEventListener("message",f),h(e)},f=function(e){var t=e.data;switch(t.id){case"getExternalResource":s(t.uri).then((function(e){d.postMessage({id:"getExternalResource.resolve",index:t.index,value:e},[e])}),(function(e){d.postMessage({id:"getExternalResource.reject",index:t.index,reason:e})}));break;case"validate.resolve":d.removeEventListener("error",p),d.removeEventListener("message",f),l(t.value);break;case"validate.reject":d.removeEventListener("error",p),d.removeEventListener("message",f),h(t.reason)}};d.addEventListener("error",p),d.addEventListener("message",f),d.postMessage({id:"init",url:i.Tools.GetAbsoluteUrl(a.Configuration.url)}),d.postMessage({id:"validate",data:e,rootUrl:t,fileName:r})})):(this._LoadScriptPromise||(this._LoadScriptPromise=i.Tools.LoadScriptAsync(this.Configuration.url)),this._LoadScriptPromise.then((function(){return n(e,t,r,s)})))},e.Configuration={url:"https://preview.babylonjs.com/gltf_validator.js"},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.create,Object.create},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t)},function(e,t,r){"use strict";r.r(t),r.d(t,"EXT_lights_image_based",(function(){return s})),r.d(t,"EXT_mesh_gpu_instancing",(function(){return a})),r.d(t,"EXT_texture_webp",(function(){return l})),r.d(t,"KHR_draco_mesh_compression",(function(){return h})),r.d(t,"KHR_lights",(function(){return u})),r.d(t,"KHR_materials_pbrSpecularGlossiness",(function(){return c})),r.d(t,"KHR_materials_unlit",(function(){return d})),r.d(t,"KHR_materials_clearcoat",(function(){return p})),r.d(t,"KHR_materials_sheen",(function(){return f})),r.d(t,"KHR_materials_specular",(function(){return _})),r.d(t,"KHR_materials_ior",(function(){return g})),r.d(t,"KHR_materials_variants",(function(){return m})),r.d(t,"KHR_materials_transmission",(function(){return v})),r.d(t,"KHR_materials_translucency",(function(){return T})),r.d(t,"KHR_mesh_quantization",(function(){return O})),r.d(t,"KHR_texture_basisu",(function(){return E})),r.d(t,"KHR_texture_transform",(function(){return A})),r.d(t,"MSFT_audio_emitter",(function(){return C})),r.d(t,"MSFT_lod",(function(){return M})),r.d(t,"MSFT_minecraftMesh",(function(){return x})),r.d(t,"MSFT_sRGBFactors",(function(){return w})),r.d(t,"ExtrasAsMetadata",(function(){return S}));var i=r(0),n=r(1),o="EXT_lights_image_based",s=function(){function e(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}return e.prototype.dispose=function(){this._loader=null,delete this._lights},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._lights=t.lights}},e.prototype.loadSceneAsync=function(e,t){var r=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(i,o){var s=new Array;s.push(r._loader.loadSceneAsync(e,t)),r._loader.logOpen(""+i);var a=n.a.Get(i+"/light",r._lights,o.light);return s.push(r._loadLightAsync("/extensions/"+r.name+"/lights/"+o.light,a).then((function(e){r._loader.babylonScene.environmentTexture=e}))),r._loader.logClose(),Promise.all(s).then((function(){}))}))},e.prototype._loadLightAsync=function(e,t){var r=this;if(!t._loaded){var o=new Array;this._loader.logOpen(""+e);for(var s=new Array(t.specularImages.length),a=function(r){var i=t.specularImages[r];s[r]=new Array(i.length);for(var a=function(t){var a=e+"/specularImages/"+r+"/"+t;l._loader.logOpen(""+a);var h=i[t],u=n.a.Get(a,l._loader.gltf.images,h);o.push(l._loader.loadImageAsync("/images/"+h,u).then((function(e){s[r][t]=e}))),l._loader.logClose()},h=0;h<i.length;h++)a(h)},l=this,h=0;h<t.specularImages.length;h++)a(h);this._loader.logClose(),t._loaded=Promise.all(o).then((function(){var e=new i.RawCubeTexture(r._loader.babylonScene,null,t.specularImageSize);if(e.name=t.name||"environment",t._babylonTexture=e,null!=t.intensity&&(e.level=t.intensity),t.rotation){var n=i.Quaternion.FromArray(t.rotation);r._loader.babylonScene.useRightHandedSystem||(n=i.Quaternion.Inverse(n)),i.Matrix.FromQuaternionToRef(n,e.getReflectionTextureMatrix())}var o=i.SphericalHarmonics.FromArray(t.irradianceCoefficients);o.scaleInPlace(t.intensity),o.convertIrradianceToLambertianRadiance();var a=i.SphericalPolynomial.FromHarmonics(o),l=(s.length-1)/i.Scalar.Log2(t.specularImageSize);return e.updateRGBDAsync(s,a,l)}))}return t._loaded.then((function(){return t._babylonTexture}))},e}();n.b.RegisterExtension(o,(function(e){return new s(e)}));var a=function(){function e(e){this.name="EXT_mesh_gpu_instancing",this._loader=e,this.enabled=this._loader.isExtensionUsed("EXT_mesh_gpu_instancing")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadNodeAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(e,s){o._loader._disableInstancedMesh++;var a=o._loader.loadNodeAsync("/nodes/"+t.index,t,r);if(o._loader._disableInstancedMesh--,!t._primitiveBabylonMeshes)return a;var l=new Array,h=0,u=function(t){if(null!=s.attributes[t]){var r=n.a.Get(e+"/attributes/"+t,o._loader.gltf.accessors,s.attributes[t]);if(l.push(o._loader._loadFloatAccessorAsync("/accessors/"+r.bufferView,r)),0===h)h=r.count;else if(h!==r.count)throw new Error(e+"/attributes: Instance buffer accessors do not have the same count.")}else l.push(Promise.resolve(null))};return u("TRANSLATION"),u("ROTATION"),u("SCALE"),a.then((function(e){return Promise.all(l).then((function(r){var n=r[0],o=r[1],s=r[2],a=new Float32Array(16*h);i.TmpVectors.Vector3[0].copyFromFloats(0,0,0),i.TmpVectors.Quaternion[0].copyFromFloats(0,0,0,1),i.TmpVectors.Vector3[1].copyFromFloats(1,1,1);for(var l=0;l<h;++l)n&&i.Vector3.FromArrayToRef(n,3*l,i.TmpVectors.Vector3[0]),o&&i.Quaternion.FromArrayToRef(o,4*l,i.TmpVectors.Quaternion[0]),s&&i.Vector3.FromArrayToRef(s,3*l,i.TmpVectors.Vector3[1]),i.Matrix.ComposeToRef(i.TmpVectors.Vector3[1],i.TmpVectors.Quaternion[0],i.TmpVectors.Vector3[0],i.TmpVectors.Matrix[0]),i.TmpVectors.Matrix[0].copyToArray(a,16*l);for(var u=0,c=t._primitiveBabylonMeshes;u<c.length;u++)c[u].thinInstanceSetBuffer("matrix",a,16,!0);return e}))}))}))},e}();n.b.RegisterExtension("EXT_mesh_gpu_instancing",(function(e){return new a(e)}));var l=function(){function e(e){this.name="EXT_texture_webp",this._loader=e,this.enabled=e.isExtensionUsed("EXT_texture_webp")}return e.prototype.dispose=function(){this._loader=null},e.prototype._loadTextureAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(o,s){var a=null==t.sampler?n.b.DefaultSampler:n.a.Get(e+"/sampler",i._loader.gltf.samplers,t.sampler),l=n.a.Get(o+"/source",i._loader.gltf.images,s.source);return i._loader._createTextureAsync(e,a,l,(function(e){r(e)}))}))},e}();n.b.RegisterExtension("EXT_texture_webp",(function(e){return new l(e)}));var h=function(){function e(e){this.name="KHR_draco_mesh_compression",this._loader=e,this.enabled=i.DracoCompression.DecoderAvailable&&this._loader.isExtensionUsed("KHR_draco_mesh_compression")}return e.prototype.dispose=function(){delete this.dracoCompression,this._loader=null},e.prototype._loadVertexDataAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(s,a){if(null!=t.mode){if(5!==t.mode&&4!==t.mode)throw new Error(e+": Unsupported mode "+t.mode);if(5===t.mode)throw new Error(e+": Mode "+t.mode+" is not currently supported")}var l={},h=function(e,t){var i=a.attributes[e];null!=i&&(r._delayInfo=r._delayInfo||[],-1===r._delayInfo.indexOf(t)&&r._delayInfo.push(t),l[t]=i)};h("POSITION",i.VertexBuffer.PositionKind),h("NORMAL",i.VertexBuffer.NormalKind),h("TANGENT",i.VertexBuffer.TangentKind),h("TEXCOORD_0",i.VertexBuffer.UVKind),h("TEXCOORD_1",i.VertexBuffer.UV2Kind),h("JOINTS_0",i.VertexBuffer.MatricesIndicesKind),h("WEIGHTS_0",i.VertexBuffer.MatricesWeightsKind),h("COLOR_0",i.VertexBuffer.ColorKind);var u=n.a.Get(s,o._loader.gltf.bufferViews,a.bufferView);return u._dracoBabylonGeometry||(u._dracoBabylonGeometry=o._loader.loadBufferViewAsync("/bufferViews/"+u.index,u).then((function(t){return(o.dracoCompression||i.DracoCompression.Default).decodeMeshAsync(t,l).then((function(e){var t=new i.Geometry(r.name,o._loader.babylonScene);return e.applyToGeometry(t),t})).catch((function(t){throw new Error(e+": "+t.message)}))}))),u._dracoBabylonGeometry}))},e}();n.b.RegisterExtension("KHR_draco_mesh_compression",(function(e){return new h(e)}));var u=function(){function e(e){this.name="KHR_lights_punctual",this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_lights_punctual")}return e.prototype.dispose=function(){this._loader=null,delete this._lights},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._lights=t.lights}},e.prototype.loadNodeAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(s,a){return o._loader.loadNodeAsync(e,t,(function(e){var t,l=n.a.Get(s,o._lights,a.light),h=l.name||e.name;switch(o._loader.babylonScene._blockEntityCollection=o._loader._forAssetContainer,l.type){case"directional":t=new i.DirectionalLight(h,i.Vector3.Backward(),o._loader.babylonScene);break;case"point":t=new i.PointLight(h,i.Vector3.Zero(),o._loader.babylonScene);break;case"spot":var u=new i.SpotLight(h,i.Vector3.Zero(),i.Vector3.Backward(),0,1,o._loader.babylonScene);u.angle=2*(l.spot&&l.spot.outerConeAngle||Math.PI/4),u.innerAngle=2*(l.spot&&l.spot.innerConeAngle||0),t=u;break;default:throw o._loader.babylonScene._blockEntityCollection=!1,new Error(s+": Invalid light type ("+l.type+")")}o._loader.babylonScene._blockEntityCollection=!1,t.falloffType=i.Light.FALLOFF_GLTF,t.diffuse=l.color?i.Color3.FromArray(l.color):i.Color3.White(),t.intensity=null==l.intensity?1:l.intensity,t.range=null==l.range?Number.MAX_VALUE:l.range,t.parent=e,o._loader._babylonLights.push(t),n.b.AddPointerMetadata(t,s),r(e)}))}))},e}();n.b.RegisterExtension("KHR_lights_punctual",(function(e){return new u(e)}));var c=function(){function e(e){this.name="KHR_materials_pbrSpecularGlossiness",this.order=200,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_pbrSpecularGlossiness")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialBasePropertiesAsync(e,t,r)),s.push(i._loadSpecularGlossinessPropertiesAsync(n,t,o,r)),i._loader.loadMaterialAlphaProperties(e,t,r),Promise.all(s).then((function(){}))}))},e.prototype._loadSpecularGlossinessPropertiesAsync=function(e,t,r,n){if(!(n instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var o=new Array;return n.metallic=null,n.roughness=null,r.diffuseFactor?(n.albedoColor=i.Color3.FromArray(r.diffuseFactor),n.alpha=r.diffuseFactor[3]):n.albedoColor=i.Color3.White(),n.reflectivityColor=r.specularFactor?i.Color3.FromArray(r.specularFactor):i.Color3.White(),n.microSurface=null==r.glossinessFactor?1:r.glossinessFactor,r.diffuseTexture&&o.push(this._loader.loadTextureInfoAsync(e+"/diffuseTexture",r.diffuseTexture,(function(e){e.name=n.name+" (Diffuse)",n.albedoTexture=e}))),r.specularGlossinessTexture&&(r.specularGlossinessTexture.nonColorData=!0,o.push(this._loader.loadTextureInfoAsync(e+"/specularGlossinessTexture",r.specularGlossinessTexture,(function(e){e.name=n.name+" (Specular Glossiness)",n.reflectivityTexture=e}))),n.reflectivityTexture.hasAlpha=!0,n.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(o).then((function(){}))},e}();n.b.RegisterExtension("KHR_materials_pbrSpecularGlossiness",(function(e){return new c(e)}));var d=function(){function e(e){this.name="KHR_materials_unlit",this.order=210,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_unlit")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(){return i._loadUnlitPropertiesAsync(e,t,r)}))},e.prototype._loadUnlitPropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;r.unlit=!0;var o=t.pbrMetallicRoughness;return o&&(o.baseColorFactor?(r.albedoColor=i.Color3.FromArray(o.baseColorFactor),r.alpha=o.baseColorFactor[3]):r.albedoColor=i.Color3.White(),o.baseColorTexture&&n.push(this._loader.loadTextureInfoAsync(e+"/baseColorTexture",o.baseColorTexture,(function(e){e.name=r.name+" (Base Color)",r.albedoTexture=e})))),t.doubleSided&&(r.backFaceCulling=!1,r.twoSidedLighting=!0),this._loader.loadMaterialAlphaProperties(e,t,r),Promise.all(n).then((function(){}))},e}();n.b.RegisterExtension("KHR_materials_unlit",(function(e){return new d(e)}));var p=function(){function e(e){this.name="KHR_materials_clearcoat",this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_clearcoat")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadClearCoatPropertiesAsync(n,o,r)),Promise.all(s).then((function(){}))}))},e.prototype._loadClearCoatPropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;return r.clearCoat.isEnabled=!0,r.clearCoat.useRoughnessFromMainTexture=!1,r.clearCoat.remapF0OnInterfaceChange=!1,null!=t.clearcoatFactor?r.clearCoat.intensity=t.clearcoatFactor:r.clearCoat.intensity=0,t.clearcoatTexture&&n.push(this._loader.loadTextureInfoAsync(e+"/clearcoatTexture",t.clearcoatTexture,(function(e){e.name=r.name+" (ClearCoat Intensity)",r.clearCoat.texture=e}))),null!=t.clearcoatRoughnessFactor?r.clearCoat.roughness=t.clearcoatRoughnessFactor:r.clearCoat.roughness=0,t.clearcoatRoughnessTexture&&(t.clearcoatRoughnessTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(e+"/clearcoatRoughnessTexture",t.clearcoatRoughnessTexture,(function(e){e.name=r.name+" (ClearCoat Roughness)",r.clearCoat.textureRoughness=e})))),t.clearcoatNormalTexture&&(t.clearcoatNormalTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(e+"/clearcoatNormalTexture",t.clearcoatNormalTexture,(function(e){e.name=r.name+" (ClearCoat Normal)",r.clearCoat.bumpTexture=e}))),r.invertNormalMapX=!r.getScene().useRightHandedSystem,r.invertNormalMapY=r.getScene().useRightHandedSystem,null!=t.clearcoatNormalTexture.scale&&(r.clearCoat.bumpTexture.level=t.clearcoatNormalTexture.scale)),Promise.all(n).then((function(){}))},e}();n.b.RegisterExtension("KHR_materials_clearcoat",(function(e){return new p(e)}));var f=function(){function e(e){this.name="KHR_materials_sheen",this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_sheen")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadSheenPropertiesAsync(n,o,r)),Promise.all(s).then((function(){}))}))},e.prototype._loadSheenPropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;return r.sheen.isEnabled=!0,r.sheen.intensity=1,null!=t.sheenColorFactor?r.sheen.color=i.Color3.FromArray(t.sheenColorFactor):r.sheen.color=i.Color3.Black(),t.sheenColorTexture&&n.push(this._loader.loadTextureInfoAsync(e+"/sheenColorTexture",t.sheenColorTexture,(function(e){e.name=r.name+" (Sheen Color)",r.sheen.texture=e}))),void 0!==t.sheenRoughnessFactor?r.sheen.roughness=t.sheenRoughnessFactor:r.sheen.roughness=0,t.sheenRoughnessTexture&&(t.sheenRoughnessTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(e+"/sheenRoughnessTexture",t.sheenRoughnessTexture,(function(e){e.name=r.name+" (Sheen Roughness)",r.sheen.textureRoughness=e})))),r.sheen.albedoScaling=!0,r.sheen.useRoughnessFromMainTexture=!1,Promise.all(n).then((function(){}))},e}();n.b.RegisterExtension("KHR_materials_sheen",(function(e){return new f(e)}));var _=function(){function e(e){this.name="KHR_materials_specular",this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_specular")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadSpecularPropertiesAsync(n,o,r)),Promise.all(s).then((function(){}))}))},e.prototype._loadSpecularPropertiesAsync=function(e,t,r){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var n=new Array;return void 0!==t.specularFactor&&(r.metallicF0Factor=t.specularFactor),void 0!==t.specularColorFactor&&(r.metallicReflectanceColor=i.Color3.FromArray(t.specularColorFactor)),t.specularTexture&&(t.specularTexture.nonColorData=!0,n.push(this._loader.loadTextureInfoAsync(e+"/specularTexture",t.specularTexture,(function(e){e.name=r.name+" (Specular F0 Color)",r.metallicReflectanceTexture=e})))),Promise.all(n).then((function(){}))},e}();n.b.RegisterExtension("KHR_materials_specular",(function(e){return new _(e)}));var g=function(){function e(e){this.name="KHR_materials_ior",this.order=180,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_ior")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadIorPropertiesAsync(n,o,r)),Promise.all(s).then((function(){}))}))},e.prototype._loadIorPropertiesAsync=function(t,r,n){if(!(n instanceof i.PBRMaterial))throw new Error(t+": Material type not supported");return void 0!==r.ior?n.indexOfRefraction=r.ior:n.indexOfRefraction=e._DEFAULT_IOR,Promise.resolve()},e._DEFAULT_IOR=1.5,e}();n.b.RegisterExtension("KHR_materials_ior",(function(e){return new g(e)}));var m=function(){function e(e){this.name="KHR_materials_variants",this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_variants")}return e.prototype.dispose=function(){this._loader=null},e.GetAvailableVariants=function(e){var t=this._GetExtensionMetadata(e);return t?Object.keys(t.variants):[]},e.prototype.getAvailableVariants=function(t){return e.GetAvailableVariants(t)},e.SelectVariant=function(e,t){var r=this._GetExtensionMetadata(e);if(!r)throw new Error("Cannot select variant on a glTF mesh that does not have the KHR_materials_variants extension");var i=function(e){var t=r.variants[e];if(t)for(var i=0,n=t;i<n.length;i++){var o=n[i];o.mesh.material=o.material}};if(t instanceof Array)for(var n=0,o=t;n<o.length;n++)i(o[n]);else i(t);r.lastSelected=t},e.prototype.selectVariant=function(t,r){return e.SelectVariant(t,r)},e.Reset=function(e){var t=this._GetExtensionMetadata(e);if(!t)throw new Error("Cannot reset on a glTF mesh that does not have the KHR_materials_variants extension");for(var r=0,i=t.original;r<i.length;r++){var n=i[r];n.mesh.material=n.material}t.lastSelected=null},e.prototype.reset=function(t){return e.Reset(t)},e.GetLastSelectedVariant=function(e){var t=this._GetExtensionMetadata(e);if(!t)throw new Error("Cannot get the last selected variant on a glTF mesh that does not have the KHR_materials_variants extension");return t.lastSelected},e.prototype.getLastSelectedVariant=function(t){return e.GetLastSelectedVariant(t)},e._GetExtensionMetadata=function(e){var t,r;return(null===(r=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.gltf)||void 0===r?void 0:r.KHR_materials_variants)||null},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._variants=t.variants}},e.prototype._loadMeshPrimitiveAsync=function(e,t,r,o,s,a){var l=this;return n.b.LoadExtensionAsync(e,s,this.name,(function(h,u){var c=new Array;return c.push(l._loader._loadMeshPrimitiveAsync(e,t,r,o,s,(function(t){if(a(t),t instanceof i.Mesh){var r=n.b._GetDrawMode(e,s.mode),o=l._loader.rootBabylonMesh,d=o.metadata=o.metadata||{},p=d.gltf=d.gltf||{},f=p.KHR_materials_variants=p.KHR_materials_variants||{lastSelected:null,original:[],variants:{}};f.original.push({mesh:t,material:t.material});for(var _=f.variants,g=0,m=u.mappings;g<m.length;g++)for(var b=m[g],y=function(e){var i=n.a.Get(h+"/mapping/"+e,l._variants,e),o=n.a.Get("#/materials/",l._loader.gltf.materials,b.material);c.push(l._loader._loadMaterialAsync("#/materials/"+b.material,o,t,r,(function(e){_[i.name]=_[i.name]||[],_[i.name].push({mesh:t,material:e})})))},v=0,T=b.variants;v<T.length;v++)y(T[v])}}))),Promise.all(c).then((function(e){return e[0]}))}))},e}();n.b.RegisterExtension("KHR_materials_variants",(function(e){return new m(e)}));var b=r(4),y=function(){function e(t,r){var n=this;this._opaqueRenderTarget=null,this._opaqueMeshesCache=[],this._transparentMeshesCache=[],this._options=Object(b.a)(Object(b.a)({},e._getDefaultOptions()),t),this._scene=r,this._scene._transmissionHelper=this,this.onErrorObservable=new i.Observable,this._scene.onDisposeObservable.addOnce((function(e){n.dispose()})),this._parseScene(),this._setupRenderTargets()}return e._getDefaultOptions=function(){return{renderSize:512}},e.prototype.updateOptions=function(e){var t=this;if(Object.keys(e).filter((function(r){return t._options[r]!==e[r]})).length){var r=Object(b.a)(Object(b.a)({},this._options),e),i=this._options;this._options=r,r.renderSize!==i.renderSize&&this._setupRenderTargets()}},e.prototype.getOpaqueTarget=function(){return this._opaqueRenderTarget},e.prototype.shouldRenderAsTransmission=function(e){return!!e&&!!(e instanceof i.PBRMaterial&&e.subSurface.isRefractionEnabled)},e.prototype._addMesh=function(e){e instanceof i.Mesh&&(e.onMaterialChangedObservable.add(this.onMeshMaterialChanged.bind(this)),this.shouldRenderAsTransmission(e.material)?this._transparentMeshesCache.push(e):this._opaqueMeshesCache.push(e))},e.prototype._removeMesh=function(e){if(e instanceof i.Mesh){e.onMaterialChangedObservable.remove(this.onMeshMaterialChanged.bind(this));var t=this._transparentMeshesCache.indexOf(e);-1!==t&&this._transparentMeshesCache.splice(t,1),-1!==(t=this._opaqueMeshesCache.indexOf(e))&&this._opaqueMeshesCache.splice(t,1)}},e.prototype._parseScene=function(){this._scene.meshes.forEach(this._addMesh.bind(this)),this._scene.onNewMeshAddedObservable.add(this._addMesh.bind(this)),this._scene.onMeshRemovedObservable.add(this._removeMesh.bind(this))},e.prototype.onMeshMaterialChanged=function(e){if(e instanceof i.Mesh){var t=this._transparentMeshesCache.indexOf(e),r=this._opaqueMeshesCache.indexOf(e);this.shouldRenderAsTransmission(e.material)?(e.material instanceof i.PBRMaterial&&(e.material.subSurface.refractionTexture=this._opaqueRenderTarget),-1!==r?(this._opaqueMeshesCache.splice(r,1),this._transparentMeshesCache.push(e)):-1===t&&this._transparentMeshesCache.push(e)):-1!==t?(this._transparentMeshesCache.splice(t,1),this._opaqueMeshesCache.push(e)):-1===r&&this._opaqueMeshesCache.push(e)}},e.prototype._setupRenderTargets=function(){var e=this,t=-1;if(this._scene.layers&&this._opaqueRenderTarget)for(var r=0,n=this._scene.layers;r<n.length;r++){var o=(l=n[r]).renderTargetTextures.indexOf(this._opaqueRenderTarget);o>=0&&l.renderTargetTextures.splice(o,1)}if(this._opaqueRenderTarget&&(t=this._scene.customRenderTargets.indexOf(this._opaqueRenderTarget),this._opaqueRenderTarget.dispose()),this._opaqueRenderTarget=new i.RenderTargetTexture("opaqueSceneTexture",this._options.renderSize,this._scene,!0),this._opaqueRenderTarget.renderList=this._opaqueMeshesCache,this._opaqueRenderTarget.gammaSpace=!0,this._opaqueRenderTarget.lodGenerationScale=1,this._opaqueRenderTarget.lodGenerationOffset=-4,t>=0?this._scene.customRenderTargets.splice(t,0,this._opaqueRenderTarget):(t=this._scene.customRenderTargets.length,this._scene.customRenderTargets.push(this._opaqueRenderTarget)),this._scene.layers&&this._opaqueRenderTarget)for(var s=0,a=this._scene.layers;s<a.length;s++){var l;(l=a[s]).renderTargetTextures.push(this._opaqueRenderTarget)}this._transparentMeshesCache.forEach((function(t){e.shouldRenderAsTransmission(t.material)&&t.material instanceof i.PBRMaterial&&(t.material.refractionTexture=e._opaqueRenderTarget)}))},e.prototype.dispose=function(){this._scene._transmissionHelper=void 0,this._opaqueRenderTarget&&(this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=null),this._transparentMeshesCache=[],this._opaqueMeshesCache=[]},e}(),v=function(){function e(e){this.name="KHR_materials_transmission",this.order=175,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_transmission"),this.enabled&&(e.parent.transparencyAsCoverage=!0)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialBasePropertiesAsync(e,t,r)),s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadTransparentPropertiesAsync(n,t,r,o)),Promise.all(s).then((function(){}))}))},e.prototype._loadTransparentPropertiesAsync=function(e,t,r,n){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var o=r;if(o.subSurface.isRefractionEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.useAlbedoToTintRefraction=!0,void 0===n.transmissionFactor)return o.subSurface.refractionIntensity=0,o.subSurface.isRefractionEnabled=!1,Promise.resolve();o.subSurface.refractionIntensity=n.transmissionFactor;var s=o.getScene();return o.subSurface.refractionIntensity&&!s._transmissionHelper&&new y({},o.getScene()),n.transmissionTexture?(n.transmissionTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(e+"/transmissionTexture",n.transmissionTexture,void 0).then((function(e){o.subSurface.thicknessTexture=e,o.subSurface.useMaskFromThicknessTextureGltf=!0}))):Promise.resolve()},e}();n.b.RegisterExtension("KHR_materials_transmission",(function(e){return new v(e)}));var T=function(){function e(e){this.name="KHR_materials_translucency",this.order=175,this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_materials_translucency"),this.enabled&&(e.parent.transparencyAsCoverage=!0)}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,o){var s=new Array;return s.push(i._loader.loadMaterialBasePropertiesAsync(e,t,r)),s.push(i._loader.loadMaterialPropertiesAsync(e,t,r)),s.push(i._loadTranslucentPropertiesAsync(n,t,r,o)),Promise.all(s).then((function(){}))}))},e.prototype._loadTranslucentPropertiesAsync=function(e,t,r,n){if(!(r instanceof i.PBRMaterial))throw new Error(e+": Material type not supported");var o=r;return o.subSurface.isTranslucencyEnabled=!0,o.subSurface.volumeIndexOfRefraction=1,o.subSurface.minimumThickness=0,o.subSurface.maximumThickness=0,o.subSurface.useAlbedoToTintRefraction=!0,void 0===n.translucencyFactor?(o.subSurface.translucencyIntensity=0,o.subSurface.isTranslucencyEnabled=!1,Promise.resolve()):(o.subSurface.translucencyIntensity=n.translucencyFactor,n.translucencyTexture?this._loader.loadTextureInfoAsync(e+"/translucencyTexture",n.translucencyTexture).then((function(e){o.subSurface.thicknessTexture=e,o.subSurface.useMaskFromThicknessTextureGltf=!0})):Promise.resolve())},e}();n.b.RegisterExtension("KHR_materials_translucency",(function(e){return new T(e)}));var O=function(){function e(e){this.name="KHR_mesh_quantization",this.enabled=e.isExtensionUsed("KHR_mesh_quantization")}return e.prototype.dispose=function(){},e}();n.b.RegisterExtension("KHR_mesh_quantization",(function(e){return new O(e)}));var E=function(){function e(e){this.name="KHR_texture_basisu",this._loader=e,this.enabled=e.isExtensionUsed("KHR_texture_basisu")}return e.prototype.dispose=function(){this._loader=null},e.prototype._loadTextureAsync=function(e,t,r){var i=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(o,s){var a=null==t.sampler?n.b.DefaultSampler:n.a.Get(e+"/sampler",i._loader.gltf.samplers,t.sampler),l=n.a.Get(o+"/source",i._loader.gltf.images,s.source);return i._loader._createTextureAsync(e,a,l,(function(e){r(e)}),t._textureInfo.nonColorData?{useRGBAIfASTCBC7NotAvailableWhenUASTC:!0}:void 0)}))},e}();n.b.RegisterExtension("KHR_texture_basisu",(function(e){return new E(e)}));var A=function(){function e(e){this.name="KHR_texture_transform",this._loader=e,this.enabled=this._loader.isExtensionUsed("KHR_texture_transform")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadTextureInfoAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(n,s){return o._loader.loadTextureInfoAsync(e,t,(function(e){if(!(e instanceof i.Texture))throw new Error(n+": Texture type not supported");s.offset&&(e.uOffset=s.offset[0],e.vOffset=s.offset[1]),e.uRotationCenter=0,e.vRotationCenter=0,s.rotation&&(e.wAng=-s.rotation),s.scale&&(e.uScale=s.scale[0],e.vScale=s.scale[1]),null!=s.texCoord&&(e.coordinatesIndex=s.texCoord),r(e)}))}))},e}();n.b.RegisterExtension("KHR_texture_transform",(function(e){return new A(e)}));var C=function(){function e(e){this.name="MSFT_audio_emitter",this._loader=e,this.enabled=this._loader.isExtensionUsed("MSFT_audio_emitter")}return e.prototype.dispose=function(){this._loader=null,this._clips=null,this._emitters=null},e.prototype.onLoading=function(){var e=this._loader.gltf.extensions;if(e&&e[this.name]){var t=e[this.name];this._clips=t.clips,this._emitters=t.emitters,n.a.Assign(this._clips),n.a.Assign(this._emitters)}},e.prototype.loadSceneAsync=function(e,t){var r=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(i,o){var s=new Array;s.push(r._loader.loadSceneAsync(e,t));for(var a=0,l=o.emitters;a<l.length;a++){var h=l[a],u=n.a.Get(i+"/emitters",r._emitters,h);if(null!=u.refDistance||null!=u.maxDistance||null!=u.rolloffFactor||null!=u.distanceModel||null!=u.innerAngle||null!=u.outerAngle)throw new Error(i+": Direction or Distance properties are not allowed on emitters attached to a scene");s.push(r._loadEmitterAsync(i+"/emitters/"+u.index,u))}return Promise.all(s).then((function(){}))}))},e.prototype.loadNodeAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(e,s){var a=new Array;return o._loader.loadNodeAsync(e,t,(function(t){for(var l=function(r){var s=n.a.Get(e+"/emitters",o._emitters,r);a.push(o._loadEmitterAsync(e+"/emitters/"+s.index,s).then((function(){for(var e=0,r=s._babylonSounds;e<r.length;e++){var n=r[e];n.attachToMesh(t),null==s.innerAngle&&null==s.outerAngle||(n.setLocalDirectionToMesh(i.Vector3.Forward()),n.setDirectionalCone(2*i.Tools.ToDegrees(null==s.innerAngle?Math.PI:s.innerAngle),2*i.Tools.ToDegrees(null==s.outerAngle?Math.PI:s.outerAngle),0))}})))},h=0,u=s.emitters;h<u.length;h++)l(u[h]);r(t)})).then((function(e){return Promise.all(a).then((function(){return e}))}))}))},e.prototype.loadAnimationAsync=function(e,t){var r=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(i,o){return r._loader.loadAnimationAsync(e,t).then((function(s){var a=new Array;n.a.Assign(o.events);for(var l=0,h=o.events;l<h.length;l++){var u=h[l];a.push(r._loadAnimationEventAsync(i+"/events/"+u.index,e,t,u,s))}return Promise.all(a).then((function(){return s}))}))}))},e.prototype._loadClipAsync=function(e,t){if(t._objectURL)return t._objectURL;var r;if(t.uri)r=this._loader.loadUriAsync(e,t,t.uri);else{var i=n.a.Get(e+"/bufferView",this._loader.gltf.bufferViews,t.bufferView);r=this._loader.loadBufferViewAsync("/bufferViews/"+i.index,i)}return t._objectURL=r.then((function(e){return URL.createObjectURL(new Blob([e],{type:t.mimeType}))})),t._objectURL},e.prototype._loadEmitterAsync=function(e,t){var r=this;if(t._babylonSounds=t._babylonSounds||[],!t._babylonData){for(var o=new Array,s=t.name||"emitter"+t.index,a={loop:!1,autoplay:!1,volume:null==t.volume?1:t.volume},l=function(e){var l="/extensions/"+h.name+"/clips",u=n.a.Get(l,h._clips,t.clips[e].clip);o.push(h._loadClipAsync(l+"/"+t.clips[e].clip,u).then((function(n){var o=t._babylonSounds[e]=new i.Sound(s,n,r._loader.babylonScene,null,a);o.refDistance=t.refDistance||1,o.maxDistance=t.maxDistance||256,o.rolloffFactor=t.rolloffFactor||1,o.distanceModel=t.distanceModel||"exponential",o._positionInEmitterSpace=!0})))},h=this,u=0;u<t.clips.length;u++)l(u);var c=Promise.all(o).then((function(){var e=t.clips.map((function(e){return e.weight||1})),r=new i.WeightedSound(t.loop||!1,t._babylonSounds,e);t.innerAngle&&(r.directionalConeInnerAngle=2*i.Tools.ToDegrees(t.innerAngle)),t.outerAngle&&(r.directionalConeOuterAngle=2*i.Tools.ToDegrees(t.outerAngle)),t.volume&&(r.volume=t.volume),t._babylonData.sound=r}));t._babylonData={loaded:c}}return t._babylonData.loaded},e.prototype._getEventAction=function(e,t,r,i,n){switch(r){case"play":return function(e){var r=(n||0)+(e-i);t.play(r)};case"stop":return function(e){t.stop()};case"pause":return function(e){t.pause()};default:throw new Error(e+": Unsupported action "+r)}},e.prototype._loadAnimationEventAsync=function(e,t,r,o,s){var a=this;if(0==s.targetedAnimations.length)return Promise.resolve();var l=s.targetedAnimations[0],h=o.emitter,u=n.a.Get("/extensions/"+this.name+"/emitters",this._emitters,h);return this._loadEmitterAsync(e,u).then((function(){var t=u._babylonData.sound;if(t){var r=new i.AnimationEvent(o.time,a._getEventAction(e,t,o.action,o.time,o.startOffset));l.animation.addEvent(r),s.onAnimationGroupEndObservable.add((function(){t.stop()})),s.onAnimationGroupPauseObservable.add((function(){t.pause()}))}}))},e}();n.b.RegisterExtension("MSFT_audio_emitter",(function(e){return new C(e)}));var M=function(){function e(e){this.name="MSFT_lod",this.order=100,this.maxLODsToLoad=10,this.onNodeLODsLoadedObservable=new i.Observable,this.onMaterialLODsLoadedObservable=new i.Observable,this._bufferLODs=new Array,this._nodeIndexLOD=null,this._nodeSignalLODs=new Array,this._nodePromiseLODs=new Array,this._nodeBufferLODs=new Array,this._materialIndexLOD=null,this._materialSignalLODs=new Array,this._materialPromiseLODs=new Array,this._materialBufferLODs=new Array,this._loader=e,this.enabled=this._loader.isExtensionUsed("MSFT_lod")}return e.prototype.dispose=function(){this._loader=null,this._nodeIndexLOD=null,this._nodeSignalLODs.length=0,this._nodePromiseLODs.length=0,this._nodeBufferLODs.length=0,this._materialIndexLOD=null,this._materialSignalLODs.length=0,this._materialPromiseLODs.length=0,this._materialBufferLODs.length=0,this.onMaterialLODsLoadedObservable.clear(),this.onNodeLODsLoadedObservable.clear()},e.prototype.onReady=function(){for(var e=this,t=function(t){var i=Promise.all(r._nodePromiseLODs[t]).then((function(){0!==t&&(e._loader.endPerformanceCounter("Node LOD "+t),e._loader.log("Loaded node LOD "+t)),e.onNodeLODsLoadedObservable.notifyObservers(t),t!==e._nodePromiseLODs.length-1&&(e._loader.startPerformanceCounter("Node LOD "+(t+1)),e._loadBufferLOD(e._nodeBufferLODs,t+1),e._nodeSignalLODs[t]&&e._nodeSignalLODs[t].resolve())}));r._loader._completePromises.push(i)},r=this,i=0;i<this._nodePromiseLODs.length;i++)t(i);var n=function(t){var r=Promise.all(o._materialPromiseLODs[t]).then((function(){0!==t&&(e._loader.endPerformanceCounter("Material LOD "+t),e._loader.log("Loaded material LOD "+t)),e.onMaterialLODsLoadedObservable.notifyObservers(t),t!==e._materialPromiseLODs.length-1&&(e._loader.startPerformanceCounter("Material LOD "+(t+1)),e._loadBufferLOD(e._materialBufferLODs,t+1),e._materialSignalLODs[t]&&e._materialSignalLODs[t].resolve())}));o._loader._completePromises.push(r)},o=this;for(i=0;i<this._materialPromiseLODs.length;i++)n(i)},e.prototype.loadSceneAsync=function(e,t){var r=this._loader.loadSceneAsync(e,t);return this._loadBufferLOD(this._bufferLODs,0),r},e.prototype.loadNodeAsync=function(e,t,r){var o=this;return n.b.LoadExtensionAsync(e,t,this.name,(function(e,r){var n,s=o._getLODs(e,t,o._loader.gltf.nodes,r.ids);o._loader.logOpen(""+e);for(var a=function(e){var t=s[e];0!==e&&(o._nodeIndexLOD=e,o._nodeSignalLODs[e]=o._nodeSignalLODs[e]||new i.Deferred);var r=o._loader.loadNodeAsync("/nodes/"+t.index,t,(function(e){e.setEnabled(!1)})).then((function(t){if(0!==e){var r=s[e-1];r._babylonTransformNode&&(o._disposeTransformNode(r._babylonTransformNode),delete r._babylonTransformNode)}return t.setEnabled(!0),t}));o._nodePromiseLODs[e]=o._nodePromiseLODs[e]||[],0===e?n=r:(o._nodeIndexLOD=null,o._nodePromiseLODs[e].push(r))},l=0;l<s.length;l++)a(l);return o._loader.logClose(),n}))},e.prototype._loadMaterialAsync=function(e,t,r,i,o){var s=this;return this._nodeIndexLOD?null:n.b.LoadExtensionAsync(e,t,this.name,(function(e,n){var a,l=s._getLODs(e,t,s._loader.gltf.materials,n.ids);s._loader.logOpen(""+e);for(var h=function(e){var t=l[e];0!==e&&(s._materialIndexLOD=e);var n=s._loader._loadMaterialAsync("/materials/"+t.index,t,r,i,(function(t){0===e&&o(t)})).then((function(t){if(0!==e){o(t);var r=l[e-1]._data;r[i]&&(s._disposeMaterials([r[i].babylonMaterial]),delete r[i])}return t}));s._materialPromiseLODs[e]=s._materialPromiseLODs[e]||[],0===e?a=n:(s._materialIndexLOD=null,s._materialPromiseLODs[e].push(n))},u=0;u<l.length;u++)h(u);return s._loader.logClose(),a}))},e.prototype._loadUriAsync=function(e,t,r){var n=this;if(null!==this._nodeIndexLOD){this._loader.log("deferred");var o=this._nodeIndexLOD-1;return this._nodeSignalLODs[o]=this._nodeSignalLODs[o]||new i.Deferred,this._nodeSignalLODs[this._nodeIndexLOD-1].promise.then((function(){return n._loader.loadUriAsync(e,t,r)}))}return null!==this._materialIndexLOD?(this._loader.log("deferred"),o=this._materialIndexLOD-1,this._materialSignalLODs[o]=this._materialSignalLODs[o]||new i.Deferred,this._materialSignalLODs[o].promise.then((function(){return n._loader.loadUriAsync(e,t,r)}))):null},e.prototype.loadBufferAsync=function(e,t,r,n){if(this._loader.parent.useRangeRequests&&!t.uri){if(!this._loader.bin)throw new Error(e+": Uri is missing or the binary glTF is missing its binary chunk");var o=function(e,t){var o=r,s=o+n-1,a=e[t];return a?(a.start=Math.min(a.start,o),a.end=Math.max(a.end,s)):(a={start:o,end:s,loaded:new i.Deferred},e[t]=a),a.loaded.promise.then((function(e){return new Uint8Array(e.buffer,e.byteOffset+r-a.start,n)}))};return this._loader.log("deferred"),null!==this._nodeIndexLOD?o(this._nodeBufferLODs,this._nodeIndexLOD):null!==this._materialIndexLOD?o(this._materialBufferLODs,this._materialIndexLOD):o(this._bufferLODs,0)}return null},e.prototype._loadBufferLOD=function(e,t){var r=e[t];r&&(this._loader.log("Loading buffer range ["+r.start+"-"+r.end+"]"),this._loader.bin.readAsync(r.start,r.end-r.start+1).then((function(e){r.loaded.resolve(e)}),(function(e){r.loaded.reject(e)})))},e.prototype._getLODs=function(e,t,r,i){if(this.maxLODsToLoad<=0)throw new Error("maxLODsToLoad must be greater than zero");for(var o=new Array,s=i.length-1;s>=0;s--)if(o.push(n.a.Get(e+"/ids/"+i[s],r,i[s])),o.length===this.maxLODsToLoad)return o;return o.push(t),o},e.prototype._disposeTransformNode=function(e){var t=this,r=new Array,i=e.material;i&&r.push(i);for(var n=0,o=e.getChildMeshes();n<o.length;n++){var s=o[n];s.material&&r.push(s.material)}e.dispose();var a=r.filter((function(e){return t._loader.babylonScene.meshes.every((function(t){return t.material!=e}))}));this._disposeMaterials(a)},e.prototype._disposeMaterials=function(e){for(var t={},r=0,i=e;r<i.length;r++){for(var n=0,o=(u=i[r]).getActiveTextures();n<o.length;n++){var s=o[n];t[s.uniqueId]=s}u.dispose()}for(var a in t)for(var l=0,h=this._loader.babylonScene.materials;l<h.length;l++){var u;(u=h[l]).hasTexture(t[a])&&delete t[a]}for(var a in t)t[a].dispose()},e}();n.b.RegisterExtension("MSFT_lod",(function(e){return new M(e)}));var x=function(){function e(e){this.name="MSFT_minecraftMesh",this._loader=e,this.enabled=this._loader.isExtensionUsed("MSFT_minecraftMesh")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var o=this;return n.b.LoadExtraAsync(e,t,this.name,(function(n,s){if(s){if(!(r instanceof i.PBRMaterial))throw new Error(n+": Material type not supported");var a=o._loader.loadMaterialPropertiesAsync(e,t,r);return r.needAlphaBlending()&&(r.forceDepthWrite=!0,r.separateCullingPass=!0),r.backFaceCulling=r.forceDepthWrite,r.twoSidedLighting=!0,a}return null}))},e}();n.b.RegisterExtension("MSFT_minecraftMesh",(function(e){return new x(e)}));var w=function(){function e(e){this.name="MSFT_sRGBFactors",this._loader=e,this.enabled=this._loader.isExtensionUsed("MSFT_sRGBFactors")}return e.prototype.dispose=function(){this._loader=null},e.prototype.loadMaterialPropertiesAsync=function(e,t,r){var o=this;return n.b.LoadExtraAsync(e,t,this.name,(function(n,s){if(s){if(!(r instanceof i.PBRMaterial))throw new Error(n+": Material type not supported");var a=o._loader.loadMaterialPropertiesAsync(e,t,r);return r.albedoTexture||r.albedoColor.toLinearSpaceToRef(r.albedoColor),r.reflectivityTexture||r.reflectivityColor.toLinearSpaceToRef(r.reflectivityColor),a}return null}))},e}();n.b.RegisterExtension("MSFT_sRGBFactors",(function(e){return new w(e)}));var S=function(){function e(e){this.name="ExtrasAsMetadata",this.enabled=!0,this._loader=e}return e.prototype._assignExtras=function(e,t){if(t.extras&&Object.keys(t.extras).length>0){var r=e.metadata=e.metadata||{};(r.gltf=r.gltf||{}).extras=t.extras}},e.prototype.dispose=function(){this._loader=null},e.prototype.loadNodeAsync=function(e,t,r){var i=this;return this._loader.loadNodeAsync(e,t,(function(e){i._assignExtras(e,t),r(e)}))},e.prototype.loadCameraAsync=function(e,t,r){var i=this;return this._loader.loadCameraAsync(e,t,(function(e){i._assignExtras(e,t),r(e)}))},e.prototype.createMaterial=function(e,t,r){var i=this._loader.createMaterial(e,t,r);return this._assignExtras(i,t),i},e}();n.b.RegisterExtension("ExtrasAsMetadata",(function(e){return new S(e)}))},function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFBinaryExtension",(function(){return j})),r.d(t,"GLTFLoaderBase",(function(){return F})),r.d(t,"GLTFLoader",(function(){return V})),r.d(t,"GLTFLoaderExtension",(function(){return H})),r.d(t,"EComponentType",(function(){return i})),r.d(t,"EShaderType",(function(){return n})),r.d(t,"EParameterType",(function(){return o})),r.d(t,"ETextureWrapMode",(function(){return s})),r.d(t,"ETextureFilterType",(function(){return a})),r.d(t,"ETextureFormat",(function(){return l})),r.d(t,"ECullingType",(function(){return h})),r.d(t,"EBlendingFunction",(function(){return u})),r.d(t,"GLTFUtils",(function(){return f})),r.d(t,"GLTFMaterialsCommonExtension",(function(){return U}));var i,n,o,s,a,l,h,u,c=r(4);!function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.FLOAT=5126]="FLOAT"}(i||(i={})),function(e){e[e.FRAGMENT=35632]="FRAGMENT",e[e.VERTEX=35633]="VERTEX"}(n||(n={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D"}(o||(o={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.REPEAT=10497]="REPEAT"}(s||(s={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9728]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(a||(a={})),function(e){e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA"}(l||(l={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(h||(h={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"}(u||(u={}));var d,p=r(0),f=function(){function e(){}return e.SetMatrix=function(e,t,r,i,n){var s=null;if("MODEL"===r.semantic?s=t.getWorldMatrix():"PROJECTION"===r.semantic?s=e.getProjectionMatrix():"VIEW"===r.semantic?s=e.getViewMatrix():"MODELVIEWINVERSETRANSPOSE"===r.semantic?s=p.Matrix.Transpose(t.getWorldMatrix().multiply(e.getViewMatrix()).invert()):"MODELVIEW"===r.semantic?s=t.getWorldMatrix().multiply(e.getViewMatrix()):"MODELVIEWPROJECTION"===r.semantic?s=t.getWorldMatrix().multiply(e.getTransformMatrix()):"MODELINVERSE"===r.semantic?s=t.getWorldMatrix().invert():"VIEWINVERSE"===r.semantic?s=e.getViewMatrix().invert():"PROJECTIONINVERSE"===r.semantic?s=e.getProjectionMatrix().invert():"MODELVIEWINVERSE"===r.semantic?s=t.getWorldMatrix().multiply(e.getViewMatrix()).invert():"MODELVIEWPROJECTIONINVERSE"===r.semantic?s=t.getWorldMatrix().multiply(e.getTransformMatrix()).invert():"MODELINVERSETRANSPOSE"===r.semantic&&(s=p.Matrix.Transpose(t.getWorldMatrix().invert())),s)switch(r.type){case o.FLOAT_MAT2:n.setMatrix2x2(i,p.Matrix.GetAsMatrix2x2(s));break;case o.FLOAT_MAT3:n.setMatrix3x3(i,p.Matrix.GetAsMatrix3x3(s));break;case o.FLOAT_MAT4:n.setMatrix(i,s)}},e.SetUniform=function(e,t,r,i){switch(i){case o.FLOAT:return e.setFloat(t,r),!0;case o.FLOAT_VEC2:return e.setVector2(t,p.Vector2.FromArray(r)),!0;case o.FLOAT_VEC3:return e.setVector3(t,p.Vector3.FromArray(r)),!0;case o.FLOAT_VEC4:return e.setVector4(t,p.Vector4.FromArray(r)),!0;default:return!1}},e.GetWrapMode=function(e){switch(e){case s.CLAMP_TO_EDGE:return p.Texture.CLAMP_ADDRESSMODE;case s.MIRRORED_REPEAT:return p.Texture.MIRROR_ADDRESSMODE;case s.REPEAT:default:return p.Texture.WRAP_ADDRESSMODE}},e.GetByteStrideFromType=function(e){switch(e.type){case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 1}},e.GetTextureFilterMode=function(e){switch(e){case a.LINEAR:case a.LINEAR_MIPMAP_NEAREST:case a.LINEAR_MIPMAP_LINEAR:return p.Texture.TRILINEAR_SAMPLINGMODE;case a.NEAREST:case a.NEAREST_MIPMAP_NEAREST:return p.Texture.NEAREST_SAMPLINGMODE;default:return p.Texture.BILINEAR_SAMPLINGMODE}},e.GetBufferFromBufferView=function(e,t,r,n,o){r=t.byteOffset+r;var s=e.loadedBufferViews[t.buffer];if(r+n>s.byteLength)throw new Error("Buffer access is out of range");var a=s.buffer;switch(r+=s.byteOffset,o){case i.BYTE:return new Int8Array(a,r,n);case i.UNSIGNED_BYTE:return new Uint8Array(a,r,n);case i.SHORT:return new Int16Array(a,r,n);case i.UNSIGNED_SHORT:return new Uint16Array(a,r,n);default:return new Float32Array(a,r,n)}},e.GetBufferFromAccessor=function(t,r){var i=t.bufferViews[r.bufferView],n=r.count*e.GetByteStrideFromType(r);return e.GetBufferFromBufferView(t,i,r.byteOffset,n,r.componentType)},e.DecodeBufferToText=function(e){for(var t="",r=e.byteLength,i=0;i<r;++i)t+=String.fromCharCode(e[i]);return t},e.GetDefaultMaterial=function(t){if(!e._DefaultMaterial){p.Effect.ShadersStore.GLTFDefaultMaterialVertexShader=["precision highp float;","","uniform mat4 worldView;","uniform mat4 projection;","","attribute vec3 position;","","void main(void)","{","    gl_Position = projection * worldView * vec4(position, 1.0);","}"].join("\n"),p.Effect.ShadersStore.GLTFDefaultMaterialPixelShader=["precision highp float;","","uniform vec4 u_emission;","","void main(void)","{","    gl_FragColor = u_emission;","}"].join("\n");var r={attributes:["position"],uniforms:["worldView","projection","u_emission"],samplers:new Array,needAlphaBlending:!1};e._DefaultMaterial=new p.ShaderMaterial("GLTFDefaultMaterial",t,{vertex:"GLTFDefaultMaterial",fragment:"GLTFDefaultMaterial"},r),e._DefaultMaterial.setColor4("u_emission",new p.Color4(.5,.5,.5,1))}return e._DefaultMaterial},e._DefaultMaterial=null,e}(),_=r(2);!function(e){e[e.IDENTIFIER=1]="IDENTIFIER",e[e.UNKNOWN=2]="UNKNOWN",e[e.END_OF_INPUT=3]="END_OF_INPUT"}(d||(d={}));var g=function(){function e(e){this._pos=0,this.currentToken=d.UNKNOWN,this.currentIdentifier="",this.currentString="",this.isLetterOrDigitPattern=/^[a-zA-Z0-9]+$/,this._toParse=e,this._maxPos=e.length}return e.prototype.getNextToken=function(){if(this.isEnd())return d.END_OF_INPUT;if(this.currentString=this.read(),this.currentToken=d.UNKNOWN,"_"===this.currentString||this.isLetterOrDigitPattern.test(this.currentString))for(this.currentToken=d.IDENTIFIER,this.currentIdentifier=this.currentString;!this.isEnd()&&(this.isLetterOrDigitPattern.test(this.currentString=this.peek())||"_"===this.currentString);)this.currentIdentifier+=this.currentString,this.forward();return this.currentToken},e.prototype.peek=function(){return this._toParse[this._pos]},e.prototype.read=function(){return this._toParse[this._pos++]},e.prototype.forward=function(){this._pos++},e.prototype.isEnd=function(){return this._pos>=this._maxPos},e}(),m=["MODEL","VIEW","PROJECTION","MODELVIEW","MODELVIEWPROJECTION","JOINTMATRIX"],b=["world","view","projection","worldView","worldViewProjection","mBones"],y=["translation","rotation","scale"],v=["position","rotationQuaternion","scaling"],T=function(e,t,r){for(var i in e){var n=e[i];r[t][i]=n}},O=function(e){if(e)for(var t=0;t<e.length/2;t++)e[2*t+1]=1-e[2*t+1]},E=function(e){if("NORMAL"===e.semantic)return"normal";if("POSITION"===e.semantic)return"position";if("JOINT"===e.semantic)return"matricesIndices";if("WEIGHT"===e.semantic)return"matricesWeights";if("COLOR"===e.semantic)return"color";if(e.semantic&&-1!==e.semantic.indexOf("TEXCOORD_")){var t=Number(e.semantic.split("_")[1]);return"uv"+(0===t?"":t+1)}return null},A=function(e){var t=null;if(e.translation||e.rotation||e.scale){var r=p.Vector3.FromArray(e.scale||[1,1,1]),i=p.Quaternion.FromArray(e.rotation||[0,0,0,1]),n=p.Vector3.FromArray(e.translation||[0,0,0]);t=p.Matrix.Compose(r,i,n)}else t=p.Matrix.FromArray(e.matrix);return t},C=function(e,t,r,i){for(var n=0;n<i.bones.length;n++)if(i.bones[n].name===r)return i.bones[n];var o=e.nodes;for(var s in o){var a=o[s];if(a.jointName){var l=a.children;for(n=0;n<l.length;n++){var h=e.nodes[l[n]];if(h.jointName&&h.jointName===r){var u=A(a),c=new p.Bone(a.name||"",i,C(e,t,a.jointName,i),u);return c.id=s,c}}}}return null},M=function(e,t){for(var r=0;r<e.length;r++)for(var i=e[r],n=0;n<i.node.children.length;n++)if(i.node.children[n]===t)return i.bone;return null},x=function(e,t){var r=e.nodes,i=r[t];if(i)return{node:i,id:t};for(var n in r)if((i=r[n]).jointName===t)return{node:i,id:n};return null},w=function(e,t){for(var r=0;r<e.jointNames.length;r++)if(e.jointNames[r]===t)return!0;return!1},S=function(e,t,r,i,n){if(i||(i=new p.Skeleton(t.name||"","",e.scene)),!t.babylonSkeleton)return i;var o=[],s=[];!function(e,t,r,i){for(var n in e.nodes){var o=e.nodes[n],s=n;if(o.jointName&&!w(r,o.jointName)){var a=A(o),l=new p.Bone(o.name||"",t,null,a);l.id=s,i.push({bone:l,node:o,id:s})}}for(var h=0;h<i.length;h++)for(var u=i[h],c=u.node.children,d=0;d<c.length;d++){for(var f=null,_=0;_<i.length;_++)if(i[_].id===c[d]){f=i[_];break}f&&(f.bone._parent=u.bone,u.bone.children.push(f.bone))}}(e,i,t,o),i.bones=[];for(var a=0;a<t.jointNames.length;a++)if(v=x(e,t.jointNames[a])){var l=v.node;if(l){n=v.id;var h=e.scene.getBoneByID(n);if(h)i.bones.push(h);else{for(var u=!1,c=null,d=0;d<a;d++){var f=x(e,t.jointNames[d]);if(f){var _=f.node;if(_){var g=_.children;if(g){u=!1;for(var m=0;m<g.length;m++)if(g[m]===n){c=C(e,t,t.jointNames[d],i),u=!0;break}if(u)break}}else p.Tools.Warn("Joint named "+t.jointNames[d]+" does not exist when looking for parent")}}var b=A(l);!c&&o.length>0&&(c=M(o,n))&&-1===s.indexOf(c)&&s.push(c),new p.Bone(l.jointName||"",i,c,b).id=n}}else p.Tools.Warn("Joint named "+t.jointNames[a]+" does not exist")}var y=i.bones;for(i.bones=[],a=0;a<t.jointNames.length;a++){var v;if(v=x(e,t.jointNames[a]))for(d=0;d<y.length;d++)if(y[d].id===v.id){i.bones.push(y[d]);break}}for(i.prepare(),a=0;a<s.length;a++)i.bones.push(s[a]);return i},R=function(e,t,r,i,n){if(n||(e.scene._blockEntityCollection=e.forAssetContainer,n=new p.Mesh(t.name||"",e.scene),e.scene._blockEntityCollection=!1,n.id=i),!t.babylonNode)return n;for(var o,s=[],a=null,l=new Array,h=new Array,u=new Array,c=new Array,d=0;d<r.length;d++){var g=r[d];if(I=e.meshes[g])for(var m=0;m<I.primitives.length;m++){var b=new p.VertexData,y=I.primitives[m];y.mode;var v=y.attributes,T=null,E=null;for(var A in v)if(T=e.accessors[v[A]],E=f.GetBufferFromAccessor(e,T),"NORMAL"===A)b.normals=new Float32Array(E.length),b.normals.set(E);else if("POSITION"===A){if(_.GLTFFileLoader.HomogeneousCoordinates){b.positions=new Float32Array(E.length-E.length/4);for(var C=0;C<E.length;C+=4)b.positions[C]=E[C],b.positions[C+1]=E[C+1],b.positions[C+2]=E[C+2]}else b.positions=new Float32Array(E.length),b.positions.set(E);h.push(b.positions.length)}else if(-1!==A.indexOf("TEXCOORD_")){var M=Number(A.split("_")[1]),x=p.VertexBuffer.UVKind+(0===M?"":M+1),w=new Float32Array(E.length);w.set(E),O(w),b.set(w,x)}else"JOINT"===A?(b.matricesIndices=new Float32Array(E.length),b.matricesIndices.set(E)):"WEIGHT"===A?(b.matricesWeights=new Float32Array(E.length),b.matricesWeights.set(E)):"COLOR"===A&&(b.colors=new Float32Array(E.length),b.colors.set(E));if(T=e.accessors[y.indices])E=f.GetBufferFromAccessor(e,T),b.indices=new Int32Array(E.length),b.indices.set(E),c.push(b.indices.length);else{var S=[];for(C=0;C<b.positions.length/3;C++)S.push(C);b.indices=new Int32Array(S),c.push(b.indices.length)}a?a.merge(b):a=b;var R=e.scene.getMaterialByID(y.material);s.push(null===R?f.GetDefaultMaterial(e.scene):R),l.push(0===l.length?0:l[l.length-1]+h[h.length-2]),u.push(0===u.length?0:u[u.length-1]+c[c.length-2])}}e.scene._blockEntityCollection=e.forAssetContainer,s.length>1?(o=new p.MultiMaterial("multimat"+i,e.scene)).subMaterials=s:o=new p.StandardMaterial("multimat"+i,e.scene),1===s.length&&(o=s[0]),n.material||(n.material=o),new p.Geometry(i,e.scene,a,!1,n),n.computeWorldMatrix(!0),e.scene._blockEntityCollection=!1,n.subMeshes=[];var P=0;for(d=0;d<r.length;d++){var I;if(g=r[d],I=e.meshes[g])for(m=0;m<I.primitives.length;m++)I.primitives[m].mode,p.SubMesh.AddToMesh(P,l[P],h[P],u[P],c[P],n,n,!0),P++}return n},P=function(e,t,r,i){e.position&&(e.position=t),(e.rotationQuaternion||e.rotation)&&(e.rotationQuaternion=r),e.scaling&&(e.scaling=i)},I=function(e,t,r,i){var n=null;if(e.importOnlyMeshes&&(t.skin||t.meshes)&&e.importMeshesNames&&e.importMeshesNames.length>0&&-1===e.importMeshesNames.indexOf(t.name||""))return null;if(t.skin){if(t.meshes){var o=e.skins[t.skin];(s=R(e,t,t.meshes,r,t.babylonNode)).skeleton=e.scene.getLastSkeletonByID(t.skin),null===s.skeleton&&(s.skeleton=S(e,o,0,o.babylonSkeleton,t.skin),o.babylonSkeleton||(o.babylonSkeleton=s.skeleton)),n=s}}else if(t.meshes){var s;n=s=R(e,t,t.mesh?[t.mesh]:t.meshes,r,t.babylonNode)}else if(!t.light||t.babylonNode||e.importOnlyMeshes){if(t.camera&&!t.babylonNode&&!e.importOnlyMeshes){var a=e.cameras[t.camera];if(a){if(e.scene._blockEntityCollection=e.forAssetContainer,"orthographic"===a.type){var l=new p.FreeCamera(t.camera,p.Vector3.Zero(),e.scene,!1);l.name=t.name||"",l.mode=p.Camera.ORTHOGRAPHIC_CAMERA,l.attachControl(),n=l}else if("perspective"===a.type){var h=a[a.type],u=new p.FreeCamera(t.camera,p.Vector3.Zero(),e.scene,!1);u.name=t.name||"",u.attachControl(),h.aspectRatio||(h.aspectRatio=e.scene.getEngine().getRenderWidth()/e.scene.getEngine().getRenderHeight()),h.znear&&h.zfar&&(u.maxZ=h.zfar,u.minZ=h.znear),n=u}e.scene._blockEntityCollection=!1}}}else{var c=e.lights[t.light];if(c)if("ambient"===c.type){var d=c[c.type],f=new p.HemisphericLight(t.light,p.Vector3.Zero(),e.scene);f.name=t.name||"",d.color&&(f.diffuse=p.Color3.FromArray(d.color)),n=f}else if("directional"===c.type){var _=c[c.type],g=new p.DirectionalLight(t.light,p.Vector3.Zero(),e.scene);g.name=t.name||"",_.color&&(g.diffuse=p.Color3.FromArray(_.color)),n=g}else if("point"===c.type){var m=c[c.type],b=new p.PointLight(t.light,p.Vector3.Zero(),e.scene);b.name=t.name||"",m.color&&(b.diffuse=p.Color3.FromArray(m.color)),n=b}else if("spot"===c.type){var y=c[c.type],v=new p.SpotLight(t.light,p.Vector3.Zero(),p.Vector3.Zero(),0,0,e.scene);v.name=t.name||"",y.color&&(v.diffuse=p.Color3.FromArray(y.color)),y.fallOfAngle&&(v.angle=y.fallOfAngle),y.fallOffExponent&&(v.exponent=y.fallOffExponent),n=v}}if(!t.jointName){if(t.babylonNode)return t.babylonNode;if(null===n){e.scene._blockEntityCollection=e.forAssetContainer;var T=new p.Mesh(t.name||"",e.scene);e.scene._blockEntityCollection=!1,t.babylonNode=T,n=T}}if(null!==n){if(t.matrix&&n instanceof p.Mesh)!function(e,t,r){if(t.matrix){var i=new p.Vector3(0,0,0),n=new p.Quaternion,o=new p.Vector3(0,0,0);p.Matrix.FromArray(t.matrix).decompose(o,n,i),P(e,i,n,o)}else t.translation&&t.rotation&&t.scale&&P(e,p.Vector3.FromArray(t.translation),p.Quaternion.FromArray(t.rotation),p.Vector3.FromArray(t.scale));e.computeWorldMatrix(!0)}(n,t);else{var O=t.translation||[0,0,0],E=t.rotation||[0,0,0,1],A=t.scale||[1,1,1];P(n,p.Vector3.FromArray(O),p.Quaternion.FromArray(E),p.Vector3.FromArray(A))}n.updateCache(!0),t.babylonNode=n}return n},L=function(e,t,r,i){void 0===i&&(i=!1);var n=e.nodes[t],o=null;if(i=!(e.importOnlyMeshes&&!i&&e.importMeshesNames)||-1!==e.importMeshesNames.indexOf(n.name||"")||0===e.importMeshesNames.length,!n.jointName&&i&&null!==(o=I(e,n,t))&&(o.id=t,o.parent=r),n.children)for(var s=0;s<n.children.length;s++)L(e,n.children[s],o,i)},N=function(e){var t=e.currentScene;if(t)for(var r=0;r<t.nodes.length;r++)L(e,t.nodes[r],null);else for(var i in e.scenes)for(t=e.scenes[i],r=0;r<t.nodes.length;r++)L(e,t.nodes[r],null);for(function(e){for(var t in e.animations){var r=e.animations[t];if(r.channels&&r.samplers)for(var i=null,n=0;n<r.channels.length;n++){var o=r.channels[n],s=r.samplers[o.sampler];if(s){var a=null,l=null;r.parameters?(a=r.parameters[s.input],l=r.parameters[s.output]):(a=s.input,l=s.output);var h=f.GetBufferFromAccessor(e,e.accessors[a]),u=f.GetBufferFromAccessor(e,e.accessors[l]),c=o.target.id,d=e.scene.getNodeByID(c);if(null===d&&(d=e.scene.getNodeByName(c)),null!==d){var _=d instanceof p.Bone,g=o.target.path,m=y.indexOf(g);-1!==m&&(g=v[m]);var b=p.Animation.ANIMATIONTYPE_MATRIX;_||("rotationQuaternion"===g?(b=p.Animation.ANIMATIONTYPE_QUATERNION,d.rotationQuaternion=new p.Quaternion):b=p.Animation.ANIMATIONTYPE_VECTOR3);var T=null,O=[],E=0,A=!1;_&&i&&i.getKeys().length===h.length&&(T=i,A=!0),A||(e.scene._blockEntityCollection=e.forAssetContainer,T=new p.Animation(t,_?"_matrix":g,1,b,p.Animation.ANIMATIONLOOPMODE_CYCLE),e.scene._blockEntityCollection=!1);for(var C=0;C<h.length;C++){var M=null;if("rotationQuaternion"===g?(M=p.Quaternion.FromArray([u[E],u[E+1],u[E+2],u[E+3]]),E+=4):(M=p.Vector3.FromArray([u[E],u[E+1],u[E+2]]),E+=3),_){var x=d,w=p.Vector3.Zero(),S=new p.Quaternion,R=p.Vector3.Zero(),P=x.getBaseMatrix();A&&i&&(P=i.getKeys()[C].value),P.decompose(R,S,w),"position"===g?w=M:"rotationQuaternion"===g?S=M:R=M,M=p.Matrix.Compose(R,S,w)}A?i&&(i.getKeys()[C].value=M):O.push({frame:h[C],value:M})}!A&&T&&(T.setKeys(O),d.animations.push(T)),i=T,e.scene.stopAnimation(d),e.scene.beginAnimation(d,0,h[h.length-1],!0,1)}else p.Tools.Warn("Creating animation named "+t+". But cannot find node named "+c+" to attach to")}}}}(e),r=0;r<e.scene.skeletons.length;r++){var n=e.scene.skeletons[r];e.scene.beginAnimation(n,0,Number.MAX_VALUE,!0,1)}},k=function(e,t,r,i,n,s){return function(a){!function(e,t,r,i,n){var s=i.values||r.parameters,a=r.uniforms;for(var l in n){var h=n[l],u=h.type,c=s[a[l]];if(void 0===c&&(c=h.value),c){var d=function(e){return function(r){h.value&&e&&(t.setTexture(e,r),delete n[e])}};u===o.SAMPLER_2D?H.LoadTextureAsync(e,i.values?c:h.value,d(l),(function(){return d(null)})):h.value&&f.SetUniform(t,l,i.values?c:h.value,u)&&delete n[l]}}}(e,t,r,i,n),t.onBind=function(a){!function(e,t,r,i,n,s,a){var l=s.values||n.parameters;for(var h in r){var u=r[h],c=u.type;if(c===o.FLOAT_MAT2||c===o.FLOAT_MAT3||c===o.FLOAT_MAT4)if(!u.semantic||u.source||u.node){if(u.semantic&&(u.source||u.node)){var d=t.scene.getNodeByName(u.source||u.node||"");if(null===d&&(d=t.scene.getNodeByID(u.source||u.node||"")),null===d)continue;f.SetMatrix(t.scene,d,u,h,i.getEffect())}}else f.SetMatrix(t.scene,e,u,h,i.getEffect());else{var p=l[n.uniforms[h]];if(!p)continue;if(c===o.SAMPLER_2D){var _=t.textures[s.values?p:u.value].babylonTexture;if(null==_)continue;i.getEffect().setTexture(h,_)}else f.SetUniform(i.getEffect(),h,p,c)}}a(i)}(a,e,n,t,r,i,s)}}},D=function(e,t,r){for(var i in t.uniforms){var n=t.uniforms[i],o=t.parameters[n];if(e.currentIdentifier===i&&o.semantic&&!o.source&&!o.node){var s=m.indexOf(o.semantic);if(-1!==s)return delete r[i],b[s]}}return e.currentIdentifier},B=function(e){for(var t in e.materials)H.LoadMaterialAsync(e,t,(function(e){}),(function(){}))},F=function(){function e(){}return e.CreateRuntime=function(e,t,r){var i={extensions:{},accessors:{},buffers:{},bufferViews:{},meshes:{},lights:{},cameras:{},nodes:{},images:{},textures:{},shaders:{},programs:{},samplers:{},techniques:{},materials:{},animations:{},skins:{},extensionsUsed:[],scenes:{},buffersCount:0,shaderscount:0,scene:t,rootUrl:r,loadedBufferCount:0,loadedBufferViews:{},loadedShaderCount:0,importOnlyMeshes:!1,dummyNodes:[],forAssetContainer:!1};return e.extensions&&T(e.extensions,"extensions",i),e.extensionsUsed&&T(e.extensionsUsed,"extensionsUsed",i),e.buffers&&function(e,t){for(var r in e){var i=e[r];t.buffers[r]=i,t.buffersCount++}}(e.buffers,i),e.bufferViews&&T(e.bufferViews,"bufferViews",i),e.accessors&&T(e.accessors,"accessors",i),e.meshes&&T(e.meshes,"meshes",i),e.lights&&T(e.lights,"lights",i),e.cameras&&T(e.cameras,"cameras",i),e.nodes&&T(e.nodes,"nodes",i),e.images&&T(e.images,"images",i),e.textures&&T(e.textures,"textures",i),e.shaders&&function(e,t){for(var r in e){var i=e[r];t.shaders[r]=i,t.shaderscount++}}(e.shaders,i),e.programs&&T(e.programs,"programs",i),e.samplers&&T(e.samplers,"samplers",i),e.techniques&&T(e.techniques,"techniques",i),e.materials&&T(e.materials,"materials",i),e.animations&&T(e.animations,"animations",i),e.skins&&T(e.skins,"skins",i),e.scenes&&(i.scenes=e.scenes),e.scene&&e.scenes&&(i.currentScene=e.scenes[e.scene]),i},e.LoadBufferAsync=function(e,t,r,i,n){var o=e.buffers[t];p.Tools.IsBase64(o.uri)?setTimeout((function(){return r(new Uint8Array(p.Tools.DecodeBase64(o.uri)))})):p.Tools.LoadFile(e.rootUrl+o.uri,(function(e){return r(new Uint8Array(e))}),n,void 0,!0,(function(e){e&&i(e.status+" "+e.statusText)}))},e.LoadTextureBufferAsync=function(e,t,r,i){var n=e.textures[t];if(n&&n.source)if(n.babylonTexture)r(null);else{var o=e.images[n.source];p.Tools.IsBase64(o.uri)?setTimeout((function(){return r(new Uint8Array(p.Tools.DecodeBase64(o.uri)))})):p.Tools.LoadFile(e.rootUrl+o.uri,(function(e){return r(new Uint8Array(e))}),void 0,void 0,!0,(function(e){e&&i(e.status+" "+e.statusText)}))}else i("")},e.CreateTextureAsync=function(e,t,r,i,n){var o=e.textures[t];if(o.babylonTexture)i(o.babylonTexture);else{var s=e.samplers[o.sampler],l=s.minFilter===a.NEAREST_MIPMAP_NEAREST||s.minFilter===a.NEAREST_MIPMAP_LINEAR||s.minFilter===a.LINEAR_MIPMAP_NEAREST||s.minFilter===a.LINEAR_MIPMAP_LINEAR,h=p.Texture.BILINEAR_SAMPLINGMODE,u=null==r?new Blob:new Blob([r]),c=URL.createObjectURL(u),d=function(){return URL.revokeObjectURL(c)},_=new p.Texture(c,e.scene,!l,!0,h,d,d);void 0!==s.wrapS&&(_.wrapU=f.GetWrapMode(s.wrapS)),void 0!==s.wrapT&&(_.wrapV=f.GetWrapMode(s.wrapT)),_.name=t,o.babylonTexture=_,i(_)}},e.LoadShaderStringAsync=function(e,t,r,i){var n=e.shaders[t];if(p.Tools.IsBase64(n.uri)){var o=atob(n.uri.split(",")[1]);r&&r(o)}else p.Tools.LoadFile(e.rootUrl+n.uri,r,void 0,void 0,!1,(function(e){e&&i&&i(e.status+" "+e.statusText)}))},e.LoadMaterialAsync=function(e,t,r,i){var n=e.materials[t];if(n.technique){var s=e.techniques[n.technique];if(!s){e.scene._blockEntityCollection=e.forAssetContainer;var a=new p.StandardMaterial(t,e.scene);return e.scene._blockEntityCollection=!1,a.diffuseColor=new p.Color3(.5,.5,.5),a.sideOrientation=p.Material.CounterClockWiseSideOrientation,void r(a)}var l=e.programs[s.program],c=s.states,f=p.Effect.ShadersStore[l.vertexShader+"VertexShader"],_=p.Effect.ShadersStore[l.fragmentShader+"PixelShader"],y="",v="",T=new g(f),O=new g(_),A={},C=[],M=[],x=[];for(var w in s.uniforms){var S=s.uniforms[w],R=s.parameters[S];if(A[w]=R,!R.semantic||R.node||R.source)R.type===o.SAMPLER_2D?x.push(w):C.push(w);else{var P=m.indexOf(R.semantic);-1!==P?(C.push(b[P]),delete A[w]):C.push(w)}}for(var I in s.attributes){var L=s.attributes[I];if((F=s.parameters[L]).semantic){var N=E(F);N&&M.push(N)}}for(;!T.isEnd()&&T.getNextToken();)if(T.currentToken===d.IDENTIFIER){var B=!1;for(var I in s.attributes){L=s.attributes[I];var F=s.parameters[L];if(T.currentIdentifier===I&&F.semantic){y+=E(F),B=!0;break}}B||(y+=D(T,s,A))}else y+=T.currentString;for(;!O.isEnd()&&O.getNextToken();)O.currentToken===d.IDENTIFIER?v+=D(O,s,A):v+=O.currentString;var V={vertex:l.vertexShader+t,fragment:l.fragmentShader+t},H={attributes:M,uniforms:C,samplers:x,needAlphaBlending:c&&c.enable&&-1!==c.enable.indexOf(3042)};p.Effect.ShadersStore[l.vertexShader+t+"VertexShader"]=y,p.Effect.ShadersStore[l.fragmentShader+t+"PixelShader"]=v;var j=new p.ShaderMaterial(t,e.scene,V,H);if(j.onError=function(e,t,r){return function(i,n){t.dispose(!0),r("Cannot compile program named "+e.name+". Error: "+n+". Default material will be applied")}}(l,j,i),j.onCompiled=k(e,j,s,n,A,r),j.sideOrientation=p.Material.CounterClockWiseSideOrientation,c&&c.functions){var U=c.functions;U.cullFace&&U.cullFace[0]!==h.BACK&&(j.backFaceCulling=!1);var G=U.blendFuncSeparate;G&&(G[0]===u.SRC_ALPHA&&G[1]===u.ONE_MINUS_SRC_ALPHA&&G[2]===u.ONE&&G[3]===u.ONE?j.alphaMode=p.Constants.ALPHA_COMBINE:G[0]===u.ONE&&G[1]===u.ONE&&G[2]===u.ZERO&&G[3]===u.ONE?j.alphaMode=p.Constants.ALPHA_ONEONE:G[0]===u.SRC_ALPHA&&G[1]===u.ONE&&G[2]===u.ZERO&&G[3]===u.ONE?j.alphaMode=p.Constants.ALPHA_ADD:G[0]===u.ZERO&&G[1]===u.ONE_MINUS_SRC_COLOR&&G[2]===u.ONE&&G[3]===u.ONE?j.alphaMode=p.Constants.ALPHA_SUBTRACT:G[0]===u.DST_COLOR&&G[1]===u.ZERO&&G[2]===u.ONE&&G[3]===u.ONE?j.alphaMode=p.Constants.ALPHA_MULTIPLY:G[0]===u.SRC_ALPHA&&G[1]===u.ONE_MINUS_SRC_COLOR&&G[2]===u.ONE&&G[3]===u.ONE&&(j.alphaMode=p.Constants.ALPHA_MAXIMIZED))}}else i&&i("No technique found.")},e}(),V=function(){function e(){this.state=null}return e.RegisterExtension=function(t){e.Extensions[t.name]?p.Tools.Error('Tool with the same name "'+t.name+'" already exists'):e.Extensions[t.name]=t},e.prototype.dispose=function(){},e.prototype._importMeshAsync=function(e,t,r,i,n,o,s,a){var l=this;return t.useRightHandedSystem=!0,H.LoadRuntimeAsync(t,r,i,(function(t){t.forAssetContainer=n,t.importOnlyMeshes=!0,""===e?t.importMeshesNames=[]:"string"==typeof e?t.importMeshesNames=[e]:!e||e instanceof Array?(t.importMeshesNames=[],p.Tools.Warn("Argument meshesNames must be of type string or string[]")):t.importMeshesNames=[e],l._createNodes(t);var r=new Array,i=new Array;for(var a in t.nodes){var h=t.nodes[a];h.babylonNode instanceof p.AbstractMesh&&r.push(h.babylonNode)}for(var u in t.skins){var c=t.skins[u];c.babylonSkeleton instanceof p.Skeleton&&i.push(c.babylonSkeleton)}l._loadBuffersAsync(t,(function(){l._loadShadersAsync(t,(function(){B(t),N(t),!_.GLTFFileLoader.IncrementalLoading&&o&&o(r,i)}))}),s),_.GLTFFileLoader.IncrementalLoading&&o&&o(r,i)}),a),!0},e.prototype.importMeshAsync=function(e,t,r,i,n,o){var s=this;return new Promise((function(a,l){s._importMeshAsync(e,t,i,n,r,(function(e,t){a({meshes:e,particleSystems:[],skeletons:t,animationGroups:[],lights:[],transformNodes:[],geometries:[]})}),o,(function(e){l(new Error(e))}))}))},e.prototype._loadAsync=function(e,t,r,i,n,o,s){var a=this;e.useRightHandedSystem=!0,H.LoadRuntimeAsync(e,t,r,(function(e){H.LoadRuntimeExtensionsAsync(e,(function(){a._createNodes(e),a._loadBuffersAsync(e,(function(){a._loadShadersAsync(e,(function(){B(e),N(e),_.GLTFFileLoader.IncrementalLoading||n()}))})),_.GLTFFileLoader.IncrementalLoading&&n()}),s)}),s)},e.prototype.loadAsync=function(e,t,r,i){var n=this;return new Promise((function(o,s){n._loadAsync(e,t,r,!1,(function(){o()}),i,(function(e){s(new Error(e))}))}))},e.prototype._loadShadersAsync=function(e,t){var r=!1,i=function(r,i){H.LoadShaderStringAsync(e,r,(function(o){o instanceof ArrayBuffer||(e.loadedShaderCount++,o&&(p.Effect.ShadersStore[r+(i.type===n.VERTEX?"VertexShader":"PixelShader")]=o),e.loadedShaderCount===e.shaderscount&&t())}),(function(){p.Tools.Error("Error when loading shader program named "+r+" located at "+i.uri)}))};for(var o in e.shaders){r=!0;var s=e.shaders[o];s?i.bind(this,o,s)():p.Tools.Error("No shader named: "+o)}r||t()},e.prototype._loadBuffersAsync=function(e,t,r){var i=!1,n=function(r,i){H.LoadBufferAsync(e,r,(function(n){e.loadedBufferCount++,n&&(n.byteLength!=e.buffers[r].byteLength&&p.Tools.Error("Buffer named "+r+" is length "+n.byteLength+". Expected: "+i.byteLength),e.loadedBufferViews[r]=n),e.loadedBufferCount===e.buffersCount&&t()}),(function(){p.Tools.Error("Error when loading buffer named "+r+" located at "+i.uri)}))};for(var o in e.buffers){i=!0;var s=e.buffers[o];s?n.bind(this,o,s)():p.Tools.Error("No buffer named: "+o)}i||t()},e.prototype._createNodes=function(e){var t=e.currentScene;if(t)for(var r=0;r<t.nodes.length;r++)L(e,t.nodes[r],null);else for(var i in e.scenes)for(t=e.scenes[i],r=0;r<t.nodes.length;r++)L(e,t.nodes[r],null)},e.Extensions={},e}(),H=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.loadRuntimeAsync=function(e,t,r,i,n){return!1},e.prototype.loadRuntimeExtensionsAsync=function(e,t,r){return!1},e.prototype.loadBufferAsync=function(e,t,r,i,n){return!1},e.prototype.loadTextureBufferAsync=function(e,t,r,i){return!1},e.prototype.createTextureAsync=function(e,t,r,i,n){return!1},e.prototype.loadShaderStringAsync=function(e,t,r,i){return!1},e.prototype.loadMaterialAsync=function(e,t,r,i){return!1},e.LoadRuntimeAsync=function(t,r,i,n,o){e.ApplyExtensions((function(e){return e.loadRuntimeAsync(t,r,i,n,o)}),(function(){setTimeout((function(){n&&n(F.CreateRuntime(r.json,t,i))}))}))},e.LoadRuntimeExtensionsAsync=function(t,r,i){e.ApplyExtensions((function(e){return e.loadRuntimeExtensionsAsync(t,r,i)}),(function(){setTimeout((function(){r()}))}))},e.LoadBufferAsync=function(t,r,i,n,o){e.ApplyExtensions((function(e){return e.loadBufferAsync(t,r,i,n,o)}),(function(){F.LoadBufferAsync(t,r,i,n,o)}))},e.LoadTextureAsync=function(t,r,i,n){e.LoadTextureBufferAsync(t,r,(function(o){o&&e.CreateTextureAsync(t,r,o,i,n)}),n)},e.LoadShaderStringAsync=function(t,r,i,n){e.ApplyExtensions((function(e){return e.loadShaderStringAsync(t,r,i,n)}),(function(){F.LoadShaderStringAsync(t,r,i,n)}))},e.LoadMaterialAsync=function(t,r,i,n){e.ApplyExtensions((function(e){return e.loadMaterialAsync(t,r,i,n)}),(function(){F.LoadMaterialAsync(t,r,i,n)}))},e.LoadTextureBufferAsync=function(t,r,i,n){e.ApplyExtensions((function(e){return e.loadTextureBufferAsync(t,r,i,n)}),(function(){F.LoadTextureBufferAsync(t,r,i,n)}))},e.CreateTextureAsync=function(t,r,i,n,o){e.ApplyExtensions((function(e){return e.createTextureAsync(t,r,i,n,o)}),(function(){F.CreateTextureAsync(t,r,i,n,o)}))},e.ApplyExtensions=function(e,t){for(var r in V.Extensions)if(e(V.Extensions[r]))return;t()},e}();_.GLTFFileLoader._CreateGLTF1Loader=function(){return new V};var j=function(e){function t(){return e.call(this,"KHR_binary_glTF")||this}return Object(c.b)(t,e),t.prototype.loadRuntimeAsync=function(e,t,r,i,n){var o=t.json.extensionsUsed;return!(!o||-1===o.indexOf(this.name)||!t.bin)&&(this._bin=t.bin,i(F.CreateRuntime(t.json,e,r)),!0)},t.prototype.loadBufferAsync=function(e,t,r,i){return-1!==e.extensionsUsed.indexOf(this.name)&&"binary_glTF"===t&&(this._bin.readAsync(0,this._bin.byteLength).then(r,(function(e){return i(e.message)})),!0)},t.prototype.loadTextureBufferAsync=function(e,t,r,n){var o=e.textures[t],s=e.images[o.source];if(!s.extensions||!(this.name in s.extensions))return!1;var a=s.extensions[this.name],l=e.bufferViews[a.bufferView];return r(f.GetBufferFromBufferView(e,l,0,l.byteLength,i.UNSIGNED_BYTE)),!0},t.prototype.loadShaderStringAsync=function(e,t,r,n){var o=e.shaders[t];if(!o.extensions||!(this.name in o.extensions))return!1;var s=o.extensions[this.name],a=e.bufferViews[s.bufferView],l=f.GetBufferFromBufferView(e,a,0,a.byteLength,i.UNSIGNED_BYTE);return setTimeout((function(){var e=f.DecodeBufferToText(l);r(e)})),!0},t}(H);V.RegisterExtension(new j);var U=function(e){function t(){return e.call(this,"KHR_materials_common")||this}return Object(c.b)(t,e),t.prototype.loadRuntimeExtensionsAsync=function(e,t,r){if(!e.extensions)return!1;var i=e.extensions[this.name];if(!i)return!1;var n=i.lights;if(n)for(var o in n){var s=n[o];switch(s.type){case"ambient":var a=new p.HemisphericLight(s.name,new p.Vector3(0,1,0),e.scene),l=s.ambient;l&&(a.diffuse=p.Color3.FromArray(l.color||[1,1,1]));break;case"point":var h=new p.PointLight(s.name,new p.Vector3(10,10,10),e.scene),u=s.point;u&&(h.diffuse=p.Color3.FromArray(u.color||[1,1,1]));break;case"directional":var c=new p.DirectionalLight(s.name,new p.Vector3(0,-1,0),e.scene),d=s.directional;d&&(c.diffuse=p.Color3.FromArray(d.color||[1,1,1]));break;case"spot":var f=s.spot;f&&(new p.SpotLight(s.name,new p.Vector3(0,10,0),new p.Vector3(0,-1,0),f.fallOffAngle||Math.PI,f.fallOffExponent||0,e.scene).diffuse=p.Color3.FromArray(f.color||[1,1,1]));break;default:p.Tools.Warn('GLTF Material Common extension: light type "'+s.type+"” not supported")}}return!1},t.prototype.loadMaterialAsync=function(e,t,r,i){var n=e.materials[t];if(!n||!n.extensions)return!1;var o=n.extensions[this.name];if(!o)return!1;var s=new p.StandardMaterial(t,e.scene);return s.sideOrientation=p.Material.CounterClockWiseSideOrientation,"CONSTANT"===o.technique&&(s.disableLighting=!0),s.backFaceCulling=void 0!==o.doubleSided&&!o.doubleSided,s.alpha=void 0===o.values.transparency?1:o.values.transparency,s.specularPower=void 0===o.values.shininess?0:o.values.shininess,"string"==typeof o.values.ambient?this._loadTexture(e,o.values.ambient,s,"ambientTexture",i):s.ambientColor=p.Color3.FromArray(o.values.ambient||[0,0,0]),"string"==typeof o.values.diffuse?this._loadTexture(e,o.values.diffuse,s,"diffuseTexture",i):s.diffuseColor=p.Color3.FromArray(o.values.diffuse||[0,0,0]),"string"==typeof o.values.emission?this._loadTexture(e,o.values.emission,s,"emissiveTexture",i):s.emissiveColor=p.Color3.FromArray(o.values.emission||[0,0,0]),"string"==typeof o.values.specular?this._loadTexture(e,o.values.specular,s,"specularTexture",i):s.specularColor=p.Color3.FromArray(o.values.specular||[0,0,0]),!0},t.prototype._loadTexture=function(e,t,r,i,n){F.LoadTextureBufferAsync(e,t,(function(o){F.CreateTextureAsync(e,t,o,(function(e){return r[i]=e}),n)}),n)},t}(H);V.RegisterExtension(new U)},function(e,t,r){"use strict";r.r(t),r.d(t,"ArrayItem",(function(){return i.a})),r.d(t,"GLTFLoader",(function(){return i.b})),r.d(t,"EXT_lights_image_based",(function(){return n.EXT_lights_image_based})),r.d(t,"EXT_mesh_gpu_instancing",(function(){return n.EXT_mesh_gpu_instancing})),r.d(t,"EXT_texture_webp",(function(){return n.EXT_texture_webp})),r.d(t,"KHR_draco_mesh_compression",(function(){return n.KHR_draco_mesh_compression})),r.d(t,"KHR_lights",(function(){return n.KHR_lights})),r.d(t,"KHR_materials_pbrSpecularGlossiness",(function(){return n.KHR_materials_pbrSpecularGlossiness})),r.d(t,"KHR_materials_unlit",(function(){return n.KHR_materials_unlit})),r.d(t,"KHR_materials_clearcoat",(function(){return n.KHR_materials_clearcoat})),r.d(t,"KHR_materials_sheen",(function(){return n.KHR_materials_sheen})),r.d(t,"KHR_materials_specular",(function(){return n.KHR_materials_specular})),r.d(t,"KHR_materials_ior",(function(){return n.KHR_materials_ior})),r.d(t,"KHR_materials_variants",(function(){return n.KHR_materials_variants})),r.d(t,"KHR_materials_transmission",(function(){return n.KHR_materials_transmission})),r.d(t,"KHR_materials_translucency",(function(){return n.KHR_materials_translucency})),r.d(t,"KHR_mesh_quantization",(function(){return n.KHR_mesh_quantization})),r.d(t,"KHR_texture_basisu",(function(){return n.KHR_texture_basisu})),r.d(t,"KHR_texture_transform",(function(){return n.KHR_texture_transform})),r.d(t,"MSFT_audio_emitter",(function(){return n.MSFT_audio_emitter})),r.d(t,"MSFT_lod",(function(){return n.MSFT_lod})),r.d(t,"MSFT_minecraftMesh",(function(){return n.MSFT_minecraftMesh})),r.d(t,"MSFT_sRGBFactors",(function(){return n.MSFT_sRGBFactors})),r.d(t,"ExtrasAsMetadata",(function(){return n.ExtrasAsMetadata}));var i=r(1),n=(r(6),r(7))},function(e,t,r){"use strict";r.r(t),r.d(t,"MTLFileLoader",(function(){return n})),r.d(t,"OBJFileLoader",(function(){return o}));var i=r(0),n=function(){function e(){this.materials=[]}return e.prototype.parseMTL=function(t,r,n,o){if(!(r instanceof ArrayBuffer)){for(var s,a=r.split("\n"),l=/\s+/,h=null,u=0;u<a.length;u++){var c=a[u].trim();if(0!==c.length&&"#"!==c.charAt(0)){var d=c.indexOf(" "),p=d>=0?c.substring(0,d):c;p=p.toLowerCase();var f=d>=0?c.substring(d+1).trim():"";"newmtl"===p?(h&&this.materials.push(h),t._blockEntityCollection=o,h=new i.StandardMaterial(f,t),t._blockEntityCollection=!1):"kd"===p&&h?(s=f.split(l,3).map(parseFloat),h.diffuseColor=i.Color3.FromArray(s)):"ka"===p&&h?(s=f.split(l,3).map(parseFloat),h.ambientColor=i.Color3.FromArray(s)):"ks"===p&&h?(s=f.split(l,3).map(parseFloat),h.specularColor=i.Color3.FromArray(s)):"ke"===p&&h?(s=f.split(l,3).map(parseFloat),h.emissiveColor=i.Color3.FromArray(s)):"ns"===p&&h?h.specularPower=parseFloat(f):"d"===p&&h?h.alpha=parseFloat(f):"map_ka"===p&&h?h.ambientTexture=e._getTexture(n,f,t):"map_kd"===p&&h?h.diffuseTexture=e._getTexture(n,f,t):"map_ks"===p&&h?h.specularTexture=e._getTexture(n,f,t):"map_ns"===p||("map_bump"===p&&h?h.bumpTexture=e._getTexture(n,f,t):"map_d"===p&&h&&(h.opacityTexture=e._getTexture(n,f,t)))}}h&&this.materials.push(h)}},e._getTexture=function(t,r,n){if(!r)return null;var o=t;if("file:"===t){var s=r.lastIndexOf("\\");-1===s&&(s=r.lastIndexOf("/")),o+=s>-1?r.substr(s+1):r}else o+=r;return new i.Texture(o,n,!1,e.INVERT_TEXTURE_Y)},e.INVERT_TEXTURE_Y=!0,e}(),o=function(){function e(t){this.name="obj",this.extensions=".obj",this.obj=/^o/,this.group=/^g/,this.mtllib=/^mtllib /,this.usemtl=/^usemtl /,this.smooth=/^s /,this.vertexPattern=/v(\s+[\d|\.|\+|\-|e|E]+){3,7}/,this.normalPattern=/vn(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,this.uvPattern=/vt(\s+[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,this.facePattern1=/f\s+(([\d]{1,}[\s]?){3,})+/,this.facePattern2=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,this.facePattern3=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,this.facePattern4=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,this.facePattern5=/f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/,this._forAssetContainer=!1,this._meshLoadOptions=t||e.currentMeshLoadOptions}return Object.defineProperty(e,"INVERT_TEXTURE_Y",{get:function(){return n.INVERT_TEXTURE_Y},set:function(e){n.INVERT_TEXTURE_Y=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"currentMeshLoadOptions",{get:function(){return{ComputeNormals:e.COMPUTE_NORMALS,ImportVertexColors:e.IMPORT_VERTEX_COLORS,InvertY:e.INVERT_Y,InvertTextureY:e.INVERT_TEXTURE_Y,UVScaling:e.UV_SCALING,MaterialLoadingFailsSilently:e.MATERIAL_LOADING_FAILS_SILENTLY,OptimizeWithUV:e.OPTIMIZE_WITH_UV,SkipMaterials:e.SKIP_MATERIALS}},enumerable:!1,configurable:!0}),e.prototype._loadMTL=function(e,t,r,n){var o=i.Tools.BaseUrl+t+e;i.Tools.LoadFile(o,r,void 0,void 0,!1,(function(e,t){n(o,t)}))},e.prototype.createPlugin=function(){return new e(e.currentMeshLoadOptions)},e.prototype.canDirectLoad=function(e){return!1},e.prototype.importMeshAsync=function(e,t,r,i,n,o){return this._parseSolid(e,t,r,i).then((function(e){return{meshes:e,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}}))},e.prototype.loadAsync=function(e,t,r,i,n){return this.importMeshAsync(null,e,t,r,i).then((function(){}))},e.prototype.loadAssetContainerAsync=function(e,t,r,n,o){var s=this;return this._forAssetContainer=!0,this.importMeshAsync(null,e,t,r).then((function(t){var r=new i.AssetContainer(e);return t.meshes.forEach((function(e){return r.meshes.push(e)})),t.meshes.forEach((function(e){var t=e.material;t&&-1==r.materials.indexOf(t)&&(r.materials.push(t),t.getActiveTextures().forEach((function(e){-1==r.textures.indexOf(e)&&r.textures.push(e)})))})),s._forAssetContainer=!1,r})).catch((function(e){throw s._forAssetContainer=!1,e}))},e.prototype._parseSolid=function(t,r,o,s){for(var a,l=this,h=[],u=[],c=[],d=[],p=[],f=[],_=[],g=[],m=[],b=[],y=[],v=0,T=!1,O=[],E=[],A=[],C=[],M=[],x="",w="",S=new n,R=1,P=!0,I=new i.Color4(.5,.5,.5,1),L=function(e,t,r,i,n,o,s){var a;-1===(a=l._meshLoadOptions.OptimizeWithUV?function(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[],uv:[]});var r=e[t[0]].normals.indexOf(t[1]);return 1!=r&&t[2]===e[t[0]].uv[r]?e[t[0]].idx[r]:-1}(y,[e,r,t]):function(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[]});var r=e[t[0]].normals.indexOf(t[1]);return-1===r?-1:e[t[0]].idx[r]}(y,[e,r]))?(f.push(_.length),_.push(i),g.push(n),b.push(o),void 0!==s&&m.push(s),y[e].normals.push(r),y[e].idx.push(v++),l._meshLoadOptions.OptimizeWithUV&&y[e].uv.push(t)):f.push(a)},N=function(){for(var e=0;e<_.length;e++)O.push(_[e].x,_[e].y,_[e].z),A.push(b[e].x,b[e].y,b[e].z),C.push(g[e].x,g[e].y),!0===l._meshLoadOptions.ImportVertexColors&&E.push(m[e].r,m[e].g,m[e].b,m[e].a);_=[],b=[],g=[],m=[],y=[],v=0},k=function(e,t){for(var r=t;r<e.length-1;r++)M.push(e[0],e[r],e[r+1])},D=function(e,t){k(e,t);for(var r=0;r<M.length;r++){var n=parseInt(M[r])-1;L(n,0,0,h[n],i.Vector2.Zero(),i.Vector3.Up(),!0===l._meshLoadOptions.ImportVertexColors?d[n]:void 0)}M=[]},B=function(e,t){k(e,t);for(var r=0;r<M.length;r++){var n=M[r].split("/"),o=parseInt(n[0])-1,s=parseInt(n[1])-1;L(o,s,0,h[o],c[s],i.Vector3.Up(),!0===l._meshLoadOptions.ImportVertexColors?d[o]:void 0)}M=[]},F=function(e,t){k(e,t);for(var r=0;r<M.length;r++){var i=M[r].split("/"),n=parseInt(i[0])-1,o=parseInt(i[1])-1,s=parseInt(i[2])-1;L(n,o,s,h[n],c[o],u[s])}M=[]},V=function(e,t){k(e,t);for(var r=0;r<M.length;r++){var n=M[r].split("//"),o=parseInt(n[0])-1,s=parseInt(n[1])-1;L(o,1,s,h[o],i.Vector2.Zero(),u[s],!0===l._meshLoadOptions.ImportVertexColors?d[o]:void 0)}M=[]},H=function(e,t){k(e,t);for(var r=0;r<M.length;r++){var i=M[r].split("/"),n=h.length+parseInt(i[0]),o=c.length+parseInt(i[1]),s=u.length+parseInt(i[2]);L(n,o,s,h[n],c[o],u[s],!0===l._meshLoadOptions.ImportVertexColors?d[n]:void 0)}M=[]},j=function(){p.length>0&&(a=p[p.length-1],N(),f.reverse(),a.indices=f.slice(),a.positions=O.slice(),a.normals=A.slice(),a.uvs=C.slice(),!0===l._meshLoadOptions.ImportVertexColors&&(a.colors=E.slice()),f=[],O=[],E=[],A=[],C=[])},U=o.split("\n"),G=0;G<U.length;G++){var W,z=U[G].trim().replace(/\s\s/g," ");if(0!==z.length&&"#"!==z.charAt(0))if(this.vertexPattern.test(z))W=z.match(/[^ ]+/g),h.push(new i.Vector3(parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3]))),!0===this._meshLoadOptions.ImportVertexColors&&(W.length>=7?d.push(new i.Color4(parseFloat(W[4]),parseFloat(W[5]),parseFloat(W[6]),7===W.length||void 0===W[7]?1:parseFloat(W[7]))):d.push(I));else if(null!==(W=this.normalPattern.exec(z)))u.push(new i.Vector3(parseFloat(W[1]),parseFloat(W[2]),parseFloat(W[3])));else if(null!==(W=this.uvPattern.exec(z)))c.push(new i.Vector2(parseFloat(W[1])*e.UV_SCALING.x,parseFloat(W[2])*e.UV_SCALING.y));else if(null!==(W=this.facePattern3.exec(z)))F(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern4.exec(z)))V(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern5.exec(z)))H(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern2.exec(z)))B(W[1].trim().split(" "),1);else if(null!==(W=this.facePattern1.exec(z)))D(W[1].trim().split(" "),1);else if(this.group.test(z)||this.obj.test(z)){var X={name:z.substring(2).trim(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:""};j(),p.push(X),T=!0,P=!0,R=1}else this.usemtl.test(z)?(x=z.substring(7).trim(),P&&T||(j(),X={name:"mesh_mm"+R.toString(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:x},R++,p.push(X),T=!0),T&&P&&(p[p.length-1].materialName=x,P=!1)):this.mtllib.test(z)?w=z.substring(7).trim():this.smooth.test(z)||console.log("Unhandled expression at line : "+z)}T&&(a=p[p.length-1],f.reverse(),N(),a.indices=f,a.positions=O,a.normals=A,a.uvs=C,!0===this._meshLoadOptions.ImportVertexColors&&(a.colors=E)),T||(f.reverse(),N(),p.push({name:i.Geometry.RandomId(),indices:f,positions:O,colors:E,normals:A,uvs:C,materialName:x}));for(var Y=[],K=new Array,$=0;$<p.length;$++){if(t&&p[$].name)if(t instanceof Array){if(-1===t.indexOf(p[$].name))continue}else if(p[$].name!==t)continue;a=p[$],r._blockEntityCollection=this._forAssetContainer;var q=new i.Mesh(p[$].name,r);r._blockEntityCollection=!1,K.push(p[$].materialName);var Z=new i.VertexData;if(Z.uvs=a.uvs,Z.indices=a.indices,Z.positions=a.positions,!0===this._meshLoadOptions.ComputeNormals){var J=new Array;i.VertexData.ComputeNormals(a.positions,a.indices,J),Z.normals=J}else Z.normals=a.normals;!0===this._meshLoadOptions.ImportVertexColors&&(Z.colors=a.colors),Z.applyToMesh(q),this._meshLoadOptions.InvertY&&(q.scaling.y*=-1),Y.push(q)}var Q=[];return""!==w&&!1===this._meshLoadOptions.SkipMaterials&&Q.push(new Promise((function(e,t){l._loadMTL(w,s,(function(n){try{S.parseMTL(r,n,s,l._forAssetContainer);for(var o=0;o<S.materials.length;o++){for(var a,h=0,u=[];(a=K.indexOf(S.materials[o].name,h))>-1;)u.push(a),h=a+1;if(-1===a&&0===u.length)S.materials[o].dispose();else for(var c=0;c<u.length;c++)Y[u[c]].material=S.materials[o]}e()}catch(r){i.Tools.Warn("Error processing MTL file: '"+w+"'"),l._meshLoadOptions.MaterialLoadingFailsSilently?e():t(r)}}),(function(r,n){i.Tools.Warn("Error downloading MTL file: '"+w+"'"),l._meshLoadOptions.MaterialLoadingFailsSilently?e():t(n)}))}))),Promise.all(Q).then((function(){return Y}))},e.OPTIMIZE_WITH_UV=!0,e.INVERT_Y=!1,e.IMPORT_VERTEX_COLORS=!1,e.COMPUTE_NORMALS=!1,e.UV_SCALING=new i.Vector2(1,1),e.SKIP_MATERIALS=!1,e.MATERIAL_LOADING_FAILS_SILENTLY=!0,e}();i.SceneLoader&&i.SceneLoader.RegisterPlugin(new o)},function(e,t,r){"use strict";r.r(t),r.d(t,"STLFileLoader",(function(){return n}));var i=r(0),n=function(){function e(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}return e.prototype.importMesh=function(e,t,r,n,o,s,a){var l;if("string"!=typeof r){if(this._isBinary(r)){var h=new i.Mesh("stlmesh",t);return this._parseBinary(h,r),o&&o.push(h),!0}for(var u=new Uint8Array(r),c="",d=0;d<r.byteLength;d++)c+=String.fromCharCode(u[d]);r=c}for(;l=this.solidPattern.exec(r);){var p=l[1];if(p!=l[3])return i.Tools.Error("Error in STL, solid name != endsolid name"),!1;if(e&&p)if(e instanceof Array){if(!e.indexOf(p))continue}else if(p!==e)continue;p=p||"stlmesh",h=new i.Mesh(p,t),this._parseASCII(h,l[2]),o&&o.push(h)}return!0},e.prototype.load=function(e,t,r){return this.importMesh(null,e,t,r,null,null,null)},e.prototype.loadAssetContainer=function(e,t,r,n){var o=new i.AssetContainer(e);return e._blockEntityCollection=!0,this.importMesh(null,e,t,r,o.meshes,null,null),e._blockEntityCollection=!1,o},e.prototype._isBinary=function(e){var t;if(84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var r=t.byteLength,i=0;i<r;i++)if(t.getUint8(i)>127)return!0;return!1},e.prototype._parseBinary=function(e,t){for(var r=new DataView(t),n=r.getUint32(80,!0),o=0,s=new Float32Array(3*n*3),a=new Float32Array(3*n*3),l=new Uint32Array(3*n),h=0,u=0;u<n;u++){for(var c=84+50*u,d=r.getFloat32(c,!0),p=r.getFloat32(c+4,!0),f=r.getFloat32(c+8,!0),_=1;_<=3;_++){var g=c+12*_;s[o]=r.getFloat32(g,!0),s[o+2]=r.getFloat32(g+4,!0),s[o+1]=r.getFloat32(g+8,!0),a[o]=d,a[o+2]=p,a[o+1]=f,o+=3}l[h]=h++,l[h]=h++,l[h]=h++}e.setVerticesData(i.VertexBuffer.PositionKind,s),e.setVerticesData(i.VertexBuffer.NormalKind,a),e.setIndices(l),e.computeWorldMatrix(!0)},e.prototype._parseASCII=function(e,t){for(var r,n=[],o=[],s=[],a=0;r=this.facetsPattern.exec(t);){var l=r[1],h=this.normalPattern.exec(l);if(this.normalPattern.lastIndex=0,h){for(var u,c=[Number(h[1]),Number(h[5]),Number(h[3])];u=this.vertexPattern.exec(l);)n.push(Number(u[1]),Number(u[5]),Number(u[3])),o.push(c[0],c[1],c[2]);s.push(a++,a++,a++),this.vertexPattern.lastIndex=0}}this.facetsPattern.lastIndex=0,e.setVerticesData(i.VertexBuffer.PositionKind,n),e.setVerticesData(i.VertexBuffer.NormalKind,o),e.setIndices(s),e.computeWorldMatrix(!0)},e}();i.SceneLoader&&i.SceneLoader.RegisterPlugin(new n)},function(e,t,r){"use strict";(function(e){var i=r(2),n=r(3);r.d(t,"a",(function(){return i.GLTFFileLoader})),r.d(t,"b",(function(){return i.GLTFLoaderAnimationStartMode})),r.d(t,"c",(function(){return i.GLTFLoaderCoordinateSystemMode})),r.d(t,"d",(function(){return i.GLTFLoaderState})),r.d(t,"e",(function(){return n.GLTFValidation}));var o=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==o){for(var s in o.BABYLON=o.BABYLON||{},i)o.BABYLON[s]=i[s];for(var s in n)o.BABYLON[s]=n[s]}}).call(this,r(5))},function(e,t,r){"use strict";(function(e){var i=r(8);r.d(t,"a",(function(){return i}));var n=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in n.BABYLON=n.BABYLON||{},n.BABYLON.GLTF1=n.BABYLON.GLTF1||{},i)n.BABYLON.GLTF1[o]=i[o]}).call(this,r(5))},function(e,t,r){"use strict";(function(e){var i=r(7),n=r(6),o=r(9);r.d(t,"a",(function(){return o}));var s=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==s){s.BABYLON=s.BABYLON||{};var a=s.BABYLON;a.GLTF2=a.GLTF2||{},a.GLTF2.Loader=a.GLTF2.Loader||{},a.GLTF2.Loader.Extensions=a.GLTF2.Loader.Extensions||{};var l=[];for(var h in i)a.GLTF2.Loader.Extensions[h]=i[h],l.push(h);for(var h in n)a.GLTF2.Loader[h]=n[h],l.push(h);for(var h in o)l.indexOf(h)>-1||(a.GLTF2[h]=o[h])}}).call(this,r(5))},function(e,t,r){"use strict";r.r(t),function(e){var i=r(10);r.d(t,"MTLFileLoader",(function(){return i.MTLFileLoader})),r.d(t,"OBJFileLoader",(function(){return i.OBJFileLoader}));var n=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in i)n.BABYLON[o]=i[o]}.call(this,r(5))},function(e,t,r){"use strict";r.r(t),function(e){var i=r(11);r.d(t,"STLFileLoader",(function(){return i.STLFileLoader}));var n=void 0!==e?e:"undefined"!=typeof window?window:void 0;if(void 0!==n)for(var o in i)n.BABYLON[o]=i[o]}.call(this,r(5))},,,,function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFLoaderCoordinateSystemMode",(function(){return i.c})),r.d(t,"GLTFLoaderAnimationStartMode",(function(){return i.b})),r.d(t,"GLTFLoaderState",(function(){return i.d})),r.d(t,"GLTFFileLoader",(function(){return i.a})),r.d(t,"GLTFValidation",(function(){return i.e})),r.d(t,"GLTF1",(function(){return n.a})),r.d(t,"GLTF2",(function(){return o.a})),r.d(t,"MTLFileLoader",(function(){return s.MTLFileLoader})),r.d(t,"OBJFileLoader",(function(){return s.OBJFileLoader})),r.d(t,"STLFileLoader",(function(){return a.STLFileLoader})),r(2),r(3),r(8),r(9),r(10),r(11);var i=r(12),n=r(13),o=r(14),s=r(15),a=r(16)}])}))}).call(this,r("c8ba"))},b848:function(e,t,r){"use strict";var i=r("58df");function n(e){const t=[];for(let r=0;r<e.length;r++){const i=e[r];i.isActive&&i.isDependent?t.push(i):t.push(...n(i.$children))}return t}t["a"]=Object(i["a"])().extend({name:"dependent",data(){return{closeDependents:!0,isActive:!1,isDependent:!0}},watch:{isActive(e){if(e)return;const t=this.getOpenDependents();for(let r=0;r<t.length;r++)t[r].isActive=!1}},methods:{getOpenDependents(){return this.closeDependents?n(this.$children):[]},getOpenDependentElements(){const e=[],t=this.getOpenDependents();for(let r=0;r<t.length;r++)e.push(...t[r].getClickableDependentElements());return e},getClickableDependentElements(){const e=[this.$el];return this.$refs.content&&e.push(this.$refs.content),this.overlay&&e.push(this.overlay.$el),e.push(...this.getOpenDependentElements()),e}}})},ba87:function(e,t,r){"use strict";r("1b2c");var i=r("a9ad"),n=r("7560"),o=r("58df"),s=r("80d2"),a=Object(o["a"])(n["a"]).extend({name:"v-label",functional:!0,props:{absolute:Boolean,color:{type:String,default:"primary"},disabled:Boolean,focused:Boolean,for:String,left:{type:[Number,String],default:0},right:{type:[Number,String],default:"auto"},value:Boolean},render(e,t){const{children:r,listeners:o,props:a}=t,l={staticClass:"v-label",class:{"v-label--active":a.value,"v-label--is-disabled":a.disabled,...Object(n["b"])(t)},attrs:{for:a.for,"aria-hidden":!a.for},on:o,style:{left:Object(s["h"])(a.left),right:Object(s["h"])(a.right),position:a.absolute?"absolute":"relative"},ref:"label"};return e("label",i["a"].options.methods.setTextColor(a.focused&&a.color,l),r)}});t["a"]=a},c37a:function(e,t,r){"use strict";r("d191");var i=r("9d26"),n=r("ba87"),o=(r("8ff2"),r("a9ad")),s=r("7560"),a=r("58df"),l=r("80d2"),h=Object(a["a"])(o["a"],s["a"]).extend({name:"v-messages",props:{value:{type:Array,default:()=>[]}},methods:{genChildren(){return this.$createElement("transition-group",{staticClass:"v-messages__wrapper",attrs:{name:"message-transition",tag:"div"}},this.value.map(this.genMessage))},genMessage(e,t){return this.$createElement("div",{staticClass:"v-messages__message",key:t},Object(l["r"])(this,"default",{message:e,key:t})||[e])}},render(e){return e("div",this.setTextColor(this.color,{staticClass:"v-messages",class:this.themeClasses}),[this.genChildren()])}}),u=h,c=r("7e2b"),d=r("38cb"),p=r("d9f7");const f=Object(a["a"])(c["a"],d["a"]);var _=f.extend().extend({name:"v-input",inheritAttrs:!1,props:{appendIcon:String,backgroundColor:{type:String,default:""},dense:Boolean,height:[Number,String],hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,id:String,label:String,loading:Boolean,persistentHint:Boolean,prependIcon:String,value:null},data(){return{lazyValue:this.value,hasMouseDown:!1}},computed:{classes(){return{"v-input--has-state":this.hasState,"v-input--hide-details":!this.showDetails,"v-input--is-label-active":this.isLabelActive,"v-input--is-dirty":this.isDirty,"v-input--is-disabled":this.isDisabled,"v-input--is-focused":this.isFocused,"v-input--is-loading":!1!==this.loading&&null!=this.loading,"v-input--is-readonly":this.isReadonly,"v-input--dense":this.dense,"v-input--hide-spin-buttons":this.hideSpinButtons,...this.themeClasses}},computedId(){return this.id||"input-"+this._uid},hasDetails(){return this.messagesToDisplay.length>0},hasHint(){return!this.hasMessages&&!!this.hint&&(this.persistentHint||this.isFocused)},hasLabel(){return!(!this.$slots.label&&!this.label)},internalValue:{get(){return this.lazyValue},set(e){this.lazyValue=e,this.$emit(this.$_modelEvent,e)}},isDirty(){return!!this.lazyValue},isLabelActive(){return this.isDirty},messagesToDisplay(){return this.hasHint?[this.hint]:this.hasMessages?this.validations.map(e=>{if("string"===typeof e)return e;const t=e(this.internalValue);return"string"===typeof t?t:""}).filter(e=>""!==e):[]},showDetails(){return!1===this.hideDetails||"auto"===this.hideDetails&&this.hasDetails}},watch:{value(e){this.lazyValue=e}},beforeCreate(){this.$_modelEvent=this.$options.model&&this.$options.model.event||"input"},methods:{genContent(){return[this.genPrependSlot(),this.genControl(),this.genAppendSlot()]},genControl(){return this.$createElement("div",{staticClass:"v-input__control",attrs:{title:this.attrs$.title}},[this.genInputSlot(),this.genMessages()])},genDefaultSlot(){return[this.genLabel(),this.$slots.default]},genIcon(e,t,r={}){const n=this[e+"Icon"],o="click:"+Object(l["v"])(e),s=!(!this.listeners$[o]&&!t),a=Object(p["a"])({attrs:{"aria-label":s?Object(l["v"])(e).split("-")[0]+" icon":void 0,color:this.validationState,dark:this.dark,disabled:this.isDisabled,light:this.light,tabindex:"clear"===e?-1:void 0},on:s?{click:e=>{e.preventDefault(),e.stopPropagation(),this.$emit(o,e),t&&t(e)},mouseup:e=>{e.preventDefault(),e.stopPropagation()}}:void 0},r);return this.$createElement("div",{staticClass:"v-input__icon",class:e?"v-input__icon--"+Object(l["v"])(e):void 0},[this.$createElement(i["a"],a,n)])},genInputSlot(){return this.$createElement("div",this.setBackgroundColor(this.backgroundColor,{staticClass:"v-input__slot",style:{height:Object(l["h"])(this.height)},on:{click:this.onClick,mousedown:this.onMouseDown,mouseup:this.onMouseUp},ref:"input-slot"}),[this.genDefaultSlot()])},genLabel(){return this.hasLabel?this.$createElement(n["a"],{props:{color:this.validationState,dark:this.dark,disabled:this.isDisabled,focused:this.hasState,for:this.computedId,light:this.light}},this.$slots.label||this.label):null},genMessages(){return this.showDetails?this.$createElement(u,{props:{color:this.hasHint?"":this.validationState,dark:this.dark,light:this.light,value:this.messagesToDisplay},attrs:{role:this.hasMessages?"alert":null},scopedSlots:{default:e=>Object(l["r"])(this,"message",e)}}):null},genSlot(e,t,r){if(!r.length)return null;const i=`${e}-${t}`;return this.$createElement("div",{staticClass:"v-input__"+i,ref:i},r)},genPrependSlot(){const e=[];return this.$slots.prepend?e.push(this.$slots.prepend):this.prependIcon&&e.push(this.genIcon("prepend")),this.genSlot("prepend","outer",e)},genAppendSlot(){const e=[];return this.$slots.append?e.push(this.$slots.append):this.appendIcon&&e.push(this.genIcon("append")),this.genSlot("append","outer",e)},onClick(e){this.$emit("click",e)},onMouseDown(e){this.hasMouseDown=!0,this.$emit("mousedown",e)},onMouseUp(e){this.hasMouseDown=!1,this.$emit("mouseup",e)}},render(e){return e("div",this.setTextColor(this.validationState,{staticClass:"v-input",class:this.classes}),this.genContent())}});t["a"]=_},c70c:function(e,t,r){"use strict";r("ee9d")},d191:function(e,t,r){},d9f7:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l}));var i=r("80d2");const n={styleList:/;(?![^(]*\))/g,styleProp:/:(.*)/};function o(e){const t={};for(const r of e.split(n.styleList)){let[e,o]=r.split(n.styleProp);e=e.trim(),e&&("string"===typeof o&&(o=o.trim()),t[Object(i["c"])(e)]=o)}return t}function s(){const e={};let t,r=arguments.length;while(r--)for(t of Object.keys(arguments[r]))switch(t){case"class":case"directives":arguments[r][t]&&(e[t]=l(e[t],arguments[r][t]));break;case"style":arguments[r][t]&&(e[t]=a(e[t],arguments[r][t]));break;case"staticClass":if(!arguments[r][t])break;void 0===e[t]&&(e[t]=""),e[t]&&(e[t]+=" "),e[t]+=arguments[r][t].trim();break;case"on":case"nativeOn":arguments[r][t]&&(e[t]=h(e[t],arguments[r][t]));break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":if(!arguments[r][t])break;e[t]||(e[t]={}),e[t]={...arguments[r][t],...e[t]};break;default:e[t]||(e[t]=arguments[r][t])}return e}function a(e,t){return e?t?(e=Object(i["E"])("string"===typeof e?o(e):e),e.concat("string"===typeof t?o(t):t)):e:t}function l(e,t){return t?e&&e?Object(i["E"])(e).concat(t):t:e}function h(...e){if(!e[0])return e[1];if(!e[1])return e[0];const t={};for(let r=2;r--;){const i=e[r];for(const e in i)i[e]&&(t[e]?t[e]=[].concat(i[e],t[e]):t[e]=i[e])}return t}},dc22:function(e,t,r){"use strict";function i(e,t,r){const i=t.value,n=t.options||{passive:!0};window.addEventListener("resize",i,n),e._onResize=Object(e._onResize),e._onResize[r.context._uid]={callback:i,options:n},t.modifiers&&t.modifiers.quiet||i()}function n(e,t,r){var i;if(!(null===(i=e._onResize)||void 0===i?void 0:i[r.context._uid]))return;const{callback:n,options:o}=e._onResize[r.context._uid];window.removeEventListener("resize",n,o),delete e._onResize[r.context._uid]}const o={inserted:i,unbind:n};t["a"]=o},dd89:function(e,t,r){"use strict";function i(e){if("function"!==typeof e.getRootNode){while(e.parentNode)e=e.parentNode;return e!==document?null:document}const t=e.getRootNode();return t!==document&&t.getRootNode({composed:!0})!==document?null:t}r.d(t,"a",(function(){return i}))},e07a:function(e,t,r){"use strict";var i=r("6821"),n=r.n(i),o=!1,s={radToDeg(e){var t=Math.PI;return e*(180/t)},degToRad(e){var t=Math.PI;return e*(t/180)},getMeshSize(e){const t=e.getHierarchyBoundingVectors(),r={x:t.max.x-t.min.x,y:t.max.y-t.min.y,z:t.max.z-t.min.z};return r},getMeshFromMeshs(e,t){var r=null;return e.forEach((e,i)=>{e.name==t&&(r=e)}),r},getChildMeshFromMeshs(e,t){var r=null;return e._children.forEach((e,i)=>{e.name==t&&(console.log("find child mesh"),r=e)}),r},debugLog(...e){o&&console.log(...e)},createProjectId(){return n()(new Date)},getProjectById(e){var t=this.getLocalProjects();for(const r of t)if(r.id==e)return r;return null},deleteProjectById(e){var t=this.getLocalProjects(),r=0,i=!1;for(const n of t){if(n.id==e){t.splice(r,1),i=!0;break}r++}return!!i&&(window.localStorage.setItem("MyProjects",JSON.stringify(t)),t)},copyProjectById(e){var t=this.getLocalProjects(),r=!1,i=this.createProjectId();for(const o of t)if(o.id==e){var n=JSON.parse(JSON.stringify(o));n.name=n.name+"(复制)",n.id=i,t.push(n),r=!0;break}return!!r&&(window.localStorage.setItem(i,window.localStorage.getItem(e)),window.localStorage.setItem("MyProjects",JSON.stringify(t)),t)},renameProjectById(e,t){var r=this.getLocalProjects(),i=!1;for(const n of r)if(n.id==e){n.name=t,i=!0;break}return!!i&&(window.localStorage.setItem("MyProjects",JSON.stringify(r)),r)},getLocalProjects(){var e=window.localStorage.getItem("MyProjects");return e=null==e?[]:JSON.parse(e),e}};t["a"]=s,Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e}},e4d3:function(e,t,r){"use strict";var i=r("2b0e");t["a"]=i["a"].extend({name:"returnable",props:{returnValue:null},data:()=>({isActive:!1,originalValue:null}),watch:{isActive(e){e?this.originalValue=this.returnValue:this.$emit("update:return-value",this.originalValue)}},methods:{save(e){this.originalValue=e,setTimeout(()=>{this.isActive=!1})}}})},e707:function(e,t,r){"use strict";r("3c93");var i=r("a9ad"),n=r("7560"),o=r("f2e7"),s=r("58df"),a=Object(s["a"])(i["a"],n["a"],o["a"]).extend({name:"v-overlay",props:{absolute:Boolean,color:{type:String,default:"#212121"},dark:{type:Boolean,default:!0},opacity:{type:[Number,String],default:.46},value:{default:!0},zIndex:{type:[Number,String],default:5}},computed:{__scrim(){const e=this.setBackgroundColor(this.color,{staticClass:"v-overlay__scrim",style:{opacity:this.computedOpacity}});return this.$createElement("div",e)},classes(){return{"v-overlay--absolute":this.absolute,"v-overlay--active":this.isActive,...this.themeClasses}},computedOpacity(){return Number(this.isActive?this.opacity:0)},styles(){return{zIndex:this.zIndex}}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-overlay__content"},this.$slots.default)}},render(e){const t=[this.__scrim];return this.isActive&&t.push(this.genContent()),e("div",{staticClass:"v-overlay",on:this.$listeners,class:this.classes,style:this.styles},t)}}),l=a,h=r("80d2"),u=r("2b0e");t["a"]=u["a"].extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(e){this.isActive&&(e?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const e=new l({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});e.$mount();const t=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");t&&t.insertBefore(e.$el,t.firstChild),this.overlay=e},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame(()=>{this.overlay&&(void 0!==this.activeZIndex?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=Object(h["t"])(this.$el)),this.overlay.value=!0)}),!0},removeOverlay(e=!0){this.overlay&&(Object(h["a"])(this.overlay.$el,"transitionend",()=>{this.overlay&&this.overlay.$el&&this.overlay.$el.parentNode&&!this.overlay.value&&!this.isActive&&(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)}),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),e&&this.showScroll()},scrollListener(e){if("key"in e){if(["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)||e.target.isContentEditable)return;const t=[h["w"].up,h["w"].pageup],r=[h["w"].down,h["w"].pagedown];if(t.includes(e.keyCode))e.deltaY=-1;else{if(!r.includes(e.keyCode))return;e.deltaY=1}}(e.target===this.overlay||"keydown"!==e.type&&e.target===document.body||this.checkPath(e))&&e.preventDefault()},hasScrollbar(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return(["auto","scroll"].includes(t.overflowY)||"SELECT"===e.tagName)&&e.scrollHeight>e.clientHeight||["auto","scroll"].includes(t.overflowX)&&e.scrollWidth>e.clientWidth},shouldScroll(e,t){if(e.hasAttribute("data-app"))return!1;const r=t.shiftKey||t.deltaX?"x":"y",i="y"===r?t.deltaY:t.deltaX||t.deltaY;let n,o;"y"===r?(n=0===e.scrollTop,o=e.scrollTop+e.clientHeight===e.scrollHeight):(n=0===e.scrollLeft,o=e.scrollLeft+e.clientWidth===e.scrollWidth);const s=i<0,a=i>0;return!(n||!s)||(!(o||!a)||!(!n&&!o)&&this.shouldScroll(e.parentNode,t))},isInside(e,t){return e===t||null!==e&&e!==document.body&&this.isInside(e.parentNode,t)},checkPath(e){const t=Object(h["g"])(e);if("keydown"===e.type&&t[0]===document.body){const t=this.$refs.dialog,r=window.getSelection().anchorNode;return!(t&&this.hasScrollbar(t)&&this.isInside(r,t))||!this.shouldScroll(t,e)}for(let r=0;r<t.length;r++){const i=t[r];if(i===document)return!0;if(i===document.documentElement)return!0;if(i===this.$refs.content)return!0;if(this.hasScrollbar(i))return!this.shouldScroll(i,e)}return!0},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):(Object(h["b"])(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}})},e9b1:function(e,t,r){},ee9d:function(e,t,r){},f289:function(e,t,r){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{ref:"blocklyDiv",staticClass:"blocklyDiv"}),t("xml",{ref:"blocklyToolbox",staticStyle:{display:"none"}},[e._t("default")],2)],1)},n=[],o=r("54ca"),s=r.n(o),a=r("7724"),l=r.n(a),h=r("b7fd"),u=r.n(h);const c={};class d extends u.a.MetricsManager{constructor(e){super(e)}static setFixedEdges(e){c.top=!!e.top,c.bottom=!!e.bottom,c.left=!!e.left,c.right=!!e.right}hasFixedEdges(){return!0}getComputedFixedEdges_(e){const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically(),i=e||this.getViewMetrics(!1),n={top:c.top?0:void 0,bottom:c.bottom?0:void 0,left:c.left?0:void 0,right:c.right?0:void 0};return c.top&&c.bottom&&(n.bottom=i.height),c.left&&c.right&&(n.right=i.width),r||(void 0!==n.top?n.bottom=n.top+i.height:void 0!==n.bottom?n.top=n.bottom-i.height:(n.top=i.top,n.bottom=i.top+i.height)),t||(void 0!==n.left?n.right=n.left+i.width:void 0!==n.right?n.left=n.right-i.width:(n.left=i.left,n.right=i.left+i.width)),n}}var p=r("e07a"),f=r("560a");s.a.setLocale(f);var _={name:"BlocklyComponent",props:["robotController","projectId"],data(){return{robotCtr:null,workspace:null,isStop:!0,runNext:0,options:{media:"media/",zoom:{controls:!0,wheel:!1,startScale:1,maxScale:3,minScale:.8,scaleSpeed:1.2},trashcan:!1,scrollbars:!0,theme:"deuteranopia",renderer:"zelos",move:{scrollbars:{horizontal:!0,vertical:!0},drag:!0,wheel:!0},oneBasedIndex:!0,horizontalLayout:!0,toolboxPosition:"end",grid:{spacing:100,length:3,colour:"#ccc",snap:!0},toolbox:{kind:"flyoutToolbox",contents:[{kind:"block",type:"while_program_start"},{kind:"block",type:"move"},{kind:"block",type:"turn"},{kind:"block",type:"arc"},{kind:"block",type:"draw"},{kind:"block",type:"pencilcolor"},{kind:"block",type:"controls_repeat_ext"},{kind:"block",type:"controls_whileUntil"},{kind:"block",type:"controls_for"},{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_negate"},{kind:"block",type:"logic_boolean"},{kind:"sep",gap:"32"},{kind:"block",blockxml:"<block type='math_number'><field name='NUM'>10</field></block>"},{kind:"block",type:"math_arithmetic"},{kind:"block",type:"math_single"},{kind:"block",type:"text"},{kind:"block",type:"text_length"},{kind:"block",type:"text_print"},{kind:"block",type:"variables_get"},{kind:"block",type:"variables_set"}]}}}},methods:{runCodeClick(){console.log("runCodeClick"),this.isStop?window.step_btn():console.log("程序还没运行完，别急")},stopCodeClick(){console.log("stopCodeClick"),window.stop_btn()}},watch:{robotController(){this.robotCtr=this.$props.robotController},runNext(){this.runNext&&!this.isStop&&window.step_btn()}},mounted(){var e=this.options;e.toolbox||(e.toolbox=this.$refs["blocklyToolbox"]),this.robotCtr=this.$props.robotController,d.setFixedEdges({top:!0,left:!0}),e["plugins"]={metricsManager:d},this.workspace=s.a.inject(this.$refs["blocklyDiv"],e);var t=this;function r(e){e instanceof s.a.Events.Ui||c()}this.workspace.addChangeListener(r);var i=null;function n(e,r){var i=function(e){return t.isStop=!1,e=String(e||""),h(e)};e.setProperty(r,"highlightBlock",e.createNativeFunction(i));var n=e.nativeToPseudo({});e.setProperty(r,"robot",n);var s=function(){return t.isStop=!1,t.runNext+=1,o=!0,t.robotCtr.init()};e.setProperty(n,"init",e.createNativeFunction(s));var a=function(){return t.isStop=!0,o=!1,t.robotCtr.stop()};e.setProperty(n,"stop",e.createNativeFunction(a));var l=function(e){o=!0,t.robotCtr.moveBlockly(e,(function(e){p["a"].debugLog("result",e),o=!1,t.runNext+=1}))};e.setProperty(n,"move",e.createNativeFunction(l));var u=function(e,r){o=!0,t.robotCtr.turnBlockly(e,r,(function(e){p["a"].debugLog("result",e),o=!1,t.runNext+=1}))};e.setProperty(n,"turn",e.createNativeFunction(u));var c=function(e,r,i){o=!0,t.robotCtr.arcBlockly(e,r,i,(function(e){p["a"].debugLog("result",e),o=!1,t.runNext+=1}))};e.setProperty(n,"arc",e.createNativeFunction(c));var d=function(e){o=!0,t.robotCtr.drawableBlockly(e,(function(e){p["a"].debugLog("result",e),o=!1,t.runNext+=1}))};e.setProperty(n,"drawable",e.createNativeFunction(d))}var o=!1,a="";function h(e){t.workspace.highlightBlock(e),o=!1}function u(e){t.workspace.highlightBlock(null),o=!1,e&&p["a"].debugLog("clearOutput")}function c(){p["a"].debugLog("generateCodeAndLoadIntoInterpreter"),s.a.JavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n",s.a.JavaScript.addReservedWords("highlightBlock"),a=s.a.JavaScript.workspaceToCode(t.workspace),u(!0)}function f(){if(!i)return u(!0),p["a"].debugLog("latestCode",a),i=new l.a(a,n),void setTimeout((function(){o=!0,f()}),1);o=!1;do{try{var e=i.step()}finally{e||(p["a"].debugLog("代码执行完了"),i=null,u(!1))}}while(e&&!o)}function _(){t.isStop=!0,t.robotCtr.stop(),u(!0),o=!0,i=null}window.step_btn=f,window.stop_btn=_}},g=_,m=(r("c70c"),r("2877")),b=Object(m["a"])(g,i,n,!1,null,"1978aa07",null);t["a"]=b.exports},f32a:function(e,t,r){"use strict";var i=r("633b"),n=(r("b234"),r("dd4a")),o=r("6fcd"),s=r("8681"),a=r.n(s),l=r("e07a"),h=r("d722"),u=!1,c=null,d=null,p=null,f=null,_=null,g=null,m=null,b=null,y=null,v=null,T=null,O=null,E=null,A=1;const C=A/10;var M=50;const x=M/10;var w=.5,S=.5,R=.9;const P=9,I=.16,L=P*I,N=.8,k=.5;var D=512;const B=h["a"].simulatorUrl;var F=[];let V=null;var H=!1,j={async init(e,t){return p=e,V=t,this.initEngine(),this.initCamera(),this.initLights(),await this.initAmmo(),this.initGreenGround(),this.initGridPlane(),this.initPencilGround(),this.initSkyBox(),this.initCubes(),this.initButtons(),await this.initRobot(),this.dragListening(),u&&d.debugLayer.show(),d},async initAmmo(){const e=await a()();l["a"].debugLog("Ammo",e),d.enablePhysics(new i["Vector3"](0,-100,0),new i["AmmoJSPlugin"](!0,e)),d.onReadyObservable.add((function(){l["a"].debugLog("getPhysicsEngine",d.getPhysicsEngine()._physicsPlugin.bjsAMMO.btDefaultCollisionConfiguration()),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._collisionConfiguration),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._dispatcher),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin._solver),l["a"].debugLog(d.getPhysicsEngine()._physicsPlugin.world)}))},bindRobotController(e){E=e},cleanDrawLines(){_=null,g=null,m=null,v=null,T=null,O=new i["Vector3"](0,0,0)},async retsetScene(){this.cleanDrawLines(),d.dispose(),this.initEngine(),u&&d.debugLayer.show(),this.initCamera(),this.initLights(),await this.initAmmo(),this.initGreenGround(),this.initGridPlane(),this.initPencilGround(),this.initSkyBox(),this.initCubes(),this.initButtons(),await this.initRobot(T),E.resetScene(d,T,O),E.initRobotPenclDynamicTexture(y),console.log("robotCotroller",E)},createDefaultEngine(){return new i["Engine"](p,!0,{preserveDrawingBuffer:!0,stencil:!0})},async resizeEngine(){await this.retsetScene(),f.resize()},initEngine(){if(f=this.createDefaultEngine(),!f)throw"engine should not be null.";d=new i["Scene"](f),this.customLoadingUI(),f.displayLoadingUI(),f.runRenderLoop((function(){d&&(d.render(),V.innerHTML="("+f.getFps().toFixed()+" fps)")})),window.addEventListener("resize",(function(){f.resize()}))},initCamera(){return _=new i["ArcRotateCamera"]("Camera",0,0,0,new i["Vector3"](0,0,0),d),_.setPosition(new i["Vector3"](-210*C,250*C,200*C)),_.upperBetaLimit=1.5,_.lowerRadiusLimit=20,_.upperRadiusLimit=500,_.wheelPrecision=5,_.pinchPrecision=20,d.activeCamera.panningSensibility=100,_.attachControl(p,!0),_},initLights(){var e=new i["HemisphericLight"]("light1",new i["Vector3"](0,10,0),d);e.specular=new i["Color3"](0,0,0),e.intensity=1},initGreenGround(){const e=100*A*L,t=50*e/2;var r=new i["StandardMaterial"]("texturePlane",d);r.diffuseColor=new i["Color3"](152/255,209/255,115/255),r.backFaceCulling=!1,r.freeze();var n=i["MeshBuilder"].CreateDisc("ground",{radius:t},d);return n.rotation.x=Math.PI/2,n.material=r,n.freezeWorldMatrix(),n.position.y=-.01,n.physicsImpostor=new i["PhysicsImpostor"](n,i["PhysicsImpostor"].BoxImpostor,{mass:0,restitution:k,friction:N},d),g=n,n},initGridPlane(){const e=100*A*L;var t=i["Mesh"].CreateGround("ground",e,e,1,d,!0),r=new n["GridMaterial"]("grid",d);r.freeze(),r.mainColor=i["Color3"].White(),r.alpha=1;const o=.95;r.lineColor=new i["Color3"](o,o,o),r.backFaceCulling=!0,r.majorUnitFrequency=e/P,r.minorUnitVisibility=0;const s=.5*e/P;return r.gridOffset=new i["Vector3"](s,0,s),t.material=r,m=t,t},getRobotPenclDynamicTexture(){return y},initPencilGround(){const e=100*A*L;var t=i["MeshBuilder"].CreateGround("pencilGround",{width:e,height:e,subdivisions:1},d);y=new i["DynamicTexture"]("dynamic texture",D,d);var r=new i["StandardMaterial"]("Mat",d);r.diffuseTexture=y,r.opacityTexture=y,r.specularColor=new i["Color3"](0,0,0),r.backFaceCulling=!1,r.useAlphaFromDiffuseTexture=!0,r.freeze(),t.material=r,t.rotation.y-=Math.PI,t.position.y+=.01,t.freezeWorldMatrix(),t.alphaIndex=0,t.physicsImpostor=new i["PhysicsImpostor"](t,i["PhysicsImpostor"].BoxImpostor,{mass:0,restitution:k,friction:N},d),b=t},initSkyBox(){const e=100*A*L,t=50*e;var r=new n["SkyMaterial"]("skyMaterial",d);r.backFaceCulling=!1,r.inclination=0,r.cameraOffset.y=t/10;var o=i["Mesh"].CreateBox("skyBox",t,d);return o.material=r,v=o,o},createBasicRoundedBox:function(e,t,r){let n=.25,o=.5,s=.5;const a=r,l=3.1*a/2,h=i["MeshBuilder"].CreateSphere("sphere",{diameter:l,segments:16},e),u=i["Mesh"].CreateBox("box",a,e),c=i["CSG"].FromMesh(u).intersect(i["CSG"].FromMesh(h));h.dispose(),u.dispose();const d=c.toMesh(t,new i["StandardMaterial"]("roundedBoxMaterial",e),e);return d.draggable=!0,d.physicsImpostor=new i["PhysicsImpostor"](d,i["PhysicsImpostor"].BoxImpostor,{mass:n,restitution:o,friction:s}),d.material.freeze(),d.material.specularColor=new i["Color3"](0,0,0),d.freezeWorldMatrix(),d},initCubes(){F=new i["TransformNode"]("cubes");const e=80*C;var t=this.createBasicRoundedBox(d,"cube",e);t.position._y+=e/2,t.position._x-=100,t.material=new i["StandardMaterial"]("amaterial",d),t.material.diffuseColor=new i["Color3"](16/255,156/255,73/255),F[0]=t;var r=this.createBasicRoundedBox(d,"cube2",e);r.position._y+=e/2,r.position._x-=100,r.position._z+=2*e,r.material=new i["StandardMaterial"]("amaterial",d),r.material.diffuseColor=new i["Color3"](48/255,.4,150/255),F[1]=r;var n=this.createBasicRoundedBox(d,"cube3",e);n.position._y+=e/2,n.position._x-=100,n.position._z-=2*e,n.material=new i["StandardMaterial"]("amaterial",d),n.material.diffuseColor=new i["Color3"](199/255,88/255,93/255),F[2]=n;let o=new i["ActionManager"](d);t.actionManager=o,r.actionManager=o,n.actionManager=o;var s=new i["HighlightLayer"]("hl1",d);o.registerAction(new i["ExecuteCodeAction"](i["ActionManager"].OnPointerOverTrigger,(function(e){var o=e.meshUnderPointer.id;o==t.name?s.addMesh(t,i["Color3"].White()):o==r.name?s.addMesh(r,i["Color3"].White()):o==n.name&&s.addMesh(n,i["Color3"].White())}))),o.registerAction(new i["ExecuteCodeAction"](i["ActionManager"].OnPointerOutTrigger,(function(e){var i=e.meshUnderPointer.id;i==t.name?s.removeMesh(t):i==r.name?s.removeMesh(r):i==n.name&&s.removeMesh(n)}))),d.freezeMaterials()},initButtons(){console.log("gui",o);var e=o["AdvancedDynamicTexture"].CreateFullscreenUI("UI",!0,d),t=o["Button"].CreateImageOnlyButton("but",B+"restart.png");t.height="60px",t.width="60px",t.thickness=0,t.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_RIGHT,t.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,t.top="-20px",t.left="-20px",t.onPointerClickObservable.add((function(){console.log("重启引擎"),j.resizeEngine()})),c=new o["Rectangle"]("speedSelect"),c.height="110px",c.width="60px",c.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_LEFT,c.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,c.top="-90px",c.left="20px",c.thickness=3,c.color="#505781",c.background="white",c.cornerRadius=15,c.isVisible=!1;var r=o["Button"].CreateImageOnlyButton("slowlyBtn",B+"turtle.png");r.width="30px",r.height="30px",r.thickness=0,r.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_TOP,r.top=15,r.onPointerClickObservable.add((function(){console.log("slowImg click"),a.source=B+"turtle.png",E.setSpeed(1),c.isVisible=!1}));var i=o["Button"].CreateImageOnlyButton("fastBtn",B+"rabbit.png");i.width="30px",i.height="30px",i.thickness=0,i.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,i.top=-15,i.onPointerClickObservable.add((function(){console.log("fastImg click"),a.source=B+"rabbit.png",E.setSpeed(6),c.isVisible=!1})),c.addControl(r),c.addControl(i);var n=new o["Button"]("speedBtn");n.height="60px",n.width="60px",n.horizontalAlignment=o["Control"].HORIZONTAL_ALIGNMENT_LEFT,n.verticalAlignment=o["Control"].VERTICAL_ALIGNMENT_BOTTOM,n.top="-20px",n.left="20px",n.thickness=0,n.onPointerClickObservable.add((function(){c.isVisible=!c.isVisible,c.isVisible&&(H=!0)})),n.isPointerBlocker=!0;var s=new o["Ellipse"];s.width="60px",s.height="60px",s.color="#505781",s.thickness=3,s.background="white";var a=new o["Image"]("currentSpeedBtn",B+"turtle.png");a.width="30px",a.height="30px",a.thickness=0,n.addControl(s),n.addControl(a),e._shouldBlockPointer=!1,e.addControl(t),e.addControl(n),e.addControl(c)},makePhysicsObjects(e,t,r,n){var o=new i["Mesh"]("robot",t);e.forEach(e=>{null==e.parent&&o.addChild(e)}),o.getChildMeshes().forEach(e=>{e.scaling.x=Math.abs(e.scaling.x),e.scaling.y=Math.abs(e.scaling.y),e.scaling.z=Math.abs(e.scaling.z),e.physicsImpostor=new i["PhysicsImpostor"](e,i["PhysicsImpostor"].BoxImpostor,{mass:.1},t)}),o.scaling.scaleInPlace(r),o.physicsImpostor=new i["PhysicsImpostor"](o,i["PhysicsImpostor"].NoImpostor,{mass:w,friction:S,restitution:R},t);const s=-n.y/1.1;return o.physicsImpostor.setDeltaPosition(new i["Vector3"](0,s,0)),o.position.subtractInPlace(new i["Vector3"](0,-s,0)),o},async initRobot(){const e="sportcar.babylon";console.log("api.modelUrl",h["a"].modelUrl);var t=await i["SceneLoader"].ImportMeshAsync(null,h["a"].modelUrl,e,d),r=t.meshes,n=l["a"].getMeshFromMeshs(r,"Glass_Plane.006");console.log("robotBody",n);var o=l["a"].getMeshSize(n);console.log("robotSize",o);var s=new i["Mesh"]("robot",d),a=new i["Mesh"]("pencil"),u=[];u[0]=new i["Vector4"](0,0,0,0),u[1]=new i["Vector4"](1,.2,0,1),u[2]=new i["Vector4"](0,0,.25,1);var c=[];c[0]=new i["Color4"](.5,.5,.5,1),c[2]=new i["Color3"](16/255,156/255,73/255);var p=4*o.y,_=o.y/2,g=.3*o.x,m=i["MeshBuilder"].CreateCylinder("cylinder",{height:p,diameter:g,faceUV:u,faceColors:c,updatable:!0},d);m.position._y=p/2+_,m.rotation._y=m.rotation._y+Math.PI/2;var b=new i["StandardMaterial"]("material",d);b.diffuseTexture=new i["Texture"](B+"marker.png",d),m.material=b,b.freeze(),m.parent=a;var y=.8*g,v=g,O=p/20,E=50,C=i["Mesh"].CreateCylinder("inner",O,y,y,E,1,d,!0),M=i["Mesh"].CreateCylinder("outer",O,v,v,E,1,d,!0),w=i["CSG"].FromMesh(C),S=i["CSG"].FromMesh(M),R=S.subtract(w),P=new i["StandardMaterial"]("mat0",d),I=R.toMesh("csg2",P,d);I.material.mainColor=new i["Color3"](0,1,0);var L=new i["StandardMaterial"]("outinMaterial",d);L.diffuseColor=new i["Color3"](16/255,156/255,73/255),L.freeze(),I.material=L,I.position._y=p+_+O/2,I.parent=a,C.scaling._z=.7,C.scaling._x=.7,C.material=L,C.position=I.position,C.parent=a,M.dispose(),r.push(a);var N=this.makePhysicsObjects(r,d,x,o);console.log("physicsRoot",N);var k=N;s=k,f.hideLoadingUI();var D=document.getElementById("customLoadingScreenDiv");return D&&(D.outerHTML=""),setTimeout((function(){j.ArcAnimation(0,0,470*A/5)}),1500),s.freezeWorldMatrix(),s.position.y+=.1,T=s,s},getRobot(){return T},getStartPoint(){return O},customLoadingUI(){i["DefaultLoadingScreen"].prototype.displayLoadingUI=function(){if(document.getElementById("customLoadingScreenDiv"))document.getElementById("customLoadingScreenDiv").style.display="initial";else{this._loadingDiv=document.createElement("div"),this._loadingDiv.id="customLoadingScreenDiv",this._loadingDiv.style.background="#505781",this._loadingDiv.style.height="100%",this._loadingDiv.style.width="700px",this._loadingDiv.style.alignContent="center",this._loadingDiv.style.zIndex="10006";var e=new Image;e.src=B+"loading.gif",e.style.padding="15%",e.style.paddingTop="30%",this._loadingDiv.appendChild(e),this._resizeLoadingUI(),window.addEventListener("resize",this._resizeLoadingUI),document.body.appendChild(this._loadingDiv)}}},ArcAnimation(e,t,r){var n=new i["Animation"]("animCam","alpha",30,i["Animation"].ANIMATIONTYPE_FLOAT,i["Animation"].ANIMATIONLOOPMODE_CYCLE),o=[];o.push({frame:0,value:_.alpha}),o.push({frame:100,value:e});var s=new i["Animation"]("animCam","beta",30,i["Animation"].ANIMATIONTYPE_FLOAT,i["Animation"].ANIMATIONLOOPMODE_CYCLE),a=[];a.push({frame:0,value:_.beta}),a.push({frame:100,value:t});var l=new i["Animation"]("animCam","radius",30,i["Animation"].ANIMATIONTYPE_FLOAT,i["Animation"].ANIMATIONLOOPMODE_CYCLE),h=[];h.push({frame:0,value:_.radius}),h.push({frame:100,value:r}),n.setKeys(o),s.setKeys(a),l.setKeys(h),_.animations.push(n),_.animations.push(s),_.animations.push(l),d.beginAnimation(_,0,100,!1,6,(function(){}))},dragListening(e){var t,r=f.getRenderingCanvas(),i=function(){var e=d.pick(d.pointerX,d.pointerY,(function(e){return e==m||e==b||e==g}));return e.hit?e.pickedPoint:null},n=function(n){if(0===n.button){var o=d.pick(d.pointerX,d.pointerY,(function(e){return e!==m&&e!==b&&e!==v&&e!==g}));console.log("pickInfo",o),o.hit&&(d.stopAnimation(parent),t=o.pickedMesh,null==t.parent?console.log("no parent"):"robot"==t.parent.name?t=t.parent:"pencil"==t.parent.name&&(t=t.parent.parent),console.log("currentMesh",t),e=i(n),e&&setTimeout((function(){_.detachControl(r)}),0))}},o=function(){if(H&&(H=!1,c.isVisible=!1),e)return _.attachControl(r,!0),void(e=null)},s=function(r){if(e){var n=i(r);if(n){var o=n.subtract(e);t.position.addInPlace(o),console.log("currentMesh.name",t.name),e=n}}};r.addEventListener("pointerdown",n,!1),r.addEventListener("pointerup",o,!1),r.addEventListener("pointermove",s,!1),O=e}};t["a"]=j}}]);
//# sourceMappingURL=chunk-47e17d80.a8d53e87.js.map